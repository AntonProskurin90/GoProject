/*
 * Copyright (C) 2014  Ilya Kirillov 
 * email: ilya_kirillov@inbox.ru
 * 
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 3.0 of the License, or (at your option) any later version.
 * 
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
*/
(function(){var r;function aa(a){this.k=a;this.H=this.c=null;this.qa=0;this.uc=!1;this.sg=this.pe=this.bd=this.vc=this.wc=0;this.yg={};this.La=null;this.b={M:0,D:0,Yh:0,gh:0,ab:0,Db:0,ih:2,I:null,hh:null,J:null,Ue:null,gg:[],ai:Array(361),Md:null,he:null,Qf:null,qc:null,rc:null,Kh:null,Lh:null,Bh:null,Ch:null,Eh:null,Gh:null,Fh:null,Hh:null,nh:null,bh:null,dh:null,yh:null,fh:null,Tg:null,Pg:null};this.Gb=this.qg=this.$c=this.fb=!0;this.R=new u(255,255,255,255);this.Q=new u(0,0,0,255);this.Ba=new u(231,188,95,255);this.Ra=new u(0,0,0,255);this.Z=!1;this.kj=new u(255,0,0,128);this.a={d:null,J:{d:null},I:{d:null},mc:{d:null},Pd:{d:null},ua:{d:null},fe:{d:null},Na:{d:null},nb:{d:null},Event:{d:null},Jf:[]};this.ib={f:-1,g:-1};this.Qa={};this.Ca={};this.we=-1;this.i={O:0,P:0,W:18,X:18};this.ac=null;this.me=!1;var b=this;this.Oe=function(a){ba(a);a=b.Hd(y.f,y.g);a=ca(b,a.f,a.g);da(b,a.f,a.g,!1)};this.Gd=function(a){ba(a);b.me=!1;ea(b)};this.Fd=function(a){fa(a);b.me=!0;b.a.Event.d.a.focus();var d=b.Hd(y.f,y.g),d=ca(b,d.f,d.g);b.Lg(d.f,d.g,y);a.preventDefault();a.stopPropagation();return!1};this.Ng=function(){b.me=!1};this.zj=function(a){ga(a);16===ha.Ja&&2===b.qa?(y.aa=!0,b.Va()):16!==ha.Ja&&17!==ha.Ja||10!==b.qa?ia(b):(16===ha.Ja?y.aa=!0:17===ha.Ja&&(y.U=!0),b.Va());a.preventDefault()};this.Aj=function(a){ga(a);16===ha.Ja&&2===b.qa?(y.aa=!1,b.Va()):16!==ha.Ja&&17!==ha.Ja||10!==b.qa||(16===ha.Ja?y.aa=!1:17===ha.Ja&&(y.U=!1),b.Va())};this.Og=function(){return setTimeout(function(){b.Kg();b.Ed();b.Me();b.Le();if(b.b.I){var a=b.b.ab;b.b.qc=ja(b,a,a,.05*a,new u(0,0,0,255));b.b.rc=ja(b,a,a,.05*a,new u(255,255,255,255));b.b.Kh=b.oa(a,a,.05*a,new u(0,0,0,255));b.b.Lh=b.oa(a,a,.05*a,new u(255,255,255,255));b.b.Bh=ka(b,a,a,.05*a,new u(0,0,0,255));b.b.Ch=ka(b,a,a,.05*a,new u(255,255,255,255));b.b.Eh=la(b,a,a,!1,new u(0,0,0,255),b.fb?new u(0,0,0,255):b.Z?new u(255,255,255,255):new u(0,0,0,255));b.b.Gh=la(b,a,a,!1,new u(255,255,255,255),b.fb?new u(255,255,255,255):b.Z?new u(255,255,255,255):new u(0,0,0,255));b.b.Fh=la(b,a,a,!0,new u(0,0,0,255),b.fb?new u(0,0,0,255):b.Z?new u(255,255,255,255):new u(0,0,0,255));b.b.Hh=la(b,a,a,!0,new u(255,255,255,255),b.fb?new u(255,255,255,255):b.Z?new u(255,255,255,255):new u(0,0,0,255));b.b.nh=ma(b,a,a,.05*a,new u(255,0,0,255));b.b.bh=ma(b,a,a,.05*a,new u(0,0,0,255));b.b.dh=ma(b,a,a,.05*a,new u(255,255,255,255));b.b.yh=ka(b,a,a,.05*a,new u(200,0,0,255));b.b.fh=ka(b,a,a,.05*a,new u(0,128,0,255));b.b.Tg=ka(b,a,a,.05*a,new u(0,0,200,255));b.b.Pg=ka(b,a,a,.05*a,new u(128,128,128,255))}b.Ua();b.b.Qf=na(b)},20)};this.xj=function(a){a.preventDefault();return!1};this.yj=function(a){a.preventDefault();if(0<a.dataTransfer.files.length&&FileReader){a=a.dataTransfer.files[0];var d=new FileReader;d.onload=function(a){b.c.kc(a.target.result)};d.readAsText(a);b.Da()}}}r=aa.prototype;r.v=function(a,b){this.k&&this.k.zh(this);this.c=b;this.H=b.ca;this.c.n=this;this.a.d=z(a);var c=this.a.d.a,d=a+"_BoardCanvas",f=a+"_LinesCanvas",e=a+"_ColorCanvas",g=a+"_ShadowsCanvas",h=a+"_StonesCanvas",l=a+"_VariantsCanvas",k=a+"_MarksCanvas",m=a+"_TargetCanvas",n=a+"_EventDiv";this.xa(c,d);this.xa(c,f);this.xa(c,e);this.xa(c,g);this.xa(c,h);this.xa(c,l);this.xa(c,k);this.xa(c,m);var c=this.na(c,n),p=this.a.d;this.ga(this.a.J,p,d);this.ga(this.a.I,p,f);this.ga(this.a.Pd,p,e);this.ga(this.a.ua,p,g);this.ga(this.a.mc,p,h);this.ga(this.a.fe,p,l);this.ga(this.a.Na,p,k);this.ga(this.a.nb,p,m);this.ga(this.a.Event,p,n);c.onmousemove=this.Oe;c.onmouseout=this.Gd;c.onmousedown=this.Fd;c.onmouseup=this.Ng;c.onkeydown=this.zj;c.onkeyup=this.Aj;c.tabIndex=-1;c.style.$i=!0;c.style.outline=0;c.ondragover=this.xj;c.ondrop=this.yj;return p};r.Rg=function(a){this.a.Jf.push(a)};r.Da=function(){this.a.Event.d.a.focus()};function oa(a,b){if(b!==a.uc){a.uc=b;for(var c=0,d=a.a.Jf.length;c<d;c++){var f=a.a.Jf[c];f.Ea(f.width,f.height)}pa(a);a.Ua(!0)}}function na(a){var b=document.createElement("canvas"),c=b.getContext("2d");b.width=a.a.J.d.a.width;b.height=a.a.J.d.a.height;c.drawImage(a.a.J.d.a,0,0);c.drawImage(a.a.I.d.a,0,0);c.drawImage(a.a.ua.d.a,0,0);c.drawImage(a.a.mc.d.a,0,0);c.drawImage(a.a.Na.d.a,0,0);return b}r.t=function(a){var b=this.a.d.a.clientWidth,c=this.a.d.a.clientHeight,d=qa(this),f=c*d;f<=b?b=f:c=b/d;if(b!==this.b.Yh||c!==this.b.gh||!0===a)this.b.Yh=b,this.b.gh=c,this.a.d.Ea(b,c),pa(this),this.Ua(a)};function sa(a,b,c,d,f){var e=a.H.V(),e=Math.min(e.f,e.g);a.i.O=Math.max(0,Math.min(e-1,b));a.i.P=Math.max(0,Math.min(e-1,c));a.i.W=Math.max(0,Math.min(e-1,d));a.i.X=Math.max(0,Math.min(e-1,f));a.i.W<=a.i.O&&(a.i.O=0,a.i.W=e-1);a.i.X<=a.i.P&&(a.i.P=0,a.i.X=e-1)}function ta(a,b,c,d){if(a.b.I&&d!==a.yg[(c<<8)+b]){var f=a.a.mc.d.a.getContext("2d"),e=a.a.ua.d.a.getContext("2d"),g=a.b.ab,h=(g-1)/2,l=a.b.I,k=a.b.Db;if(!0===ua(a,b-1,c-1)){var m=l[b-1].f-h,h=l[c-1].g-h;switch(d){case A:f.putImageData(a.b.Ue,m,h);!0===a.Gb&&e.putImageData(a.b.ua,m+k,h+k);break;case B:f.putImageData(a.b.gg[a.b.ai[b-1+(c-1)*a.H.V().f]],m,h);!0===a.Gb&&e.putImageData(a.b.ua,m+k,h+k);break;default:f.clearRect(m,h,g,g),!0===a.Gb&&e.clearRect(m+k,h+k,g,g)}}a.yg[(c<<8)+b]=d;b===a.ib.f&&c===a.ib.g&&(A===d||B===d?ea(a):a.Va())}}r.$a=function(a,b){var c=(b<<8)+a;delete this.Ca[""+c];c===this.we&&(this.Ca[""+c]=new C(a,b,va,""))};r.za=function(a){wa(this,a.Mc(),a.Nc(),a)};function D(a,b){if((a.c.A&xa||9===b)&&a.qa!==b){1===a.qa&&a.c.hf();a.qa=b;a.Va();if(1===b){var c=a.H;c.ob=[];for(var d=1;d<=c.G;d++)for(var f=1;f<=c.B;f++)c.ob[ya(c,f,d)]=E;za(c,!1);a.c.Qd()}else if(9===b){c=a.H;for(d=1;d<=c.G;d++)for(f=1;f<=c.B;f++)Aa(c,f,d,c.w(f,d));c=Ba(a.H,a);a.ue&&Ca(a.ue,"B "+c.Vg+"("+c.Ug+") W "+c.$h+"("+c.Zh+")")}a.c.Vb()}}function qa(a){var b=a.H.V(),b=Math.min(b.f,b.g),c=(a.i.W-a.i.O)*Da+2*Ea,d=(a.i.X-a.i.P)*Da+2*Ea;!0===a.uc&&(c+=Da,d+=Da);0<a.i.O&&(c+=Fa/2);a.i.W<b-1&&(c+=Fa/2);0<a.i.P&&(d+=Fa/2);a.i.X<b-1&&(d+=Fa/2);return c/d}r.xa=function(a,b){var c=document.createElement("canvas");c.setAttribute("id",b);c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("oncontextmenu","return false;");a.appendChild(c);return c};r.na=function(a,b){var c=document.createElement("div");c.setAttribute("id",b);c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("oncontextmenu","return false;");a.appendChild(c);return c};r.ga=function(a,b,c){a.d=z(c);a=a.d;F(a.h,0,0,1E3,1E3,!1,!1,!1,!1,-1,-1);a.m=I|J|L|P;b.l(a)};r.Hd=function(a,b){var c=Ga(this.a.J.d.a);return{f:a-c.f,g:b-c.g}};function pa(a){var b=a.H.V(),b=Math.min(b.f,b.g);a.i.O=Math.max(0,Math.min(b-1,a.i.O));a.i.P=Math.max(0,Math.min(b-1,a.i.P));a.i.W=Math.max(0,Math.min(b-1,a.i.W));a.i.X=Math.max(0,Math.min(b-1,a.i.X));a.i.W<=a.i.O&&(a.i.O=0,a.i.W=b-1);a.i.X<=a.i.P&&(a.i.P=0,a.i.X=b-1);var c=(a.i.W-a.i.O)*Da+2*Ea,d=(a.i.X-a.i.P)*Da+2*Ea,f=Ea,e=Ea;!0===a.uc&&(c+=Da,d+=Da,f+=Fa,e+=Fa);0<a.i.O&&(c+=Fa/2,f+=Fa/2);a.i.W<b-1&&(c+=Fa/2);0<a.i.P&&(d+=Fa/2,e+=Fa/2);a.i.X<b-1&&(d+=Fa/2);a.pe=Da/d;a.bd=Da/c;a.vc=f/c;a.wc=e/d;a.sg=4/c}r.Ua=function(a){var b=this.a.J.d.a.width,c=this.a.J.d.a.height;if(b!=this.b.M||c!=this.b.D||null===this.b.J||null!==this.La||!0===a){if(null!==this.La&&clearTimeout(this.La),this.La=this.Og(),this.Ed(),0!==b&&0!==c)if(null!==this.b.Qf)this.a.J.d.a.getContext("2d").drawImage(this.b.Qf,0,0,b,c);else{var d=this.a.J.d.a.getContext("2d");d.fillStyle=Q(this.Ba);d.fillRect(0,0,b,c);var f=this.a.I.d.a.getContext("2d"),d=this.bd*b;a=this.pe*c;var e=this.vc*b-this.i.O*d,g=this.wc*c-this.i.P*a,h=this.H.V();f.clearRect(0,0,b,c);f.strokeStyle=Q(this.Ra);for(var l=e+(h.f-1)*d,k=0;k<h.g;k++){var m=g+k*a;f.beginPath();f.moveTo(e,m);f.lineTo(l,m);f.stroke()}for(var l=g+(h.g-1)*a,n=0;n<h.f;n++)m=e+n*d,f.beginPath(),f.moveTo(m,g),f.lineTo(m,l),f.stroke();if(h.f===h.g&&(9===h.f||13===h.f||19===h.f)){f.fillStyle=Q(this.Ra);k=Math.max(2,this.sg*b/2);n=[];switch(h.f){case 9:n=[[2,2],[2,6],[4,4],[6,2],[6,6]];break;case 13:n=[[3,3],[3,6],[3,9],[6,3],[6,6],[6,9],[9,3],[9,6],[9,9]];break;case 19:n=[[3,3],[3,9],[3,15],[9,3],[9,9],[9,15],[15,3],[15,9],[15,15]]}for(var p=0,t=n.length;p<t;p++)l=e+n[p][0]*d,m=g+n[p][1]*d,f.beginPath(),f.arc(l,m,k,0,2*Math.PI,!1),f.fill()}f=this.a.mc.d.a.getContext("2d");f.clearRect(0,0,b,c);f.strokeStyle=Q(this.Ra);f.lineWidth=1;p=Q(new u(0,0,0,255));t=Q(new u(255,255,255,255));for(k=1;k<=h.g;k++)for(n=1;n<=h.f;n++){l=this.H.w(n,k);if(A===l)f.fillStyle=p;else if(B===l)f.fillStyle=t;else continue;l=e+(n-1)*d;m=g+(k-1)*a;f.beginPath();f.arc(l,m,d/2,0,2*Math.PI,!1);f.fill();f.stroke()}this.a.ua.d.a.getContext("2d").clearRect(0,0,b,c);this.a.fe.d.a.getContext("2d").clearRect(0,0,b,c);this.a.Na.d.a.getContext("2d").clearRect(0,0,b,c);this.a.nb.d.a.getContext("2d").clearRect(0,0,b,c)}}else{this.a.J.d.a.getContext("2d").putImageData(this.b.J,0,0);if(!0===this.uc&&this.b.I){b=this.a.J.d.a.getContext("2d");c=this.b.M;h=this.b.D;a=this.H.V();for(f=this.i.O;f<=this.i.W;f++){l=2*this.b.ab/3;e=(l-1)/2;m=this.b.I;g=m[f].f-e;m=this.wc*h/3-e;k=new String;switch(f+1){case 1:k="A";break;case 2:k="B";break;case 3:k="C";break;case 4:k="D";break;case 5:k="E";break;case 6:k="F";break;case 7:k="G";break;case 8:k="H";break;case 9:k="J";break;case 10:k="K";break;case 11:k="L";break;case 12:k="M";break;case 13:k="N";break;case 14:k="O";break;case 15:k="P";break;case 16:k="Q";break;case 17:k="R";break;case 18:k="S";break;case 19:k="T";break;case 20:k="a";break;case 21:k="b";break;case 22:k="c";break;case 23:k="d";break;case 24:k="e";break;case 25:k="f";break;case 26:k="g";break;case 27:k="h";break;case 28:k="j";break;case 29:k="k";break;case 30:k="l";break;case 31:k="m";break;case 32:k="n";break;case 33:k="o";break;case 34:k="p";break;case 35:k="q";break;case 36:k="r";break;case 37:k="s";break;case 38:k="t"}n=2*l/3;p=Ha(k)?"Arial":"Helvetica, Arial, Verdana";p=n+"px "+p;b.fillStyle="rgb(0,0,0)";b.font=p;n=l/2+n/3;l=(l-b.measureText(k).width)/2;b.fillText(k,g+l,m+n);m=h-this.wc*h/3-e;b.fillText(k,g+l,m+n)}for(h=this.i.P;h<=this.i.X;h++)l=2*this.b.ab/3,e=(l-1)/2,m=this.b.I,g=this.vc*c/3-e,m=m[h].g-e,k=a.g-h+"",n=2*l/3,p=Ha(k)?"Arial":"Helvetica, Arial, Verdana",p=n+"px "+p,b.fillStyle="rgb(0,0,0)",b.font=p,n=l/2+n/3,l=(l-b.measureText(k).width)/2,b.fillText(k,g+l,m+n),g=c-this.vc*c/3-e,b.fillText(k,g+l,m+n)}Ia(this);b=this.b.M;c=this.b.D;this.a.mc.d.a.getContext("2d").clearRect(0,0,b,c);this.a.ua.d.a.getContext("2d").clearRect(0,0,b,c);this.yg={};Ja(this);for(d in this.Qa)b=R(d),Ka(this,b.f,b.g);La(this)}};r.Kg=function(){var a=this.a.J.d.a.width,b=this.a.J.d.a.height,c=this.a.J.d.a.getContext("2d");if(0!==a&&0!==b){for(var c=c.createImageData(a,b),d=.9,f=this.Ba.o,e=this.Ba.q,g=this.Ba.p,h=Array(a),l=0;l<a;l++)h[l]=(Math.tan(300*l/a)+1)/2+(Math.tan(100*l/a)+1)/10;for(var k=Array(b),m=0;m<b;m++)k[m]=.02*Math.tan(m/b);var n,p;if(!0===this.fb)for(m=0;m<b;m++)for(l=0;l<a;l++){d=40*(h[l]+k[m])+.5;d-=Math.floor(d);d=.2>d?1-d/2:.4>d?1-(.4-d)/2:1;if(m==b-1||m==b-2&&l<a-2||l>=a-1||l==a-2&&m<b-1)d/=2;0==m||1==m&&1<l||0==l||1==l&&1<m?(n=128+f*d/2,p=128+e*d/2,d=128+g*d/2):(n=f*d,p=e*d,d*=g);var t=4*(l+m*a);c.data[t+0]=n;c.data[t+1]=p;c.data[t+2]=d;c.data[t+3]=255}else for(m=0;m<b;m++)for(l=0;l<a;l++)0==m||1==m&&1<l||0==l||1==l&&1<m?(n=128+f/2,p=128+e/2,d=128+g/2):(n=f,p=e,d=g),t=4*(l+m*a),c.data[t+0]=n,c.data[t+1]=p,c.data[t+2]=d,c.data[t+3]=255;this.b.J=c;this.b.M=a;this.b.D=b;this.La=null}};r.Ed=function(){var a=this.b.M,b=this.b.D;if(0!==a&&0!==b){for(var c=this.vc*a,d=this.wc*b,b=this.pe*b,f=this.bd*a,e=this.H.V(),g=Math.min(e.f,e.g),e=Array(e.f),c=c-f*this.i.O,d=d-b*this.i.P,h,l,k,m,n,p,t,q,v,x,H=0;H<g;H++)h=c+H*f,k=c+H*f+.6*f,n=c+H*f-.6*f,t=c+H*f+.5*f,v=c+H*f-.5*f,l=d+H*b,m=d+H*b+.6*b,p=d+H*b-.6*b,q=d+H*b+.5*b,x=d+H*b-.5*b,e[H]={f:Math.floor(h+.5),Wi:Math.floor(k+.5),Xi:Math.floor(n+.5),hg:Math.floor(t+.5),Wc:Math.floor(v+.5),g:Math.floor(l+.5),Yi:Math.floor(m+.5),Zi:Math.floor(p+.5),ig:Math.floor(q+.5),Xc:Math.floor(x+.5)};this.b.I=e;a=Math.max(2,Math.ceil(this.sg*a/2));g=2*a+1;b=this.b;f=g+2;e=g+2;g=this.Ra;e=document.createElement("canvas").getContext("2d").createImageData(f,e);c=e.data;Math.max(f/2,2);d=f/2-.5;h=d-.2;for(l=0;l<f;l++)for(k=0;k<f;k++)m=l-d,n=k-d,m=h-Math.sqrt(m*m+n*n),n=4*(l*f+f-k-1),0<=m?(p=255,.8>=m&&(p=parseInt(255*(1-(.8-m)/.8))),c[n+0]=g.o,c[n+1]=g.q,c[n+2]=g.p,c[n+3]=p):(c[n+0]=0,c[n+1]=0,c[n+2]=0,c[n+3]=0);b.hh=e;this.b.ih=a+1}};function Ia(a,b){if(a.b.I){var c=a.b.M,d=a.b.D,f=a.a.I.d.a.getContext("2d"),e=a.H.V(),g=a.b.I;f.clearRect(0,0,c,d);if(e.f===e.g&&(9===e.f||13===e.f||19===e.f)){var h=a.b.hh,l=a.b.ih,k=[];switch(e.f){case 9:k=[[2,2],[2,6],[4,4],[6,2],[6,6]];break;case 13:k=[[3,3],[3,6],[3,9],[6,3],[6,6],[6,9],[9,3],[9,6],[9,9]];break;case 19:k=[[3,3],[3,9],[3,15],[9,3],[9,9],[9,15],[15,3],[15,9],[15,15]]}for(var m=0,n=k.length;m<n;m++)!0===ua(a,k[m][0],k[m][1])&&f.putImageData(h,g[k[m][0]].f-l,g[k[m][1]].g-l)}for(var n=0===a.i.O?g[a.i.O].f:g[a.i.O].Xi,l=e.f-1===a.i.W?g[a.i.W].f:g[a.i.W].Wi,k=0===a.i.P?g[a.i.P].g:g[a.i.P].Zi,m=e.f-1===a.i.X?g[a.i.X].g:g[a.i.X].Yi,p=f.createImageData(1,d),t=f.createImageData(c,1),q=a.Ra,v=0;v<d;v++)h=4*v,v>=k&&v<=m&&(p.data[h+0]=q.o,p.data[h+1]=q.q,p.data[h+2]=q.p,p.data[h+3]=q.Xb);for(v=0;v<c;v++)h=4*v,n<=v&&v<=l&&(t.data[h+0]=q.o,t.data[h+1]=q.q,t.data[h+2]=q.p,t.data[h+3]=q.Xb);for(v=0;v<e.f;v++)!0===(v>=a.i.O&&v<=a.i.W?!0:!1)&&f.putImageData(p,g[v].f,0),!0===(v>=a.i.P&&v<=a.i.X?!0:!1)&&f.putImageData(t,0,g[v].g);if(void 0!==b)for(c=g[1].f-g[0].f+2,d=g[1].g-g[0].g+2,h=0,n=b.length;h<n;h++)e=b[h].f,l=b[h].g,!0===ua(a,e-1,l-1)&&E===a.H.w(e,l)&&f.clearRect(g[e-1].Wc,g[l-1].Xc,c,d)}}r.Me=function(){if(this.b.I){var a=this.a.J.d.a.width,b=this.a.mc.d.a.getContext("2d"),a=2*Math.floor(Math.floor(this.bd*a)/2)+1;this.b.ab=a;this.b.Ue=b.createImageData(a,a);this.b.Vi=b.createImageData(a,a);this.b.Md=b.createImageData(a,a);this.b.he=b.createImageData(a,a);var c=this.b.Ue.data,d=this.b.Vi.data,f=this.b.Md.data,e=this.b.he.data;if(!0===this.$c)for(var g=a/2-.5,h=g-.2,l=Math.sqrt(3),k=0;k<a;k++)for(var m=0;m<a;m++){var n=k-g,p=m-g,t=h-Math.sqrt(n*n+p*p),q=4*(k*a+a-m-1);if(0<=t){var v=h*h-n*n-p*p,v=0<v?Math.sqrt(v)*l:0,x=n,H=p,O=Math.sqrt(6*(x*x+H*H+v*v)),O=(2*v-x+H)/O,v=0;.9<O&&(v=10*(O-.9));x=255;.8>=t&&(t=(.8-t)/.8,x=.7,n-p<h/3&&(x=1),x=parseInt(255*(1-t*x)));n=parseInt(10+10*O+140*v);c[q+0]=n;c[q+1]=n;c[q+2]=n;c[q+3]=x;f[q+0]=n;f[q+1]=n;f[q+2]=n;f[q+3]=parseInt(x/2);n=parseInt(200+10*O+45*v);d[q+0]=n;d[q+1]=n;d[q+2]=n;d[q+3]=x;e[q+0]=n;e[q+1]=n;e[q+2]=n;e[q+3]=parseInt(x/2)}else c[q+0]=0,c[q+1]=0,c[q+2]=0,c[q+3]=0,f[q+0]=0,f[q+1]=0,f[q+2]=0,f[q+3]=0,d[q+0]=0,d[q+1]=0,d[q+2]=0,d[q+3]=0,e[q+0]=0,e[q+1]=0,e[q+2]=0,e[q+3]=0}else for(g=a/2-.5,h=g-.2,k=0;k<a;k++)for(m=0;m<a;m++)n=k-g,p=m-g,t=h-Math.sqrt(n*n+p*p),q=4*(k*a+a-m-1),0<=t?(x=255,.8>=t?(O=(.8-t)/.8,x=.7,n-p<h/3&&(x=1),x=parseInt(255*(1-O*x))):1.6>=t&&.8<=t&&!0===this.Z&&(O=(1.6-t)/.8,x=.7,n-p<h/3&&(x=1),x=parseInt(O*x*255)),l=!1,1.6>=t&&(l=!0),!1===l||!1===this.Z?(c[q+0]=this.Q.o,c[q+1]=this.Q.q,c[q+2]=this.Q.p,c[q+3]=x,f[q+0]=this.Q.o,f[q+1]=this.Q.q,f[q+2]=this.Q.p,f[q+3]=parseInt(x/2)):(c[q+0]=this.R.o,c[q+1]=this.R.q,c[q+2]=this.R.p,c[q+3]=x,f[q+0]=this.R.o,f[q+1]=this.R.q,f[q+2]=this.R.p,f[q+3]=x),x=255,.8>=t?(O=(.8-t)/.8,x=.7,n-p<h/3&&(x=1),x=parseInt(255*(1-O*x))):1.6>=t&&.8<=t&&!1===this.Z&&(O=(1.6-t)/.8,x=.7,n-p<h/3&&(x=1),x=parseInt(O*x*255)),!1===l||!0===this.Z?(d[q+0]=this.R.o,d[q+1]=this.R.q,d[q+2]=this.R.p,d[q+3]=x,e[q+0]=this.R.o,e[q+1]=this.R.q,e[q+2]=this.R.p,e[q+3]=parseInt(x/2)):(d[q+0]=this.Q.o,d[q+1]=this.Q.q,d[q+2]=this.Q.p,d[q+3]=x,e[q+0]=this.Q.o,e[q+1]=this.Q.q,e[q+2]=this.Q.p,e[q+3]=x)):(c[q+0]=0,c[q+1]=0,c[q+2]=0,c[q+3]=0,f[q+0]=0,f[q+1]=0,f[q+2]=0,f[q+3]=0,d[q+0]=0,d[q+1]=0,d[q+2]=0,d[q+3]=0,e[q+0]=0,e[q+1]=0,e[q+2]=0,e[q+3]=0);c=[];f=[];for(q=0;28>q;q++)for(c[q]=b.createImageData(a,a),f[q]=c[q].data,k=0;k<a;k++)for(m=0;m<a;m++)g=4*(k*a+m),f[q][g+0]=d[g+0],f[q][g+1]=d[g+1],f[q][g+2]=d[g+2],f[q][g+3]=d[g+3];f.push(e);f.push(d);if(!0===this.qg){b=a/51*978|0;d=.9;q=Array(b);for(e=0;e<b;e++)q[e]=(Math.sin(18*e/b)+1)/20+(Math.sin(3*e/b)+1)/10;g=Array(b);for(k=0;k<b;k++)g[k]=.2*Math.cos(5*k/b)+.1*Math.sin(11*k/b);m=Array(b*b);for(k=0;k<b;k++)for(e=0;e<b;e++)d=90*(q[e]+g[k])+.5,d-=Math.floor(d),d=.2>d?1-d/2:.4>d?1-(.4-d)/2:1,m[e+k*b]=d;q=f.length;for(g=0;g<q;g++){var h=f[g],G,K;switch(g){case 0:G=12*b/978|0;K=163*b/978|0;break;case 1:G=12*b/978|0;K=213*b/978|0;break;case 2:G=12*b/978|0;K=263*b/978|0;break;case 3:G=12*b/978|0;K=313*b/978|0;break;case 4:G=62*b/978|0;K=163*b/978|0;break;case 5:G=62*b/978|0;K=213*b/978|0;break;case 6:G=62*b/978|0;K=263*b/978|0;break;case 7:G=62*b/978|0;K=313*b/978|0;break;case 8:G=113*b/978|0;K=163*b/978|0;break;case 9:G=113*b/978|0;K=213*b/978|0;break;case 10:G=113*b/978|0;K=263*b/978|0;break;case 11:G=113*b/978|0;K=313*b/978|0;break;case 12:G=163*b/978|0;K=163*b/978|0;break;case 13:G=163*b/978|0;K=213*b/978|0;break;case 14:G=163*b/978|0;K=263*b/978|0;break;case 15:G=163*b/978|0;K=313*b/978|0;break;case 16:G=213*b/978|0;K=163*b/978|0;break;case 17:G=213*b/978|0;K=213*b/978|0;break;case 18:G=213*b/978|0;K=263*b/978|0;break;case 19:G=213*b/978|0;K=313*b/978|0;break;case 20:G=263*b/978|0;K=163*b/978|0;break;case 21:G=263*b/978|0;K=213*b/978|0;break;case 22:G=263*b/978|0;K=263*b/978|0;break;case 23:G=263*b/978|0;K=313*b/978|0;break;case 24:G=313*b/978|0;K=163*b/978|0;break;case 25:G=313*b/978|0;K=213*b/978|0;break;case 26:G=313*b/978|0;K=263*b/978|0;break;case 27:G=313*b/978|0;K=313*b/978|0;break;case 28:G=12*b/978|0;K=12*b/978|0;break;case 29:G=12*b/978|0,K=12*b/978|0}for(k=0;k<a;k++)for(e=0;e<a;e++)d=m[G+e+(K+k)*b],n=4*(e+k*a),h[n+0]*=Math.pow(d,.8),h[n+1]*=Math.pow(d,.8),h[n+2]*=Math.pow(d,.8)}}this.b.gg=c;G=this.H.V();for(K=0;K<G.g;K++)for(a=0;a<G.f;a++)this.b.ai[a+K*G.f]=Math.floor(Math.random()*(this.b.gg.length-1))}};function Ja(a){for(var b=a.H.V(),c=1;c<=b.g;c++)for(var d=1;d<=b.f;d++)ta(a,d,c,a.H.w(d,c))}r.Le=function(){if(this.b.I){var a=this.a.ua.d.a.getContext("2d"),b=this.b.ab;this.b.ua=a.createImageData(b,b);a=this.b.ua.data;this.b.Db=Math.max(parseInt(.15*b),3);for(var c=(b-5)/2+1,d=0;d<b;d++)for(var f=0;f<b;f++){var e=Math.abs(d-c),g=Math.abs(f-c),e=Math.sqrt(g*g+e*e)/c,e=1>e?.15+.75*(1-e):0,g=4*(b*d+f);a[g+0]=0;a[g+1]=0;a[g+2]=0;a[g+3]=parseInt(255*e)}}};r.Va=function(){da(this,this.ib.f,this.ib.g,!0)};function da(a,b,c,d){var f=y;if(-1===b||-1===c||0===b||0===c)ea(a);else if(null===a.La&&null!==a.b.I&&(void 0===d&&(d=!1),b!==a.ib.f||c!==a.ib.g||!0===d)){a.ib.f=b;a.ib.g=c;10===a.qa&&a.me&&!d&&Ma(a,b,c,f);var e=a.b.M,g=a.b.D;d=a.a.nb.d.a.getContext("2d");d.clearRect(0,0,e,g);if(!0===ua(a,b-1,c-1)){var g=(a.b.ab-1)/2,h=a.b.I,e=h[b-1].f-g,g=h[c-1].g-g,h=a.H.w(b,c);switch(a.qa){case 0:E===h&&(A===a.c.gb?d.putImageData(a.b.Md,e,g):d.putImageData(a.b.he,e,g));break;case 1:A===h?d.putImageData(a.b.rc,e,g):B===h&&d.putImageData(a.b.qc,e,g);break;case 2:A===h?d.putImageData(a.b.rc,e,g):B===h?d.putImageData(a.b.qc,e,g):f.aa?d.putImageData(a.b.he,e,g):d.putImageData(a.b.Md,e,g);break;case 9:b=Oa(a.H,b,c);A===b?d.putImageData(a.b.rc,e,g):B===b&&d.putImageData(a.b.qc,e,g);break;case 10:y.U&&!y.aa?d.putImageData(a.b.yh,e,g):!y.U&&y.aa?d.putImageData(a.b.fh,e,g):y.U&&y.aa?d.putImageData(a.b.Pg,e,g):d.putImageData(a.b.Tg,e,g);break;default:A===h||E===h&&!0===a.Z?d.putImageData(a.b.rc,e,g):d.putImageData(a.b.qc,e,g)}}}}function ea(a){var b=a.b.M,c=a.b.D;a.a.nb.d.a.getContext("2d").clearRect(0,0,b,c);a.ib.f=-1;a.ib.g=-1}function ca(a,b,c){for(var d=a.b.M,f=a.b.D,e=a.pe*f,g=a.bd*d,d=a.vc*d-e*a.i.O,h=a.wc*f-g*a.i.P,f=0,l=a.H.V(),f=0;f<l.g-1&&c>h+e*f+e/2;f++);for(c=c=0;c<l.f-1&&b>d+g*c+g/2;c++);c=Math.max(a.i.O,Math.min(a.i.W,c));f=Math.max(a.i.P,Math.min(a.i.X,f));return{f:c+1,g:f+1}}function ja(a,b,c,d,f){a=a.a.Na.d.a.getContext("2d");a.clearRect(0,0,b,c);a.strokeStyle=Q(f);a.fillStyle=Q(f);a.lineWidth=d;a.beginPath();a.moveTo(1*b/4,1*c/4);a.lineTo(3*b/4,3*c/4);a.moveTo(3*b/4,1*c/4);a.lineTo(1*b/4,3*c/4);a.stroke();return a.getImageData(0,0,b,c)}r.oa=function(a,b,c,d,f){void 0===f&&(f=1);var e=this.a.Na.d.a.getContext("2d");e.clearRect(0,0,a,b);e.globalAlpha=f;e.strokeStyle=Q(d);e.fillStyle=Q(d);e.lineWidth=c;var g=a/2;c=3*b/4;d=.1*a;f=Math.sqrt(g*g-(c-g)*(c-g))+g;g=-Math.sqrt(g*g-(c-g)*(c-g))+g;e.beginPath();e.moveTo(a/2,d);e.lineTo(f-d,c);e.lineTo(g+d,c);e.closePath();e.stroke();return e.getImageData(0,0,a,b)};function ka(a,b,c,d,f){var e=a.a.Na.d.a.getContext("2d");e.clearRect(0,0,b,c);e.strokeStyle=Q(f);e.fillStyle=Q(f);e.lineWidth=Math.floor(d+.5);var g=b/2,h=-c/2*Math.sqrt(2)/2+c/2;a=Math.floor(-Math.sqrt(g*g-(h-g)*(h-g))+g);var g=Math.ceil(+Math.sqrt(g*g-(h-g)*(h-g))+g),h=Math.ceil(h),l=Math.floor(c/2*Math.sqrt(2)/2+c/2);d=Math.floor(d);for(var e=e.createImageData(b,c),k=0;k<c;k++)for(var m=0;m<b;m++){var n=4*(k*b+m);(a<=m&&m<=a+d||g-d<=m&&m<=g)&&h<=k&&k<=l||(h<=k&&k<=h+d||l-d<=k&&k<=l)&&a<=m&&m<=g?(e.data[n+0]=f.o,e.data[n+1]=f.q,e.data[n+2]=f.p,e.data[n+3]=255):(e.data[n+0]=0,e.data[n+1]=0,e.data[n+2]=0,e.data[n+3]=0)}return e}function la(a,b,c,d,f,e){a=a.a.Na.d.a.getContext("2d").createImageData(b,c);var g=d?c/4|0:c/3|0,h=d?3*c/4|0:2*c/3|0,l=d?b/4|0:b/3|0;d=d?3*b/4|0:2*b/3|0;for(var k=0;k<c;k++)for(var m=0;m<b;m++){var n=4*(k*b+m);(k===g||k===h)&&m>=l&&m<=d||(m===l||m===d)&&k>=g&&k<=h?(a.data[n+0]=e.o,a.data[n+1]=e.q,a.data[n+2]=e.p,a.data[n+3]=255):k>g&&k<h&&m>l&&m<d?(a.data[n+0]=f.o,a.data[n+1]=f.q,a.data[n+2]=f.p,a.data[n+3]=255):a.data[n+3]=0}return a}function ma(a,b,c,d,f){a=a.a.Na.d.a.getContext("2d");a.clearRect(0,0,b,c);var e=b/2,g=4*d;a.strokeStyle=Q(f);a.fillStyle=Q(f);a.lineWidth=d;a.beginPath();a.arc(b/2,c/2,e-g,0,2*Math.PI,!1);a.stroke();return a.getImageData(0,0,b,c)}function Pa(a,b,c){a=a.Ca[""+((c<<8)+b)];return void 0!==a?a:null}function wa(a,b,c,d){va===d.C?Qa(a,b,c):a.Ca[""+((c<<8)+b)]=d}function Qa(a,b,c){if(0>=b||0>=c)a.we=0;else{var d=(c<<8)+b;void 0===a.Ca[""+d]&&(a.Ca[""+d]=new C(b,c,va,""));a.we=d}}function La(a){a.a.Na.d.a.getContext("2d").clearRect(0,0,a.b.M,a.b.D);var b=[],c;for(c in a.Ca){var d=a.Ca[c];Ra(a,d);Sa===d.C&&b.push({f:d.Mc(),g:d.Nc()})}Ia(a,b)}function Ra(a,b){if(a.b.I){var c=b.Mc(),d=b.Nc(),f=b.C,e=a.a.Na.d.a.getContext("2d");if(!0===ua(a,c-1,d-1)){var g=a.b.ab,h=(g-1)/2,l=a.b.I,k=l[c-1].f-h,h=l[d-1].g-h,c=a.H.w(c,d);switch(f){case Ta:e.putImageData(a.b.Eh,k,h);break;case Ua:e.putImageData(a.b.Gh,k,h);break;case Va:e.putImageData(a.b.Fh,k,h);break;case Wa:e.putImageData(a.b.Hh,k,h);break;case va:e.putImageData(a.b.nh,k,h);break;case Xa:e.putImageData(c===A||c==E&&1==a.Z?a.b.dh:a.b.bh,k,h);break;case Ya:e.putImageData(c===A||c==E&&1==a.Z?a.b.Ch:a.b.Bh,k,h);break;case Za:e.putImageData(c===A||c==E&&1==a.Z?a.b.Lh:a.b.Kh,k,h);break;case $a:e.putImageData(c===A||c==E&&1==a.Z?a.b.rc:a.b.qc,k,h);break;case Sa:f=b.Fe,d=2>=f.length?2*g/3:g/2,l=d+"px "+(Ha(f)?"Arial":"Helvetica, Arial, Verdana"),e.fillStyle=c===A||c==E&&1==a.Z?"rgb(255,255,255)":"rgb(0,0,0)",e.font=l,e.fillText(f,k+(g-e.measureText(f).width)/2,h+(g/2+d/3))}}}}function ab(a){a.a.Pd.d.a.getContext("2d").clearRect(0,0,a.b.M,a.b.D);a.Qa={}}function Ma(a,b,c,d){var f=(c<<8)+b;if(bb===d.ef)void 0!==a.Qa[f]&&(delete a.Qa[f],cb(a,b,c));else{d=d.U&&!d.aa?new u(200,0,0,60):d.aa&&!d.U?new u(0,100,0,60):d.aa&&d.U?new u(80,80,80,60):new u(0,0,200,60);if(void 0!==a.Qa[f]){var e=a.Qa[f];d.o===e.o&&d.q===e.q&&d.p===e.p?(d=e.Xb,a.Qa[f].Xb=60>d?60:120>d?120:180):a.Qa[f]=d}else a.Qa[f]=d;Ka(a,b,c)}}function Ka(a,b,c){cb(a,b,c);var d=a.a.Pd.d.a.getContext("2d"),f=a.b.I,e=b-1,g=c-1;d.fillStyle=Q(a.Qa[(c<<8)+b]);d.beginPath();d.moveTo(f[e].Wc,f[g].Xc);d.lineTo(f[e].hg,f[g].Xc);d.lineTo(f[e].hg,f[g].ig);d.lineTo(f[e].Wc,f[g].ig);d.closePath();d.fill()}function cb(a,b,c){var d=a.a.Pd.d.a.getContext("2d");a=a.b.I;--b;--c;d.clearRect(a[b].Wc,a[c].Xc,a[b].hg-a[b].Wc,a[c].ig-a[c].Xc)}r.Lg=function(a,b,c){switch(this.qa){case 0:if(bb==c.ef)1<=this.c.ed&&(db(this.c,1),eb(this,a,b));else if(c.aa&&c.U)this.c.Sc(A===this.c.gb?B:A),this.Va();else if(!0===c.U){var d=new String;switch(a){case 1:d="A";break;case 2:d="B";break;case 3:d="C";break;case 4:d="D";break;case 5:d="E";break;case 6:d="F";break;case 7:d="G";break;case 8:d="H";break;case 9:d="J";break;case 10:d="K";break;case 11:d="L";break;case 12:d="M";break;case 13:d="N";break;case 14:d="O";break;case 15:d="P";break;case 16:d="Q";break;case 17:d="R";break;case 18:d="S";break;case 19:d="T"}this.c.Jd(d+b)}else if(c.aa){d=this.c;d.wa&&d.wa.Oi(!0);var f=d.j;fb(d);for(c=0;1E3>c&&E===d.ca.w(a,b);)gb(d,1),c++;E===d.ca.w(a,b)&&hb(d,f);d.wa&&d.wa.Oi(!1)}else eb(this,a,b),null!==this.ac&&ib(this.c.j)>=jb(this.ac)&&kb(this.ac);break;case 1:if(!0===c.U)D(this,0);else{d=this.H;f=d.w(a,b);if(E!==f)if(d.te.ra(),c=d.ob[ya(d,a,b)],A!==c&&B!==c){d.ea.ra();lb(d,a,b,f);for(var e in d.te.Oa)c=R(e|0),d.ea.ra(),mb(d,c.f,c.g,3-f),nb(d.ea,d,3);za(d,!0);d.ea.ra();lb(d,a,b,f);nb(d.ea,d,3-f)}else d.ea.ra(),lb(d,a,b,f),nb(d.ea,d,3),za(d,!0);this.c.Qd()}break;case 2:!0===this.c.j.ic()&&!0===ob(this.c,!0,!0)&&pb(this.c);d=A;E!==this.H.w(a,b)?d=E:c.aa&&(d=B);ta(this,a,b,d);this.H.ia(a,b,d,-1);this.c.Id(d,[(b<<8)+a]);break;case 3:qb(this,Za,a,b);break;case 4:qb(this,Ya,a,b);break;case 5:qb(this,Xa,a,b);break;case 6:qb(this,$a,a,b);break;case 7:a:{f=Pa(this,a,b);if(null!==f&&Sa===f.C)this.c.$a([(b<<8)+a]),this.$a(a,b);else{f="";c.aa&&(f=prompt("Enter the label that you want to add to board here. For best results, keep your label to one or two letters.",""));if(void 0==f||""===f||null===f){f=[];c=-1;for(d in this.Ca)if(e=this.Ca[d],Sa==e.C){e=e.Fe;var g=e.charCodeAt(0);1==e.length&&65<=g&&90>=g&&(f[g]=1)}for(d=65;90>=d;d++)if(void 0===f[d]||""==f[d]){c=d;break}f=-1==c?null:String.fromCharCode(c);if(null===f){alert("Sorry, all the standard labels are used up! To add more labels, you will have to shift click on the board and make up ur own labels to add.");break a}}d=new C(a,b,Sa,f);this.c.Dc(f,(b<<8)+a);wa(this,a,b,d)}La(this)}break;case 8:a:{d=Pa(this,a,b);if(null!==d&&Sa===d.C)this.c.$a([(b<<8)+a]),this.$a(a,b);else{d="";if(c.aa){d=this.H.tf(a,b);if(-1==d){alert("Sorry, no move has been made at that location, so you can't mark it with the move number!");break a}d=""+d}if(void 0===d||""===d||null===d){d=[];c=0;for(f in this.Ca)e=this.Ca[f],Sa===e.C&&Ha(e.Fe)&&(d[c]=parseInt(e.Fe),c++);if(0>=c)d="1";else{d.sort(rb);e=f=0;for(var g=!1,h=0;h<c;h++){if(d[h]>f+1){e=f+1;g=!0;break}f=d[h]}g||(e=f+1);d=""+e}}f=new C(a,b,Sa,d);this.c.Dc(d,(b<<8)+a);wa(this,a,b,f)}La(this)}break;case 9:d=this.H;c=d.w(a,b);if(E!==c){e=new sb;tb(d,a,b,e);f=[];for(g in e.Ae)f.push(g);a=Oa(d,a,b)!==c?c:A===c?B:A;b=0;for(c=f.length;b<c;b++)e=R(f[b]),Aa(d,e.f,e.g,a)}a=Ba(this.H,this);this.ue&&Ca(this.ue,"B "+a.Vg+"("+a.Ug+") W "+a.$h+"("+a.Zh+")");La(this);this.Va();break;case 10:Ma(this,a,b,c)}};function qb(a,b,c,d){var f=Pa(a,c,d);if(null!==f&&b===f.C){if(a.c.$a([(d<<8)+c]),a.$a(c,d),a.b.I&&!0===ua(a,c-1,d-1)){b=(a.b.ab-1)/2;var e=a.b.I,f=e[c-1].f-b,e=e[d-1].g-b;a.a.Na.d.a.getContext("2d").clearRect(f,e,2*b,2*b);b=R(a.we);c===b.f&&d===b.g&&(Qa(a,c,d),Ra(a,Pa(a,c,d)))}}else f=new C(c,d,b,""),a.c.za(b,[(d<<8)+c]),wa(a,c,d,f),Ra(a,f)}function eb(a,b,c){if(E===a.H.w(b,c)){var d=A===a.c.gb?A:B,f=!1,e=a.H.ub.kf();a.H.ia(b,c,d,-1);f=null!==ub(a.H,b,c,d,!0)?!0:null!==vb(a.H,b,c,d)?!1:!0;a.H.ia(b,c,E,-1);a.H.ub.Ic(e);1==f&&!0===wb(a.c,b,c,d)&&pb(a.c)}}function ia(a){var b=ha;if(9!==a.qa){var c=b.Ja;if(8===c||46===c)xb(a.c);else if(13===c)b=prompt("Enter here code of ur sgf file",""),a.c.kc(b);else if(37===c)b.U&&b.aa?fb(a.c):b.U?db(a.c,5):db(a.c,1);else if(38===c)b.U?a.c.uf():yb(a.c);else if(39===c)b.U&&b.aa?zb(a.c):b.U?gb(a.c,5):gb(a.c,1);else if(40===c)Ab(a.c);else if(69===c&&!0===b.U)Bb(a.a.d.a.id,Cb,{Lc:a.c});else if(72===c&&!0===b.U)Db(a.c);else if(79===c&&!0===b.U&&10===a.qa)Bb(a.a.d.a.id,Eb,{Di:a});else if(82===c&&!0===b.U&&10===a.qa)ab(a);else if(83===c&&!0===b.U){if(b=a.c.Sf(),FileReader&&Blob){var d=a.c.Bc;""===d&&(d=a.c.Dd+" vs. "+a.c.pd);""===d&&(d="download");d+=".sgf";a=new FileReader;a.readAsDataURL(new Blob([b],{type:"text/plain;charset=utf-8"}));a.onload=function(a){var b=document.createElement("a");b.href=a.target.result;b.target="_blank";b.download=d||"unknown file";a=document.createEvent("Event");a.initEvent("click",!0,!0);b.dispatchEvent(a);(window.URL||window.webkitURL).revokeObjectURL(b.href)}}}else 112===c?D(a,0):113===c?D(a,1):114===c?D(a,2):115===c?D(a,3):116===c?D(a,4):117===c?D(a,5):118===c?D(a,6):119===c?D(a,7):120===c?D(a,8):121===c?D(a,10):189===c?(b=a.c.yc,b++,b>Fb&&(b=Gb),Hb(a.c,b)):192===c&&oa(a,!0===a.uc?!1:!0)}}function ua(a,b,c){return b>=a.i.O&&b<=a.i.W&&c>=a.i.P&&c<=a.i.X?!0:!1};function Ib(a){this.k=a;this.c=null;this.la=this.C=0;this.kd=16;this.pg=!1;this.b={eh:null,sh:null,mh:null,Qg:null,Ah:null};this.a={d:null,Od:{d:null}};this.Bg=new u(217,217,217,255);this.ze=new u(0,0,0,255);this.ve=new u(54,101,179,255);this.od=new u(255,255,255,255);this.wg=new u(54,101,179,255);this.se=new u(255,255,255,255);this.zg=new u(217,217,217,255);this.Ag=new u(140,140,140,255);this.G=this.B=0;var b=this;this.Fd=function(a){4!==b.la&&(fa(a),b.la=1,Jb(b),a.stopImmediatePropagation())};this.Ng=function(a){if(4!==b.la){if(y.ta!==a.target)return;b.la=2;Jb(b);b.Lg();a.stopImmediatePropagation()}b.Ne()};this.Dj=function(){4!==b.la&&(1!==b.la&&(b.la=2),Jb(b))};this.Gd=function(){4!==b.la&&(b.la=b.pg?8:0,Jb(b))};this.Ne=function(){b.c&&20!==b.C&&b.c.Da()};this.Mg=function(a){a.dataTransfer.effectAllowed="all";a.dataTransfer.setData("text/sgf","(;SZ[19];)")}}r=Ib.prototype;r.v=function(a,b,c){this.c=b;this.C=c;if(this.k)switch(this.C){case 1:this.k.u.Se.push(this);break;case 2:this.k.u.Te.push(this);break;case 3:this.k.u.xb.push(this);break;case 4:this.k.u.zb.push(this);break;case 5:this.k.u.sf.push(this);break;case 6:this.k.u.rf.push(this);break;case 7:this.k.u.Sb.push(this);break;case 8:this.k.u.Tb.push(this);break;case 9:this.k.u.Xe.push(this);break;case 10:this.k.u.Ze.push(this);break;case 11:this.k.u.We.push(this);break;case 12:this.k.u.bf.push(this);break;case 13:this.k.u.$e.push(this);break;case 14:this.k.u.Ve.push(this);break;case 15:this.k.u.cf.push(this);break;case 16:this.k.u.af.push(this);break;case 17:this.k.u.Ye.push(this);break;case 18:this.k.md=this}this.a.d=z(a);b=this.a.d.a;b.setAttribute("title",Kb(this));c=document.createElement("canvas");c.setAttribute("id",a+"_canvas");c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("oncontextmenu","return false;");c.style["-webkit-transition"]="background 2s";c.style.transition="background 2s";b.appendChild(c);this.a.Od.d=z(a+"_canvas");a=this.a.Od.d;F(a.h,0,0,1E3,1E3,!1,!1,!1,!1,-1,-1);a.m=I|J|L|P;this.a.d.l(a);b.onmousedown=this.Fd;b.onmouseup=this.Ng;b.onmouseover=this.Dj;b.onmouseout=this.Gd;b.onfocus=this.Ne;b.tabIndex=-1;b.style.outline="none";b.draggable="true";b.Mj=this.Mg;this.t()};r.t=function(){var a=this.a.d.a.clientWidth,b=this.a.d.a.clientHeight;if(a!==this.B||b!==this.G)this.B=a,this.G=b,this.a.d.Ea(this.B,this.G),this.Ua()};function Lb(a,b){!0===b&&4===a.la?(a.la=0,Jb(a)):!1===b&&4!==a.la&&(a.la=4,Jb(a))}function Mb(a,b){a.kd!==b&&(a.kd=b,a.Ua(),a.a.d.a.setAttribute("title",Kb(a)))}function Nb(a,b){a.pg!==b&&(a.pg=b,!0===b&&0===a.la?(a.la=8,Jb(a)):!1===b&&8===a.la&&(a.la=0,Jb(a)))}r.Ua=function(){var a=this.G,b=this.B;if(0!==b&&0!==a){this.b.Qg=Ob(this,this.wg,this.se,b,a);this.b.mh=Ob(this,this.ve,this.od,b,a);this.b.sh=Ob(this,this.Bg,this.ze,b,a);this.b.eh=Ob(this,this.zg,this.Ag,b,a);this.b.Ah=Ob(this,this.ve,this.od,b,a);var a=document.getElementsByTagName("head")[0],b=document.createElement("style"),c=document.createTextNode("a#my_link:hover{color:#ff0000 !important;}");b.type="text/css";b.styleSheet?b.styleSheet.cssText=c.nodeValue:b.appendChild(c);a.appendChild(b);Jb(this)}};function Ob(a,b,c,d,f){var e=a.a.Od.d.a.getContext("2d");e.fillStyle=Q(b);e.fillStyle=Q(b);e.fillRect(0,0,d,f);e.fillStyle=Q(c);e.strokeStyle=Q(c);var g=Math.min(d,f),h=(d-g)/2,l=(f-g)/2;switch(a.C){case 1:a.oa(g,h,l,e,-1);var k=Math.ceil(h+g/10+.5),h=Math.ceil(l+g/5+.5);b=Math.floor(g/10+.5);a=Math.floor(3*g/5+.5);e.fillRect(k,h,b,a);break;case 2:a.oa(g,h-g/10,l,e,-1);k=Math.ceil(h+8*g/10+.5);h=Math.ceil(l+g/5+.5);b=Math.floor(g/10+.5);a=Math.floor(3*g/5+.5);e.fillRect(k,h,b,a);break;case 3:a.oa(g,h-g/10,l,e,-1);break;case 4:a.oa(g,h-g/10,l,e,1);break;case 5:a.oa(g,h+g/10,l,e,1);k=Math.ceil(h+g/10+.5);h=Math.ceil(l+g/5+.5);b=Math.floor(g/10+.5);a=Math.floor(3*g/5+.5);e.fillRect(k,h,b,a);break;case 6:a.oa(g,h,l,e,1);k=Math.ceil(h+8*g/10+.5);h=Math.ceil(l+g/5+.5);b=Math.floor(g/10+.5);a=Math.floor(3*g/5+.5);e.fillRect(k,h,b,a);break;case 7:b=Math.ceil(h+.2*g+.5);a=Math.ceil(h+.35*g+.5);var k=Math.ceil(h+.57*g+.5),h=Math.ceil(h+.92*g+.5),m=Math.ceil(l+.2*g+.5),n=Math.ceil(l+.38*g+.5);c=Math.ceil(l+.52*g+.5);var p=Math.ceil(l+.6*g+.5),t=Math.ceil(l+.68*g+.5),l=Math.ceil(l+.84*g+.5);e.beginPath();e.moveTo(b,m);e.lineTo(a,m);e.lineTo(a,c);e.lineTo(k,c);e.lineTo(k,n);e.lineTo(h,p);e.lineTo(k,l);e.lineTo(k,t);e.lineTo(b,t);e.closePath();e.fill();break;case 8:b=Math.ceil(h+.2*g+.5);a=Math.ceil(h+.35*g+.5);k=Math.ceil(h+.57*g+.5);h=Math.ceil(h+.92*g+.5);m=Math.ceil(l+.8*g+.5);n=Math.ceil(l+.62*g+.5);c=Math.ceil(l+.48*g+.5);p=Math.ceil(l+.4*g+.5);t=Math.ceil(l+(1-.68)*g+.5);l=Math.ceil(l+(1-.84)*g+.5);e.beginPath();e.moveTo(b,m);e.lineTo(a,m);e.lineTo(a,c);e.lineTo(k,c);e.lineTo(k,n);e.lineTo(h,p);e.lineTo(k,l);e.lineTo(k,t);e.lineTo(b,t);e.closePath();e.fill();break;case 9:k=Math.ceil(h+.5*g-g/10+.5);n=Math.ceil(l+.5*g-g/10+.5);b=Math.ceil(.25*g+.5);e.fillStyle=Q(new u(255,255,255));e.strokeStyle=Q(new u(0,0,0));e.beginPath();e.arc(k,n,b,0,2*Math.PI,!1);e.fill();e.stroke();e.fillStyle=Q(new u(0,0,0));k=Math.ceil(h+.5*g+g/10+.5);n=Math.ceil(l+.5*g+g/10+.5);b=Math.ceil(.25*g+.5);e.beginPath();e.arc(k,n,b,0,2*Math.PI,!1);e.fill();break;case 10:m=e.createImageData(g,g);k=g/5|0;n=4*g/5|0;for(c=0;c<g;c++)for(p=0;p<g;p++)a=4*(c*g+p),c>=k&&c<=n&&p>=k&&p<=n?g-c>=p||c===k||c===n||p===k||p===n?(m.data[a+0]=0,m.data[a+1]=0,m.data[a+2]=0):(m.data[a+0]=255,m.data[a+1]=255,m.data[a+2]=255):(m.data[a+0]=b.o,m.data[a+1]=b.q,m.data[a+2]=b.p),m.data[a+3]=255;e.putImageData(m,h,l);break;case 11:k=Math.ceil(h+.75*g+.5);n=Math.ceil(l+.125*g+.5);b=Math.ceil(.25*g+.5);a=Math.ceil(.02*g+.5);e.fillRect(k,n,b,a);k=Math.ceil(h+.875*g+.5);n=Math.ceil(l+.5);b=Math.ceil(.02*g+.5);a=Math.ceil(.25*g+.5);e.fillRect(k,n,b,a);k=Math.ceil(h+.5);n=Math.ceil(l+.875*g+.5);b=Math.ceil(.25*g+.5);a=Math.ceil(.02*g+.5);e.fillRect(k,n,b,a);k=Math.ceil(h+.5*g-g/10+.5);n=Math.ceil(l+.5*g-g/10+.5);b=Math.ceil(.25*g+.5);e.fillStyle=Q(new u(255,255,255));e.strokeStyle=Q(new u(0,0,0));e.beginPath();e.arc(k,n,b,0,2*Math.PI,!1);e.fill();e.stroke();e.fillStyle=Q(new u(0,0,0));k=Math.ceil(h+.5*g+g/10+.5);n=Math.ceil(l+.5*g+g/10+.5);b=Math.ceil(.25*g+.5);e.beginPath();e.arc(k,n,b,0,2*Math.PI,!1);e.fill();break;case 12:b=g/2;k=3*g/4;a=.1*g;n=Math.sqrt(b*b-(k-b)*(k-b))+b;c=-Math.sqrt(b*b-(k-b)*(k-b))+b;e.lineWidth=Math.ceil(.05*g+.5);e.beginPath();e.moveTo(h+g/2,l+2*a);e.lineTo(h+n-a,l+k+a);e.lineTo(h+c+a,l+k+a);e.closePath();e.stroke();break;case 13:b=g/2;a=.05*g;m=-g/2*Math.sqrt(2)/2+g/2;k=g/2*Math.sqrt(2)/2+g/2;n=Math.sqrt(b*b-(m-b)*(m-b))+b;c=-Math.sqrt(b*b-(m-b)*(m-b))+b;b=Math.floor(h+n-a);h=Math.ceil(h+c+a);m=Math.ceil(l+m+a);l=Math.floor(l+k-a);e.lineWidth=Math.ceil(.05*g+.5);e.beginPath();e.moveTo(b,m);e.lineTo(h,m);e.lineTo(h,l);e.lineTo(b,l);e.closePath();e.stroke();break;case 14:m=.05*g;b=g/2;a=4*m;e.lineWidth=Math.ceil(m+.5);e.beginPath();e.arc(h+g/2,l+g/2,b-a,0,2*Math.PI,!1);e.stroke();break;case 15:b=h+.25*g;a=h+.75*g;m=l+.25*g;n=l+.75*g;e.lineWidth=Math.ceil(.05*g+.5);e.beginPath();e.moveTo(b,m);e.lineTo(a,n);e.moveTo(a,m);e.lineTo(b,n);e.stroke();break;case 16:b="A";a=.8*g;e.font=a+"px Arial";k=h+(g-e.measureText(b).width)/2;e.fillText(b,k,l+g/2+a/3);break;case 17:b="1";a=.8*g;e.font=a+"px Helvetica, Arial, Verdana";k=h+(g-e.measureText(b).width)/2;e.fillText(b,k,l+g/2+a/3);break;case 18:16===a.kd?a.oa(g,h,l,e,1):(b=Math.floor(h+g/5+g/20+.5),a=Math.ceil(h+4*g/5-g/20+.5),h=Math.ceil(l+g/5+.5),l=Math.ceil(l+4*g/5+.5),k=Math.ceil(b+g/5),g=Math.floor(a-g/5),e.beginPath(),e.moveTo(b,h),e.lineTo(k,h),e.lineTo(k,l),e.lineTo(b,l),e.closePath(),e.fill(),e.beginPath(),e.moveTo(a,h),e.lineTo(g,h),e.lineTo(g,l),e.lineTo(a,l),e.closePath(),e.fill());break;case 19:m=e.createImageData(d,f);e=m.data;h=(d-8)/2|0;l=(f-8)/2|0;for(n=0;n<f;n++)for(k=0;k<d;k++){a=4*(k+n*d);b=c.o;var g=c.q,p=c.p,t=n-l,q=k-h;if(0===t&&(0===q||1===q||6===q||7===q)||1===t&&(1===q||2===q||5===q||6===q)||2===t&&(2===q||3===q||4===q||5===q)||3===t&&(3===q||4===q)||4===t&&(3===q||4===q)||5===t&&(2===q||3===q||4===q||5===q)||6===t&&(1===q||2===q||5===q||6===q)||7===t&&(0===q||1===q||6===q||7===q))p=g=b=255;e[a+0]=b;e[a+1]=g;e[a+2]=p;e[a+3]=255}return m;case 20:m=.02*g;b=g/2;a=4*m;e.lineWidth=Math.ceil(m+.5);e.beginPath();e.arc(h+g/2,l+g/2,b-a,0,2*Math.PI,!1);e.stroke();b="i";a=.9*g;e.font=a+"px Times New Roman, Sans serif";k=h+(g-e.measureText(b).width)/2;e.fillText(b,k,l+g/2+a/3);break;case 21:e.lineWidth=1;e.moveTo(0,0);e.lineTo(0,f);e.lineTo(d,f);e.lineTo(d,0);e.lineTo(0,0);e.stroke();b="OK";a=.6*g;e.fillStyle=Q(new u(0,0,0,255));e.font=a+"px Tahoma, Sans serif";k=h+(g-e.measureText(b).width)/2;e.fillText(b,k,l+g/2+a/3);break;case 22:e.lineWidth=1;e.moveTo(0,0);e.lineTo(0,f);e.lineTo(d,f);e.lineTo(d,0);e.lineTo(0,0);e.stroke();b="Cancel";a=.6*g;e.fillStyle=Q(new u(0,0,0,255));e.font=a+"px Tahoma, Sans serif";k=h+(g-e.measureText(b).width)/2;e.fillText(b,k,l+g/2+a/3);break;case 23:m=.02*g;k=g/2-g/30;b=g/4;e.lineWidth=Math.ceil(7*m+.5);e.beginPath();e.arc(h+g/2,l+g/2,b,0,2*Math.PI,!1);e.stroke();e.lineWidth=Math.ceil(5*m+.5);for(a=0;9>a;a++)e.beginPath(),m=40*a*Math.PI/180,e.lineTo(h+b*Math.cos(m)+g/2,l-b*Math.sin(m)+g/2),e.lineTo(h+k*Math.cos(m)+g/2,l-k*Math.sin(m)+g/2),e.stroke();break;case 24:b="Pass",a=.9*g,e.font=a+"px Times New Roman, Sans serif",k=h+(g-e.measureText(b).width)/2,e.fillText(b,k,l+g/2+a/3)}return e.getImageData(0,0,d,f)}r.oa=function(a,b,c,d,f){var e=Math.ceil(b+a/5+.5);b=Math.ceil(b+4*a/5+.5);var g=Math.ceil(c+a/5+.5),h=Math.ceil(c+a/2+.5);a=Math.ceil(c+4*a/5+.5);0>f?(d.beginPath(),d.moveTo(e,h),d.lineTo(b,g),d.lineTo(b,a)):(d.beginPath(),d.moveTo(e,g),d.lineTo(b,h),d.lineTo(e,a));d.closePath();d.fill()};function Jb(a){var b=a.a.Od.d.a.getContext("2d"),c=null;switch(a.la){case 2:c=a.b.mh;break;case 1:c=a.b.Qg;break;case 4:c=a.b.eh;break;case 8:c=a.b.Ah;break;default:case 0:c=a.b.sh}c&&b.putImageData(c,0,0)}r.Lg=function(){if(this.c)switch(this.C){case 1:fb(this.c);break;case 2:db(this.c,5);break;case 3:db(this.c,1);break;case 4:gb(this.c,1);break;case 5:gb(this.c,5);break;case 6:zb(this.c);break;case 7:Ab(this.c);break;case 8:yb(this.c);break;case 9:D(this.c.n,0);break;case 10:D(this.c.n,1);break;case 11:D(this.c.n,2);break;case 12:D(this.c.n,3);break;case 13:D(this.c.n,4);break;case 14:D(this.c.n,5);break;case 15:D(this.c.n,6);break;case 16:D(this.c.n,7);break;case 17:D(this.c.n,8);break;case 18:16===this.kd?this.c.Tc():this.c.nc();break;case 19:Pb(this.c);break;case 20:Bb(this.a.d.a.id,Qb,{Lc:this.c});break;case 21:this.c&&this.c.vf();break;case 22:this.c&&this.c.jh();break;case 23:Bb(this.a.d.a.id,Rb,{Lc:this.c});break;case 24:this.c.uh()}};function Kb(a){switch(a.C){case 1:return"Back to the start (Ctrl+Shift+Left)";case 2:return"Back 5 moves (Ctrl+Left)";case 3:return"Back (Left)";case 4:return"Forward (Right)";case 5:return"Forward 5 moves (Ctrl+Right)";case 6:return"Go to the end (Ctrl+Shift+Right)";case 7:return"Next variant (Down)";case 8:return"Previous variant (Up)";case 9:return"Moves (F1)";case 10:return"Count Scores (F2)";case 11:return"Editor (F3)";case 12:return"Triangles (F4)";case 13:return"Squares (F5)";case 14:return"Circles (F6)";case 15:return"X marks (F7)";case 16:return"Text labels (F8)";case 17:return"Numeric labels (F9)";case 18:return 16===a.kd?"Autoplay start":"Autoplay stop";case 19:return"Close";case 20:return"Game info";case 22:return"Cancel";case 21:return"OK";case 23:return"Settings";case 24:return"Pass"}};function Sb(a){this.k=a;this.c=null;this.a={d:null,ee:{d:null}};var b=this;this.ti=function(){b.c.be(b.a.ee.d.a.value)}}Sb.prototype.v=function(a,b){this.c=b;this.a.d=z(a);var c=this.a.d.a;c.style.background=Q(new u(217,217,217,255));var d=a+"_TextArea",f=document.createElement("textarea");f.setAttribute("id",d);f.setAttribute("style","position:absolute;padding:0;margin:0;resize:none;outline: none;-moz-appearance: none;padding:2px;");c.appendChild(f);f.onchange=this.ti;f.onblur=this.ti;f.style.outline="none";f.style.margin="0px";f.style.border="1px solid rgb(172,172,172)";c=this.a.d;this.a.ee.d=z(d);d=this.a.ee.d;F(d.h,6,0,12,6,!0,!0,!0,!0,-1,-1);d.m=I|J|L|P;c.l(d);this.k&&this.k.jg.push(this);this.t()};Sb.prototype.Ub=function(a){this.a.ee.d.a.value=a};Sb.prototype.t=function(){this.a.d.Ea(this.a.d.a.clientWidth,this.a.d.a.clientHeight)};function Tb(a){this.k=a;this.ii=E;this.c=null;this.a={d:null,Cb:null,Zd:null,Image:null};this.Ee=this.De="";this.tg=0;this.og=!1}Tb.prototype.v=function(a,b,c){this.ii=c;this.c=b;this.a.d=z(a);b=this.a.d.a;b.style.backgroundColor=Q(new u(217,217,217,255));this.a.Cb=document.createElement("div");this.a.Zd=document.createElement("div");this.a.Image=document.createElement("canvas");var d=this.a.Image,f=this.a.Cb,e=this.a.Zd;b.appendChild(d);b.appendChild(f);b.appendChild(e);f.style.paddingLeft="25px";e.style.paddingLeft="25px";f.style.fontSize="14pt";e.style.paddingLeft="10pt";d.setAttribute("id",a+"_Image");d.setAttribute("style","position:absolute;padding:0;margin:0;");d.setAttribute("oncontextmenu","return false;");d.style.left="0px";d.style.top="0px";d.style.width="25px";d.style.height="25px";d.width=25;d.height=25;a=d.getContext("2d");a.clearRect(0,0,25,25);b=Math.ceil(13);d=Math.ceil(13);f=Math.ceil(6.75);B===c?(a.fillStyle=Q(new u(255,255,255)),a.strokeStyle=Q(new u(0,0,0))):A===c&&(a.fillStyle=Q(new u(0,0,0)),a.strokeStyle=Q(new u(0,0,0)));a.beginPath();a.arc(b,d,f,0,2*Math.PI,!1);a.fill();a.stroke();this.k&&(A===c?this.k.tb=this:B===c&&(this.k.vb=this));Ub(this)};Tb.prototype.t=function(){Ub(this);var a=this.cj,b=this.a.d.a.clientWidth-25,c=0,c=b<a?0:(b-a)/2;this.a.Image.style.left=c+"px";c+=25;this.a.Cb.style.paddingLeft=c+"px";this.a.Zd.style.paddingLeft=c+"px";this.a.Cb.style.overflow="hidden";this.a.Cb.style.textOverflow="ellipsis";this.a.Cb.style["-o-text-overflow"]="ellipsis";this.a.Cb.style.height="25px"};Tb.prototype.Uc=function(a){this.og=!1;this.tg=a;Ub(this)};Tb.prototype.Vc=function(a){this.og=!0;this.tg=a;Ub(this)};function Ub(a){var b=a.a.Cb,c=a.a.Zd,d=(""===a.De?A===a.ii?"Black ":"White ":a.De)+(""===a.Ee?"":"["+a.Ee+"]"),f=(!0===a.og?"Scores ":"Captured ")+a.tg;b.innerText=d;b.innerHTML=d;c.innerText=f;c.innerHTML=f;b=document.createElement("canvas").getContext("2d");b.font="14pt Times New Roman";a.cj=b.measureText(d).width};function Vb(){this.Wa=this.Za=this.bb=this.Ya=0;this.ie=this.ke=this.le=this.je=!1;this.Cc=this.Lb=-1}function F(a,b,c,d,f,e,g,h,l,k,m){a.Ya=b;a.bb=c;a.Za=d;a.Wa=f;a.je=e;a.le=g;a.ke=h;a.ie=l;a.Lb=k;a.Cc=m}var J=1,I=2,P=4,L=8;function Wb(){this.h=new Vb;this.m=J|I;this.a=this.Xd=this.qh=null;this.wb=new Vb;this.fa=[];this.oc=this.height=this.width=0;this.Jc=null}Wb.prototype.mb=function(a,b){this.oc=a;(this.Jc=b)&&b.Rg&&b.Rg(this)};Wb.prototype.l=function(a){a.Xd=this;this.fa[this.fa.length]=a};Wb.prototype.Ea=function(a,b){this.width=a;this.height=b;if(null==this.Xd)this.wb.Ya=0,this.wb.bb=0,this.wb.Za=a,this.wb.Wa=b,null!==this.a&&Xb(this,a,b);else{var c=0,d=0,f=0,e=0,c=this.m&5,d=this.m&10;J==c?(c=this.h.je?this.h.Ya:this.h.Ya*a/1E3,f=-1!=this.h.Lb?c+this.h.Lb:this.h.ke?a-this.h.Za:this.h.Za*a/1E3):P==c?(f=this.h.ke?a-this.h.Za:this.h.Za*a/1E3,c=-1!=this.h.Lb?f-this.h.Lb:this.h.je?this.h.Ya:this.h.Ya*a/1E3):(J|P)==c?(c=this.h.je?this.h.Ya:this.h.Ya*a/1E3,f=this.h.ke?a-this.h.Za:this.h.Za*a/1E3):(c=this.h.Ya,f=this.h.Za);I==d?(d=this.h.le?this.h.bb:this.h.bb*b/1E3,e=-1!=this.h.Cc?d+this.h.Cc:this.h.ie?b-this.h.Wa:this.h.Wa*b/1E3):L==d?(e=this.h.ie?b-this.h.Wa:this.h.Wa*b/1E3,d=-1!=this.h.Cc?e-this.h.Cc:this.h.le?this.h.bb:this.h.bb*b/1E3):(I|L)==d?(d=this.h.le?this.h.bb:this.h.bb*b/1E3,e=this.h.ie?b-this.h.Wa:this.h.Wa*b/1E3):(d=this.h.bb,e=this.h.Wa);f<c&&(f=c);e<d&&(e=d);-2===this.h.Lb?f=c+(e-d)*g_dKoef_Board_W_to_H:-3===this.h.Lb&&(c=(e-d)*g_dKoef_Board_W_to_H);this.wb.Ya=c;this.wb.bb=d;this.wb.Za=f;this.wb.Wa=e;this.a.style.left=(c+.5|0)+"px";this.a.style.top=(d+.5|0)+"px";this.a.style.width=(f-c+.5|0)+"px";this.a.style.height=(e-d+.5|0)+"px";this.a.width=f-c+.5|0;this.a.height=e-d+.5|0;Xb(this,f-c,e-d)}};function Xb(a,b,c){var d=a.fa.length;if(1===a.oc&&2===d){var f=a.Jc?qa(a.Jc):1,e=a.fa[0],g=a.fa[1],h;h=b-400;var l=c*f,f=h/f,k;l<=h?(f=c,h=k=0):(l=h,h=0,k=(c-f)/2);F(e.h,h,k,1E3,1E3,!0,!0,!1,!1,l,f);e.m=J|I;F(g.h,l,0,1E3,1E3,!0,!1,!1,!1,-1,-1);g.m=P|L|I}else 2===a.oc&&1===d&&(a.Jc?(f=qa(a.Jc),e=a.fa[0],l=c*f,f=b/f,l<=b?(f=c,k=0,h=(b-l)/2):(l=b,h=0,k=(c-f)/2),F(e.h,h,k,1E3,1E3,!0,!0,!1,!1,l,f),e.m=J|I):(e=a.fa[0],g=Math.min(b,c),F(e.h,(b-g)/2,(c-g)/2,1E3,1E3,!0,!0,!0,!1,g,g),e.m=J|L|I));for(e=0;e<d;e++)a.fa[e].Ea(b,c)}function z(a){var b=new Wb;b.qh=a;b.a=document.getElementById(a);return b}function Yb(){this.a=this.Xd=null;this.D=0;this.fa=[]}Yb.prototype.ia=function(a){this.D=a};Yb.prototype.l=function(a){a.Xd=this;this.fa[this.fa.length]=a};Yb.prototype.Ea=function(a,b){var c=b-this.D,d=a;d!==c&&(c=d=Math.min(d,c));var f=(b-this.D-c)/2;this.a.style.left=parseInt((a-d)/2+.5)+"px";this.a.style.top=parseInt(f+.5)+"px";this.a.style.width=parseInt(d+.5)+"px";this.a.style.height=parseInt(c+this.D+.5)+"px";this.a.width=parseInt(d+.5);this.a.height=parseInt(c+this.D+.5);for(var f=this.fa.length,e=0;e<f;e++)this.fa[e].Ea(d,c+this.D)};function Zb(a){if(this.c=a)a.k=this;this.Ga=null;this.ba=[];this.u={Se:[],Te:[],xb:[],zb:[],sf:[],rf:[],Sb:[],Tb:[],uh:null,Xe:[],Ze:[],We:[],bf:[],$e:[],Ve:[],cf:[],af:[],Ye:[]};this.vb=this.tb=this.nd=this.md=this.Cg=this.xe=this.ca=null;this.jg=[];var b=this;this.mg=!0;this.si=function(){$b(b.si);var a;if(a=b.xe)a=b.xe,a=a.ne||a.oe?!0:!1;if(a){a=b.xe;if(a.ne&&a.c){var d=a.b.M,f=a.b.D;if(!(0>=d||0>=f)){var e=a.c.j.Ha,g=10+a.K.f+24*e.f,e=10+a.K.g+24*e.g,h=a.a.Mb.d.a.getContext("2d");h.clearRect(0,0,d,f);-24<=g&&g<=d+24&&-24<=e&&e<=f+24&&h.putImageData(a.b.Mb,g,e);a.ne=!1}}if(a.oe&&(d=a.b.M,f=a.b.D,0!==d&&0!==f)){if(!(a.Ma.M===d&&a.Ma.D===f&&1>Math.abs(a.K.f-a.Ma.f)&&1>Math.abs(a.K.g-a.Ma.g))){a.Ma.M=d;a.Ma.D=f;a.Ma.f=a.K.f;a.Ma.g=a.K.g;var g=a.a.I.d.a.getContext("2d"),e=a.a.Vf.d.a.getContext("2d"),h=a.a.Nf.d.a.getContext("2d"),l=a.a.Selection.d.a.getContext("2d");h.clearRect(0,0,d,f);e.clearRect(0,0,d,f);g.clearRect(0,0,d,f);l.clearRect(0,0,d,f);for(var l=10+a.K.f,k=10+a.K.g,m=a.F.F.length,n=0;n<=m-1;n++){var p=k+24*n;if(-24<=p&&p<=f+24)for(var t=a.F.F[n].length-1,q=0;q<=t;q++){var v=l+24*q;if(-24<=v&&v<=d+24){var x=a.F.w(q,n);if(!1===x.Pc()){var H=x.jc();switch(x.C){case ac:H.Eb?g.putImageData(a.b.$f,v,p):g.putImageData(a.b.fg,v,p);break;case bc:H.Eb?1===H.Dh?g.putImageData(a.b.ag,v,p):g.putImageData(a.b.bg,v,p):g.putImageData(a.b.cg,v,p);break;case cc:H.Eb?g.putImageData(a.b.dg,v,p):g.putImageData(a.b.eg,v,p)}}else{var H=x.jc(),O=x.jb.C,G=""+x.Ha.Of,K=h.measureText(G).width,ra=x.Ta;A===O?(H&&!0===a.Gb&&e.putImageData(a.b.ua,v+2+a.b.Db,p+2+a.b.Db),h.putImageData(H?a.b.ec:a.b.Ld,v+2,p+2),""===ra?(h.font="bold 10px sans-serif",h.fillStyle=H?"#CCC":"rgb(192, 192, 192)",h.fillText(G,v+12-K/2,p+12+3)):h.putImageData(H?a.b.Nh:a.b.Oh,v+2,p+2)):B===O?(H&&!0===a.Gb&&e.putImageData(a.b.ua,v+2+a.b.Db,p+2+a.b.Db),h.putImageData(H?a.b.pc:a.b.ge,v+2,p+2),""===ra?(h.font="bold 10px sans-serif",h.fillStyle=H?"#000":"rgb(56, 56, 56)",h.fillText(G,v+12-K/2,p+12+3)):h.putImageData(H?a.b.Qh:a.b.Rh,v+2,p+2)):h.putImageData(H?a.b.Mh:a.b.Ph,v+2,p+2);G=S(x);x=x.da;0===q?0!==G&&(1===G?H?g.putImageData(a.b.Cf,v,p):g.putImageData(a.b.Gf,v,p):H?0==x?g.putImageData(a.b.Df,v,p):g.putImageData(a.b.Ef,v,p):g.putImageData(a.b.Ff,v,p)):0===G?H?g.putImageData(a.b.Af,v,p):g.putImageData(a.b.Bf,v,p):1===G?H?g.putImageData(a.b.wf,v,p):g.putImageData(a.b.Hf,v,p):H?0===x?g.putImageData(a.b.xf,v,p):g.putImageData(a.b.yf,v,p):g.putImageData(a.b.zf,v,p);A!==O&&B!==O||g.clearRect(v+3,p+3,18,18)}}}}}a.oe=!1}}b.mg&&dc(b,!1)};this.si()}r=Zb.prototype;r.of=function(a){var b=new aa(this);b.v(a,this.c);b.Da();this.ba.push(b);this.t()};r.mf=function(a){var b=this.c,c=z(a);this.L(c.a,a+"div");var d=a+"div",f=new Yb;f.qh=d;f.a=document.getElementById(d);f.ia(25);var e=f.a;c.l(f);d=a+"_Board";a+="_Toolbar";this.L(e,d);this.L(e,a);e=z(d);F(e.h,0,0,1E3,25,!1,!1,!1,!0,-1,-1);e.m=I|J|P;f.l(e);e=new aa(this);e.v(d,b);e.Da();d=z(a);F(d.h,0,0,1E3,0,!1,!1,!1,!0,-1,25);d.m=J|L|P;f.l(d);f=new ec(this);f.v(a,b,{fa:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,20]});this.Ga=c;this.ba.push(e);this.ba.push(f);this.t()};r.lf=function(a){var b=this.c,c=new aa(this),d=z(a),f=a+"GoBoard";this.L(d.a,f);f=z(f);F(f.h,0,0,1,1,!1,!1,!0,!0,-1,-1);f.m=I|J|P|L;d.l(f);f.mb(1,c);var e=a+"_Board",g=a+"_Panel";this.L(f.a,e);this.L(f.a,g);var h=z(e);a=z(g);f.l(h);f.l(a);c.v(e,b);c.Da();f=g+"_CaT";e=g+"_Navigator";this.L(a.a,f);this.L(a.a,e);g=z(f);F(g.h,0,0,1E3,500,!1,!1,!1,!1,-1,-1);g.m=I|J|P|L;a.l(g);h=z(e);F(h.h,0,500,1E3,1E3,!1,!1,!1,!1,-1,-1);h.m=I|J|P|L;a.l(h);a=new fc(this);a.v(e,b);var l=f+"_Info",k=f+"_Comments",m=f+"_Toolbar",h=f+"_ToolbarSecond",n=f+"_ToolbarAutoPlay",p=f+"_ToolbarTimeLine";this.L(g.a,l);this.L(g.a,k);this.L(g.a,m);this.L(g.a,h);var t=this.L(g.a,n);this.L(g.a,p);f=n+"_Slider";e=n+"_Button";this.L(t,e);this.L(t,f);t=z(l);F(t.h,0,0,1E3,0,!1,!1,!1,!1,-1,50);t.m=I|J|P;g.l(t);var q=l+"_White",l=l+"_Black";this.L(t.a,q);this.L(t.a,l);var v=z(q);F(v.h,0,0,500,1E3,!1,!1,!1,!1,-1,-1);v.m=I|J|P|L;t.l(v);v=z(l);F(v.h,500,0,1E3,1E3,!1,!1,!1,!1,-1,-1);v.m=I|J|P|L;t.l(v);t=new Tb(this);t.v(q,b,B);q=new Tb(this);q.v(l,b,A);l=z(k);F(l.h,0,50,1E3,100,!1,!0,!1,!0,-1,25);l.m=I|J|P|L;g.l(l);l=z(m);F(l.h,0,0,1E3,75,!1,!1,!1,!0,-1,25);l.m=J|P|L;g.l(l);l=z(h);F(l.h,0,0,1E3,50,!1,!1,!1,!0,-1,25);l.m=J|P|L;g.l(l);l=z(n);F(l.h,0,0,1E3,25,!1,!1,!1,!0,-1,25);l.m=J|P|L;g.l(l);n=z(e);F(n.h,0,0,1E3,1E3,!1,!1,!1,!1,25,-1);n.m=J|I|L;l.l(n);n=z(f);F(n.h,25,0,1E3,1E3,!0,!1,!1,!1,-1,25);n.m=I|P|L;l.l(n);l=z(p);F(l.h,0,0,1E3,0,!1,!1,!1,!0,-1,25);l.m=J|P|L;g.l(l);g=new Sb(this);g.v(k,b);k=new ec(this);k.v(m,b,{fa:[1,2,3,4,5,6,24,7,8]});m=new ec(this);m.v(h,b,{fa:[9,10,11,12,13,14,15,16,17,20,23]});h=new gc(this);h.v(p,b,hc,0);p=new Ib(this);p.v(e,b,18);e=new gc(this);e.v(f,b,ic,0);this.ba.push(c);this.ba.push(a);this.ba.push(g);this.ba.push(k);this.ba.push(m);this.ba.push(h);this.ba.push(p);this.ba.push(e);this.ba.push(q);this.ba.push(t);this.Ga=d;this.t();jc(b)};r.nf=function(a){var b=this.c,c=new aa(this);c.qg=!1;var d=z(a),f=a+"GoBoard";this.L(d.a,f);f=z(f);F(f.h,0,0,1,1,!1,!1,!0,!0,-1,-1);f.m=I|J|P|L;d.l(f);f.mb(1,c);var e=a+"_Board",g=a+"_Panel";this.L(f.a,e);this.L(f.a,g);var h=z(e);a=z(g);f.l(h);f.l(a);c.v(e,b);c.Da();f=g+"_Toolbar";e=g+"_Comments";this.L(a.a,e);this.L(a.a,f);g=z(e);F(g.h,0,25,1E3,1E3,!1,!0,!1,!1,-1,-1);g.m=I|J|P|L;a.l(g);g=z(f);F(g.h,0,0,1E3,1E3,!0,!0,!1,!0,-1,25);g.m=J|P|I;a.l(g);a=new Sb(this);a.v(e,b);e=new ec(this);e.v(f,b,{fa:[1]});this.ba.push(c);this.ba.push(a);this.ba.push(e);this.Ga=d;this.t();jc(b)};r.t=function(a){a?dc(this,!0):this.mg=!0};function dc(a,b){a.mg=!1;a.Ga&&a.Ga.Ea(a.Ga.a.clientWidth,a.Ga.a.clientHeight);for(var c=0,d=a.ba.length;c<d;c++)a.ba[c].t(b)}r.L=function(a,b){var c=document.createElement("div");c.setAttribute("id",b);c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("oncontextmenu","return false;");a.appendChild(c);return c};r.zh=function(a){this.ca=a};r.th=function(){this.md&&Mb(this.md,0)};r.Pf=function(){this.md&&Mb(this.md,16)};r.Sh=function(a){if(this.tb){var b=this.tb;b.De=a;Ub(b)}};r.Th=function(a){if(this.tb){var b=this.tb;b.Ee=a;Ub(b)}};r.Uh=function(a){if(this.vb){var b=this.vb;b.De=a;Ub(b)}};r.Vh=function(a){if(this.vb){var b=this.vb;b.Ee=a;Ub(b)}};r.Uc=function(a,b){this.tb&&this.tb.Uc(a);this.vb&&this.vb.Uc(b)};r.Vc=function(a,b){this.tb&&this.tb.Vc(a);this.vb&&this.vb.Vc(b)};r.Vb=function(a){for(var b=0,c=this.u.Se.length;b<c;b++)Lb(this.u.Se[b],a.xb);b=0;for(c=this.u.Te.length;b<c;b++)Lb(this.u.Te[b],a.xb);b=0;for(c=this.u.xb.length;b<c;b++)Lb(this.u.xb[b],a.xb);b=0;for(c=this.u.zb.length;b<c;b++)Lb(this.u.zb[b],a.zb);b=0;for(c=this.u.sf.length;b<c;b++)Lb(this.u.sf[b],a.zb);b=0;for(c=this.u.rf.length;b<c;b++)Lb(this.u.rf[b],a.zb);b=0;for(c=this.u.Sb.length;b<c;b++)Lb(this.u.Sb[b],a.Sb);b=0;for(c=this.u.Tb.length;b<c;b++)Lb(this.u.Tb[b],a.Tb);b=0;for(c=this.u.Xe.length;b<c;b++)Nb(this.u.Xe[b],0===a.Xa);b=0;for(c=this.u.Ze.length;b<c;b++)Nb(this.u.Ze[b],1===a.Xa);b=0;for(c=this.u.We.length;b<c;b++)Nb(this.u.We[b],2===a.Xa);b=0;for(c=this.u.bf.length;b<c;b++)Nb(this.u.bf[b],3===a.Xa);b=0;for(c=this.u.$e.length;b<c;b++)Nb(this.u.$e[b],4===a.Xa);b=0;for(c=this.u.Ve.length;b<c;b++)Nb(this.u.Ve[b],5===a.Xa);b=0;for(c=this.u.cf.length;b<c;b++)Nb(this.u.cf[b],6===a.Xa);b=0;for(c=this.u.af.length;b<c;b++)Nb(this.u.af[b],7===a.Xa);b=0;for(c=this.u.Ye.length;b<c;b++)Nb(this.u.Ye[b],8===a.Xa);this.Cg&&(b=this.Cg,!0!==b.Zc&&kc(b,a.Jh,!0))};r.Ub=function(a){for(var b=0,c=this.jg.length;b<c;b++)this.jg[b].Ub(a)};var lc=0,mc=1,bb=2,y=new function(){this.ef=this.g=this.f=0;this.oc=mc;this.aa=this.U=this.Kd=!1;this.ta=null;this.Qc=-1;this.ph=this.oh=this.Gc=0;this.If=this.Td=!1},ha=new function(){this.aa=this.U=this.Kd=!1;this.ta=null;this.Ja=this.zi=0};function ga(a){ha.Kd=a.altKey;ha.U=void 0!==a.metaKey?a.ctrlKey||a.metaKey:a.ctrlKey;ha.aa=a.shiftKey;ha.ta=a.srcElement?a.srcElement:a.target;ha.zi=a.charCode;ha.Ja=a.keyCode;ha.Kj=a.which}function ba(a){if(!a.Td||a.If){if(a.pageX||a.pageY)y.f=a.pageX,y.g=a.pageY;else if(a.clientX||a.clientY)y.f=a.clientX,y.g=a.clientY;y.Kd=a.altKey;y.aa=a.shiftKey;y.U=a.ctrlKey||a.metaKey;y.oc=mc;y.Td||(y.ta=a.srcElement?a.srcElement:a.target);if(3<Math.abs(y.f-y.oh)||3<Math.abs(y.g-y.ph))y.Qc=-1,y.Gc=0}}function fa(a){if(a.pageX||a.pageY)y.f=a.pageX,y.g=a.pageY;else if(a.clientX||a.clientY)y.f=a.clientX,y.g=a.clientY;y.oh=y.f;y.ph=y.g;y.Kd=a.altKey;y.aa=a.shiftKey;y.U=a.ctrlKey||a.metaKey;y.oc=lc;y.ef=a.button;y.ta=a.srcElement?a.srcElement:a.target;a=(new Date).getTime();0==y.Gc?(y.Gc=1,y.Qc=a):500>a-y.Qc?(y.Qc=a,y.Gc++):(y.Gc=1,y.Qc=a);window.bi=!1}window.onmousemove=function(a){y.Td&&void 0!=y.ta&&null!=y.ta&&void 0!=y.ta.onmousemove&&null!=y.ta.onmousemove&&(y.If=!0,y.ta.onmousemove(a),y.If=!1)};window.onmouseup=function(a){if(!1===window.bi){window.bi=!0;if(y.Td&&y.ta&&void 0!=y.ta.onmouseup&&null!=y.ta.onmouseup)y.ta.onmouseup(a,!0);y.ta=null}};function nc(){this.Tb=this.Sb=this.zb=this.xb=!0;this.Jh=this.Xa=0};var va=-1,Za=0,Ya=1,Xa=2,Sa=3,$a=4,Ta=5,Ua=6,Va=7,Wa=8;function C(a,b,c,d){this.li={f:void 0===a?0:a,g:void 0==b?0:b};this.C=void 0===c?Za:c;this.Fe=void 0===d?"":d}C.prototype.Mc=function(){return this.li.f};C.prototype.Nc=function(){return this.li.g};C.prototype.mb=function(a){this.C=a};function fc(a){this.k=a;this.c=null;this.F=new oc;this.oe=this.ne=!0;this.a={d:null,J:{d:null},Selection:{d:null},Mb:{d:null},I:{d:null},Vf:{d:null},Nf:{d:null},Ei:{d:null},ha:null,ja:null,Ob:null,Wb:null,ae:0,$d:0};this.Gb=this.$c=this.fb=!0;this.R=new u(255,255,255,255);this.Q=new u(0,0,0,255);this.Ba=new u(231,188,95,255);this.Ra=new u(0,0,0,255);this.Z=!1;this.La=null;this.b={M:0,D:0,J:null,ec:null,pc:null,Ld:null,ge:null,Cf:null,lh:null,wf:null,kh:null,Af:null,$f:null,Xh:null,dg:null,Gf:null,Df:null,Ef:null,Ff:null,Hf:null,xf:null,yf:null,zf:null,Bf:null,fg:null,ag:null,bg:null,cg:null,eg:null,Mh:null,Ph:null,Nh:null,Qh:null,Oh:null,Rh:null,nb:null,Mb:null,ua:null,Db:0};this.K={f:0,g:0};this.tc=!1;this.bj=!0;this.Ma={M:0,D:0,f:0,g:0};var b=this;this.Og=function(){return setTimeout(function(){b.Kg()},20)};this.Fd=function(a){b.tc||(b.c&&b.c.Da(),fa(a),a=b.Hd(y.f,y.g),a=b.F.w(a.f,a.g),a.Pc()&&b.c&&hb(b.c,a))};this.Oe=function(a){b.tc||(ba(a),a=b.Hd(y.f,y.g),b.Va(a.f,a.g))};this.Gd=function(){b.tc||b.Va(-1,-1)};this.ri=function(a){if(b.tc)return!1;var d=0,d=void 0!=a.wheelDelta?0<a.wheelDelta?-45:45:0<a.detail?45:-45;a.preventDefault&&a.preventDefault();var f=20+24*(b.F.F.length+1)-b.a.J.d.a.height;b.K.g-=d;b.K.g=Math.min(0,Math.max(b.K.g,-f));pc(b);b.Oe(a);qc(b);return!1};this.Ne=function(){b.c&&b.c.Da()};this.Ej=function(){b.a.ha.style.opacity=.7;b.a.Ob.style.opacity=.3;b.a.Ob.style.display="block"};this.Bj=function(){b.a.ha.style.opacity=.5;b.a.Ob.style.opacity=0;b.a.Ob.style.display="none"};this.Fj=function(){b.a.ja.style.opacity=.7;b.a.Wb.style.opacity=.3;b.a.Wb.style.display="block"};this.Cj=function(){b.a.ja.style.opacity=.5;b.a.Wb.style.opacity=0;b.a.Wb.style.display="none"};this.qi=function(){b.tc=!0};this.pi=function(){b.tc=!1};this.oj=function(a){var d=b.b.M;b.K.f=-((a-2)/(d-4-b.a.ae)*(20+24*(rc(b.F)+1)-d));pc(b)};this.wj=function(a,d){var f=b.b.D;b.K.g=-((d-2)/(f-4-b.a.$d)*(20+24*(b.F.F.length+1)-f));pc(b)}}r=fc.prototype;r.v=function(a,b){this.k&&(this.k.xe=this);this.c=b;this.c.N=this;this.F.c=b;this.a.d=z(a);var c=this.a.d.a,d=this.a.d,f=a+"_Board",e=a+"_Selection",g=a+"_Current",h=a+"_Lines",l=a+"_Shadows",k=a+"_Nodes",m=a+"_Events";this.xa(c,f);this.xa(c,e);this.xa(c,g);this.xa(c,h);this.xa(c,l);this.xa(c,k);var n=this.na(c,m);this.a.Ob=this.na(c,a+"HorScroll_BG");this.a.ha=this.na(c,a+"HorScroll");this.a.Wb=this.na(c,a+"VerScroll_BG");this.a.ja=this.na(c,a+"VerScroll");this.a.Ob.style.background="rgb(0,0,0)";this.a.Ob.style.display="none";this.a.Wb.style.background="rgb(0,0,0)";this.a.Wb.style.display="none";this.a.ha.onmouseover=this.Ej;this.a.ha.onmouseout=this.Bj;this.a.ja.onmouseover=this.Fj;this.a.ja.onmouseout=this.Cj;c=z(a+"HorScroll_BG");F(c.h,2,0,2,4,!0,!1,!0,!0,-1,8);c.m=J|L|P;d.l(c);c=z(a+"VerScroll_BG");F(c.h,0,2,4,2,!1,!0,!0,!0,8,-1);c.m=I|L|P;d.l(c);this.ga(this.a.J,d,f);this.ga(this.a.Selection,d,e);this.ga(this.a.Mb,d,g);this.ga(this.a.I,d,h);this.ga(this.a.Vf,d,l);this.ga(this.a.Nf,d,k);this.ga(this.a.Ei,d,m);n.onmousedown=this.Fd;n.onmousemove=this.Oe;n.onmouseout=this.Gd;n.onmousewheel=this.ri;n.addEventListener&&n.addEventListener("DOMMouseScroll",this.ri,!1);n.onfocus=this.Ne;n.tabIndex=-1;n.style.$i=!0;n.style.outline=0;this.Me();this.Ed();sc(this);this.Le()};r.t=function(a){var b=this.a.d.a.clientWidth,c=this.a.d.a.clientHeight;this.a.d.Ea(b,c);this.Ua(b,c,a)};function tc(a){if(!(0>=a.b.M||0>=a.b.D)){var b=a.b.M,c=a.b.D,d=20+24*(rc(a.F)+1),f=20+24*(a.F.F.length+1);d>b?(a.a.ae=Math.max(50,b*b/d),a.a.ha.style.width=Math.max(50,b*b/d)+"px",a.a.ha.style.display="block",a.a.ha.style.position="absolute",a.a.ha.style.top=c-12+"px",a.a.ha.style.height="8px",a.a.ha.style.background=a.Z?"rgb(220, 220, 220)":"rgb(0,0,0)",a.a.ha.style.opacity=.5,uc(a.a.ha,2,b-a.a.ae-2,c-12,c-12),a.a.ha.Ia=a.oj,a.a.ha.Ke=a.qi,a.a.ha.Je=a.pi):a.a.ha.style.display="none";f>c?(a.a.$d=Math.max(50,c*c/f),a.a.ja.style.height=Math.max(50,c*c/f)+"px",a.a.ja.style.display="block",a.a.ja.style.position="absolute",a.a.ja.style.left=b-12+"px",a.a.ja.style.width="8px",a.a.ja.style.background=a.Z?"rgb(220, 220, 220)":"rgb(0,0,0)",a.a.ja.style.opacity=.5,uc(a.a.ja,b-12,b-12,2,c-a.a.$d-2),a.a.ja.Ia=a.wj,a.a.ja.Ke=a.qi,a.a.ja.Je=a.pi):a.a.ja.style.display="none";a.Ma.D=-1;a.Ma.M=-1;pc(a);qc(a)}}r.yb=function(){this.F.yb();this.Ma.D=-1;this.Ma.M=-1};function vc(a,b){a.ne=!0;var c=a.b.M,d=a.b.D;if(!(0>=c||0>=d)){var f=a.c.j.Ha,e=f.f,f=f.g,g=10+a.K.f+24*e,h=10+a.K.g+24*f;if(0!=b&&!0===a.bj&&(10>=g||g>=c-10||10>=h||h>=d-10)){var l=20+24*(a.F.F.length+1)-d,k=20+24*(rc(a.F)+1)-c;10>=g?a.K.f=24*-e:g>=c-10&&(a.K.f=c-24-10-10-24*e);10>=h?a.K.g=24*-f:h>=d-10&&(a.K.g=d-24-10-10-24*f);a.K.f=Math.min(0,Math.max(a.K.f,-k));a.K.g=Math.min(0,Math.max(a.K.g,-l));qc(a);pc(a)}}}r.xa=function(a,b){var c=document.createElement("canvas");c.setAttribute("id",b);c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("oncontextmenu","return false;");a.appendChild(c);return c};r.na=function(a,b){var c=document.createElement("div");c.setAttribute("id",b);c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("oncontextmenu","return false;");a.appendChild(c);return c};r.ga=function(a,b,c){a.d=z(c);a=a.d;F(a.h,0,0,1E3,1E3,!1,!1,!1,!1,-1,-1);a.m=I|J|L|P;b.l(a)};r.Ua=function(a,b,c){var d=this.a.J.d.a.getContext("2d");a!==this.b.M||b!==this.b.D||null===this.b.J||null!==this.La||!0===c?(this.b.M=a,this.b.D=b,d.fillStyle=Q(this.Ba),d.fillRect(0,0,a,b),null!==this.La&&clearTimeout(this.La),this.La=this.Og()):d.putImageData(this.b.J,0,0);tc(this)};r.Kg=function(){this.La=null;var a=this.b.M,b=this.b.D,c=this.a.J.d.a.getContext("2d");if(0!==a&&0!==b){for(var d=c.createImageData(a,b),f=this.Ba.o,e=this.Ba.q,g=this.Ba.p,h=Array(a),l=0;l<a;l++)h[l]=(Math.tan(300*l/a)+1)/2+(Math.tan(100*l/a)+1)/10;for(var k=Array(b),m=0;m<b;m++)k[m]=.02*Math.tan(m/b);var n,p,t;if(!0===this.fb)for(t=.9,m=0;m<b;m++)for(l=0;l<a;l++){t=40*(h[l]+k[m])+.5;t-=Math.floor(t);t=.2>t?1-t/2:.4>t?1-(.4-t)/2:1;if(m==b-1||m==b-2&&l<a-2||l>=a-1||l==a-2&&m<b-1)t/=2;0==m||1==m&&1<l||0==l||1==l&&1<m?(n=128+f*t/2,p=128+e*t/2,t=128+g*t/2):(n=f*t,p=e*t,t*=g);var q=4*(l+m*a);d.data[q+0]=n;d.data[q+1]=p;d.data[q+2]=t;d.data[q+3]=255}else for(h=0;h<b;h++)for(l=0;l<a;l++)0==h||0==l||h===b-1||l===a-1?(n=this.Ra.o,p=this.Ra.q,t=this.Ra.p):(n=f,p=e,t=g),q=4*(l+h*a),d.data[q+0]=n,d.data[q+1]=p,d.data[q+2]=t,d.data[q+3]=255;this.b.J=d;c.putImageData(this.b.J,0,0)}};r.Me=function(){var a=this.a.Nf.d.a.getContext("2d");this.b.ec=a.createImageData(20,20);this.b.pc=a.createImageData(20,20);this.b.Ld=a.createImageData(20,20);this.b.ge=a.createImageData(20,20);var a=this.b.ec.data,b=this.b.pc.data,c=this.b.Ld.data,d=this.b.ge.data;if(!0===this.$c)for(var f=9.5,e=f-.2,g=Math.sqrt(3),h=0;20>h;h++)for(var l=0;20>l;l++){var k=h-f,m=l-f,n=e-Math.sqrt(k*k+m*m),p=4*(20*h+20-l-1);if(0<=n){var t=e*e-k*k-m*m,t=0<t?Math.sqrt(t)*g:0,q=k,v=m,x=Math.sqrt(6*(q*q+v*v+t*t)),x=(2*t-q+v)/x,t=0;.9<x&&(t=10*(x-.9));q=255;.8>=n&&(n=(.8-n)/.8,q=.7,k-m<e/3&&(q=1),q=parseInt(255*(1-n*q)));k=parseInt(10+10*x+140*t);a[p+0]=k;a[p+1]=k;a[p+2]=k;a[p+3]=q;c[p+0]=k;c[p+1]=k;c[p+2]=k;c[p+3]=parseInt(.5*q);k=parseInt(200+10*x+45*t);b[p+0]=k;b[p+1]=k;b[p+2]=k;b[p+3]=q;d[p+0]=k;d[p+1]=k;d[p+2]=k;d[p+3]=parseInt(.7*q)}else a[p+0]=0,a[p+1]=0,a[p+2]=0,a[p+3]=0,d[p+0]=0,d[p+1]=0,d[p+2]=0,d[p+3]=0}else for(f=9.5,e=f-.2,h=0;20>h;h++)for(l=0;20>l;l++)k=h-f,m=l-f,n=e-Math.sqrt(k*k+m*m),p=4*(20*h+20-l-1),0<=n?(q=255,.8>=n?(x=(.8-n)/.8,q=.7,k-m<e/3&&(q=1),q=parseInt(255*(1-x*q))):1.6>=n&&.8<=n&&!0===this.Z&&(x=(1.6-n)/.8,q=.7,k-m<e/3&&(q=1),q=parseInt(x*q*255)),g=!1,1.6>=n&&(g=!0),!1===g||!1===this.Z?(a[p+0]=this.Q.o,a[p+1]=this.Q.q,a[p+2]=this.Q.p,a[p+3]=q,c[p+0]=this.Q.o,c[p+1]=this.Q.q,c[p+2]=this.Q.p):(a[p+0]=this.R.o,a[p+1]=this.R.q,a[p+2]=this.R.p,a[p+3]=q,c[p+0]=this.R.o,c[p+1]=this.R.q,c[p+2]=this.R.p),c[p+3]=parseInt(.5*q),q=255,.8>=n?(x=(.8-n)/.8,q=.7,k-m<e/3&&(q=1),q=parseInt(255*(1-x*q))):1.6>=n&&.8<=n&&!1===this.Z&&(x=(1.6-n)/.8,q=.7,k-m<e/3&&(q=1),q=parseInt(x*q*255)),!1===g||!0===this.Z?(b[p+0]=this.R.o,b[p+1]=this.R.q,b[p+2]=this.R.p,b[p+3]=q,d[p+0]=this.R.o,d[p+1]=this.R.q,d[p+2]=this.R.p):(b[p+0]=this.Q.o,b[p+1]=this.Q.q,b[p+2]=this.Q.p,b[p+3]=q,d[p+0]=this.Q.o,d[p+1]=this.Q.q,d[p+2]=this.Q.p),d[p+3]=parseInt(q/2)):(a[p+0]=0,a[p+1]=0,a[p+2]=0,a[p+3]=0,c[p+0]=0,c[p+1]=0,c[p+2]=0,c[p+3]=0,b[p+0]=0,b[p+1]=0,b[p+2]=0,b[p+3]=0,d[p+0]=0,d[p+1]=0,d[p+2]=0,d[p+3]=0)};r.Ed=function(){var a=this.a.I.d.a.getContext("2d");this.b.Cf=a.createImageData(24,24);this.b.lh=a.createImageData(24,24);this.b.wf=a.createImageData(24,24);this.b.kh=a.createImageData(24,24);this.b.Af=a.createImageData(24,24);this.b.$f=a.createImageData(24,24);this.b.Xh=a.createImageData(24,24);this.b.dg=a.createImageData(24,24);this.b.Gf=a.createImageData(24,24);this.b.Df=a.createImageData(24,24);this.b.Ef=a.createImageData(24,24);this.b.Ff=a.createImageData(24,24);this.b.Hf=a.createImageData(24,24);this.b.xf=a.createImageData(24,24);this.b.yf=a.createImageData(24,24);this.b.zf=a.createImageData(24,24);this.b.Bf=a.createImageData(24,24);this.b.fg=a.createImageData(24,24);this.b.ag=a.createImageData(24,24);this.b.bg=a.createImageData(24,24);this.b.cg=a.createImageData(24,24);this.b.eg=a.createImageData(24,24);for(var a=this.b.Cf.data,b=this.b.lh.data,c=this.b.wf.data,d=this.b.kh.data,f=this.b.Af.data,e=this.b.$f.data,g=this.b.Xh.data,h=this.b.dg.data,l=this.b.Gf.data,k=this.b.Df.data,m=this.b.Ef.data,n=this.b.Ff.data,p=this.b.Hf.data,t=this.b.xf.data,q=this.b.yf.data,v=this.b.zf.data,x=this.b.Bf.data,H=this.b.fg.data,O=this.b.ag.data,G=this.b.bg.data,K=this.b.cg.data,ra=this.b.eg.data,Na=!0===this.Z?200:28,w=new u(Na,Na,Na,255),M=0;24>M;M++)for(var N=0;24>N;N++){var s=4*(24*M+N);12<=N&&(11===M||12===M)?(a[s+0]=w.o,a[s+1]=w.p,a[s+2]=w.q,a[s+3]=255,l[s+0]=w.o,l[s+1]=w.p,l[s+2]=w.q,l[s+3]=96):(a[s+3]=0,l[s+3]=0);11<=N&&(11===M||12===M)||12<=M&&(11===N||12===N)?(b[s+0]=w.o,b[s+1]=w.p,b[s+2]=w.q,b[s+3]=255,n[s+0]=w.o,n[s+1]=w.p,n[s+2]=w.q,n[s+3]=96):(b[s+3]=0,n[s+3]=0);11<=N&&(11===M||12===M)?(k[s+0]=w.o,k[s+1]=w.p,k[s+2]=w.q,k[s+3]=255):12<=M&&(11===N||12===N)?(k[s+0]=w.o,k[s+1]=w.p,k[s+2]=w.q,k[s+3]=96):k[s+3]=0;12<=M&&(11===N||12===N)?(m[s+0]=w.o,m[s+1]=w.p,m[s+2]=w.q,m[s+3]=255):11<=N&&(11===M||12===M)?(m[s+0]=w.o,m[s+1]=w.p,m[s+2]=w.q,m[s+3]=96):m[s+3]=0;11===M||12===M?(c[s+0]=w.o,c[s+1]=w.p,c[s+2]=w.q,c[s+3]=255,p[s+0]=w.o,p[s+1]=w.p,p[s+2]=w.q,p[s+3]=96):(c[s+3]=0,p[s+3]=0);11===M||12===M||12<=M&&(11===N||12===N)?(d[s+0]=w.o,d[s+1]=w.p,d[s+2]=w.q,d[s+3]=255,v[s+0]=w.o,v[s+1]=w.p,v[s+2]=w.q,v[s+3]=96):(d[s+3]=0,v[s+3]=0);11===M||12===M?(t[s+0]=w.o,t[s+1]=w.p,t[s+2]=w.q,t[s+3]=255):12<=M&&(11===N||12===N)?(t[s+0]=w.o,t[s+1]=w.p,t[s+2]=w.q,t[s+3]=96):t[s+3]=0;(11===M||12===M)&&12>=N||12<=M&&(11===N||12===N)?(q[s+0]=w.o,q[s+1]=w.p,q[s+2]=w.q,q[s+3]=255):(11===M||12===M)&&12<N?(q[s+0]=w.o,q[s+1]=w.p,q[s+2]=w.q,q[s+3]=96):(d[s+3]=0,v[s+3]=0);11>=N&&(11===M||12===M)?(f[s+0]=w.o,f[s+1]=w.p,f[s+2]=w.q,f[s+3]=255,x[s+0]=w.o,x[s+1]=w.p,x[s+2]=w.q,x[s+3]=96):(f[s+3]=0,x[s+3]=0);11===N||12===N?(e[s+0]=w.o,e[s+1]=w.p,e[s+2]=w.q,e[s+3]=255,H[s+0]=w.o,H[s+1]=w.p,H[s+2]=w.q,H[s+3]=96):(e[s+3]=0,H[s+3]=0);11===N||12===N||12<=N&&(11===M||12===M)?(g[s+0]=w.o,g[s+1]=w.p,g[s+2]=w.q,g[s+3]=255,K[s+0]=w.o,K[s+1]=w.p,K[s+2]=w.q,K[s+3]=96):(g[s+3]=0,K[s+3]=0);(11===N||12===N)&&12>=M||12<=N&&(11===M||12===M)?(O[s+0]=w.o,O[s+1]=w.p,O[s+2]=w.q,O[s+3]=255):(11===N||12===N)&&12<M?(O[s+0]=w.o,O[s+1]=w.p,O[s+2]=w.q,O[s+3]=96):O[s+3]=0;11===N||12===N?(G[s+0]=w.o,G[s+1]=w.p,G[s+2]=w.q,G[s+3]=255):12<N&&(11===M||12===M)?(G[s+0]=w.o,G[s+1]=w.p,G[s+2]=w.q,G[s+3]=96):G[s+3]=0;11>=M&&(11===N||12===N)||11<=N&&(11===M||12===M)?(h[s+0]=w.o,h[s+1]=w.p,h[s+2]=w.q,h[s+3]=255,ra[s+0]=w.o,ra[s+1]=w.p,ra[s+2]=w.q,ra[s+3]=96):(h[s+3]=0,ra[s+3]=0)}this.b.Mh=this.oa(20,20,20*.07,w,1,null);this.b.Ph=this.oa(20,20,20*.07,new u(Na,Na,Na,96),1,null);this.b.Nh=this.oa(20,20,1.2,new u(255,255,255,255),1,this.b.ec);this.b.Qh=this.oa(20,20,1.2,new u(0,0,0,255),1,this.b.pc);this.b.Oh=this.oa(20,20,1.2,new u(255,255,255,96),1,this.b.Ld);this.b.Rh=this.oa(20,20,1.2,new u(0,0,0,96),1,this.b.ge)};function sc(a){var b=a.a.Selection.d.a.getContext("2d");a.b.nb=b.createImageData(24,24);a.b.Mb=b.createImageData(24,24);for(var c=a.b.nb.data,d=a.b.Mb.data,f=0;24>f;f++)for(var e=0;24>e;e++){var g=4*(e+24*f);c[g+3]=255;d[g+3]=255;0===e&&23===f||23===e&&0===f?(c[g+0]=135,c[g+1]=125,c[g+2]=135,d[g+0]=216):23===e||23===f?(c[g+0]=89,c[g+1]=89,c[g+2]=89,d[g+0]=178):(0===f||0===e?(c[g+0]=182,c[g+1]=182,c[g+2]=182):(c[g+0]=128,c[g+1]=128,c[g+2]=128),d[g+0]=255);d[g+1]=0;d[g+2]=0}b.putImageData(a.b.nb,0,0);b.putImageData(a.b.Mb,0,30)}r.oa=function(a,b,c,d,f,e){void 0===f&&(f=1);var g=this.a.I.d.a.getContext("2d");g.clearRect(0,0,a,b);null!==e&&g.putImageData(e,0,0);g.globalAlpha=f;g.strokeStyle=Q(d);g.fillStyle=Q(d);g.lineWidth=c;f=a/2;d=3*b/4;var h=.1*a;c=Math.sqrt(f*f-(d-f)*(d-f))+f-h;f=-Math.sqrt(f*f-(d-f)*(d-f))+f+h;null!==e&&(c=Math.floor(c-.5),f=Math.ceil(f+.5),h=Math.ceil(h+.5),d=Math.floor(d-.5));g.beginPath();g.moveTo(a/2,h);g.lineTo(c,d);g.lineTo(f,d);g.closePath();g.stroke();a=g.getImageData(0,0,a,b);g.putImageData(a,0,0);return a};r.Le=function(){var a=this.a.Vf.d.a.getContext("2d");this.b.ua=a.createImageData(20,20);a=this.b.ua.data;this.b.Db=Math.max(3,3);for(var b=0;20>b;b++)for(var c=0;20>c;c++){var d=Math.abs(b-8.5),f=Math.abs(c-8.5),d=Math.sqrt(f*f+d*d)/8.5,d=1>d?.15+.75*(1-d):0,f=4*(20*b+c);a[f+0]=0;a[f+1]=0;a[f+2]=0;a[f+3]=parseInt(255*d)}};function pc(a){a.oe=!0;vc(a,!1)}r.Hd=function(a,b){var c=Ga(this.a.J.d.a);return{f:(a-c.f-10-this.K.f)/24|0,g:(b-c.g-10-this.K.g)/24|0}};r.Va=function(a,b){var c=this.b.M,d=this.b.D;if(!(0>=c||0>=d)){var f=this.a.Selection.d.a.getContext("2d");f.clearRect(0,0,c,d);0<=a&&0<=b&&(c=10+this.K.f+24*a,d=10+this.K.g+24*b,this.F.w(a,b).Pc()&&f.putImageData(this.b.nb,c,d))}};function qc(a){var b=a.b.M,c=a.b.D,c=-a.K.g/(20+24*(a.F.F.length+1)-c)*(c-4-a.a.$d)+2;a.a.ha.style.left=-a.K.f/(20+24*(rc(a.F)+1)-b)*(b-4-a.a.ae)+2+"px";a.a.ja.style.top=c+"px"};var ac=-9,bc=-8,cc=-7;function wc(a,b,c){this.C=a;this.$=b;this.ye=c}wc.prototype.Pc=function(){return!1};wc.prototype.S=function(){return this.ye};wc.prototype.jc=function(){if(-10!==this.C)if(ac===this.C){if(this.$.jc()&&0<S(this.$)&&this.$.S().Ha.g>=this.ye.Ha.g)return{Eb:!0}}else if(bc===this.C){if(!this.$.jc())return{Eb:!1};var a=this.ye.Ha.g,b=this.$.S().Ha.g;if(a<b)return{Eb:!0,Dh:0};if(a===b)return{Eb:!0,Dh:1}}else if(cc===this.C)return{Eb:this.ye.jc()};return{Eb:!1}};function oc(){this.F=[];this.c=null;this.Fa=0}oc.prototype.ra=function(){this.F=[];this.Fa=0};oc.prototype.yb=function(){this.c&&(this.ra(),xc(this,this.c.ma,0,0))};function xc(a,b,c,d){var f,e=1;for(f=b;0<S(f);)e++,f=f.S(0);for(f=e;!yc(a,c,d,f);)d++;var e=c,g=d,h=b;for(a.ia(e,g,b);0<S(h);)e++,h=h.S(0),a.ia(e,g,h);for(e=b;0<S(e);)e=e.S(0);c+=f-1;for(f={Wh:d};;){for(var g=d,h=a.Fa,l=S(e),k=1;k<l;k++){a.Fa=h;var m=d,n=xc(a,e.S(k),c+1,d+1);d=n.g;for(m+=1;m<=d;m++)if(m===n.Wh)if(l-1===k){a.ia(c,m,new wc(cc,e,e.S(k)));break}else a.ia(c,m,new wc(bc,e,e.S(k)));else m<n.Wh?a.ia(c,m,new wc(ac,e,e.S(k))):a.ia(c,m,new wc(ac,e,e.S(k+1)))}a.Fa=h;if(e===b)break;e.ic()&&a.Fa--;e=e.$;c--;d=g}f.g=d;return f}oc.prototype.w=function(a,b){return void 0===this.F[b]||void 0===this.F[b][a]?new wc(-10,null,null):this.F[b][a]};oc.prototype.ia=function(a,b,c){void 0===this.F[b]&&(this.F[b]=[]);if(c.Pc())if(c.ic()){this.Fa++;var d=this.Fa;c.Ha.f=a;c.Ha.g=b;c.Ha.Of=d}else c.Ha.f=a,c.Ha.g=b,c.Ha.Of=-1;this.F[b][a]=c};function yc(a,b,c,d){for(var f=0;f<d;f++){var e=b+f;if(!1===(void 0===a.F[c]||void 0===a.F[c][e]||-10===a.F[c][e].C?!0:!1))return!1}return!0}function rc(a){for(var b=0,c=a.F.length,d=0;d<c;d++){var f=a.F[d].length-1;f>b&&(b=f)}return b};function zc(a){if(this.c=a)a.k=this;this.Ga=null;this.ba=[];this.a={Mf:null,Ih:null,xh:null,rh:null,Wd:null,Yd:null,Nd:null};this.rb=this.re=this.Pa=0}r=zc.prototype;r.v=function(a,b){Ac(this,b);var c=this.c,d=z(a),f=a+"_Board",e=a+"_Message",g=a+"_Next";this.L(d.a,f);var h=this.L(d.a,g),l=this.L(d.a,e);l.style.backgroundColor="rgb(255,255,255)";l.style["border-radius"]="6px";l.style["-webkit-border-radius"]="6px";l.style["-moz-border-radius"]="5px";l.style["-khtml-border-radius"]="10px";l.style.borderColor="#e3e3e3";l.style.borderWidth="5px";l.style.borderStyle="ridge";l.style.display="block";var k=z(f);F(k.h,0,0,1E3,1E3,!1,!1,!1,!1,-1,-1);k.m=I|J|P|L;d.l(k);this.L(k.a,f+"_Centred");var m=z(f);k.mb(2);k.l(m);k=z(e);F(k.h,350,350,650,650,!1,!1,!1,!1,-1,-1);k.m=I|J|P|L;d.l(k);m=new aa(this);m.v(f,c);m.ac=this;var n=z(g);F(n.h,0,0,1E3,1E3,!1,!1,!1,!1,-1,-1);n.m=I|J|P|L;d.l(n);c=g+"_Centred";this.L(n.a,c);f=z(c);n.mb(2);n.l(f);n=c+"_Next";g=Bc(f.a,n);g.value="\u0414\u0430\u043b\u0435\u0435";g.style.display="none";var p=c+"_Prev",c=Bc(f.a,p);c.value="\u041d\u0430\u0437\u0430\u0434";c.style.display="none";var t=this;g.onclick=function(){t.a.Wd.style.display="none";t.a.Yd.style.display="none";Cc(t)};c.onclick=function(){t.a.Wd.style.display="none";t.a.Yd.style.display="none";Dc(t)};n=z(n);F(n.h,501,0,2,2,!1,!1,!0,!0,-1,25);n.m=J|P|L;f.l(n);n=z(p);F(n.h,2,0,499,2,!0,!1,!1,!0,-1,25);n.m=J|P|L;f.l(n);var q=e+"_Text",p=e+"_Next",v=e+"_Prev",e=this.L(l,q);e.style.fontFamily="verdana";e.style.textAlign="justify";e.style.Lj="center";e.style.overflowY="scroll";f=Bc(l,p);n=Bc(l,v);n.onclick=function(){Dc(t)};f.onclick=function(){Cc(t)};q=z(q);F(q.h,0,0,1E3,35,!1,!1,!1,!0,-1,-1);q.m=I|J|L|P;k.l(q);p=z(p);F(p.h,0,0,5,5,!1,!1,!0,!0,100,25);p.m=L|P;k.l(p);p=z(v);F(p.h,5,0,0,5,!0,!1,!1,!0,100,25);p.m=L|J;k.l(p);this.a.Mf=l;this.a.Ih=e;this.a.xh=n;this.a.rh=f;this.a.Wd=g;this.a.Yd=c;this.a.Nd=h;this.ba.push(m);this.Ga=d;this.t();Ec(this,0,0)};r.t=function(){this.Ga&&this.Ga.Ea(this.Ga.a.clientWidth,this.Ga.a.clientHeight);for(var a=0,b=this.ba.length;a<b;a++)this.ba[a].t()};function jb(a){return null===a.T[a.Pa].Aa||void 0===a.T[a.Pa].Aa.ah?0:a.T[a.Pa].Aa.ah}function kb(a){null!==a.T[a.Pa].Aa&&!0===a.T[a.Pa].Aa.Si?(a.a.Nd.style.display="block",a.a.Wd.style.display="block",a.a.Yd.style.display="block"):a.Oj(a.Pa,2)}r.zh=function(){};r.Ub=function(){};r.Vb=function(){};r.Sh=function(){};r.Uh=function(){};r.Th=function(){};r.Vh=function(){};r.Vc=function(){};r.Uc=function(){};r.Pf=function(){};r.th=function(){};function Ac(a,b){var c=b.length;a.re=c;a.T=[];for(var d=0;d<c;d++)a.T[d]={},a.T[d].Uf=b[d].Sgf,a.T[d].Hj=b[d].Before,a.T[d].Gj=b[d].After,a.T[d].Lf=b[d].Message,null===b[d].SgfPr?a.T[d].Aa=null:(a.T[d].Aa={},a.T[d].Aa.ah=b[d].SgfPr.Count,a.T[d].Aa.Si=b[d].SgfPr.WaitOnEnd,a.T[d].Aa.Kc={},b[d].SgfPr.Flags&&(a.T[d].Aa.Kc.Vd=b[d].SgfPr.Flags.NewNode,a.T[d].Aa.Kc.Ud=b[d].SgfPr.Flags.Move,a.T[d].Aa.Kc.gf=b[d].SgfPr.Flags.ChangeBoardMode,a.T[d].Aa.Kc.Kf=b[d].SgfPr.Flags.LoadFile))}function Cc(a){var b=a.Pa;0===a.rb?null!==a.T[b].Uf?Ec(a,b,1):(a.rb=1,Cc(a)):1!==a.rb||b>=a.re-1||(null!==a.T[b+1].Lf?Ec(a,b+1,0):(a.Pa++,a.rb=0,Cc(a)))}function Dc(a){var b=a.Pa;0===a.rb?0>=b||(null!==a.T[b-1].Uf?Ec(a,b-1,1):(a.Pa--,a.rb=1,Dc(a))):1===a.rb&&(null!==a.T[b].Lf?Ec(a,b,0):(a.rb=0,Dc(a)))}function Ec(a,b,c){if(!(0>b||b>=a.re)){a.Pa=b;a.rb=c;var d=a.T[b].Uf,f=a.T[b].Aa,e=a.T[b].Lf;0===c?(a.a.Nd.style.display="block",null!==e?(c=0===b?null:"\u041d\u0430\u0437\u0430\u0434",b=b===a.re-1&&null===d?null:"\u0414\u0430\u043b\u0435\u0435",d=a.a.xh,f=a.a.rh,a.a.Mf.style.display="block",a.a.Ih.innerHTML=e,null===c?d.style.display="none":(d.style.display="block",d.value=c),null===b?f.style.display="none":(f.style.display="block",f.value=b)):Cc(a)):1===c&&(a.a.Nd.style.display="none",null!==d?(a.a.Mf.style.display="none",a.c.A=4294967295,a.c.kc(d),Fc(a.c,f.Kc),a.c.Da()):Cc(a))}}r.L=function(a,b){var c=document.createElement("div");c.setAttribute("id",b);c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("oncontextmenu","return false;");a.appendChild(c);return c};function Bc(a,b){var c=document.createElement("input");c.setAttribute("id",b);c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("type","button");a.appendChild(c);return c};var Gc=0,ic=0,hc=1;function gc(a){this.k=a;this.c=null;this.C=Gc;this.a={d:null,Rb:null,Rf:null,Xf:null};this.xg=new u(217,217,217,255);this.gj=new u(54,101,179,255);this.ij=new u(140,140,140,255);this.jj=new u(0,0,0,255);this.qe=this.xc=this.B=0;this.Hb=7;this.hb=10;this.Zc=!1;var b=this;this.lj=function(a){var d=b.B-b.qe;0!==d&&(kc(b,(a-b.hb)/d,!1),Hc(b,!1))};this.Mg=function(){b.Zc=!0;Hc(b,!1)};this.nj=function(a){b.Zc=!1;var d=b.B-b.qe;0!==d&&(kc(b,(a-b.hb)/d,!1),Hc(b,!0))}}gc.prototype.v=function(a,b,c,d){this.c=b;this.C=c;switch(c){case ic:this.k.nd=this;break;case hc:this.k.Cg=this}this.a.d=z(a);c=this.a.d.a;c.style.backgroundColor=Q(this.xg);c.style.Pj=Q(new u(255,255,255,255));var f=a+"_Left";b=a+"_Right";a+="_Slider";this.a.Rb=this.na(c,f);this.a.Rf=this.na(c,b);this.a.Xf=this.na(c,a);a=z(f);F(a.h,this.hb,this.Hb,500,this.Hb,!0,!0,!1,!0,-1,-1);a.m=I|J|L|P;this.a.d.l(a);a.a.style.background=Q(this.gj);a=z(b);F(a.h,500,this.Hb,this.hb,this.Hb,!1,!0,!0,!0,-1,-1);a.m=I|J|L|P;this.a.d.l(a);a.a.style.background=Q(this.ij);this.t();kc(this,d)};gc.prototype.t=function(){var a=this.a.d.a.clientWidth,b=this.a.d.a.clientHeight;this.B=a-2*this.hb;this.a.d.Ea(a,b);this.Ua(a,b);kc(this,this.xc,!0)};gc.prototype.Ua=function(a,b){var c=b-2*this.Hb;this.qe=c;var d=this.a.Xf;d.style.width=c+"px";d.style.height=c+"px";d.style.display="block";d.style.position="absolute";d.style.backgroundColor=Q(this.jj);d.style.top=this.Hb+"px";d.style.left=this.hb+"px";uc(d,this.hb,a-this.hb-c,this.Hb,this.Hb);d.Ia=this.lj;d.Ke=this.Mg;d.Je=this.nj;d=this.a.Rb;d.style.fontSize=c+"px";d.style.color="rgb(255,255,255)";d.style.textOverflow="clip";d.style.overflow="hidden"};gc.prototype.na=function(a,b){var c=document.createElement("div");c.setAttribute("id",b);c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("oncontextmenu","return false;");a.appendChild(c);return c};function kc(a,b,c){a.xc=Math.min(1,Math.max(b,0));b=a.xc*a.B;a.a.Rb.style.width=b+"px";a.a.Rf.style.left=b+a.hb+"px";a.a.Rf.style.width=a.B-b+"px";!1!==c&&(a.a.Xf.style.left=a.xc*(a.B-a.qe)+a.hb+"px")}function Hc(a,b){if(a.c)switch(a.C){case ic:var c=a.c,d=a.xc;c.ad=d;if(c.k){var f=c.k;f.nd&&(f=f.nd,!0!==f.Zc&&kc(f,d,!0))}null!==c.qb&&c.Tc();b?(a.a.Rb.innerText="",a.a.Rb.innerHTML=""):(c=((100+6900*(1-a.c.ad))/1E3*1E3|0)/1E3,a.a.Rb.innerText=c+" seconds for move",a.a.Rb.innerHTML=c+" seconds for move");break;case hc:c=a.c;d=c.ma;for(f=1;0<S(d);)f++,d=d.S();d=a.xc*(f-1);for(f=c.ma;0<S(f)&&0<d;)d--,f=f.S();hb(c,f)}};function Ic(){this.Zg=this.Yg=this.Xg=this.Wg=this.vh=null;this.ei=!1}Ic.prototype.v=function(a){var b=document.getElementsByTagName("body");if(!(0>=b.length)){this.ng=!0;var c="",d=navigator.userAgent;-1!=d.indexOf("Opera")?c="Opera":-1!=d.indexOf("Chrome")?c="Chrome":-1!=d.indexOf("MSIE")?c="IE":-1!=d.indexOf("Safari")?c="Safari":-1!=d.indexOf("Mozilla")&&(c="Mozilla");"IE"===c&&(this.ei=!0);b=b[0];this.vh=Jc(b,"GoBoardApiSoundPlaceStone",a+"/Stone.mp3");this.Wg=Jc(b,"GoBoardApiSoundCapture1",a+"/Capture1.mp3");this.Xg=Jc(b,"GoBoardApiSoundCapture3",a+"/Capture3.mp3");this.Yg=Jc(b,"GoBoardApiSoundCapture5",a+"/Capture5.mp3");this.Zg=Jc(b,"GoBoardApiSoundCaptureN",a+"/CaptureN.mp3")}};function Kc(a,b){1>=b?Lc(a,a.Wg):3>=b?Lc(a,a.Xg):5>=b?Lc(a,a.Yg):Lc(a,a.Zg)}function Jc(a,b,c){var d=document.getElementById(b);d||(d=document.createElement("audio"),d.id=b,d.Nj="preload",d.src=c,a.appendChild(d));return d}function Lc(a,b){if(b&&a.ng)try{a.ei?(b.setActive(),b.click(),b.autoplay="",b.autoplay="autoplay"):b.play()}catch(c){}};function ec(a){this.k=a;this.c=null;this.a={d:null};this.dj=new u(217,217,217,255);this.kg=[]}ec.prototype.v=function(a,b,c){this.c=b;this.a.d=z(a);var d=this.a.d.a,f=this.a.d;d.style.backgroundColor=Q(this.dj);for(var e=0,g=c.fa.length;e<g;e++){var h=c.fa[e],l=null;switch(h){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:case 20:case 23:case 24:l=new Ib(this.k)}if(null!==l){var k=a+e;this.na(d,k);this.ga(f,k,e/g,(e+1)/g);l.v(k,b,h);this.kg.push(l)}}this.t()};ec.prototype.t=function(){this.a.d.Ea(this.a.d.a.clientWidth,this.a.d.a.clientHeight);for(var a=0,b=this.kg.length;a<b;a++)this.kg[a].t()};ec.prototype.na=function(a,b){var c=document.createElement("div");c.setAttribute("id",b);c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("oncontextmenu","return false;");a.appendChild(c);return c};ec.prototype.ga=function(a,b,c,d){b=z(b);F(b.h,1E3*c,0,1E3*d,1E3,!1,!1,!1,!1,-1,-1);b.m=I|J|L|P;a.l(b)};function Mc(){this.a={d:null,Pb:null,Sd:null,$g:null,Fc:null,ff:null,Oc:null,gc:null,fc:null,hc:null,Nb:null,Bb:null,Ab:null,lb:null};this.hj=new u(166,166,166,255);this.ej=new u(185,185,185,255);this.xg=new u(217,217,217,255);this.G=this.B=-1;var a=this;this.qj=function(){var b=parseInt(a.a.d.a.style.left),c=parseInt(a.a.d.a.style.width),d=parseInt(a.a.Oc.style.left);60>c-d||(a.a.d.a.style.left=b+d+"px",a.a.d.a.style.width=c-d+"px");a.a.Oc.style.left="0px";a.t()};this.tj=function(){var b=parseInt(a.a.d.a.style.width),c=parseInt(a.a.gc.style.left)+6-b;60>b+c?a.a.gc.style.left=b-6+"px":(a.a.d.a.style.width=b+c+"px",a.a.gc.style.left=b+c-6+"px",a.t())};this.mj=function(){var b=parseInt(a.a.d.a.style.height),c=parseInt(a.a.fc.style.top)+6-b;60>b+c?a.a.fc.style.top=b-6+"px":(a.a.d.a.style.height=b+c+"px",a.a.fc.style.top=b+c-6+"px",a.t())};this.vj=function(){var b=parseInt(a.a.d.a.style.top),c=parseInt(a.a.d.a.style.height),d=parseInt(a.a.hc.style.top);60>c-d?a.a.hc.style.top="0px":(a.a.d.a.style.top=b+d+"px",a.a.d.a.style.height=c-d+"px",a.a.hc.style.top="0px",a.t())};this.rj=function(){var b=parseInt(a.a.d.a.style.top),c=parseInt(a.a.d.a.style.height),d=parseInt(a.a.Nb.style.top);60>c-d||(a.a.d.a.style.top=b+d+"px",a.a.d.a.style.height=c-d+"px");a.a.Nb.style.top="0px";b=parseInt(a.a.d.a.style.left);c=parseInt(a.a.d.a.style.width);d=parseInt(a.a.Nb.style.left);60>c-d||(a.a.d.a.style.left=b+d+"px",a.a.d.a.style.width=c-d+"px");a.a.Nb.style.left="0px";a.t()};this.uj=function(){var b=parseInt(a.a.d.a.style.top),c=parseInt(a.a.d.a.style.height),d=parseInt(a.a.Bb.style.top);60>c-d||(a.a.d.a.style.top=b+d+"px",a.a.d.a.style.height=c-d+"px");a.a.Bb.style.top="0px";b=parseInt(a.a.d.a.style.width);c=parseInt(a.a.Bb.style.left)+6-b;60>b+c?a.a.Bb.style.left=b-6+"px":(a.a.d.a.style.width=b+c+"px",a.a.Bb.style.left=b+c-6+"px");a.t()};this.pj=function(){var b=parseInt(a.a.d.a.style.left),c=parseInt(a.a.d.a.style.width),d=parseInt(a.a.Ab.style.left);60>c-d||(a.a.d.a.style.left=b+d+"px",a.a.d.a.style.width=c-d+"px");a.a.Ab.style.left="0px";b=parseInt(a.a.d.a.style.height);c=parseInt(a.a.Ab.style.top)+6-b;60>b+c?a.a.Ab.style.top=b-6+"px":(a.a.d.a.style.height=b+c+"px",a.a.Ab.style.top=b+c-6+"px");a.t()};this.sj=function(){var b=parseInt(a.a.d.a.style.width),c=parseInt(a.a.lb.style.left)+6-b;60>b+c?a.a.lb.style.left=b-6+"px":(a.a.d.a.style.width=b+c+"px",a.a.lb.style.left=b+c-6+"px");b=parseInt(a.a.d.a.style.height);c=parseInt(a.a.lb.style.top)+6-b;60>b+c?a.a.lb.style.top=b-6+"px":(a.a.d.a.style.height=b+c+"px",a.a.lb.style.top=b+c-6+"px");a.t()}}Mc.prototype.v=function(a,b){var c=this;this.a.d=z(a);var d=this.a.d.a,f=this.a.d;d.style.border="1px solid "+Q(this.hj);d.style.backgroundColor=Q(this.xg);var e=a+"_Inner",g=T(d,e),e=z(e);F(e.h,6,29,8,8,!0,!0,!0,!0,-1,-1);e.m=I|J|L|P;f.l(e);g.style.border="1px solid "+Q(this.ej);g.style.backgroundColor=Q(new u(255,255,255,255));g.style.overflow="hidden";this.a.Pb=g;this.a.Sd=e;e=a+"_Caption";T(d,e);g=z(e);F(g.h,0,0,1E3,1E3,!1,!1,!1,!1,-1,30);g.m=I|J|P;f.l(g);var h=e+"_Text",e=T(d,h),h=z(h);F(h.h,15,0,55,1E3,!0,!1,!0,!1,-1,30);h.m=I|J|P|L;g.l(h);e.innerText="Caption";e.style.fontFamily="Tahoma, Sans serif";e.style.fontSize="13pt";e.style.textAlign="center";e.style.height="29px";e.style.lineHeight="29px";e.style.overflow="hidden";e.style.textOverflow="ellipsis";e.style["-o-text-overflow"]="ellipsis";e.style.cursor="default";this.a.ff=e;e=a+"_Caption2";g=T(d,e);e=z(e);F(e.h,0,0,1E3,1E3,!1,!1,!1,!1,-1,30);e.m=I|J|P;f.l(e);this.a.Fc=g;uc(g);g.Ia=function(){var a=parseInt(c.a.d.a.style.top),b=parseInt(c.a.Fc.style.top);c.a.d.a.style.left=parseInt(c.a.d.a.style.left)+parseInt(c.a.Fc.style.left)+"px";c.a.d.a.style.top=a+b+"px";c.a.Fc.style.left="0px";c.a.Fc.style.top="0px";c.t()};!1!==b&&(e=a+"_LeftHandler",g=T(d,e),e=z(e),F(e.h,0,6,1E3,6,!1,!0,!1,!0,6,-1),e.m=I|J|L,f.l(e),g.style.cursor="w-resize",this.a.Oc=g,e=a+"_RightHandler",g=T(d,e),e=z(e),F(e.h,0,6,0,6,!1,!0,!0,!0,6,-1),e.m=I|P|L,f.l(e),g.style.cursor="w-resize",this.a.gc=g,e=a+"_BottomHandler",g=T(d,e),e=z(e),F(e.h,6,0,6,0,!0,!1,!0,!0,-1,6),e.m=L|P|J,f.l(e),g.style.cursor="s-resize",this.a.fc=g,e=a+"_TopHandler",g=T(d,e),e=z(e),F(e.h,6,0,6,1E3,!0,!0,!0,!1,-1,6),e.m=I|P|J,f.l(e),g.style.cursor="s-resize",this.a.hc=g,e=a+"_LeftTopHandler",g=T(d,e),e=z(e),F(e.h,0,0,1E3,1E3,!1,!1,!1,!1,6,6),e.m=I|J,f.l(e),g.style.cursor="se-resize",this.a.Nb=g,e=a+"_RightTopHandler",g=T(d,e),e=z(e),F(e.h,0,0,0,1E3,!1,!1,!0,!1,6,6),e.m=I|P,f.l(e),g.style.cursor="ne-resize",this.a.Bb=g,e=a+"_LeftBottomHandler",g=T(d,e),e=z(e),F(e.h,0,0,0,1E3,!1,!1,!1,!1,6,6),e.m=L|J,f.l(e),g.style.cursor="ne-resize",this.a.Ab=g,e=a+"_RightBottomHandler",g=T(d,e),e=z(e),F(e.h,0,0,0,1E3,!1,!1,!0,!1,6,6),e.m=L|P,f.l(e),g.style.cursor="se-resize",this.a.lb=g,uc(this.a.Oc,null,null,null,null),this.a.Oc.Ia=this.qj,uc(this.a.gc,null,null,null,null),this.a.gc.Ia=this.tj,uc(this.a.hc,null,null,null,null),this.a.hc.Ia=this.vj,uc(this.a.fc,null,null,null,null),this.a.fc.Ia=this.mj,uc(this.a.Nb,null,null,null,null),this.a.Nb.Ia=this.rj,uc(this.a.Bb,null,null,null,null),this.a.Bb.Ia=this.uj,uc(this.a.Ab,null,null,null,null),this.a.Ab.Ia=this.pj,uc(this.a.lb,null,null,null,null),this.a.lb.Ia=this.sj);g=a+"_Close";d=T(d,g);e=z(g);F(e.h,0,0,6,1E3,!1,!0,!0,!1,45,20);e.m=I|P;f.l(e);d.style.backgroundColor=Q(new u(255,0,0,255));f=new Ib(this.k);f.v(g,this,19);f.ze=new u(199,80,80,255);f.od=new u(224,67,67,255);f.se=new u(153,61,61,255);this.a.$g=f};Mc.prototype.t=function(a){var b=this.a.d.a.clientWidth,c=this.a.d.a.clientHeight;if(b!==this.B||c!==this.G||!0===a)this.B=b,this.G=c,this.a.d.Ea(b,c),this.a.$g.t()};function Pb(a){var b=a.a.d.a;b.parentNode.removeChild(b);a.c&&a.c.Da()}Mc.prototype.Da=function(){};function Ca(a,b){a.a.ff.innerText=b;a.a.ff.innerHTML=b}function T(a,b){var c=document.createElement("div");c.setAttribute("id",b);c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("oncontextmenu","return false;");a.appendChild(c);return c}function Nc(){Nc.ya.constructor.call(this);this.a.lc=null;this.a.Ec=null;this.a.Hc=null;this.a.jf=null}Oc(Nc,Mc);Nc.prototype.v=function(a,b){Nc.ya.v.call(this,a,b);var c=this.a.Pb,d=this.a.Sd,f=c.id,e=f+"Content",f=f+"Buttons",g=T(c,e),c=T(c,f),e=z(e);F(e.h,0,0,0,40,!0,!0,!0,!0,-1,-1);e.m=J|I|L|P;d.l(e);var h=z(f);F(h.h,0,0,0,0,!0,!1,!0,!0,-1,40);h.m=J|L|P;d.l(h);this.a.jf=e;this.a.Hc=g;c.style.borderTop="1px solid rgb(172,172,172)";c.style.backgroundColor="rgb(240,240,240)";g=f+"OK";T(c,g);e=z(g);F(e.h,0,9,85,1E3,!1,!0,!0,!1,66,21);e.m=I|P;d.l(e);e=new Ib(this.k);e.v(g,this,21);this.a.lc=e;e.Bg=new u(234,234,234,255);e.ze=new u(172,172,172,255);e.ve=new u(227,240,252,255);e.od=new u(126,180,234,255);e.wg=new u(207,230,252,255);e.se=new u(86,157,229,255);e.zg=new u(239,239,239,255);e.Ag=new u(217,217,217,255);f+="Cancel";T(c,f);c=z(f);F(c.h,0,9,11,1E3,!1,!0,!0,!1,66,21);c.m=I|P;d.l(c);d=new Ib(this.k);d.v(f,this,22);this.a.Ec=d;d.Bg=new u(234,234,234,255);d.ze=new u(172,172,172,255);d.ve=new u(227,240,252,255);d.od=new u(126,180,234,255);d.wg=new u(207,230,252,255);d.se=new u(86,157,229,255);d.zg=new u(239,239,239,255);d.Ag=new u(217,217,217,255)};Nc.prototype.t=function(a){Nc.ya.t.call(this,a);this.a.lc&&this.a.lc.t();this.a.Ec&&this.a.Ec.t()};Nc.prototype.jh=function(){Pb(this)};Nc.prototype.vf=function(){Pb(this)};function Pc(){Pc.ya.constructor.call(this);this.s={};this.c=null}Oc(Pc,Nc);r=Pc.prototype;r.v=function(a,b){Pc.ya.v.call(this,a);var c=b.Lc;this.c=c;!0!==(c.A&16?!0:!1)&&Lb(this.a.lc,!1);Ca(this,"Game info");var d=this.a.jf,f=this.a.Hc,e=this.a.Hc.id;f.style.overflowX="hidden";f.style.overflowY="scroll";var g=10,h=c.A&16?!0:!1;this.s.Gi=this.Y(f,d,e,"Game name",c.Bc,g,20,h);g+=25;this.s.Ki=this.Y(f,d,e,"Result",c.Bd,g,20,h);g+=25;this.s.Mi=this.Y(f,d,e,"Rules",c.Cd,g,20,h);g+=25;this.s.Ii=this.Y(f,d,e,"Komi",c.zc,g,20,h);g+=25;this.s.Hi=this.Y(f,d,e,"Handicap",c.fd,g,20,h);g+=25;this.s.Qi=this.Y(f,d,e,"Time settings",c.ld+(""===c.Ad?"":" + "+c.Ad),g,20,h);g+=25;this.s.xi=this.Y(f,d,e,"Black",c.pd,g,20,h);g+=25;this.s.yi=this.Y(f,d,e,"Black rank",c.Be,g,20,h);g+=25;this.s.Ti=this.Y(f,d,e,"White",c.Dd,g,20,h);g+=25;this.s.Ui=this.Y(f,d,e,"White rank",c.Ge,g,20,h);g+=25;this.s.Ai=this.Y(f,d,e,"Copyright",c.qd,g,20,h);g+=25;this.s.Rd=this.Y(f,d,e,"Game info",c.vd,g,20,h);g+=25;this.s.Date=this.Y(f,d,e,"Date",c.rd,g,20,h);g+=25;this.s.Event=this.Y(f,d,e,"Event",c.td,g,20,h);g+=25;this.s.Li=this.Y(f,d,e,"Round",c.xd,g,20,h);g+=25;this.s.Ji=this.Y(f,d,e,"Place",c.wd,g,20,h);g+=25;this.s.wi=this.Y(f,d,e,"Annotator",c.sd,g,20,h);g+=25;this.s.Fi=this.Y(f,d,e,"Fuseki",c.ud,g,20,h);g+=25;this.s.Pi=this.Y(f,d,e,"Source",c.yd,g,20,h);g+=25;this.s.Ri=this.Y(f,d,e,"Transcriber",c.zd,g,20,h);g+=25;T(f,e+"Bottom");c=z(e+"Bottom");F(c.h,0,g,1E3,1E3,!0,!0,!1,!1,0,10);c.m=J|I|P;d.l(c)};r.t=function(a){Pc.ya.t.call(this,a);this.a.lc&&this.a.lc.t();this.a.Ec&&this.a.Ec.t()};r.jh=function(){Pb(this)};r.vf=function(){this.c&&(this.c.Bc=this.s.Gi.value,this.c.Bd=this.s.Ki.value,this.c.Cd=this.s.Mi.value,this.c.zc=parseFloat(this.s.Ii.value),this.c.fd=this.s.Hi.value,this.c.ld=this.s.Qi.value,Qc(this.c,this.s.xi.value),Rc(this.c,this.s.yi.value),Sc(this.c,this.s.Ti.value),Tc(this.c,this.s.Ui.value),this.c.qd=this.s.Ai.value,this.c.vd=this.s.Rd.value,this.c.rd=this.s.Date.value,this.c.td=this.s.Event.value,this.c.xd=this.s.Li.value,this.c.wd=this.s.Ji.value,this.c.sd=this.s.wi.value,this.c.ud=this.s.Fi.value,this.c.yd=this.s.Pi.value,this.c.zd=this.s.Ri.value);Pb(this)};r.na=function(a,b,c){var d=document.createElement("div");d.setAttribute("id",b);d.setAttribute("style","position:absolute;padding:0;margin:0;");d.setAttribute("oncontextmenu","return false;");d.style.fontFamily="Tahoma, Sans serif";d.style.fontSize=15*c/20+"px";d.style.lineHeight=c+"px";d.style.height=c+"px";a.appendChild(d);return d};r.Jg=function(a,b,c){var d=document.createElement("input");d.setAttribute("id",b);d.setAttribute("style","position:absolute;padding:0;margin:0;");d.setAttribute("oncontextmenu","return false;");d.setAttribute("type","text");d.style.fontFamily="Tahoma, Sans serif";d.style.fontSize="10pt";d.style.outline="none";!1===c&&(d.disabled="disabled");a.appendChild(d);return d};r.Y=function(a,b,c,d,f,e,g,h){var l;l=30;c+=d;var k=this.na(a,c,g),m=z(c);F(m.h,10,e,1E3,1E3,!0,!0,!1,!1,100,g);m.m=J|I;b.l(m);k.innerText=d;k.innerHTML=d;d=c+"Value";a=this.Jg(a,d,h);h=z(d);F(h.h,110,e+1,l,1E3,!0,!0,!0,!1,-1,g-2);h.m=J|I|P;b.l(h);a.value=f;return a};function Uc(){Uc.ya.constructor.call(this)}Oc(Uc,Mc);Uc.prototype.v=function(a,b){Pc.ya.v.call(this,a,!1);var c=b.Ij,d=this.a.Pb;d.style.fontFamily="Tahoma, Sans serif";d.style.fontSize="16px";d.innerHTML=c;d.innerText=c};function Vc(){Vc.ya.constructor.call(this);this.c=null;this.s={Ka:{Yf:null,Wf:null,df:null,pf:null}}}Oc(Vc,Nc);Vc.prototype.v=function(a,b){Vc.ya.v.call(this,a,!1);var c=document.getElementById(a);c.style.width="240px";c.style.height="230px";this.c=b.Lc;var d=this.a.Hc,c=this.a.jf,f=this.a.Hc.id;Ca(this,"Settings");var f=f+"TGB",e=T(d,f),g=z(f);F(g.h,6,17,8,8,!0,!0,!0,!0,-1,-1);g.m=I|J|L|P;c.l(g);e.style.border="1px solid rgb(221,221,221)";g=f+"N";d=T(d,g);g=z(g);F(g.h,20,10,1E3,1E3,!0,!0,!1,!1,100,15);g.m=I|J;c.l(g);d.style.backgroundColor="rgb(255,255,255)";d.style.fontFamily="Tahoma, Sans serif";d.style.fontSize="10pt";d.style.textAlign="center";d.style.height="15px";d.style.lineHeight="15px";d.style.overflow="hidden";d.style.textOverflow="ellipsis";d.style["-o-text-overflow"]="ellipsis";d.style.cursor="default";d.innerHTML="Color scheme";d.innerText="Color scheme";c=document.createElement("div");c.style.width="100%";c.style.height="10px";e.appendChild(c);this.s.Ka.Yf=Wc(e,f+"TC","TrueColor");this.s.Ka.Wf=Wc(e,f+"SC","SimpleColor");this.s.Ka.df=Wc(e,f+"BS","BookStyle");this.s.Ka.pf=Wc(e,f+"D","Dark");if(c=this.c.n)231===c.Ba.o?c.fb?this.s.Ka.Yf.checked=!0:this.s.Ka.Wf.checked=!0:255===c.Ba.o?this.s.Ka.df.checked=!0:30===c.Ba.o?this.s.Ka.pf.checked=!0:this.s.Ka.Yf.checked=!0};Vc.prototype.vf=function(){var a=this.c.n,b=this.c.N,c=!0,d=!0,f=null,e=!0,g=!0,h=new u(255,255,255,255),l=new u(0,0,0,255),k=new u(0,0,0,255),m=!1;this.s.Ka.Wf.checked?(g=e=d=c=!1,f=new u(231,188,95,255),k=new u(0,0,0,255)):this.s.Ka.df.checked?(g=e=d=c=!1,f=new u(255,255,255,255),k=new u(0,0,0,255)):this.s.Ka.pf.checked?(g=e=d=c=!1,f=new u(30,30,30,255),h=new u(220,220,220,220),k=new u(255,255,255,255),m=!0):(g=e=d=c=!0,f=new u(231,188,95,255),k=new u(0,0,0,255));a&&(a.fb=c,a.$c=d,a.Ba=f,a.qg=e,a.Gb=g,a.R=h,a.Q=l,a.Ra=k,a.Z=m,a.t(!0));b&&(b.fb=c,b.$c=d,b.Ba=f,b.Gb=g,b.R=h,b.Q=l,b.Ra=k,b.Z=m,b.Me(),b.Ed(),sc(b),b.Le(),b.t(!0));Pb(this)};function Wc(a,b,c){var d=document.createElement("div");d.style.paddingLeft="10px";d.style.paddingBottom="5px";a.appendChild(d);var f=document.createElement("input");f.type="radio";f.name="ThemeId";f.value=c;f.setAttribute("id",b);d.appendChild(f);a=document.createElement("span");a.setAttribute("oncontextmenu","return false;");a.style.fontFamily="Tahoma, Sans serif";a.innerHTML=c;a.innerText=c;a.style.fontFamily="Tahoma, Sans serif";a.style.fontSize="13pt";a.style.height="15px";a.style.lineHeight="15px";a.style.cursor="default";d.appendChild(a);a.onclick=function(){f.checked=!0};return f}function Xc(){Xc.ya.constructor.call(this);this.n=null}Oc(Xc,Mc);Xc.prototype.v=function(a,b){Xc.ya.v.call(this,a,!0);this.c=b.Lc;Ca(this,"Score estimate");var c=this.a.Pb,d=this.a.Sd,f=this.a.Pb.id;c.style.background="url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAIAAAD/gAIDAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAg3SURBVHhe7ZpLltw2DEVdNfPQ83gLnmYp3kLWkiwkC0syztAzd54ICgJBEPxXVef0PXJZLeL7SH1aXbdf//ztU+DHX/8e/93w743+84EF7Kp8/uVL3EOKv0OK1cgUoDeL1UhyjOPf6T/w+Ws4dNjcLstLtFS+tzyBgWpD/biEPGZvFqsRQylwiQWEXidhP+jUIk6CWfRavUrRVmVRce5q0Ua9UgydbhXtnHI3daIbmc6Sxz9Wlq1XRY30rEzJ0yzvREHxVZYZzJm4ffvjO/2sh3G9Z0Eg3M3o0CzOTEM4Q73IUCqOM0RUGynVefv2+3cWRRudeuXRFRyulIbxDcxEfpB8FJQMzPgMWToVXiuL8MM5IKiTRmKaVfNyNGlZSgGUWTW+iYqvxQJjcRVOG2BZinB9KFHKktdmWuZmp1hp1slmfKWIxk48M7oFlcUCyl0Gh5+6h0ljo4U3fs5yU3bRohSAmbLMjwD74D84EiruKTuJYz1USwNjkm7pQylRmsxG2t0rMynQoz/xL2vWFU5HKBj7eqVi5WoPUwvVrhSRtIEnQcRXDWcZOUVLfMYxTsWyHqYGiEHapG/vJLEsraOF851hnIZroGZQulX98JSwXjoCZzlFHFtWRCnLNrEA6mbJCgx0YoD4vNDKuSaI0bdds5iaXrNIpYDcX0asXop125Npp1775sDiFOvoZ2fmHXpRtE0TbBHEQr4HTJGl1/CVPvJApcBdKbXkilsMcuo1nOW6x9FfDMqU7mgtlO6k90esKUm2vtqb0ZaPXVbAeHSYXFzRHXK8He2p7RgKTc5kOXxPpVR8bHFApJAHZzDEQjfDnVz1ff1ivs5X/RDmQUmXlzh+rT3T0oQtcxGy91mIH86R9ugK5Gj0NS1VicNlmOT9K4pKQRM8WSViTSv1LnAkk43Ht+pBJi3WKdSIUpR+WGKUZZ6zkpkU8B10lHpd16zzZZgKijS0xZ8z/NEWqCB8luJwiuHJgGNjkaoM9S4oea2cKxX3TEjdM9BwJyAmEmUlwek47q211efD7eSlHhMGRDppw47Xrzt9SgFubDnpNBCTSknQ2rXRUkIuVip8HgdPWJkoVrdSBBKE6PlcdXG40/IBtEP7hNxfCOkCsMMb5coyUoOHWINK7UO1MT0ZxBWE4xM0N7SxXpkOcL/PKnWGnoXiUBsqpuptBhkfn0IaM7VSI3mCf/6aylHCTeJIU0gkNUnEeiaoXjbAP+JzrV4IeO94zSnPvESsJZeGKVQPa2UiEPMnzUMdJUj2ZbYn6sXS8Gpavqx6yK/mx8qa12vyYkcP8RESKJVpMj7RFSRXCp/xNGzRCwfVFgfWcYT9GoKfn3HgsajWWJz46w7NZclIHVccZmEh+GYlyN3XhSoZi8847fAQKIkAglhizQ8XhKCTzWzl6Ln/t0upFAin4YqrwysrBVDepFIgffl3knfuiPjiMuWUepGNmDb1h1K4OUoBNVq1B/GVyH66aquWHcR6w0XLpupPSDOan1JZxysR+aCwExQwvOpNx/QCn97UGpViDEdx6zg4J2X+mYAVz7vi7HKovRfHq34ajqOUYpYuK/SjtjggMA+WcIy1WMPLCrBLPtsSf7SR6tpckyUNkoq1cM7zZVVaaJuZmXXFttPQVOpJeq1i5zWLgEDEO1cKnGJxS8shgfD5zpUC4StH77+NxxC+zAZOvRrvaCbs4l9TB664OUeQtrNhphGFuGbtOxM34Z4Qy6ZEYFzg2aJrTrqMl3RCIK/a4sAoToTK3bAxtzSTQlD1cosDc1CKUkA+PjDr0jKfUVss1XDcK2Aa4GDX8S5agiibRpe4V8B+nwVyz1zpavQHMFBVu4uybH359wqgdFlY3jOj6leOXcgsxmk4EBcRndJ9Gh1//FVrWNzNVT1wbM2SNSKT6pWlClIp496JE7ed1hTpnxtU6hIyILmUivR7odFELNOikVIRLehE/EuF+O2C43dVBeYdCbhfp+GMUovhp03sPO9RWSkAfaJYk0op914896AXGwxMIbsMFKnSHWJNKrUXcSY+BanG9Df/dvPUM1GRPDq8nFLEU1eWXEzGc9YHJRKxBi6B/2+kIDjtXumbf2W4yIHy2KX3IqOUwuexsub16q1D0eX+mOnMlQLXE7wqoqrgvMSMDOWUwUMqtYOM1vIXfyLxEkPXNavkgJ08Oigd74XzmgFLB+OeizQ7soSvcZi+8rj2ElR+kX5lVCeK+Uby+Mb7rFIa6fw6muYtVWtrcTFnwnjOyu1wRB3MjxDmwbWoFOhTbXEgkNczU3b9odQJpIboR3xWc5NN1axEo+Nhlv6q5Di2xKychi0hHHs1z0Aa5KON+EHM0ZZGgNML8FZWYwLHDENqiwPrUPGxxYEyziT57lqs4dkm2t1nEtV9w9nHZkoCXxEezbMUV1bLFDFdxo9gz4uK+gX+A+ZDrA4+xOrgQ6wOimJ13a0Gbm0z94RGX+e+5lC6hwIt1uR9bdL96fiyeqfhwHrpYkzZLi82bulF2phZDLGkXVeO3uZ3T4YC6ZyMLcXMXuBljq7mu4wlk1lMd9ss+3tl6/usfNWYZqBlfUlf2JdCOfRmGUNl2fKm1O9EKUU71by5psuzkJmTJRHLtGtJAJwcEmmW25i5pNmmLMqmlOUSy6+jmgB0RcjdG6nGmU0UvopiBoli7e5kVXzCiTaeKGgkyUMdd8OFnShfirwwPmFmkTtEXyJSStwB8yzrv3JU6oSYj0/kWdYkgmSkV/hUQZLnrE2dMKviE060qUSsV0CGusTa3cna+IQZc0Ei6IXtTmfmGfDTp/8Aysg4kH9KLq0AAAAASUVORK5CYII=')";d.mb(2);f+="B";T(c,f);c=z(f);F(c.h,0,0,1E3,1E3,!0,!0,!1,!1,-1,-1);c.m=I|J|L|P;d.l(c);d=new aa;d.v(f,Yc(this.c));d.ue=this;D(d,9);this.n=d};Xc.prototype.t=function(a){Xc.ya.t.call(this,a);this.n&&this.n.t(a)};function Zc(){Zc.ya.constructor.call(this)}Oc(Zc,Mc);Zc.prototype.v=function(a,b){Zc.ya.v.call(this,a,!0);Ca(this,"Colors counter");var c=this.a.Pb,d=this.a.Sd,f=this.a.Pb.id;c.style.overflowX="hidden";c.style.overflowY="scroll";var e=10,g=b.Di.Qa,h=[0,0,0],l=[0,0,0],k=[0,0,0],m=[0,0,0],n=!1,p=!1,t=!1,q=!1,v;for(v in g){var x=g[v],H=-1;0!==x.o&&0!==x.q&&0!==x.p?(q=!0,H=3):0!==x.o?(n=!0,H=0):0!==x.q?(p=!0,H=1):0!==x.p&&(t=!0,H=2);var O=0,O=60>=x.Xb?0:120>=x.Xb?1:2;switch(H){case 0:h[O]++;break;case 1:l[O]++;break;case 2:k[O]++;break;case 3:m[O]++}}n&&(this.Y(c,d,f,"Red","3 x "+h[2]+" + 2 x "+h[1]+" + 1 x "+h[0]+" ="+(3*h[2]+2*h[1]+h[0]),e,20),e+=25);p&&(this.Y(c,d,f,"Green","3 x "+l[2]+" + 2 x "+l[1]+" + 1 x "+l[0]+" ="+(3*l[2]+2*l[1]+l[0]),e,20),e+=25);t&&(this.Y(c,d,f,"Blue","3 x "+k[2]+" + 2 x "+k[1]+" + 1 x "+k[0]+" ="+(3*k[2]+2*k[1]+k[0]),e,20),e+=25);q&&(this.Y(c,d,f,"Gray","3 x "+m[2]+" + 2 x "+m[1]+" + 1 x "+m[0]+" ="+(3*m[2]+2*m[1]+m[0]),e,20),e+=25);T(c,f+"Bottom");c=z(f+"Bottom");F(c.h,0,e,1E3,1E3,!0,!0,!1,!1,0,10);c.m=J|I|P;d.l(c)};Zc.prototype.na=function(a,b,c){var d=document.createElement("div");d.setAttribute("id",b);d.setAttribute("style","position:absolute;padding:0;margin:0;");d.setAttribute("oncontextmenu","return false;");d.style.fontFamily="Tahoma, Sans serif";d.style.fontSize=15*c/20+"px";d.style.lineHeight=c+"px";d.style.height=c+"px";a.appendChild(d);return d};Zc.prototype.Jg=function(a,b){var c=document.createElement("input");c.setAttribute("id",b);c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("oncontextmenu","return false;");c.setAttribute("type","text");c.style.fontFamily="Tahoma, Sans serif";c.style.fontSize="10pt";c.style.outline="none";c.disabled="disabled";a.appendChild(c);return c};Zc.prototype.Y=function(a,b,c,d,f,e,g,h){var l;l=30;c+=d;var k=this.na(a,c,g),m=z(c);F(m.h,10,e,1E3,1E3,!0,!0,!1,!1,100,g);m.m=J|I;b.l(m);k.innerText=d;k.innerHTML=d;d=c+"Value";a=this.Jg(a,d,h);h=z(d);F(h.h,110,e+1,l,1E3,!0,!0,!0,!1,-1,g-2);h.m=J|I|P;b.l(h);a.value=f;return a};var $c=2,Qb=3,Rb=4,Cb=5,Eb=6;function Bb(a,b,c){var d="unknownwindow";switch(b){case Qb:d="Info";break;case Rb:d="Settings";break;case $c:d="Error";break;case Cb:d="ScoreEstimate";break;case Eb:d="CountColors"}a+=d;if(d=document.getElementById(a))d.style.left="300px",d.style.top="300px";else{d=document.createElement("div");d.setAttribute("id",a);d.setAttribute("style","position:absolute;padding:0;margin:0;width:500px;height:500px;left:300px;top:300px;");d.setAttribute("oncontextmenu","return false;");var f=document.getElementsByTagName("body");if(0<f.length){f[0].appendChild(d);d=null;switch(b){case Qb:d=new Pc;break;case Rb:d=new Vc;break;case $c:d=new Uc;break;case Cb:d=new Xc;break;case Eb:d=new Zc}null!==d&&(d.v(a,c),d.t(!0))}}};function U(){}r=U.prototype;r.Bi=function(){return new ad};r.of=function(a,b){(new Zb(a)).of(b)};r.mf=function(a,b){(new Zb(a)).mf(b)};r.lf=function(a,b){(new Zb(a)).lf(b)};r.Ci=function(a,b,c){(new zc(a)).v(b,c)};r.nf=function(a,b,c){(new Zb(a)).nf(b);b=.3;c.TutorTime&&(b=parseFloat(c.TutorTime));c.TutorColor&&"Black"===c.TutorColor?bd(a,!1,A,b):c.TutorColor&&"White"===c.TutorColor?bd(a,!1,B,b):bd(a,!0,E,b);a.A=0;void 0!==c.NewNode&&(Fc(a,{Vd:!0}),(b=c.NewNode)&&""!==b||(b="Wrong.\nOut of variants."),a.Gg=b);b=void 0!==c.WrongCallback?c.WrongCallback:null;var d=void 0!==c.ResetCallback?c.ResetCallback:null;a.Eg=void 0!==c.RightCallback?c.RightCallback:null;a.Fg=b;a.Dg=d};r.qf=function(a){return a.qf()};r.Tc=function(a){a.Tc(!0)};r.nc=function(a){a.nc()};r.Ni=function(a,b){var c={};c.Vd=b.NewNode;c.Ud=b.Move;c.gf=b.ChangeBoardMode;c.Kf=b.LoadFile;c.Rd=b.GameInfo;Fc(a,c)};r.kc=function(a,b,c){var d={};c&&!0===c.Auto?d.Sg=!0:c&&void 0!==c.X0&&void 0!==c.X1&&void 0!==c.Y0&&void 0!==c.Y1?(d.Sg=!1,d.O=c.X0,d.W=c.X1,d.P=c.Y0,d.X=c.Y1):d=null;c=a.A;a.A=4294967295;a.kc(b,d);a.A=c};r.Sf=function(a){return a.Sf()};r.t=function(a){a.t()};r.Tf=function(a,b){a.Tf(b)};window.GoBoardApi=new U;U.prototype.Create_GameTree=U.prototype.Bi;U.prototype.Create_SimpleBoard=U.prototype.of;U.prototype.Create_BoardWithNavigateButtons=U.prototype.mf;U.prototype.Create_BoardCommentsButtonsNavigator=U.prototype.lf;U.prototype.Create_Presentation=U.prototype.Ci;U.prototype.Create_Problems=U.prototype.nf;U.prototype.Set_Permissions=U.prototype.Ni;U.prototype.Load_Sgf=U.prototype.kc;U.prototype.Update_Size=U.prototype.t;U.prototype.Set_Sound=U.prototype.Tf;U.prototype.Find_ProblemRightVariant=U.prototype.qf;U.prototype.Start_AutoPlay=U.prototype.Tc;U.prototype.Stop_AutoPlay=U.prototype.nc;var cd={};function dd(a,b,c){this.C=void 0===a?0:a;this.mi=void 0===b?null:b;this.hi=void 0===c?0:c}dd.prototype.sa=function(){return this.mi};dd.prototype.mb=function(a){this.C=a};dd.prototype.ce=function(a){this.mi=a};function ed(){Y=X=0}function u(a,b,c,d){this.o=a;this.q=b;this.p=c;this.Xb="undefined"===typeof d?255:d}u.prototype={};function Q(a){return"rgba("+a.o+","+a.q+","+a.p+","+a.Xb/255+")"}function R(a){var b=new ed;b.f=a&255;b.g=a>>8&255;return b}function fd(a){for(var b=[],c=0,d=a.length;c<d;c++)b.push(a[c]);return b}function Ga(a){if("undefined"!=typeof a.offsetParent){for(var b=0,c=0;a;a=a.offsetParent)b+=a.offsetLeft,c+=a.offsetTop;return{f:b,g:c}}return{f:a.x,g:a.y}}function Ha(a){if("string"!=typeof a)return!1;for(var b=0;b<a.length;b++){var c=a.charCodeAt(b);if(48>c||57<c)return!1}return!0}function rb(a,b){return a>b?1:b>a?-1:0}var gd=null;function uc(a,b,c,d,f){a.onmousedown=hd;a.cb=!0;a.kb=!0;a.root=a;a.cb&&isNaN(parseInt(a.root.style.left))&&(a.root.style.left="0px");a.kb&&isNaN(parseInt(a.root.style.top))&&(a.root.style.top="350px");!a.cb&&isNaN(parseInt(a.root.style.right))&&(a.root.style.right="0px");!a.kb&&isNaN(parseInt(a.root.style.bottom))&&(a.root.style.bottom="0px");a.Jb="undefined"!=typeof b?b:null;a.Kb="undefined"!=typeof d?d:null;a.bc="undefined"!=typeof c?c:null;a.cc="undefined"!=typeof f?f:null;a.ui=null;a.vi=null;a.root.Ke=new Function;a.root.Je=new Function;a.root.Ia=new Function}function hd(a){var b=gd=this;a=id(a);var c=parseInt(b.kb?b.root.style.top:b.root.style.bottom),d=parseInt(b.cb?b.root.style.left:b.root.style.right);b.root.Ke(d,c);b.ci=a.clientX;b.di=a.clientY;b.cb?(null!=b.Jb&&(b.He=a.clientX-d+b.Jb),null!=b.bc&&(b.Hg=b.He+b.bc-b.Jb)):(null!=b.Jb&&(b.Hg=-b.Jb+a.clientX+d),null!=b.bc&&(b.He=-b.bc+a.clientX+d));b.kb?(null!=b.Kb&&(b.Ie=a.clientY-c+b.Kb),null!=b.cc&&(b.Ig=b.Ie+b.cc-b.Kb)):(null!=b.Kb&&(b.Ig=-b.Kb+a.clientY+c),null!=b.cc&&(b.Ie=-b.cc+a.clientY+c));document.onmousemove=jd;document.onmouseup=kd;return!1}function jd(a){a=id(a);var b=gd,c=a.clientY;a=a.clientX;var d=parseInt(b.kb?b.root.style.top:b.root.style.bottom),f=parseInt(b.cb?b.root.style.left:b.root.style.right),e,g;null!=b.Jb&&(a=b.cb?Math.max(a,b.He):Math.min(a,b.Hg));null!=b.bc&&(a=b.cb?Math.min(a,b.Hg):Math.max(a,b.He));null!=b.Kb&&(c=b.kb?Math.max(c,b.Ie):Math.min(c,b.Ig));null!=b.cc&&(c=b.kb?Math.min(c,b.Ig):Math.max(c,b.Ie));e=f+(a-b.ci)*(b.cb?1:-1);g=d+(c-b.di)*(b.kb?1:-1);b.ui?e=b.ui(d):b.vi&&(g=b.vi(f));null!=b.Jb&&(e=Math.max(e,b.Jb));null!=b.bc&&(e=Math.min(e,b.bc));null!=b.Kb&&(g=Math.max(g,b.Kb));null!=b.cc&&(g=Math.min(g,b.cc));gd.root.style[b.cb?"left":"right"]=e+"px";gd.root.style[b.kb?"top":"bottom"]=g+"px";gd.ci=a;gd.di=c;gd.root.Ia(e,g);return!1}function kd(){document.onmousemove=null;document.onmouseup=null;gd.root.Je(parseInt(gd.root.style[gd.cb?"left":"right"]),parseInt(gd.root.style[gd.kb?"top":"bottom"]));gd=null}function id(a){"undefined"==typeof a&&(a=window.event);"undefined"==typeof a.layerX&&(a.layerX=a.offsetX);"undefined"==typeof a.layerY&&(a.layerY=a.offsetY);return a}function Oc(a,b){function c(){}c.prototype=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.ya=b.prototype}var $b=window.requestAnimationFrame?window.requestAnimationFrame:window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1E3/60)};var E=0,A=1,B=2,ld=2,Gb=0,Fb=2,Da=23.61,Ea=17.51,Fa=Da/2;var xa=4,md=4294967295^xa;function ad(a){this.wa=new Ic;this.k=a;this.fj=new nc;this.ca=new nd;this.N=this.n=null;this.j=this.ma=new od;this.$b=this.Zb=0;this.gb=A;this.ed=this.ug=this.ki=this.gi=this.fd=this.zc=0;this.Ad=this.ud=this.vd=this.Bc=this.td=this.rd=this.qd=this.ni=this.Be=this.sd="";this.pd="Black";this.wd="";this.Dd="White";this.yd=this.Cd=this.xd=this.Bd="";this.ld=0;this.oi=this.Ge=this.zd="";this.yc=ld;this.A=4294967295;this.qb=null;this.ad=.75;this.fi=-1;this.rg=!1;this.Ib=E;this.ji=300;this.Gg="";this.Dg=this.Fg=this.Eg=this.vg=null}function Yc(a){var b=new ad;b.ca=a.ca.kf();b.ma=pd(a.ma,a.j);b.j=b.ma;zb(b);return b}function bd(a,b,c,d){!0===b?(a.rg=!0,a.Ib=E):(a.rg=!1,a.Ib=c);void 0!==d&&(a.ji=1E3*d)}r=ad.prototype;r.qf=function(){var a=[];qd(this.ma,a);if(0<a.length){var b=Math.max(0,Math.min(a.length-1,Math.floor(Math.random()*a.length)));rd(a[b]);return!0}return!1};r.Tc=function(a){if(2&this.A||!0===a){this.nc();this.k&&this.k.th();var b=this,c=function(){0<S(b.j)&&(b.qb=0,gb(b,1,a));0<S(b.j)?(b.fi=(new Date).getTime(),b.qb=setTimeout(c,100+6900*(1-b.ad))):(b.qb=null,b.k&&b.k.Pf())},d=100+6900*(1-this.ad)-((new Date).getTime()-this.fi);0>=d?c():this.qb=setTimeout(c,d)}};r.nc=function(){this.k&&this.k.Pf();null!==this.qb&&(clearTimeout(this.qb),this.qb=null)};function jc(a){a.N&&a.N.yb();if(a.k){a.Vb();var b=a.k;b.nd&&(b=b.nd,!0!==b.Zc&&kc(b,a.ad,!0))}}r.t=function(){this.k&&this.k.t()};r.Da=function(){this.n&&this.n.Da()};r.kc=function(a,b){if(this.A&8){var c=new sd(this),d=this.A;this.A=4294967295;if(void 0!==a&&""!==a){c.r=[];c.e=0;c.Ac=0;c.lg=[];c.pb=!0;for(var f=c.gd=0,e=a.length,g=[],h=!1;f<e;){(h||32<a.charCodeAt(f))&&g.push(a.charAt(f));if(3<=g.length&&"["==g[g.length-1]){var l=g[g.length-3]+g[g.length-2];if("C"==g[g.length-2]&&"UC"!=l||"AN"==l||"BR"==l||"BT"==l||"CP"==l||"DT"==l||"EV"==l||"GN"==l||"GC"==l||"ON"==l||"OT"==l||"PB"==l||"PC"==l||"PW"==l||"RE"==l||"RO"==l||"RU"==l||"SO"==l||"TM"==l||"US"==l||"WR"==l||"WT"==l)h=!0}else h&&1<=g.length&&"]"==g[g.length-1]&&(2>g.length||"\\"!=g[g.length-2])&&(h=!1);f++}c.r=g;c.gd=c.r.length;td(c)||alert("Error occurs, while read SGF")}this.rg&&(this.Ib=this.gb===A?B:A);f=this.ca.V().f;this.n&&b?!0===b.Sg?sa(this.n,4>=c.i.O?0:c.i.O-2,4>=c.i.P?0:c.i.P-2,3>=f-c.i.W?f-1:c.i.W,3>=f-c.i.X?f-1:c.i.X):sa(this.n,b.O,b.P,b.W,b.X):this.n&&sa(this.n,0,0,f-1,f-1);this.N&&(this.N.yb(),tc(this.N));hb(this,this.ma);this.A=d;this.n&&(c=this.n,null!==c.ac&&ib(c.c.j)>=jb(c.ac)&&kb(c.ac));this.k&&this.k.t(!0)}};r.Sf=function(){var a=new ud;a.c=this;a.Ce="";vd(a,this.ma);return a.Ce};r.Rc=function(){this.ma=new od;this.Cd=this.Bd=this.Bc="";this.zc=0;this.fd="0";this.Ad=this.ld="";Qc(this,"Black");Rc(this,"");Sc(this,"White");Tc(this,"");this.zd=this.yd=this.ud=this.sd=this.wd=this.xd=this.td=this.rd=this.vd=this.qd="";this.yc=0;wd(this)};function fb(a){var b=a.A;E!==a.Ib&&Fc(a,{Ud:!0});hb(a,a.ma);a.A=b;E!==a.Ib&&a.Dg&&a.Dg()}function db(a,b){for(var c=a.j;null!=c.$&&0<b;)c=c.$,b--;hb(a,c)}function gb(a,b,c){if(1===b)xd(a,c)&&pb(a);else{for(c=0;c<b;c++)xd(a);hb(a,a.j)}}function zb(a){for(;xd(a););hb(a,a.j)}r.uh=function(){!0===wb(this,0,0,this.gb)&&pb(this)};function yb(a){var b=a.j.$;if(null!==b){var c=b.da;0<S(b)&&0<c&&hb(a,b.S(c-1))}}function Ab(a){var b=a.j.$;if(null!==b){var c=b.da;c<S(b)-1&&hb(a,b.S(c+1))}}r.uf=function(){for(var a=this.j;!yd(a);){var b=a.$;if(null===b&&a!==this.ma)return;a=b}a.uf();hb(this,a)};r.Sc=function(a){this.gb=a;this.j.Sc(a)};r.dc=function(a,b,c){this.j.dc(a,b,c)};function ob(a,b,c){if(!(a.A&1))return!1;var d=new od,f=d.$=a.j;f.va.push(d);if(!0===c||-1===f.da)f.da=f.va.length-1;a.j=d;a.ed++;!0===b&&a.N&&(a.N.yb(),tc(a.N));return!0}function wb(a,b,c,d){for(var f=(c<<8)+b,e=0,g=S(a.j);e<g;e++){var h=a.j.S(e),l=h.jb,k=l.C;if(f===l.sa()&&d===k&&(A===d||B===d))return b=a.j.da,zd(a.j,e),a.j=h,a.ed++,a.N&&b!==e&&tc(a.N),!0}if(!(a.A&1))return!1;ob(a,!1,!0);a.j.dc(b,c,d);a.N&&(a.N.yb(),tc(a.N));E!==a.Ib&&""!==a.Gg&&a.j.be(a.Gg);return!0}r.Id=function(a,b){this.j.Id(a,b)};r.Jd=function(a){var b=this.j.Ta;this.j.Jd(a);this.N&&""===b&&""!==a&&tc(this.N)};r.be=function(a){var b=this.j.Ta;this.j.be(a);this.N&&(""===b&&""!==a||""!==b&&""===a)&&tc(this.N)};r.za=function(a,b){this.j.za(a,b)};r.$a=function(a){this.j.za(513,a)};r.Dc=function(a,b){this.j.Dc(a,b)};r.Qe=function(a,b){this.j.Sa.Yb||(this.j.Sa.Yb=!0);for(var c=0,d=b.length;c<d;c++)this.j.Qe(b[c],a)};r.Pe=function(a){this.j.Pe(a)};r.Re=function(a){this.j.Re(a)};r.hf=function(){!0===this.j.Sa.Yb&&(this.j.Sa.Yb=!1,this.j.hf());this.n&&(this.n.Ca={},La(this.n))};function xb(a){var b=a.j.$;if(null===b)a.j.ra(),a.N&&(a.N.yb(),tc(a.N)),hb(a,a.j);else for(var c=0,d=S(b);c<d;c++)if(a.j===b.S(c)){d=b;d.va.splice(c,1);d.da>=c&&d.da--; -1===d.da&&0<d.va.length&&(d.da=0);a.j=b;a.N&&(a.N.yb(),tc(a.N));hb(a,b);break}}r.ic=function(){return this.j.ic()};function pb(a){a.n&&(1===a.n.qa&&D(a.n,0),a.n.Ca={},a.de());for(var b=0,c=a.j.pa.length;b<c;b++){var d=a.j.pa[b],f=d.sa(),e=d.hi;switch(d.C){case 1:d=R(f);Ad(a,d.f,d.g,A,!1);break;case 2:d=R(f);Ad(a,d.f,d.g,B,!1);break;case 257:for(var g=0;g<e;g++)d=R(f[g]),Bd(a,d.f,d.g,A,-1);break;case 258:for(g=0;g<e;g++)d=R(f[g]),Bd(a,d.f,d.g,B,-1);break;case 259:for(g=0;g<e;g++)d=R(f[g]),Bd(a,d.f,d.g,E,-1);break;case 260:a.gb=f;break;case 529:if(a.n)for(g=0;g<e;g++)d=R(f[g]),a.n.za(new C(d.f,d.g,Xa,""));break;case 530:if(a.n)for(g=0;g<e;g++)d=R(f[g]),a.n.za(new C(d.f,d.g,$a,""));break;case 531:if(a.n)for(g=0;g<e;g++)d=R(f[g]),a.n.za(new C(d.f,d.g,Ya,""));break;case 532:if(a.n)for(g=0;g<e;g++)d=R(f[g]),a.n.za(new C(d.f,d.g,Za,""));break;case 533:a.n&&(d=R(f.wh),a.n.za(new C(d.f,d.g,Sa,f.Text)));break;case 513:if(a.n)for(g=0;g<e;g++)d=R(f[g]),a.n.$a(d.f,d.g)}}a.n&&(a.j.ic()?(c=a.j.jb,b=c.Mc(),c=c.Nc(),Qa(a.n,b,c)):Qa(a.n,-1,-1),a.j.Sa.Yb&&D(a.n,1),La(a.n));a.k&&(b=a.j.Ta,c=!0,E!==a.Ib?(-1!==b.indexOf("CHOICE")&&(b=b.replace("CHOICE","")),0>=S(a.j)&&(-1!==b.indexOf("RIGHT")&&null!==a.Eg?(a.k.Ub(b.replace("RIGHT","")),a.Eg(),c=!1):-1===b.indexOf("RIGHT")&&null!==a.Fg&&(a.k.Ub(b),a.Fg(),c=!1)),c&&a.k.Ub(b)):a.k.Ub(b));a.N&&vc(a.N,!0);a.Vb();if(a.gb===a.Ib&&null===a.vg&&null===a.qb&&0<=S(a.j)){var h=a.A;a.vg=setTimeout(function(){a.A=4294967295;for(var b=a.j,c=[],d=0,e=S(b);d<e;d++)-1!==b.S(d).Ta.indexOf("CHOICE")&&c.push(d);0<c.length?(d=Math.max(0,Math.min(c.length-1,Math.floor(Math.random()*c.length))),zd(b,c[d])):0<S(b)&&zd(b,0);gb(a,1);a.A=h;a.vg=null},a.ji);a.A=0}}function Ad(a,b,c,d,f){if(0!=b||0!=c){if(a.wa&&!0!==f){var e=a.wa;Lc(e,e.vh)}Bd(a,b,c,d,a.ug+1,f);e=null;if(null!==(e=ub(a.ca,b,c,d,!1))&&0<e.V()){b=e.V();for(c=0;c<b;c++){var g=R(e.sa(c));Bd(a,g.f,g.g,E,-1)}a.wa&&!0!==f&&Kc(a.wa,e.V());A===d?a.Zb+=b:a.$b+=b}else if(null!==(e=vb(a.ca,b,c,d))&&0<e.V()){b=e.V();for(c=0;c<b;c++)g=R(e.sa(c)),Bd(a,g.f,g.g,E,-1);a.wa&&!0!==f&&Kc(a.wa,e.V());A===d?a.$b+=b:a.Zb+=b}else a.ca.ub.Rc()}a.gb=A===d?B:A;a.ug++}function xd(a,b){if(!(a.A&2)&&!0!==b||0===S(a.j)||-1===a.j.da)return!1;a.j=a.j.S(a.j.da);a.ed++;return!0}r.de=function(){this.n&&this.j.de(this.yc,this.n)};r.Qd=function(){if(this.n){var a=this.ca.Qd(this.n);La(this.n);this.j.Sa.Yb||(this.j.Sa.Yb=!0);var b=this.ca,c=this.j.Sa;c.Oa={};for(var d=b.V(),f=1;f<=d.g;f++)for(var e=1;e<=d.f;e++){var g=b.ob[ya(b,e,f)],h=(f<<8)+e;if(A===g||B===g)c.Oa[""+h]=g}this.gi=a.ec+this.Zb;this.ki=a.pc+this.$b+this.zc;this.Vb()}};r.Tf=function(a){this.wa.v(a)};function hb(a,b){if(a.A&2){a.nc();wd(a);a.ca.ra();a.wa&&(a.wa.ng=!1);var c=rd(b);for(a.j=a.ma;a.j!=b&&0<S(a.j);){for(var d=a.j.pa.length,f=0;f<d;f++){var e=a.j.pa[f],g=e.sa(),h=e.hi;switch(e.C){case 1:e=R(g);Ad(a,e.f,e.g,A,!0);break;case 2:e=R(g);Ad(a,e.f,e.g,B,!0);break;case 257:for(var l=0;l<h;l++)e=R(g[l]),a.ca.ia(e.f,e.g,A,-1);break;case 258:for(l=0;l<h;l++)e=R(g[l]),a.ca.ia(e.f,e.g,B,-1);break;case 259:for(l=0;l<h;l++)e=R(g[l]),a.ca.ia(e.f,e.g,E,-1)}}if(!xd(a))break}a.n&&Ja(a.n);pb(a);a.N&&!0===c&&tc(a.N);a.wa&&(a.wa.ng=!0)}}function Hb(a,b){b!==a.yc&&(a.yc=b,a.de())}function Rc(a,b){a.Be=b;a.k&&a.k.Th(a.Be)}function Qc(a,b){a.pd=b;a.k&&a.k.Sh(a.pd)}function Sc(a,b){a.Dd=b;a.k&&a.k.Uh(a.Dd)}function Tc(a,b){a.Ge=b;a.k&&a.k.Vh(a.Ge)}function wd(a){a.j=a.ma;a.Zb=0;a.$b=0;a.ug=0;a.ed=0;a.gb=A}function Bd(a,b,c,d,f,e){a.ca.ia(b,c,d,f);a.n&&!0!==e&&ta(a.n,b,c,d)}r.Vb=function(){if(this.k){var a=this.fj,b=this.j.$;a.xb=null===this.j.$?!1:!0;a.zb=0>=S(this.j)?!1:!0;if(null!==b){var c=b.da;a.Sb=c<S(b)-1?!0:!1;a.Tb=0<c?!0:!1}else a.Sb=!1,a.Tb=!1;this.n&&(a.Xa=this.n.qa);for(var b=this.ma,d=c=1;0<S(b);)c++,b=b.S(),b===this.j&&(d=c);a.Jh=0<c?(d-1)/(c-1):1;this.k.Vb(a);this.n&&1===this.n.qa?this.k.Vc(this.gi,this.ki):this.k.Uc(this.Zb,this.$b)}};function Fc(a,b){b&&(!0===b.Vd?a.A|=1:!1===b.Vd&&(a.A&=-2),!0===b.Ud?a.A|=2:!1===b.Ud&&(a.A&=-3),!0===b.gf?a.A|=xa:!1===b.gf&&(a.A&=md),!0===b.Kf?a.A|=8:!1===b.Kf&&(a.A&=-9),!0===b.Rd?a.A|=16:!1===b.Rd&&(a.A&=-17))}function Db(a){if(a=a.n){a=na(a).toDataURL("image/png");var b=document.createElement("a");b.download="BoardShot.png";b.href="data:image/png;base64"+a;b.click()}};"use strict;";function Cd(){this.dd=this.Fa=0}Cd.prototype.Rc=function(){this.dd=this.Fa=0};Cd.prototype.kf=function(){var a=new Cd;a.Ic(this);return a};Cd.prototype.Ic=function(a){this.Fa=a.Fa;this.dd=a.dd};Cd.prototype.ia=function(a,b){this.Fa=a;this.dd=b};function Dd(a,b){this.cd=void 0===a?E:a;this.hd=void 0===b?-1:b}r=Dd.prototype;r.Ic=function(a){this.cd=a.cd;this.hd=a.hd};r.ra=function(){this.cd=E;this.hd=-1};r.ce=function(a){this.cd=a};r.sa=function(){return this.cd};r.tf=function(){return this.hd};function Ed(){this.Yc=[];this.sc=[]}Ed.prototype.V=function(){return this.sc.length};Ed.prototype.sa=function(a){return this.sc[a]};function Fd(a,b,c){b=(c<<8)+b;c=0;for(var d=a.sc.length;c<d;c++)if(a.sc[c]==b)return!0;return!1}function Gd(){this.Oa={}}Gd.prototype.ra=function(){this.Oa={}};Gd.prototype.Qb=function(a,b){var c=(b<<8)+a;if(void 0!==this.Oa[c])return!0;this.Oa[c]=1;return!1};function sb(){this.Ae={};this.sb=null}sb.prototype.Qb=function(a,b,c){if(E===c)return null;a=(b<<8)+a;if(null===this.sb)return this.sb=c,this.Ae[a]=1,!1;if(c!==this.sb)return null;if(void 0!==this.Ae[a])return!0;this.Ae[a]=1;return!1};sb.prototype.sa=function(){return this.sb};function Hd(){this.ea={};this.jd=E}Hd.prototype.ra=function(){this.ea={};this.jd=E};Hd.prototype.Qb=function(a,b){var c=(b<<8)+a;if(void 0!==this.ea[c])return!0;this.ea[c]=1;return!1};function nb(a,b,c){c=void 0===c?a.jd:c;for(var d in a.ea)a=R(d|0),b.ob[ya(b,a.f,a.g)]=c}function nd(a,b){this.B=void 0===a?19:a;this.G=void 0===b?19:b;this.eb=null;Id(this);this.ub=new Cd;this.ob=null;this.ea=new Hd;this.te=new Gd}r=nd.prototype;r.kf=function(){for(var a=new nd(this.B,this.G),b=0,c=this.eb.length;b<c;b++)a.eb[b].Ic(this.eb[b]);a.ub.Ic(this.ub);return a};r.ra=function(){for(var a=this.B*this.G,b=0;b<a;b++)this.eb[b].ra()};r.V=function(){return{f:this.B,g:this.G}};r.ia=function(a,b,c,d){a=ya(this,a,b);this.eb[a].ce(c);void 0!==d&&null!==d&&-1!==d&&(this.eb[a].hd=d)};r.w=function(a,b){return this.eb[ya(this,a,b)].sa()};r.tf=function(a,b){return this.eb[ya(this,a,b)].tf()};function vb(a,b,c,d){var f=new Ed;Jd(a,b,c,d,f);return 0<f.V()?f:null}function ub(a,b,c,d,f){var e;switch(d){case A:e=B;break;case B:e=A;break;default:return null}d=new Ed;!0!==Fd(d,b+1,c)&&Jd(a,b+1,c,e,d);!0!==Fd(d,b-1,c)&&Jd(a,b-1,c,e,d);!0!==Fd(d,b,c+1)&&Jd(a,b,c+1,e,d);!0!==Fd(d,b,c-1)&&Jd(a,b,c-1,e,d);e=d.V();if(1==e){b=(c<<8)+b;c=d.sa(0);e=a.ub;if(c===e.Fa&&b===e.dd&&1==f)return null;a.ub.ia(b,c)}else if(1<e)a.ub.Rc();else if(0>=e)return null;return d}function Id(a){var b=a.B*a.G;a.eb=Array(b);for(var c=0;c<b;c++)a.eb[c]=new Dd}function ya(a,b,c){return(c-1)*a.B+(b-1)}function Kd(a,b,c,d,f){if(b>a.B||1>b||c>a.G||1>c)return!1;var e=a.w(b,c);return E===e?!0:d===e?Ld(a,b,c,d,f):!1}function Ld(a,b,c,d,f){var e;a:{e=(c<<8)+b;for(var g=0,h=f.Yc.length;g<h;g++)if(f.Yc[g]==e){e=!0;break a}f.Yc.push(e);e=!1}return!0===e?!1:!0===Kd(a,b+1,c,d,f)||!0===Kd(a,b-1,c,d,f)||!0===Kd(a,b,c+1,d,f)||!0===Kd(a,b,c-1,d,f)?!0:!1}function Jd(a,b,c,d,f){b>a.B||1>b||c>a.G||1>c||d!==a.w(b,c)||(!0!==Ld(a,b,c,d,f)&&(f.sc=f.sc.concat(f.Yc)),f.Yc=[])}r.Qd=function(a){for(var b=0,c=0,d=1;d<=this.G;d++)for(var f=1;f<=this.B;f++){var e=null,g=this.ob[ya(this,f,d)];A===g?(e=new C(f,d,Ta,""),B===this.w(f,d)?b+=2:b++):B===g&&(e=new C(f,d,Ua,""),A===this.w(f,d)?c+=2:c++);null===e?a.$a(f,d):a.za(e)}return{ec:b,pc:c}};function Md(a,b,c){if(!(b>a.B||1>b||c>a.G||1>c)){var d=a.w(b,c);if(E!==a.w(b,c))switch(b=a.ea.jd,b){case E:a.ea.jd=d;break;case A:case B:b!==d&&(a.ea.jd=3)}else!1===a.ea.Qb(b,c)&&(Md(a,b+1,c),Md(a,b-1,c),Md(a,b,c+1),Md(a,b,c-1))}}function lb(a,b,c,d){b>a.B||1>b||c>a.G||1>c||(3-d===a.w(b,c)?d===a.ob[ya(a,b,c)]&&a.te.Qb(b,c):!0!==a.ea.Qb(b,c)&&(lb(a,b+1,c,d),lb(a,b-1,c,d),lb(a,b,c+1,d),lb(a,b,c-1,d)))}function mb(a,b,c,d){if(!(b>a.B||1>b||c>a.G||1>c)&&3-d!==a.w(b,c)){if(d===a.w(b,c)){var f=a.te,e=(c<<8)+b;void 0!==f.Oa[e]&&delete f.Oa[e]}!0!==a.ea.Qb(b,c)&&(mb(a,b+1,c,d),mb(a,b-1,c,d),mb(a,b,c+1,d),mb(a,b,c-1,d))}}function za(a,b){for(var c=1;c<=a.G;c++)for(var d=1;d<=a.B;d++)E===a.w(d,c)&&(E===a.ob[ya(a,d,c)]||!0===b&&3===a.ob[ya(a,d,c)])&&(a.ea.ra(),Md(a,d,c),nb(a.ea,a))}function Ba(a,b){var c;a.ka=[];for(var d=0;d<=a.G+1;d++){a.ka[d]=[];for(var f=0;f<=a.B+1;f++)if(0===f||a.B+1===f||0===d||a.G+1===d){a.ka[d][f]=0;c=a;for(var e=f,g=d,h=100,l=[],k=e-4;k<=e+4;k++)for(var m=g-4;m<=g+4;m++)if(!(1>k||k>c.B||1>m||m>c.G||4<Math.abs(e-k)+Math.abs(g-m))){var n=Oa(c,k,m);if(E!==n){var p=Math.abs(e-k)+Math.abs(g-m);p<h?(h=p,l=[],l.push({f:k,g:m,Zf:n})):p===h&&l.push({f:k,g:m,Zf:n})}}c=l;e=c.length;if(0<e){h=g=!1;for(l=0;l<e;l++)A===c[l].Zf&&(h=!0),B===c[l].Zf&&(g=!0);if(!0!==g||!0!==h)a.ka[d][f]=g?-128:128}}else c=Oa(a,f,d),a.ka[d][f]=A===c?128:B===c?-128:0}for(d=0;5>d;d++){f=a;c=[];for(e=0;e<=f.G+1;e++)for(c[e]=[],g=0;g<=f.B+1;g++){m=[];m[0]=0<g?f.ka[e][g-1]:0;m[1]=g<f.B+1?f.ka[e][g+1]:0;m[2]=0<e?f.ka[e-1][g]:0;m[3]=e<f.G+1?f.ka[e+1][g]:0;h=0;k=l=!1;for(n=0;4>n;n++)0<m[n]?(l=!0,h++):0>m[n]&&(k=!0,h--);m=f.ka[e][g];c[e][g]=0<=m&&!1===k||0>=m&&!1===l?m+h:m}f.ka=c}for(d=0;3>d;d++)Nd(a);c=f=0;for(d=1;d<=a.G;d++)for(e=1;e<=a.B;e++)g=null,h=a.ka[d][e],0<h&&A!==a.w(e,d)?(g=new C(e,d,Ta,""),B===a.w(e,d)?f+=2:f++):0>h&&B!==a.w(e,d)&&(g=new C(e,d,Ua,""),A===a.w(e,d)?c+=2:c++),null===g?b.$a(e,d):b.za(g);for(d=0;23>d;d++)Nd(a);k=l=0;for(d=1;d<=a.G;d++)for(e=1;e<=a.B;e++)g=null,h=a.ka[d][e],0<h&&A!==a.w(e,d)?(g=new C(e,d,Va,""),B===a.w(e,d)?l+=2:l++):0>h&&B!==a.w(e,d)&&(g=new C(e,d,Wa,""),A===a.w(e,d)?k+=2:k++),null!==g&&b.za(g);return{Vg:l,Ug:f,$h:k,Zh:c}}function tb(a,b,c,d){1>b||b>a.B||1>c||c>a.G||!1!==d.Qb(b,c,a.w(b,c))||(tb(a,b+1,c,d),tb(a,b-1,c,d),tb(a,b,c+1,d),tb(a,b,c-1,d),1<b&&1<c&&E===a.w(b-1,c)&&E===a.w(b,c-1)&&tb(a,b-1,c-1,d),b<a.B&&1<c&&E===a.w(b+1,c)&&E===a.w(b,c-1)&&tb(a,b+1,c-1,d),b<a.B&&c<a.G&&E===a.w(b+1,c)&&E===a.w(b,c+1)&&tb(a,b+1,c+1,d),1<b&&c<a.G&&E===a.w(b-1,c)&&E===a.w(b,c+1)&&tb(a,b-1,c+1,d))}function Oa(a,b,c){return void 0===a.Fb||void 0===a.Fb[c]||void 0===a.Fb[c][b]?E:a.Fb[c][b]}function Aa(a,b,c,d){void 0===a.Fb&&(a.Fb=[]);void 0===a.Fb[c]&&(a.Fb[c]=[]);a.Fb[c][b]=d}function Nd(a){for(var b=[],c=0;c<=a.G+1;c++){b[c]=[];for(var d=0;d<=a.B+1;d++){var f=[];f[0]=0<d?a.ka[c][d-1]:null;f[1]=d<a.B+1?a.ka[c][d+1]:null;f[2]=0<c?a.ka[c-1][d]:null;f[3]=c<a.G+1?a.ka[c+1][d]:null;for(var e=0,g=0,h=0;4>h;h++)null!==f[h]&&(0<=f[h]&&e++,0>=f[h]&&g--);f=a.ka[c][d];b[c][d]=0<f&&0!==g?Math.max(f+g,0):0>f&&0!==e?Math.min(f+e,0):f}}a.ka=b};function Od(a,b){this.sb=a;this.C=b}r=Od.prototype;r.Mc=function(){return R(this.sb).f};r.Nc=function(){return R(this.sb).g};r.sa=function(){return this.sb};r.ce=function(a){this.sb=a};r.mb=function(a){this.C=a};function od(){this.va=[];this.da=-1;this.$=null;this.pa=[];this.jb=new Od(0,E);this.Ta="";this.Sa=new Pd;this.Ha={f:-1,g:-1,Of:-1};this.aj=!1}function pd(a,b){var c=new od;c.pa=a.pa;0<a.va.length&&a!==b&&(c.va[0]=pd(a.va[a.da],b),c.da=0,c.va[0].$=c);return c}r=od.prototype;r.Pc=function(){return!0};r.ra=function(){this.va=[];this.da=-1;this.pa=[];this.jb=new Od(0,E);this.Ta="";this.Sa=new Pd};r.S=function(a){return void 0!==this.va[a]?this.va[a]:this.va[this.da]};function zd(a,b){a.da=b>=a.va.length?a.va.length-1:b}function S(a){return a.va.length}r.ic=function(){return E===this.jb.C?!1:!0};r.Jd=function(a){this.Ta+=a};r.be=function(a){this.Ta=a};r.Qe=function(a,b){this.Sa.Oa[""+a]=b};r.hf=function(){this.Sa.Oa={}};r.uf=function(){for(var a=this;0<S(a);)zd(a,0),a=a.S(0)};function rd(a){for(var b=!1,c=a.$;null!=c;){for(var d=!1,f=0,e=S(c);f<e;f++)if(a===c.S(f)){f!==c.da&&(b=!0);zd(c,f);d=!0;break}if(!d)return!1;a=c;c=c.$}return b}function yd(a){for(var b=null;null!==(b=a.$);){if(0!=b.da)return!1;a=b}return!0}r.jc=function(){for(var a=this,b=null;null!=(b=a.$);){if(b.S(b.da)!=a)return!1;a=b}return!0};r.dc=function(a,b,c){a=(b<<8)+a;this.pa.push(new dd(A===c?1:2,a));E===this.jb.C&&(this.jb.ce(a),this.jb.mb(c))};r.Id=function(a,b){var c=new dd(A===a?257:B===a?258:259,fd(b),b.length);this.pa.push(c)};r.za=function(a,b){var c=0;switch(a){case Xa:c=529;break;case va:c=cd.Jj;break;case Ya:c=531;break;case Za:c=532;break;case Sa:c=533;break;case $a:c=530}c=new dd(c,fd(b),b.length);this.pa.push(c)};r.Dc=function(a,b){this.pa.push(new dd(533,{Text:a,wh:b}))};r.Sc=function(a){this.pa.push(new dd(260,a))};r.Pe=function(a){this.pa.push(new dd(769,a))};r.Re=function(a){this.pa.push(new dd(770,a))};r.de=function(a,b){b.a.fe.d.a.getContext("2d").clearRect(0,0,b.b.M,b.b.D);switch(a){case ld:Qd(this,b,-1);break;case 1:var c=this.$;null!==c&&Qd(c,b,this.jb.sa())}};function ib(a){for(var b=1,c=null;null!==(c=a.$);)b++,a=c;return b}function Qd(a,b,c){if(b)for(var d=0,f=S(a);d<f;d++){var e=a.S(d).jb;if(E!==e.C&&c!==e.sa()){var g=R(e.sa()),e=b,h=g.f,l=g.g;if(e.b.I){var g=(e.b.ab/2-1)/2,k=e.b.I;!0===ua(e,h-1,l-1)&&(h=k[h-1].f,l=k[l-1].g,k=e.a.fe.d.a.getContext("2d"),k.fillStyle=Q(e.kj),k.beginPath(),k.arc(h,l,g,0,2*Math.PI,!1),k.fill())}}}}function qd(a,b){-1!==a.Ta.indexOf("RIGHT")&&b.push(a);for(var c=0,d=S(a);c<d;c++)qd(a.S(c),b)};function sd(a){this.c=a;this.r=[];this.Ac=this.e=0;this.lg=[];this.pb=!0;this.gd=0;this.i={O:100,P:100,W:-1,X:-1}}function td(a){a.c.Rc();if("("===a.r[0]&&";"===a.r[1])for(a.e++;a.e<a.gd&&(")"!==a.r[a.e]||0!==a.Ac);){var b=a.r[a.e];if(";"===b){1!=a.e?ob(a.c,!1,!1):a.c.j=a.c.ma;a.c.j.aj=!0;a:{b=a;b.e++;for(var c=b.r[b.e],d=b.r[b.e+1];void 0!==c&&")"!==c&&";"!==c&&"("!==c;){switch(c){case "A":switch(d){case "B":Rd(b,A);break;case "E":Rd(b,E);break;case "W":Rd(b,B);break;case "N":c=b;c.e+=3;d=V(c);c.c.sd=d;break;case "P":c=b;c.e+=3;V(c);break;default:W(b)}break;case "B":switch(d){case "[":Sd(b,A);break;case "R":c=b;c.e+=3;Rc(c.c,V(c));break;case "T":c=b;c.e+=3;d=V(c);c.c.ni=d;break;case "L":c=b;c.e+=3;c.c.Pe(Td(c));break;default:W(b)}break;case "C":switch(d){case "[":c=b;c.e+=2;for(d="";"]"!==c.r[c.e]||"\\"===c.r[c.e-1];)"]"===c.r[c.e+1]&&"\\"===c.r[c.e]?(d+="]",c.e++):d+=c.r[c.e],c.e++;c.e++;c.c.Jd(d);break;case "A":c=b;c.e+=3;V(c);break;case "P":c=b;c.e+=3;d=V(c);c.c.qd=d;break;case "R":Ud(b,Xa);break;default:W(b)}break;case "D":switch(d){case "T":c=b;c.e+=3;d=V(c);c.c.rd=d;break;default:W(b)}break;case "E":switch(d){case "V":c=b;c.e+=3;d=V(c);c.c.td=d;break;default:W(b)}break;case "F":switch(d){case "F":W(b);break;default:W(b)}break;case "G":switch(d){case "N":c=b;c.e+=3;d=V(c);c.c.Bc=d;break;case "C":c=b;c.e+=3;d=V(c);c.c.vd=d;break;case "M":c=b;c.e+=3;1!==Vd(c)&&(c.pb=!1);break;default:W(b)}break;case "H":switch(d){case "A":c=b;c.e+=3;d=Vd(c);c.c.fd=d;break;default:W(b)}break;case "K":switch(d){case "M":c=b;c.e+=3;d=Td(c);c.c.zc=d;break;default:W(b)}break;case "L":switch(d){case "B":c=b;for(c.e+=3;;){d=c.r[c.e];c.e++;var f=c.r[c.e];c.e++;d=d.charCodeAt(0)-96;f=f.charCodeAt(0)-96;c.e++;for(var e="";"]"!==c.r[c.e]&&c.e<c.gd;)e+=c.r[c.e],c.e++;Wd(c,d,f);c.c.Dc(e,(f<<8)+d);if("]"!==c.r[c.e]){c.pb=!1;break}c.e++;if("["!==c.r[c.e])break;c.e++}break;default:W(b)}break;case "M":switch(d){case "A":Ud(b,$a);break;default:W(b)}break;case "O":switch(d){case "N":c=b;c.e+=3;d=V(c);c.c.ud=d;break;case "T":c=b;c.e+=3;d=V(c);c.c.Ad=d;break;default:W(b)}break;case "P":switch(d){case "B":c=b;c.e+=3;Qc(c.c,V(c));break;case "C":c=b;c.e+=3;d=V(c);c.c.wd=d;break;case "W":c=b;c.e+=3;Sc(c.c,V(c));break;case "L":c=b;c.e+=3;"W"===V(c)?c.c.Sc(B):c.c.Sc(A);break;default:W(b)}break;case "R":switch(d){case "E":c=b;c.e+=3;d=V(c);c.c.Bd=d;break;case "O":c=b;c.e+=3;d=V(c);c.c.xd=d;break;case "U":c=b;c.e+=3;d=V(c);c.c.Cd=d;break;default:W(b)}break;case "S":switch(d){case "Q":Ud(b,Ya);break;case "T":c=b;c.e+=3;switch(Vd(c)){case 0:Hb(c.c,ld);break;case 1:Hb(c.c,1);break;default:Hb(c.c,0)}break;case "Z":c=b;c.e+=3;f=Vd(c);0>=f&&(f=19);c=c.c;d=f;f=d=Math.max(d,f,2);e=c.ca.V();if(d!==e.f||f!==e.g)e=c.ca,e.B=d,e.G=f,Id(e),e.ub.Rc(),c.n&&(c=c.n,pa(c),c.Ua(!0));break;case "O":c=b;c.e+=3;d=V(c);c.c.yd=d;break;default:W(b)}break;case "T":switch(d){case "R":Ud(b,Za);break;case "M":c=b;c.e+=3;d=V(c);c.c.ld=d;break;case "B":Xd(b,A);break;case "W":Xd(b,B);break;default:W(b)}break;case "U":switch(d){case "S":c=b;c.e+=3;d=V(c);c.c.zd=d;break;default:W(b)}break;case "W":switch(d){case "[":Sd(b,B);break;case "R":c=b;c.e+=3;Tc(c.c,V(c));break;case "T":c=b;c.e+=3;d=V(c);c.c.oi=d;break;case "L":c=b;c.e+=3;c.c.Re(Td(c));break;default:W(b)}break;default:W(b)}if(!b.pb){b=!1;break a}c=b.r[b.e];d=b.r[b.e+1]}b=!0}if(!b)return!1}else if("("===b)a.lg[a.Ac]=a.c.j,a.Ac++,a.e++;else if(")"===b)a.Ac--,a.c.j=a.lg[a.Ac],a.e++;else return!1}else return!1;return!0}function V(a,b){void 0===b&&(b="]");for(var c="";void 0!==a.r[a.e]&&b!==a.r[a.e];)c+=a.r[a.e],a.e++;void 0===a.r[a.e]&&(a.pb=!1);a.e++;return c}function Td(a){a=parseFloat(V(a,void 0));return isNaN(a)?0:a}function Vd(a){a=parseInt(V(a,void 0));return isNaN(a)?0:a}function W(a){for(;;){for(;void 0!==a.r[a.e]&&"]"!==a.r[a.e]&&a.e<a.gd;)for(a.e++;"]"===a.r[a.e]&&"\\"===a.r[a.e-1];)a.e++;a.e++;if("["!==a.r[a.e])break}}function Rd(a,b){a.e+=3;var c=[];if("]"!==a.r[a.e]){for(;;){var d=a.r[a.e];a.e++;var f=a.r[a.e];a.e++;var e=d.charCodeAt(0)-96,g=f.charCodeAt(0)-96;if(":"===a.r[a.e])for(a.e++,d=a.r[a.e],a.e++,f=a.r[a.e],a.e++,d=d.charCodeAt(0)-96,f=f.charCodeAt(0)-96;g<=f;g++)for(var h=e;h<=d;h++)Wd(a,h,g),c.push((g<<8)+h);else Wd(a,e,g),c.push((g<<8)+e);if("]"!==a.r[a.e]){a.pb=!1;return}a.e++;if("["!==a.r[a.e])break;a.e++}a.c.Id(b,c)}}function Sd(a,b){a.e+=2;if("]"==a.r[a.e])a.c.dc(0,0,b);else{var c=a.r[a.e];a.e++;var d=a.r[a.e];a.e++;var f=a.c.ca.V();"t"===c&&"t"===d&&19>=f.f&&19>=f.g?a.c.dc(0,0,b):(c=c.charCodeAt(0)-96,d=d.charCodeAt(0)-96,Wd(a,c,d),a.c.dc(c,d,b),"]"!==a.r[a.e]&&(a.pb=!1))}a.e++}function Ud(a,b){a.e+=3;var c=[];if("]"!==a.r[a.e]){for(;;){var d=a.r[a.e];a.e++;var f=a.r[a.e];a.e++;var e=d.charCodeAt(0)-96,g=f.charCodeAt(0)-96;if(":"===a.r[a.e])for(a.e++,d=a.r[a.e],a.e++,f=a.r[a.e],a.e++,d=d.charCodeAt(0)-96,f=f.charCodeAt(0)-96;g<=f;g++)for(var h=e;h<=d;h++)Wd(a,h,g),c.push((g<<8)+h);else Wd(a,e,g),c.push((g<<8)+e);if("]"!==a.r[a.e]){a.pb=!1;return}a.e++;if("["!==a.r[a.e])break;a.e++}a.c.za(b,c)}}function Xd(a,b){a.e+=3;var c=[];if("]"!==a.r[a.e]){for(;;){var d=a.r[a.e];a.e++;var f=a.r[a.e];a.e++;var e=d.charCodeAt(0)-96,g=f.charCodeAt(0)-96;if(":"===a.r[a.e])for(a.e++,d=a.r[a.e],a.e++,f=a.r[a.e],a.e++,d=d.charCodeAt(0)-96,f=f.charCodeAt(0)-96;g<=f;g++)for(var h=e;h<=d;h++)c.push((g<<8)+h);else c.push((g<<8)+e);if("]"!==a.r[a.e]){a.pb=!1;return}a.e++;if("["!==a.r[a.e])break;a.e++}a.c.Qe(b,c)}}function Wd(a,b,c){b<a.i.O&&(a.i.O=b);b>a.i.W&&(a.i.W=b);c<a.i.P&&(a.i.P=c);c>a.i.X&&(a.i.X=c)};function ud(){this.c=this.Ce=null}function Z(a,b){a.Ce+=b}function Yd(a,b){var c=R(b);Z(a,String.fromCharCode(91,c.f+96,c.g+96,93))}function Zd(a,b){for(var c=0,d=b.length;c<d;c++)Yd(a,b[c])}function $d(a,b,c){Z(a,b);Z(a,"["+c+"]")}function $(a,b,c){c&&""!==c&&$d(a,b,c)}function vd(a,b){var c=b.$,d=!1;if(null===c||1<S(c))d=!0;d&&Z(a,"(");Z(a,";");b===a.c.ma&&(c=a.c,$d(a,"GM",1),$d(a,"FF",4),$d(a,"CA","UTF-8"),$d(a,"AP","goban.org"),$d(a,"ST",c.yc),$(a,"RU",c.Cd),$d(a,"SZ",c.ca.V().f),$d(a,"KM",c.zc),$d(a,"HA",c.fd),$(a,"TM",c.ld),$(a,"OT",c.Ad),$(a,"RE",c.Bd),$(a,"GN",c.Bc),$(a,"DT",c.rd),$(a,"CP",c.qd),$(a,"GC",c.vd),$(a,"PB",c.pd),$(a,"BR",c.Be),$(a,"BT",c.ni),$(a,"PW",c.Dd),$(a,"WR",c.Ge),$(a,"WT",c.oi),$(a,"EV",c.td),$(a,"RO",c.xd),$(a,"PC",c.wd),$(a,"AN",c.sd),$(a,"ON",c.ud),$(a,"SO",c.yd),$(a,"US",c.zd));for(var c=0,f=b.pa.length;c<f;c++){var e=b.pa[c],g=e.sa();switch(e.C){case 257:Z(a,"AB");Zd(a,g);break;case 258:Z(a,"AW");Zd(a,g);break;case 259:Z(a,"AE");Zd(a,g);break;case 1:Z(a,"B");Yd(a,g);break;case 2:Z(a,"W");Yd(a,g);break;case 769:Z(a,"BL");Z(a,"["+g+"]");break;case 770:Z(a,"WL");Z(a,"["+g+"]");break;case 513:Z(a,"RM");Zd(a,g);break;case 529:Z(a,"CR");Zd(a,g);break;case 530:Z(a,"MA");Zd(a,g);break;case 531:Z(a,"SQ");Zd(a,g);break;case 532:Z(a,"TR");Zd(a,g);break;case 533:Z(a,"LB");Z(a,"[");var e=a,h=R(g.wh);Z(e,String.fromCharCode(h.f+96,h.g+96));Z(a,":"+g.Text+"]");break;case 260:Z(a,"PL"),Z(a,"["+(g===B?"W":"B")+"]")}}c=b.Ta;""!==c&&(c=c.replace("]","\\]"),Z(a,"C"),Z(a,"["),Z(a,c),Z(a,"]"));c=0;for(f=S(b);c<f;c++)vd(a,b.S(c));d&&Z(a,")")};function Pd(){this.Yb=!1;this.Oa={}};}());