/*
 * Copyright (C) 2014  Ilya Kirillov 
 * email: ilya_kirillov@inbox.ru
 * 
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 3.0 of the License, or (at your option) any later version.
 * 
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
*/
(function(){var r;function ba(a){this.j=a;this.J=this.c=null;this.La=0;this.qc=!1;this.nf=this.sc=this.tc=this.yb=this.zb=0;this.wf={};this.ua=null;this.b={G:0,A:0,xa:0,eb:0,Wf:2,F:null,Vf:null,K:null,ee:null,ff:[],Fg:Array(361),Mc:null,jd:null,mc:null,nc:null,rg:null,sg:null,kg:null,lg:null,ng:null,og:null,ag:null,Sf:null,Tf:null};this.ib=new v(231,188,95,255);this.zf=new v(0,0,0,255);this.Ph=new v(255,0,0,128);this.Wb={bh:new v(232,196,115,255),Eh:new v(255,255,255,255),ah:new v(0,0,0,255),xh:new v(141,141,141,255),kh:new v(112,95,54,255),nh:new v(112,95,54,255)};this.a={d:null,K:{d:null},F:{d:null},jc:{d:null},ga:{d:null},gd:{d:null},Ga:{d:null},Sa:{d:null},Event:{d:null}};this.Na={f:-1,g:-1};this.ia={};this.yd=-1;this.Fb=null;var b=this;this.Zd=function(a){ca(a);a=b.Gc(x.f,x.g);a=da(b,a.f,a.g);ea(b,a.f,a.g,!1)};this.Fc=function(a){ca(a);fa(b)};this.Ec=function(a){ga(a);b.a.Event.d.a.focus();var d=b.Gc(x.f,x.g),d=da(b,d.f,d.g);b.Lf(d.f,d.g,x);a.preventDefault();a.stopPropagation();return!1};this.di=function(a){ha(a);if(16===ia.Sc&&2===b.La)x.ha=!0,b.mb();else{var d=ia,f=d.Sc;if(8===f||46===f)if(d=b.c,f=d.i.O,null===f)d.i.ba(),d.I&&(d.I.$a(),ja(d.I)),y(d,d.i);else for(var e=0,g=A(f);e<g;e++){if(d.i===f.N(e)){g=f;g.ya.splice(e,1);g.T>=e&&g.T--; -1===g.T&&0<g.ya.length&&(g.T=0);d.i=f;d.I&&(d.I.$a(),ja(d.I));y(d,f);break}}else if(13===f)d=prompt("Enter here code of ur sgf file",""),b.c.Pb(d);else if(37===f)d.qa&&d.ha?ka(b.c):d.qa?la(b.c,5):la(b.c,1);else if(38===f)d.qa?b.c.ze():ma(b.c);else if(39===f)if(d.qa&&d.ha){for(d=b.c;na(d););y(d,d.i)}else d.qa?oa(b.c,5):oa(b.c,1);else 40===f?pa(b.c):112===f?B(b,0):113===f?B(b,1):114===f?B(b,2):115===f?B(b,3):116===f?B(b,4):117===f?B(b,5):118===f?B(b,6):119===f?B(b,7):120===f?B(b,8):189===f?(d=b.c.uc,d++,d>qa&&(d=ra),sa(b.c,d)):192===f&&(d=!0===b.qc?!1:!0,d!==b.qc&&(b.qc=d,ta(b),b.Ca(!0)))}a.preventDefault()};this.ei=function(a){ha(a);16===ia.Sc&&2===b.La&&(x.ha=!1,b.mb())};this.Nf=function(){return setTimeout(function(){b.Kf();b.Xd();if(b.b.F){var a=b.a.K.d.a.width,d=b.a.K.d.a.height,f=b.a.jc.d.a.getContext("2d"),e=2*Math.floor(Math.floor(b.tc*a)/2)+1;b.b.xa=e;b.b.ee=f.createImageData(e,e);b.b.Dh=f.createImageData(e,e);b.b.Mc=f.createImageData(e,e);b.b.jd=f.createImageData(e,e);for(var g=b.b.ee.data,h=b.b.Dh.data,k=b.b.Mc.data,l=b.b.jd.data,m=e/2-.5,n=m-.2,t=Math.sqrt(3),p=0;p<e;p++)for(var s=0;s<e;s++){var w=p-m,J=s-m,N=n-Math.sqrt(w*w+J*J),z=4*(p*e+e-s-1);if(0<=N){var M=n*n-w*w-J*J,M=0<M?Math.sqrt(M)*t:0,P=w,aa=J,u=Math.sqrt(6*(P*P+aa*aa+M*M)),u=(2*M-P+aa)/u,M=0;.9<u&&(M=10*(u-.9));P=255;.8>=N&&(N=(.8-N)/.8,P=.7,w-J<n/3&&(P=1),P=parseInt(255*(1-N*P)));w=parseInt(10+10*u+140*M);g[z+0]=w;g[z+1]=w;g[z+2]=w;g[z+3]=P;k[z+0]=w;k[z+1]=w;k[z+2]=w;k[z+3]=parseInt(P/2);w=parseInt(200+10*u+45*M);h[z+0]=w;h[z+1]=w;h[z+2]=w;h[z+3]=P;l[z+0]=w;l[z+1]=w;l[z+2]=w;l[z+3]=parseInt(P/2)}else g[z+0]=0,g[z+1]=0,g[z+2]=0,g[z+3]=0,k[z+0]=0,k[z+1]=0,k[z+2]=0,k[z+3]=0,h[z+0]=0,h[z+1]=0,h[z+2]=0,h[z+3]=0,l[z+0]=0,l[z+1]=0,l[z+2]=0,l[z+3]=0}g=[];k=[];for(z=0;28>z;z++)for(g[z]=f.createImageData(e,e),k[z]=g[z].data,p=0;p<e;p++)for(s=0;s<e;s++)m=4*(p*e+s),k[z][m+0]=h[m+0],k[z][m+1]=h[m+1],k[z][m+2]=h[m+2],k[z][m+3]=h[m+3];k.push(l);k.push(h);h=.9;s=Array(a);for(l=0;l<a;l++)s[l]=(Math.sin(18*l/a)+1)/20+(Math.sin(3*l/a)+1)/10;z=Array(d);for(p=0;p<d;p++)z[p]=.2*Math.cos(5*p/d)+.1*Math.sin(11*p/d);f=Array(a*d);for(p=0;p<d;p++)for(l=0;l<a;l++)h=75*(s[l]+z[p])+.5,h-=Math.floor(h),h=.2>h?1-h/2:.4>h?1-(.4-h)/2:1,f[l+p*a]=h;d=b.J.Q().f;s=b.b.F;z=(b.b.xa-1)/2;m=k.length;if(9===d||13===d||19===d)for(n=0;n<m;n++){t=k[n];h=l=0;p=n;if(9===d){if(1===n||9===n||13===n||11===n||21===n||23===n||25===n)p=n-1}else 13!==d||3!==n&&7!==n&&11!==n&&15!==n&&23!==n&&27!==n||(p=n-1);switch(p){case 0:l=0;h=3;break;case 1:l=0;h=4;break;case 2:l=0;h=5;break;case 3:l=0;h=6;break;case 4:l=1;h=3;break;case 5:l=1;h=4;break;case 6:l=1;h=5;break;case 7:l=1;h=6;break;case 8:l=2;h=3;break;case 9:l=2;h=4;break;case 10:l=2;h=5;break;case 11:l=2;h=6;break;case 12:h=l=3;break;case 13:l=3;h=4;break;case 14:l=3;h=5;break;case 15:l=3;h=6;break;case 16:l=4;h=3;break;case 17:h=l=4;break;case 18:l=4;h=5;break;case 19:l=4;h=6;break;case 20:l=5;h=3;break;case 21:l=5;h=4;break;case 22:h=l=5;break;case 23:l=5;h=6;break;case 24:l=6;h=3;break;case 25:l=6;h=4;break;case 26:l=6;h=5;break;case 27:h=l=6}u=s[l].f-z;w=s[h].g-z;for(p=0;p<e;p++)for(l=0;l<e;l++)h=f[u+l+(w+p)*a],J=4*(l+p*e),t[J+0]*=h,t[J+1]*=h,t[J+2]*=h}b.b.ff=g;a=b.J.Q();for(e=0;e<a.g;e++)for(d=0;d<a.f;d++)b.b.Fg[d+e*a.f]=Math.floor(Math.random()*(b.b.ff.length-1))}b.Jf();b.b.F&&(a=b.b.xa,b.b.mc=ua(b,a,a,.05*a,new v(0,0,0,255)),b.b.nc=ua(b,a,a,.05*a,new v(255,255,255,255)),b.b.rg=b.aa(a,a,.05*a,new v(0,0,0,255)),b.b.sg=b.aa(a,a,.05*a,new v(255,255,255,255)),b.b.kg=va(b,a,a,.05*a,new v(0,0,0,255)),b.b.lg=va(b,a,a,.05*a,new v(255,255,255,255)),b.b.ng=wa(b,a,a,new v(0,0,0,255)),b.b.og=wa(b,a,a,new v(255,255,255,255)),b.b.ag=xa(b,a,a,.05*a,new v(255,0,0,255)),b.b.Sf=xa(b,a,a,.05*a,new v(0,0,0,255)),b.b.Tf=xa(b,a,a,.05*a,new v(255,255,255,255)));b.Ca()},20)};this.bi=function(a){a.preventDefault();return!1};this.ci=function(a){a.preventDefault();if(0<a.dataTransfer.files.length&&FileReader){a=a.dataTransfer.files[0];var d=new FileReader;d.onload=function(a){b.c.Pb(a.target.result)};d.readAsText(a);b.ra()}}}r=ba.prototype;r.B=function(a,b){this.j&&this.j.ig(this);this.c=b;this.J=b.Y;this.c.n=this;this.a.d=C(a);var c=this.a.d.a,d=a+"_BoardCanvas",f=a+"_LinesCanvas",e=a+"_ShadowsCanvas",g=a+"_StonesCanvas",h=a+"_VariantsCanvas",k=a+"_MarksCanvas",l=a+"_TargetCanvas",m=a+"_EventDiv";this.ka(c,d);this.ka(c,f);this.ka(c,e);this.ka(c,g);this.ka(c,h);this.ka(c,k);this.ka(c,l);var c=this.ea(c,m),n=this.a.d;this.Z(this.a.K,n,d);this.Z(this.a.F,n,f);this.Z(this.a.ga,n,e);this.Z(this.a.jc,n,g);this.Z(this.a.gd,n,h);this.Z(this.a.Ga,n,k);this.Z(this.a.Sa,n,l);this.Z(this.a.Event,n,m);c.onmousemove=this.Zd;c.onmouseout=this.Fc;c.onmousedown=this.Ec;c.onkeydown=this.di;c.onkeyup=this.ei;c.tabIndex=-1;c.style.Fh=!0;c.style.outline=0;c.ondragover=this.bi;c.ondrop=this.ci;return n};r.ra=function(){this.a.Event.d.a.focus()};r.q=function(){var a=this.a.d.a.clientWidth,b=this.a.d.a.clientHeight;a!==b&&(b=a=Math.min(a,b));this.a.d.sa(a,b);ta(this);this.Ca()};function ya(a,b,c,d){if(a.b.F&&d!==a.wf[(c<<8)+b]){var f=a.a.jc.d.a.getContext("2d"),e=a.a.ga.d.a.getContext("2d"),g=a.b.xa,h=(g-1)/2,k=a.b.F,l=a.b.eb,m=k[b-1].f-h,h=k[c-1].g-h;switch(d){case D:f.putImageData(a.b.ee,m,h);e.putImageData(a.b.ga,m+l,h+l);break;case E:f.putImageData(a.b.ff[a.b.Fg[b-1+(c-1)*a.J.Q().f]],m,h);e.putImageData(a.b.ga,m+l,h+l);break;default:f.clearRect(m,h,g,g),e.clearRect(m+l,h+l,g,g)}a.wf[(c<<8)+b]=d;b===a.Na.f&&c===a.Na.g&&(D===d||E===d?fa(a):a.mb())}}r.Ra=function(a,b){var c=(b<<8)+a;delete this.ia[""+c];c===this.yd&&(this.ia[""+c]=new F(a,b,za,""))};r.pa=function(a){Aa(this,a.bc(),a.cc(),a)};function B(a,b){if(a.c.p&Ba&&a.La!==b){1===a.La&&a.c.re();a.La=b;a.mb();if(1===b){var c=a.J;c.Ta=[];for(var d=1;d<=c.R;d++)for(var f=1;f<=c.H;f++)c.Ta[Ca(c,f,d)]=G;Da(c,!1);a.c.Pc()}a.c.ub()}}r.ka=function(a,b){var c=document.createElement("canvas");c.setAttribute("id",b);c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("oncontextmenu","return false;");a.appendChild(c);return c};r.ea=function(a,b){var c=document.createElement("div");c.setAttribute("id",b);c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("oncontextmenu","return false;");a.appendChild(c);return c};r.Z=function(a,b,c){a.d=C(c);a=a.d;K(a.h,0,0,1E3,1E3,!1,!1,!1,!1,-1,-1);a.l=L|O|Q|R;b.k(a)};r.Gc=function(a,b){var c=Ea(this.a.K.d.a);return{f:a-c.f,g:b-c.g}};function ta(a){var b=a.J.Q(),c=b.f,d=b.g;if(!0===a.qc){var b=Fa/(2*Ga+c),c=(Fa-c*b)/2,f=Ha/(2*Ia+d),d=(Ha-d*f)/2;a.zb=(d+f/2)/Ha;a.yb=(c+b/2)/Fa}else b=Fa/(2*Ga+c-1),c=(Fa-(c-1)*b)/2,f=Ha/(2*Ia+d-1),d=(Ha-(d-1)*f)/2,a.zb=d/Ha,a.yb=c/Fa;a.tc=b/Fa;a.sc=f/Ha;a.nf=4/Fa}r.Ca=function(a){var b=this.a.K.d.a.width,c=this.a.K.d.a.height;if(b!=this.b.G||c!=this.b.A||null===this.b.K||null!==this.ua||!0===a){if(null!==this.ua&&clearTimeout(this.ua),this.ua=this.Nf(),this.Xd(),0!==b&&0!==c){a=this.a.K.d.a.getContext("2d");a.fillStyle=S(this.Wb.bh);a.fillRect(0,0,b,c);var d=this.a.F.d.a.getContext("2d");a=this.yb*b;var f=this.zb*c,e=this.tc*b,g=this.sc*c,h=this.J.Q();d.clearRect(0,0,b,c);d.strokeStyle=S(this.Wb.nh);for(var k=b-a,l=0;l<h.g;l++){var m=f+l*g;d.beginPath();d.moveTo(a,m);d.lineTo(k,m);d.stroke()}for(var k=c-f,n=0;n<h.f;n++)m=a+n*e,d.beginPath(),d.moveTo(m,f),d.lineTo(m,k),d.stroke();if(h.f===h.g&&(9===h.f||13===h.f||19===h.f)){d.fillStyle=S(this.Wb.kh);l=Math.max(2,this.nf*b/2);n=[];switch(h.f){case 9:n=[[2,2],[2,6],[4,4],[6,2],[6,6]];break;case 13:n=[[3,3],[3,6],[3,9],[6,3],[6,6],[6,9],[9,3],[9,6],[9,9]];break;case 19:n=[[3,3],[3,9],[3,15],[9,3],[9,9],[9,15],[15,3],[15,9],[15,15]]}for(var t=0,p=n.length;t<p;t++)k=a+n[t][0]*e,m=f+n[t][1]*e,d.beginPath(),d.arc(k,m,l,0,2*Math.PI,!1),d.fill()}d=this.a.jc.d.a.getContext("2d");d.clearRect(0,0,b,c);d.strokeStyle=S(this.Wb.xh);d.lineWidth=1;t=S(this.Wb.ah);p=S(this.Wb.Eh);for(l=1;l<=h.g;l++)for(n=1;n<=h.f;n++){k=this.J.M(n,l);if(D===k)d.fillStyle=t;else if(E===k)d.fillStyle=p;else continue;k=a+(n-1)*e;m=f+(l-1)*g;d.beginPath();d.arc(k,m,e/2,0,2*Math.PI,!1);d.fill();d.stroke()}this.a.ga.d.a.getContext("2d").clearRect(0,0,b,c);this.a.gd.d.a.getContext("2d").clearRect(0,0,b,c);this.a.Ga.d.a.getContext("2d").clearRect(0,0,b,c);this.a.Sa.d.a.getContext("2d").clearRect(0,0,b,c)}}else{this.a.K.d.a.getContext("2d").putImageData(this.b.K,0,0);if(!0===this.qc&&this.b.F){b=this.a.K.d.a.getContext("2d");c=this.b.G;g=this.b.A;a=this.J.Q();for(h=0;h<a.f;h++){d=2*this.b.xa/3;f=(d-1)/2;k=this.b.F;e=k[h].f-f;k=this.zb*g/3-f;m=new String;switch(h+1){case 1:m="A";break;case 2:m="B";break;case 3:m="C";break;case 4:m="D";break;case 5:m="E";break;case 6:m="F";break;case 7:m="G";break;case 8:m="H";break;case 9:m="J";break;case 10:m="K";break;case 11:m="L";break;case 12:m="M";break;case 13:m="N";break;case 14:m="O";break;case 15:m="P";break;case 16:m="Q";break;case 17:m="R";break;case 18:m="S";break;case 19:m="T";break;case 20:m="a";break;case 21:m="b";break;case 22:m="c";break;case 23:m="d";break;case 24:m="e";break;case 25:m="f";break;case 26:m="g";break;case 27:m="h";break;case 28:m="j";break;case 29:m="k";break;case 30:m="l";break;case 31:m="m";break;case 32:m="n";break;case 33:m="o";break;case 34:m="p";break;case 35:m="q";break;case 36:m="r";break;case 37:m="s";break;case 38:m="t"}l=2*d/3;n=Ja(m)?"Arial":"Helvetica, Arial, Verdana";n=l+"px "+n;b.fillStyle="rgb(0,0,0)";b.font=n;l=d/2+l/3;d=(d-b.measureText(m).width)/2;b.fillText(m,e+d,k+l);k=g-this.zb*g/3-f;b.fillText(m,e+d,k+l)}for(g=0;g<a.g;g++)d=2*this.b.xa/3,f=(d-1)/2,k=this.b.F,e=this.yb*c/3-f,k=k[g].g-f,m=a.g-g+"",l=2*d/3,n=Ja(m)?"Arial":"Helvetica, Arial, Verdana",n=l+"px "+n,b.fillStyle="rgb(0,0,0)",b.font=n,l=d/2+l/3,d=(d-b.measureText(m).width)/2,b.fillText(m,e+d,k+l),e=c-this.yb*c/3-f,b.fillText(m,e+d,k+l)}Ka(this);b=this.b.G;c=this.b.A;this.a.jc.d.a.getContext("2d").clearRect(0,0,b,c);this.a.ga.d.a.getContext("2d").clearRect(0,0,b,c);this.wf={};La(this);Ma(this)}};r.Kf=function(){var a=this.a.K.d.a.width,b=this.a.K.d.a.height,c=this.a.K.d.a.getContext("2d");if(0!==a&&0!==b){for(var c=c.createImageData(a,b),d=.9,f=this.ib.v,e=this.ib.t,g=this.ib.s,h=Array(a),k=0;k<a;k++)h[k]=(Math.tan(300*k/a)+1)/2+(Math.tan(100*k/a)+1)/10;for(var l=Array(b),m=0;m<b;m++)l[m]=.02*Math.tan(m/b);for(var n,t,m=0;m<b;m++)for(k=0;k<a;k++){d=40*(h[k]+l[m])+.5;d-=Math.floor(d);d=.2>d?1-d/2:.4>d?1-(.4-d)/2:1;if(m==b-1||m==b-2&&k<a-2||k>=a-1||k==a-2&&m<b-1)d/=2;0==m||1==m&&1<k||0==k||1==k&&1<m?(n=128+f*d/2,t=128+e*d/2,d=128+g*d/2):(n=f*d,t=e*d,d*=g);var p=4*(k+m*a);c.data[p+0]=n;c.data[p+1]=t;c.data[p+2]=d;c.data[p+3]=255}this.b.K=c;this.b.G=a;this.b.A=b;this.ua=null}};r.Xd=function(){var a=this.b.G,b=this.b.A;if(0!==a&&0!==b){for(var c=this.yb*a,d=this.zb*b,b=this.sc*b,f=this.tc*a,e=this.J.Q(),g=Array(e.f),h=c,k=d,l=0;l<e.f;l++)h=c+l*f,k=d+l*b,g[l]={f:Math.floor(h+.5),g:Math.floor(k+.5)};this.b.F=g;a=Math.max(2,Math.ceil(this.nf*a/2));c=2*a+1;d=this.b;b=this.zf;f=document.createElement("canvas").getContext("2d").createImageData(c,c);e=a;g=-1;h=e*e;for(l=0;e>g;){g++;k=Math.sqrt(h-g*g);k=Math.ceil(k)-k;k<=l&&e--;var m=Math.floor(255*(1-k)),n=a+e,t=a+e,p=a+g,s=a+g,w=a-e,J=a-e,l=a-g,N=a-g;Na(f,n,s,m,c,b);Na(f,p,t,m,c,b);Na(f,w,s,m,c,b);Na(f,l,t,m,c,b);Na(f,n,N,m,c,b);Na(f,p,J,m,c,b);Na(f,w,N,m,c,b);Na(f,l,J,m,c,b);for(var m=n-1,t=t-1,w=w+1,J=J+1,n=f,z=m,M=c,P=b,aa=w;aa<=z;aa++)Na(n,aa,s,255,M,P);s=f;n=t;z=c;M=b;for(P=J;P<=n;P++)Na(s,p,P,255,z,M);p=f;s=c;for(n=b;w<=m;w++)Na(p,w,N,255,s,n);N=f;w=c;for(m=b;J<=t;J++)Na(N,l,J,255,w,m);l=k}d.Vf=f;this.b.Wf=a}};function Ka(a,b){if(a.b.F){var c=a.b.G,d=a.b.A,f=a.a.F.d.a.getContext("2d"),e=a.J.Q(),g=a.b.F;f.clearRect(0,0,c,d);if(e.f===e.g&&(9===e.f||13===e.f||19===e.f)){var d=a.b.Vf,h=a.b.Wf,k=[];switch(e.f){case 9:k=[[2,2],[2,6],[4,4],[6,2],[6,6]];break;case 13:k=[[3,3],[3,6],[3,9],[6,3],[6,6],[6,9],[9,3],[9,6],[9,9]];break;case 19:k=[[3,3],[3,9],[3,15],[9,3],[9,9],[9,15],[15,3],[15,9],[15,15]]}for(var l=0,m=k.length;l<m;l++)f.putImageData(d,g[k[l][0]].f-h,g[k[l][1]].g-h)}for(var h=g[0].f,k=g[g.length-1].f,l=g[0].g,m=g[g.length-1].g,n=f.createImageData(1,m-l),t=f.createImageData(k-h,1),p=a.zf,s=0;s<m-l;s++)d=4*s,n.data[d+0]=p.v,n.data[d+1]=p.t,n.data[d+2]=p.s,n.data[d+3]=p.gf;for(s=0;s<k-h;s++)d=4*s,t.data[d+0]=p.v,t.data[d+1]=p.t,t.data[d+2]=p.s,t.data[d+3]=p.gf;for(s=0;s<e.f;s++)f.putImageData(n,g[s].f,g[0].g),f.putImageData(t,g[0].f,g[s].g);if(void 0!==b)for(c=(2*Math.floor(parseInt(a.sc*c)/2)+1-1)/2,e=g[1].f-g[0].f+2,h=g[1].g-g[0].g+2,d=0;d<b.length;d++)k=b[d].f,l=b[d].g,G===a.J.M(k,l)&&f.clearRect(g[k-1].f-c,g[l-1].g-c,e,h)}}function Na(a,b,c,d,f,e){b=4*(b+c*f);a.data[b+0]=e.v;a.data[b+1]=e.t;a.data[b+2]=e.s;a.data[b+3]=d}function La(a){for(var b=a.J.Q(),c=1;c<=b.g;c++)for(var d=1;d<=b.f;d++)ya(a,d,c,a.J.M(d,c))}r.Jf=function(){if(this.b.F){var a=this.a.ga.d.a.getContext("2d"),b=this.b.xa;this.b.ga=a.createImageData(b,b);a=this.b.ga.data;this.b.eb=Math.max(parseInt(.15*b),3);for(var c=(b-5)/2+1,d=0;d<b;d++)for(var f=0;f<b;f++){var e=Math.abs(d-c),g=Math.abs(f-c),e=Math.sqrt(g*g+e*e)/c,e=1>e?.15+.75*(1-e):0,g=4*(b*d+f);a[g+0]=0;a[g+1]=0;a[g+2]=0;a[g+3]=parseInt(255*e)}}};r.mb=function(){ea(this,this.Na.f,this.Na.g,!0)};function ea(a,b,c,d){var f=x;if(-1===b||-1===c||0===b||0===c)fa(a);else if(null===a.ua&&null!==a.b.F&&(void 0===d&&(d=!1),b!==a.Na.f||c!==a.Na.g||!0===d)){a.Na.f=b;a.Na.g=c;var e=a.b.G,g=a.b.A;d=a.a.Sa.d.a.getContext("2d");d.clearRect(0,0,e,g);var g=(a.b.xa-1)/2,h=a.b.F,e=h[b-1].f-g,g=h[c-1].g-g;b=a.J.M(b,c);switch(a.La){case 0:G===b&&(D===a.c.gb?d.putImageData(a.b.Mc,e,g):d.putImageData(a.b.jd,e,g));break;case 1:D===b?d.putImageData(a.b.nc,e,g):E===b&&d.putImageData(a.b.mc,e,g);break;case 2:D===b?d.putImageData(a.b.nc,e,g):E===b?d.putImageData(a.b.mc,e,g):f.ha?d.putImageData(a.b.jd,e,g):d.putImageData(a.b.Mc,e,g);break;default:D===b?d.putImageData(a.b.nc,e,g):d.putImageData(a.b.mc,e,g)}}}function fa(a){var b=a.b.G,c=a.b.A;a.a.Sa.d.a.getContext("2d").clearRect(0,0,b,c);a.Na.f=-1;a.Na.g=-1}function da(a,b,c){var d=a.b.G,f=a.b.A,e=a.yb*d,g=a.zb*f,f=a.sc*f,d=a.tc*d,h=0;a=a.J.Q();for(h=0;h<a.g-1&&c>g+f*h+f/2;h++);for(c=c=0;c<a.f-1&&b>e+d*c+d/2;c++);return{f:c+1,g:h+1}}function ua(a,b,c,d,f){a=a.a.Ga.d.a.getContext("2d");a.clearRect(0,0,b,c);a.strokeStyle=S(f);a.fillStyle=S(f);a.lineWidth=d;a.beginPath();a.moveTo(1*b/4,1*c/4);a.lineTo(3*b/4,3*c/4);a.moveTo(3*b/4,1*c/4);a.lineTo(1*b/4,3*c/4);a.stroke();return a.getImageData(0,0,b,c)}r.aa=function(a,b,c,d,f){void 0===f&&(f=1);var e=this.a.Ga.d.a.getContext("2d");e.clearRect(0,0,a,b);e.globalAlpha=f;e.strokeStyle=S(d);e.fillStyle=S(d);e.lineWidth=c;var g=a/2;c=3*b/4;d=.1*a;f=Math.sqrt(g*g-(c-g)*(c-g))+g;g=-Math.sqrt(g*g-(c-g)*(c-g))+g;e.beginPath();e.moveTo(a/2,d);e.lineTo(f-d,c);e.lineTo(g+d,c);e.closePath();e.stroke();return e.getImageData(0,0,a,b)};function va(a,b,c,d,f){a=a.a.Ga.d.a.getContext("2d");a.clearRect(0,0,b,c);a.strokeStyle=S(f);a.fillStyle=S(f);a.lineWidth=Math.floor(d+.5);var e=b/2,g=-c/2*Math.sqrt(2)/2+c/2;f=Math.floor(Math.sqrt(e*e-(g-e)*(g-e))+e-d);e=Math.ceil(-Math.sqrt(e*e-(g-e)*(g-e))+e+d);g=Math.ceil(g+d);d=Math.floor(c/2*Math.sqrt(2)/2+c/2-d);a.beginPath();a.moveTo(f,g);a.lineTo(e,g);a.lineTo(e,d);a.lineTo(f,d);a.closePath();a.stroke();return a.getImageData(0,0,b,c)}function wa(a,b,c,d){a=a.a.Ga.d.a.getContext("2d").createImageData(b,c);for(var f=0;f<c;f++)for(var e=0;e<b;e++){var g=4*(f*b+e);f>=c/3&&f<=2*c/3&&e>=b/3&&e<=2*b/3?(a.data[g+0]=d.v,a.data[g+1]=d.t,a.data[g+2]=d.s,a.data[g+3]=255):a.data[g+3]=0}return a}function xa(a,b,c,d,f){a=a.a.Ga.d.a.getContext("2d");a.clearRect(0,0,b,c);var e=b/2,g=4*d;a.strokeStyle=S(f);a.fillStyle=S(f);a.lineWidth=d;a.beginPath();a.arc(b/2,c/2,e-g,0,2*Math.PI,!1);a.stroke();return a.getImageData(0,0,b,c)}function Oa(a,b,c){a=a.ia[""+((c<<8)+b)];return void 0!==a?a:null}function Aa(a,b,c,d){za===d.u?Pa(a,b,c):a.ia[""+((c<<8)+b)]=d}function Pa(a,b,c){if(0>=b||0>=c)a.yd=0;else{var d=(c<<8)+b;void 0===a.ia[""+d]&&(a.ia[""+d]=new F(b,c,za,""));a.yd=d}}function Ma(a){a.a.Ga.d.a.getContext("2d").clearRect(0,0,a.b.G,a.b.A);var b=[],c;for(c in a.ia){var d=a.ia[c];Qa(a,d);Ra===d.u&&b.push({f:d.bc(),g:d.cc()})}Ka(a,b)}function Qa(a,b){if(a.b.F){var c=b.bc(),d=b.cc(),f=b.u,e=a.a.Ga.d.a.getContext("2d"),g=a.b.xa,h=(g-1)/2,k=a.b.F,l=k[c-1].f-h,h=k[d-1].g-h,c=a.J.M(c,d);switch(f){case Sa:e.putImageData(a.b.ng,l,h);break;case Ta:e.putImageData(a.b.og,l,h);break;case za:e.putImageData(a.b.ag,l,h);break;case Ua:e.putImageData(c===D?a.b.Tf:a.b.Sf,l,h);break;case Va:e.putImageData(c===D?a.b.lg:a.b.kg,l,h);break;case Wa:e.putImageData(c===D?a.b.sg:a.b.rg,l,h);break;case Xa:e.putImageData(c===D?a.b.nc:a.b.mc,l,h);break;case Ra:f=b.Sd,d=2>=f.length?2*g/3:g/2,k=d+"px "+(Ja(f)?"Arial":"Helvetica, Arial, Verdana"),e.fillStyle=c===D?"rgb(255,255,255)":"rgb(0,0,0)",e.font=k,e.fillText(f,l+(g-e.measureText(f).width)/2,h+(g/2+d/3))}}}r.Lf=function(a,b,c){switch(this.La){case 0:if(Ya==c.Pf)1<=this.c.vc&&(la(this.c,1),Za(this,a,b));else if(c.ha&&c.qa)this.c.ic(D===this.c.gb?E:D),this.mb();else if(!0===c.qa){var d=new String;switch(a){case 1:d="A";break;case 2:d="B";break;case 3:d="C";break;case 4:d="D";break;case 5:d="E";break;case 6:d="F";break;case 7:d="G";break;case 8:d="H";break;case 9:d="J";break;case 10:d="K";break;case 11:d="L";break;case 12:d="M";break;case 13:d="N";break;case 14:d="O";break;case 15:d="P";break;case 16:d="Q";break;case 17:d="R";break;case 18:d="S";break;case 19:d="T"}this.c.Jc(d+b)}else if(c.ha){d=this.c;d.ja&&d.ja.vh(!0);var f=d.i;ka(d);for(c=0;1E3>c&&G===d.Y.M(a,b);)oa(d,1),c++;G===d.Y.M(a,b)&&y(d,f);d.ja&&d.ja.vh(!1)}else Za(this,a,b),null!==this.Fb&&$a(this.c.i)>=ab(this.Fb)&&bb(this.Fb);break;case 1:if(!0===c.qa)B(this,0);else{d=this.J;f=d.M(a,b);if(G!==f)if(d.wd.ba(),c=d.Ta[Ca(d,a,b)],D!==c&&E!==c){d.S.ba();cb(d,a,b,f);for(var e in d.wd.za)c=T(e|0),d.S.ba(),db(d,c.f,c.g,3-f),eb(d.S,d,3);Da(d,!0);d.S.ba();cb(d,a,b,f);eb(d.S,d,3-f)}else d.S.ba(),cb(d,a,b,f),eb(d.S,d,3),Da(d,!0);this.c.Pc()}break;case 2:!0===this.c.i.Nb()&&!0===fb(this.c,!0,!0)&&gb(this.c);d=D;G!==this.J.M(a,b)?d=G:c.ha&&(d=E);ya(this,a,b,d);this.J.V(a,b,d,-1);this.c.Ic(d,[(b<<8)+a]);break;case 3:hb(this,Wa,a,b);break;case 4:hb(this,Va,a,b);break;case 5:hb(this,Ua,a,b);break;case 6:hb(this,Xa,a,b);break;case 7:a:{f=Oa(this,a,b);if(null!==f&&Ra===f.u)this.c.Ra([(b<<8)+a]),this.Ra(a,b);else{f="";c.ha&&(f=prompt("Enter the label that you want to add to board here. For best results, keep your label to one or two letters.",""));if(void 0==f||""===f||null===f){f=[];c=-1;for(d in this.ia)if(e=this.ia[d],Ra==e.u){e=e.Sd;var g=e.charCodeAt(0);1==e.length&&65<=g&&90>=g&&(f[g]=1)}for(d=65;90>=d;d++)if(void 0===f[d]||""==f[d]){c=d;break}f=-1==c?null:String.fromCharCode(c);if(null===f){alert("Sorry, all the standard labels are used up! To add more labels, you will have to shift click on the board and make up ur own labels to add.");break a}}d=new F(a,b,Ra,f);this.c.Yb(f,(b<<8)+a);Aa(this,a,b,d)}Ma(this)}break;case 8:a:{d=Oa(this,a,b);if(null!==d&&Ra===d.u)this.c.Ra([(b<<8)+a]),this.Ra(a,b);else{d="";if(c.ha){d=this.J.ye(a,b);if(-1==d){alert("Sorry, no move has been made at that location, so you can't mark it with the move number!");break a}d=""+d}if(void 0===d||""===d||null===d){d=[];c=0;for(f in this.ia)e=this.ia[f],Ra===e.u&&Ja(e.Sd)&&(d[c]=parseInt(e.Sd),c++);if(0>=c)d="1";else{d.sort(ib);e=f=0;for(var g=!1,h=0;h<c;h++){if(d[h]>f+1){e=f+1;g=!0;break}f=d[h]}g||(e=f+1);d=""+e}}f=new F(a,b,Ra,d);this.c.Yb(d,(b<<8)+a);Aa(this,a,b,f)}Ma(this)}}};function hb(a,b,c,d){var f=Oa(a,c,d);if(null!==f&&b===f.u){if(a.c.Ra([(d<<8)+c]),a.Ra(c,d),a.b.F){b=(a.b.xa-1)/2;var e=a.b.F,f=e[c-1].f-b,e=e[d-1].g-b;a.a.Ga.d.a.getContext("2d").clearRect(f,e,2*b,2*b);b=T(a.yd);c===b.f&&d===b.g&&(Pa(a,c,d),Qa(a,Oa(a,c,d)))}}else f=new F(c,d,b,""),a.c.pa(b,[(d<<8)+c]),Aa(a,c,d,f),Qa(a,f)}function Za(a,b,c){if(G===a.J.M(b,c)){var d=D===a.c.gb?D:E,f=!1,e=new jb,f=a.J.Eb;e.da=f.da;e.Cb=f.Cb;a.J.V(b,c,d,-1);f=null!==kb(a.J,b,c,d,!0)?!0:null!==lb(a.J,b,c,d)?!1:!0;a.J.V(b,c,G,-1);var g=a.J.Eb;g.da=e.da;g.Cb=e.Cb;if(1==f){a:{for(var e=a.c,h=(c<<8)+b,f=0,k=A(e.i);f<k;f++){var g=e.i.N(f),l=g.Oa,m=l.u;if(h===l.la()&&d===m&&(D===d||E===d)){b=e.i.T;mb(e.i,f);e.i=g;e.vc++;e.I&&b!==f&&ja(e.I);b=!0;break a}}e.p&1?(fb(e,!1,!0),e.i.Ib(b,c,d),e.I&&(e.I.$a(),ja(e.I)),G!==e.Ac&&""!==e.Ef&&e.i.bd(e.Ef),b=!0):b=!1}!0===b&&gb(a.c)}}};function nb(a){this.j=a;this.c=null;this.X=this.u=0;this.zc=16;this.mf=!1;this.b={Uf:null,fg:null,Zf:null,Of:null,jg:null};this.a={d:null,Oc:{d:null}};this.Af=new v(217,217,217,255);this.Bd=new v(0,0,0,255);this.xd=new v(54,101,179,255);this.Dc=new v(255,255,255,255);this.uf=new v(54,101,179,255);this.vd=new v(255,255,255,255);this.xf=new v(217,217,217,255);this.yf=new v(140,140,140,255);this.R=this.H=0;var b=this;this.Ec=function(a){b.Yd();4!==b.X&&(ga(a),b.X=1,ob(b),a.stopImmediatePropagation())};this.ki=function(a){4!==b.X&&x.ca===a.target&&(b.X=2,ob(b),b.Lf(),a.stopImmediatePropagation())};this.hi=function(){4!==b.X&&(1!==b.X&&(b.X=2),ob(b))};this.Fc=function(){4!==b.X&&(b.X=b.mf?8:0,ob(b))};this.Yd=function(){b.c&&20!==b.u&&b.c.ra()};this.Mf=function(a){a.dataTransfer.effectAllowed="all";a.dataTransfer.setData("text/sgf","(;SZ[19];)")}}r=nb.prototype;r.B=function(a,b,c){this.c=b;this.u=c;if(this.j)switch(this.u){case 1:this.j.o.ce.push(this);break;case 2:this.j.o.de.push(this);break;case 3:this.j.o.Za.push(this);break;case 4:this.j.o.ab.push(this);break;case 5:this.j.o.xe.push(this);break;case 6:this.j.o.we.push(this);break;case 7:this.j.o.sb.push(this);break;case 8:this.j.o.tb.push(this);break;case 9:this.j.o.he.push(this);break;case 10:this.j.o.je.push(this);break;case 11:this.j.o.ge.push(this);break;case 12:this.j.o.me.push(this);break;case 13:this.j.o.ke.push(this);break;case 14:this.j.o.fe.push(this);break;case 15:this.j.o.ne.push(this);break;case 16:this.j.o.le.push(this);break;case 17:this.j.o.ie.push(this);break;case 18:this.j.Bc=this}this.a.d=C(a);b=this.a.d.a;b.setAttribute("title",pb(this));c=document.createElement("canvas");c.setAttribute("id",a+"_canvas");c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("oncontextmenu","return false;");b.appendChild(c);this.a.Oc.d=C(a+"_canvas");a=this.a.Oc.d;K(a.h,0,0,1E3,1E3,!1,!1,!1,!1,-1,-1);a.l=L|O|Q|R;this.a.d.k(a);b.onmousedown=this.Ec;b.onmouseup=this.ki;b.onmouseover=this.hi;b.onmouseout=this.Fc;b.onfocus=this.Yd;b.tabIndex=-1;b.style.outline="none";b.draggable="true";b.ti=this.Mf;this.q()};r.q=function(){var a=this.a.d.a.clientWidth,b=this.a.d.a.clientHeight;if(a!==this.H||b!==this.R)this.H=a,this.R=b,this.a.d.sa(this.H,this.R),this.Ca()};function qb(a,b){!0===b&&4===a.X?(a.X=0,ob(a)):!1===b&&4!==a.X&&(a.X=4,ob(a))}function rb(a,b){a.zc!==b&&(a.zc=b,a.Ca(),a.a.d.a.setAttribute("title",pb(a)))}function sb(a,b){a.mf!==b&&(a.mf=b,!0===b&&0===a.X?(a.X=8,ob(a)):!1===b&&8===a.X&&(a.X=0,ob(a)))}r.Ca=function(){var a=this.R,b=this.H;0!==b&&0!==a&&(this.b.Of=tb(this,this.uf,this.vd,b,a),this.b.Zf=tb(this,this.xd,this.Dc,b,a),this.b.fg=tb(this,this.Af,this.Bd,b,a),this.b.Uf=tb(this,this.xf,this.yf,b,a),this.b.jg=tb(this,this.xd,this.Dc,b,a),ob(this))};function tb(a,b,c,d,f){var e=a.a.Oc.d.a.getContext("2d");e.fillStyle=S(b);e.fillStyle=S(b);e.fillRect(0,0,d,f);e.fillStyle=S(c);e.strokeStyle=S(c);var g=Math.min(d,f),h=(d-g)/2,k=(f-g)/2;switch(a.u){case 1:a.aa(g,h,k,e,-1);a=Math.ceil(h+g/10+.5);h=Math.ceil(k+g/5+.5);b=Math.floor(g/10+.5);var l=Math.floor(3*g/5+.5);e.fillRect(a,h,b,l);break;case 2:a.aa(g,h-g/10,k,e,-1);a=Math.ceil(h+8*g/10+.5);h=Math.ceil(k+g/5+.5);b=Math.floor(g/10+.5);l=Math.floor(3*g/5+.5);e.fillRect(a,h,b,l);break;case 3:a.aa(g,h-g/10,k,e,-1);break;case 4:a.aa(g,h-g/10,k,e,1);break;case 5:a.aa(g,h+g/10,k,e,1);a=Math.ceil(h+g/10+.5);h=Math.ceil(k+g/5+.5);b=Math.floor(g/10+.5);l=Math.floor(3*g/5+.5);e.fillRect(a,h,b,l);break;case 6:a.aa(g,h,k,e,1);a=Math.ceil(h+8*g/10+.5);h=Math.ceil(k+g/5+.5);b=Math.floor(g/10+.5);l=Math.floor(3*g/5+.5);e.fillRect(a,h,b,l);break;case 7:b=Math.ceil(h+.2*g+.5);a=Math.ceil(h+.35*g+.5);var l=Math.ceil(h+.57*g+.5),h=Math.ceil(h+.92*g+.5),m=Math.ceil(k+.2*g+.5),n=Math.ceil(k+.38*g+.5);c=Math.ceil(k+.52*g+.5);var t=Math.ceil(k+.6*g+.5),p=Math.ceil(k+.68*g+.5),k=Math.ceil(k+.84*g+.5);e.beginPath();e.moveTo(b,m);e.lineTo(a,m);e.lineTo(a,c);e.lineTo(l,c);e.lineTo(l,n);e.lineTo(h,t);e.lineTo(l,k);e.lineTo(l,p);e.lineTo(b,p);e.closePath();e.fill();break;case 8:b=Math.ceil(h+.2*g+.5);a=Math.ceil(h+.35*g+.5);l=Math.ceil(h+.57*g+.5);h=Math.ceil(h+.92*g+.5);m=Math.ceil(k+.8*g+.5);n=Math.ceil(k+.62*g+.5);c=Math.ceil(k+.48*g+.5);t=Math.ceil(k+.4*g+.5);p=Math.ceil(k+(1-.68)*g+.5);k=Math.ceil(k+(1-.84)*g+.5);e.beginPath();e.moveTo(b,m);e.lineTo(a,m);e.lineTo(a,c);e.lineTo(l,c);e.lineTo(l,n);e.lineTo(h,t);e.lineTo(l,k);e.lineTo(l,p);e.lineTo(b,p);e.closePath();e.fill();break;case 9:a=Math.ceil(h+.5*g-g/10+.5);n=Math.ceil(k+.5*g-g/10+.5);b=Math.ceil(.25*g+.5);e.fillStyle=S(new v(255,255,255));e.strokeStyle=S(new v(0,0,0));e.beginPath();e.arc(a,n,b,0,2*Math.PI,!1);e.fill();e.stroke();e.fillStyle=S(new v(0,0,0));a=Math.ceil(h+.5*g+g/10+.5);n=Math.ceil(k+.5*g+g/10+.5);b=Math.ceil(.25*g+.5);e.beginPath();e.arc(a,n,b,0,2*Math.PI,!1);e.fill();break;case 10:l=e.createImageData(g,g);a=g/5|0;n=4*g/5|0;for(c=0;c<g;c++)for(t=0;t<g;t++)m=4*(c*g+t),c>=a&&c<=n&&t>=a&&t<=n?g-c>=t||c===a||c===n||t===a||t===n?(l.data[m+0]=0,l.data[m+1]=0,l.data[m+2]=0):(l.data[m+0]=255,l.data[m+1]=255,l.data[m+2]=255):(l.data[m+0]=b.v,l.data[m+1]=b.t,l.data[m+2]=b.s),l.data[m+3]=255;e.putImageData(l,h,k);break;case 11:a=Math.ceil(h+.75*g+.5);n=Math.ceil(k+.125*g+.5);b=Math.ceil(.25*g+.5);l=Math.ceil(.02*g+.5);e.fillRect(a,n,b,l);a=Math.ceil(h+.875*g+.5);n=Math.ceil(k+.5);b=Math.ceil(.02*g+.5);l=Math.ceil(.25*g+.5);e.fillRect(a,n,b,l);a=Math.ceil(h+.5);n=Math.ceil(k+.875*g+.5);b=Math.ceil(.25*g+.5);l=Math.ceil(.02*g+.5);e.fillRect(a,n,b,l);a=Math.ceil(h+.5*g-g/10+.5);n=Math.ceil(k+.5*g-g/10+.5);b=Math.ceil(.25*g+.5);e.fillStyle=S(new v(255,255,255));e.strokeStyle=S(new v(0,0,0));e.beginPath();e.arc(a,n,b,0,2*Math.PI,!1);e.fill();e.stroke();e.fillStyle=S(new v(0,0,0));a=Math.ceil(h+.5*g+g/10+.5);n=Math.ceil(k+.5*g+g/10+.5);b=Math.ceil(.25*g+.5);e.beginPath();e.arc(a,n,b,0,2*Math.PI,!1);e.fill();break;case 12:b=g/2;l=3*g/4;a=.1*g;n=Math.sqrt(b*b-(l-b)*(l-b))+b;c=-Math.sqrt(b*b-(l-b)*(l-b))+b;e.lineWidth=Math.ceil(.05*g+.5);e.beginPath();e.moveTo(h+g/2,k+2*a);e.lineTo(h+n-a,k+l+a);e.lineTo(h+c+a,k+l+a);e.closePath();e.stroke();break;case 13:b=g/2;a=.05*g;m=-g/2*Math.sqrt(2)/2+g/2;l=g/2*Math.sqrt(2)/2+g/2;n=Math.sqrt(b*b-(m-b)*(m-b))+b;c=-Math.sqrt(b*b-(m-b)*(m-b))+b;b=Math.floor(h+n-a);h=Math.ceil(h+c+a);m=Math.ceil(k+m+a);k=Math.floor(k+l-a);e.lineWidth=Math.ceil(.05*g+.5);e.beginPath();e.moveTo(b,m);e.lineTo(h,m);e.lineTo(h,k);e.lineTo(b,k);e.closePath();e.stroke();break;case 14:l=.05*g;b=g/2;a=4*l;e.lineWidth=Math.ceil(l+.5);e.beginPath();e.arc(h+g/2,k+g/2,b-a,0,2*Math.PI,!1);e.stroke();break;case 15:b=h+.25*g;a=h+.75*g;m=k+.25*g;n=k+.75*g;e.lineWidth=Math.ceil(.05*g+.5);e.beginPath();e.moveTo(b,m);e.lineTo(a,n);e.moveTo(a,m);e.lineTo(b,n);e.stroke();break;case 16:b="A";l=.8*g;e.font=l+"px Arial";a=h+(g-e.measureText(b).width)/2;e.fillText(b,a,k+g/2+l/3);break;case 17:b="1";l=.8*g;e.font=l+"px Helvetica, Arial, Verdana";a=h+(g-e.measureText(b).width)/2;e.fillText(b,a,k+g/2+l/3);break;case 18:16===a.zc?a.aa(g,h,k,e,1):(b=Math.floor(h+g/5+g/20+.5),a=Math.ceil(h+4*g/5-g/20+.5),h=Math.ceil(k+g/5+.5),k=Math.ceil(k+4*g/5+.5),l=Math.ceil(b+g/5),g=Math.floor(a-g/5),e.beginPath(),e.moveTo(b,h),e.lineTo(l,h),e.lineTo(l,k),e.lineTo(b,k),e.closePath(),e.fill(),e.beginPath(),e.moveTo(a,h),e.lineTo(g,h),e.lineTo(g,k),e.lineTo(a,k),e.closePath(),e.fill());break;case 19:l=e.createImageData(d,f);e=l.data;h=(d-8)/2|0;k=(f-8)/2|0;for(n=0;n<f;n++)for(a=0;a<d;a++){m=4*(a+n*d);b=c.v;var g=c.t,t=c.s,p=n-k,s=a-h;if(0===p&&(0===s||1===s||6===s||7===s)||1===p&&(1===s||2===s||5===s||6===s)||2===p&&(2===s||3===s||4===s||5===s)||3===p&&(3===s||4===s)||4===p&&(3===s||4===s)||5===p&&(2===s||3===s||4===s||5===s)||6===p&&(1===s||2===s||5===s||6===s)||7===p&&(0===s||1===s||6===s||7===s))t=g=b=255;e[m+0]=b;e[m+1]=g;e[m+2]=t;e[m+3]=255}return l;case 20:l=.02*g;b=g/2;a=4*l;e.lineWidth=Math.ceil(l+.5);e.beginPath();e.arc(h+g/2,k+g/2,b-a,0,2*Math.PI,!1);e.stroke();b="i";l=.9*g;e.font=l+"px Times New Roman, Sans serif";a=h+(g-e.measureText(b).width)/2;e.fillText(b,a,k+g/2+l/3);break;case 21:e.lineWidth=1;e.moveTo(0,0);e.lineTo(0,f);e.lineTo(d,f);e.lineTo(d,0);e.lineTo(0,0);e.stroke();b="OK";l=.6*g;e.fillStyle=S(new v(0,0,0,255));e.font=l+"px Tahoma, Sans serif";a=h+(g-e.measureText(b).width)/2;e.fillText(b,a,k+g/2+l/3);break;case 22:e.lineWidth=1,e.moveTo(0,0),e.lineTo(0,f),e.lineTo(d,f),e.lineTo(d,0),e.lineTo(0,0),e.stroke(),b="Cancel",l=.6*g,e.fillStyle=S(new v(0,0,0,255)),e.font=l+"px Tahoma, Sans serif",a=h+(g-e.measureText(b).width)/2,e.fillText(b,a,k+g/2+l/3)}return e.getImageData(0,0,d,f)}r.aa=function(a,b,c,d,f){var e=Math.ceil(b+a/5+.5);b=Math.ceil(b+4*a/5+.5);var g=Math.ceil(c+a/5+.5),h=Math.ceil(c+a/2+.5);a=Math.ceil(c+4*a/5+.5);0>f?(d.beginPath(),d.moveTo(e,h),d.lineTo(b,g),d.lineTo(b,a)):(d.beginPath(),d.moveTo(e,g),d.lineTo(b,h),d.lineTo(e,a));d.closePath();d.fill()};function ob(a){var b=a.a.Oc.d.a.getContext("2d"),c=null;switch(a.X){case 2:c=a.b.Zf;break;case 1:c=a.b.Of;break;case 4:c=a.b.Uf;break;case 8:c=a.b.jg;break;default:case 0:c=a.b.fg}c&&b.putImageData(c,0,0)}r.Lf=function(){if(this.c)switch(this.u){case 1:ka(this.c);break;case 2:la(this.c,5);break;case 3:la(this.c,1);break;case 4:oa(this.c,1);break;case 5:oa(this.c,5);break;case 6:for(var a=this.c;na(a););y(a,a.i);break;case 7:pa(this.c);break;case 8:ma(this.c);break;case 9:B(this.c.n,0);break;case 10:B(this.c.n,1);break;case 11:B(this.c.n,2);break;case 12:B(this.c.n,3);break;case 13:B(this.c.n,4);break;case 14:B(this.c.n,5);break;case 15:B(this.c.n,6);break;case 16:B(this.c.n,7);break;case 17:B(this.c.n,8);break;case 18:16===this.zc?ub(this.c):vb(this.c);break;case 19:wb(this.c);break;case 20:var a=this.a.d.a.id+"GameInfo",b=document.getElementById(a);if(b)b.style.left="100px",b.style.top="100px";else{b=document.createElement("div");b.setAttribute("id",a);b.setAttribute("style","position:absolute;padding:0;margin:0;width:500px;height: 500px; left : 100px; top:100px;");b.setAttribute("oncontextmenu","return false;");var c=document.getElementsByTagName("body");0<c.length&&(c[0].appendChild(b),(new xb).B(a,this.c))}break;case 21:this.c&&(a=this.c,a.c&&(a.c.Id=a.r.jh.value,a.c.Qd=a.r.rh.value,a.c.Rd=a.r.th.value,a.c.wc=parseFloat(a.r.mh.value),a.c.qd=a.r.lh.value,a.c.td=a.r.yh.value,yb(a.c,a.r.Zg.value),zb(a.c,a.r.$g.value),Ab(a.c,a.r.Bh.value),Bb(a.c,a.r.Ch.value),a.c.Cd=a.r.eh.value,a.c.Hd=a.r.Qc.value,a.c.Dd=a.r.Date.value,a.c.Fd=a.r.Event.value,a.c.Kd=a.r.sh.value,a.c.Jd=a.r.oh.value,a.c.Ed=a.r.Yg.value,a.c.Gd=a.r.ih.value,a.c.Ld=a.r.wh.value,a.c.Md=a.r.zh.value),wb(a));break;case 22:this.c&&wb(this.c)}};function pb(a){switch(a.u){case 1:return"Back to the start";case 2:return"Back 5 moves";case 3:return"Back";case 4:return"Forward";case 5:return"Forward 5 moves";case 6:return"Go to the end";case 7:return"Next variant";case 8:return"Previous variant";case 9:return"Moves (F1)";case 10:return"Count Scores (F2)";case 11:return"Editor (F3)";case 12:return"Triangles (F4)";case 13:return"Squares (F5)";case 14:return"Circles (F6)";case 15:return"X marks (F7)";case 16:return"Text labels (F8)";case 17:return"Numeric labels (F9)";case 18:return 16===a.zc?"Autoplay start":"Autoplay stop";case 19:return"Close";case 20:return"Game info";case 22:return"Cancel";case 21:return"OK"}};function Cb(a){this.j=a;this.c=null;this.a={d:null,ed:{d:null}};var b=this;this.Vg=function(){b.c.bd(b.a.ed.d.a.value)}}Cb.prototype.B=function(a,b){this.c=b;this.a.d=C(a);var c=this.a.d.a;c.style.background=S(new v(217,217,217,255));var d=a+"_TextArea",f=document.createElement("textarea");f.setAttribute("id",d);f.setAttribute("style","position:absolute;padding:0;margin:0;resize:none;outline: none;-moz-appearance: none;padding:2px;");c.appendChild(f);f.onchange=this.Vg;f.onblur=this.Vg;f.style.outline="none";f.style.margin="0px";f.style.border="1px solid rgb(172,172,172)";c=this.a.d;this.a.ed.d=C(d);d=this.a.ed.d;K(d.h,6,0,12,6,!0,!0,!0,!0,-1,-1);d.l=L|O|Q|R;c.k(d);this.j&&this.j.hf.push(this);this.q()};Cb.prototype.fd=function(a){this.a.ed.d.a.value=a};Cb.prototype.q=function(){this.a.d.sa(this.a.d.a.clientWidth,this.a.d.a.clientHeight)};function Db(a){this.j=a;this.Ng=G;this.c=null;this.a={d:null,Uc:null,Zc:null,Image:null};this.Pd=this.Nd="";this.of=0;this.lf=!1}Db.prototype.B=function(a,b,c){this.Ng=c;this.c=b;this.a.d=C(a);b=this.a.d.a;b.style.backgroundColor=S(new v(217,217,217,255));this.a.Uc=document.createElement("div");this.a.Zc=document.createElement("div");this.a.Image=document.createElement("canvas");var d=this.a.Image,f=this.a.Uc,e=this.a.Zc;b.appendChild(d);b.appendChild(f);b.appendChild(e);f.style.paddingLeft="25px";e.style.paddingLeft="25px";f.style.fontSize="14pt";e.style.paddingLeft="10pt";d.setAttribute("id",a+"_Image");d.setAttribute("style","position:absolute;padding:0;margin:0;");d.setAttribute("oncontextmenu","return false;");d.style.left="0px";d.style.top="0px";d.style.width="25px";d.style.height="25px";d.width=25;d.height=25;a=d.getContext("2d");a.clearRect(0,0,25,25);b=Math.ceil(13);d=Math.ceil(13);f=Math.ceil(6.75);E===c?(a.fillStyle=S(new v(255,255,255)),a.strokeStyle=S(new v(0,0,0))):D===c&&(a.fillStyle=S(new v(0,0,0)),a.strokeStyle=S(new v(0,0,0)));a.beginPath();a.arc(b,d,f,0,2*Math.PI,!1);a.fill();a.stroke();this.j&&(D===c?this.j.Wa=this:E===c&&(this.j.Xa=this));Eb(this)};Db.prototype.q=function(){Eb(this);var a=this.Hh,b=this.a.d.a.clientWidth-25,c=0,c=b<a?0:(b-a)/2;this.a.Image.style.left=c+"px";c+=25;this.a.Uc.style.paddingLeft=c+"px";this.a.Zc.style.paddingLeft=c+"px"};Db.prototype.kc=function(a){this.lf=!1;this.of=a;Eb(this)};Db.prototype.lc=function(a){this.lf=!0;this.of=a;Eb(this)};function Eb(a){var b=a.a.Uc,c=a.a.Zc,d=(""===a.Nd?D===a.Ng?"Black ":"White ":a.Nd)+(""===a.Pd?"":"["+a.Pd+"]"),f=(!0===a.lf?"Scores ":"Captured ")+a.of;b.innerText=d;b.innerHTML=d;c.innerText=f;c.innerHTML=f;b=document.createElement("canvas").getContext("2d");b.font="14pt Times New Roman";a.Hh=b.measureText(d).width};function Fb(){this.Da=this.Ha=this.Ja=this.Fa=0;this.kd=this.md=this.nd=this.ld=!1;this.Xb=this.nb=-1}function K(a,b,c,d,f,e,g,h,k,l,m){a.Fa=b;a.Ja=c;a.Ha=d;a.Da=f;a.ld=e;a.nd=g;a.md=h;a.kd=k;a.nb=l;a.Xb=m}var O=1,L=2,R=4,Q=8;function Gb(){this.h=new Fb;this.l=O|L;this.a=this.Xc=this.dg=null;this.Ya=new Fb;this.$=[];this.Qb=0}Gb.prototype.Ia=function(a){this.Qb=a};Gb.prototype.k=function(a){a.Xc=this;this.$[this.$.length]=a};Gb.prototype.sa=function(a,b){if(null==this.Xc)this.Ya.Fa=0,this.Ya.Ja=0,this.Ya.Ha=a,this.Ya.Da=b,null!==this.a&&Hb(this,a,b);else{var c=0,d=0,f=0,e=0,c=this.l&5,d=this.l&10;O==c?(c=this.h.ld?this.h.Fa:this.h.Fa*a/1E3,f=-1!=this.h.nb?c+this.h.nb:this.h.md?a-this.h.Ha:this.h.Ha*a/1E3):R==c?(f=this.h.md?a-this.h.Ha:this.h.Ha*a/1E3,c=-1!=this.h.nb?f-this.h.nb:this.h.ld?this.h.Fa:this.h.Fa*a/1E3):(O|R)==c?(c=this.h.ld?this.h.Fa:this.h.Fa*a/1E3,f=this.h.md?a-this.h.Ha:this.h.Ha*a/1E3):(c=this.h.Fa,f=this.h.Ha);L==d?(d=this.h.nd?this.h.Ja:this.h.Ja*b/1E3,e=-1!=this.h.Xb?d+this.h.Xb:this.h.kd?b-this.h.Da:this.h.Da*b/1E3):Q==d?(e=this.h.kd?b-this.h.Da:this.h.Da*b/1E3,d=-1!=this.h.Xb?e-this.h.Xb:this.h.nd?this.h.Ja:this.h.Ja*b/1E3):(L|Q)==d?(d=this.h.nd?this.h.Ja:this.h.Ja*b/1E3,e=this.h.kd?b-this.h.Da:this.h.Da*b/1E3):(d=this.h.Ja,e=this.h.Da);f<c&&(f=c);e<d&&(e=d);-2===this.h.nb?f=c+(e-d)*g_dKoef_Board_W_to_H:-3===this.h.nb&&(c=(e-d)*g_dKoef_Board_W_to_H);this.Ya.Fa=c;this.Ya.Ja=d;this.Ya.Ha=f;this.Ya.Da=e;this.a.style.left=(c+.5|0)+"px";this.a.style.top=(d+.5|0)+"px";this.a.style.width=(f-c+.5|0)+"px";this.a.style.height=(e-d+.5|0)+"px";this.a.width=f-c+.5|0;this.a.height=e-d+.5|0;Hb(this,f-c,e-d)}};function Hb(a,b,c){var d=a.$.length;if(1===a.Qb&&2===d){var f=a.$[0],e=a.$[1],g=b-400>=c?b-c:400;K(f.h,0,0,g,1E3,!1,!1,!0,!1,-1,-1);f.l=O|Q|L;K(e.h,b-g,0,1E3,1E3,!0,!1,!1,!1,-1,-1);e.l=R|Q|L}else 2===a.Qb&&1===d&&(f=a.$[0],e=Math.min(b,c),K(f.h,(b-e)/2,(c-e)/2,1E3,1E3,!0,!0,!0,!1,e,e),f.l=O|Q|L);for(f=0;f<d;f++)a.$[f].sa(b,c)}function C(a){var b=new Gb;b.dg=a;b.a=document.getElementById(a);return b}function Ib(){this.a=this.Xc=null;this.A=0;this.$=[]}Ib.prototype.V=function(a){this.A=a};Ib.prototype.k=function(a){a.Xc=this;this.$[this.$.length]=a};Ib.prototype.sa=function(a,b){var c=b-this.A,d=a;d!==c&&(c=d=Math.min(d,c));var f=(b-this.A-c)/2;this.a.style.left=parseInt((a-d)/2+.5)+"px";this.a.style.top=parseInt(f+.5)+"px";this.a.style.width=parseInt(d+.5)+"px";this.a.style.height=parseInt(c+this.A+.5)+"px";this.a.width=parseInt(d+.5);this.a.height=parseInt(c+this.A+.5);for(var f=this.$.length,e=0;e<f;e++)this.$[e].sa(d,c+this.A)};function Jb(a){if(this.c=a)a.j=this;this.ma=null;this.P=[];this.o={ce:[],de:[],Za:[],ab:[],xe:[],we:[],sb:[],tb:[],he:[],je:[],ge:[],me:[],ke:[],fe:[],ne:[],le:[],ie:[]};this.Xa=this.Wa=this.Cc=this.Bc=this.Bf=this.zd=this.Y=null;this.hf=[];this.Mg=40;setTimeout(function(){b.Ug()},this.Mg);var b=this;this.Ug=function(){this.zd&&Kb(this.zd)&&Lb(this.zd);setTimeout(function(){b.Ug()},b.Mg)}}r=Jb.prototype;r.ve=function(a){var b=new ba(this);b.B(a,this.c);b.ra();this.P.push(b);this.q()};r.te=function(a){var b=this.c,c=C(a);this.C(c.a,a+"div");var d=a+"div",f=new Ib;f.dg=d;f.a=document.getElementById(d);f.V(25);var e=f.a;c.k(f);d=a+"_Board";a+="_Toolbar";this.C(e,d);this.C(e,a);e=C(d);K(e.h,0,0,1E3,25,!1,!1,!1,!0,-1,-1);e.l=L|O|R;f.k(e);e=new ba(this);e.B(d,b);e.ra();d=C(a);K(d.h,0,0,1E3,0,!1,!1,!1,!0,-1,25);d.l=O|Q|R;f.k(d);f=new Mb(this);f.B(a,b,{$:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,20]});this.ma=c;this.P.push(e);this.P.push(f);this.q()};r.se=function(a){var b=this.c,c=C(a),d=a+"GoBoard";this.C(c.a,d);d=C(d);K(d.h,0,0,1,1,!1,!1,!0,!0,-1,-1);d.l=L|O|R|Q;c.k(d);d.Ia(1);var f=a+"_Board",e=a+"_Panel";this.C(d.a,f);this.C(d.a,e);var g=C(f);a=C(e);d.k(g);d.k(a);this.C(g.a,f+"_Centred");d=C(f);g.Ia(2);g.k(d);d=new ba(this);d.B(f,b);d.ra();f=e+"_CaT";g=e+"_Navigator";this.C(a.a,f);this.C(a.a,g);e=C(f);K(e.h,0,0,1E3,500,!1,!1,!1,!1,-1,-1);e.l=L|O|R|Q;a.k(e);var h=C(g);K(h.h,0,500,1E3,1E3,!1,!1,!1,!1,-1,-1);h.l=L|O|R|Q;a.k(h);a=new Nb(this);a.B(g,b);var k=f+"_Info",l=f+"_Comments",h=f+"_Toolbar",m=f+"_ToolbarAutoPlay",n=f+"_ToolbarTimeLine";this.C(e.a,k);this.C(e.a,l);this.C(e.a,h);var t=this.C(e.a,m);this.C(e.a,n);f=m+"_Slider";g=m+"_Button";this.C(t,g);this.C(t,f);t=C(k);K(t.h,0,0,1E3,0,!1,!1,!1,!1,-1,50);t.l=L|O|R;e.k(t);var p=k+"_White",k=k+"_Black";this.C(t.a,p);this.C(t.a,k);var s=C(p);K(s.h,0,0,500,1E3,!1,!1,!1,!1,-1,-1);s.l=L|O|R|Q;t.k(s);s=C(k);K(s.h,500,0,1E3,1E3,!1,!1,!1,!1,-1,-1);s.l=L|O|R|Q;t.k(s);t=new Db(this);t.B(p,b,E);p=new Db(this);p.B(k,b,D);k=C(l);K(k.h,0,50,1E3,75,!1,!0,!1,!0,-1,25);k.l=L|O|R|Q;e.k(k);k=C(h);K(k.h,0,0,1E3,50,!1,!1,!1,!0,-1,25);k.l=O|R|Q;e.k(k);k=C(m);K(k.h,0,0,1E3,25,!1,!1,!1,!0,-1,25);k.l=O|R|Q;e.k(k);m=C(g);K(m.h,0,0,1E3,1E3,!1,!1,!1,!1,25,-1);m.l=O|L|Q;k.k(m);m=C(f);K(m.h,25,0,1E3,1E3,!0,!1,!1,!1,-1,25);m.l=L|R|Q;k.k(m);k=C(n);K(k.h,0,0,1E3,0,!1,!1,!1,!0,-1,25);k.l=O|R|Q;e.k(k);e=new Cb(this);e.B(l,b);l=new Mb(this);l.B(h,b,{$:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,20]});h=new Ob(this);h.B(n,b,Pb,0);n=new nb(this);n.B(g,b,18);g=new Ob(this);g.B(f,b,Qb,0);this.P.push(d);this.P.push(a);this.P.push(e);this.P.push(l);this.P.push(h);this.P.push(n);this.P.push(g);this.P.push(p);this.P.push(t);this.ma=c;this.q();Rb(b)};r.ue=function(a){var b=this.c,c=C(a),d=a+"GoBoard";this.C(c.a,d);d=C(d);K(d.h,0,0,1,1,!1,!1,!0,!0,-1,-1);d.l=L|O|R|Q;c.k(d);d.Ia(1);var f=a+"_Board",e=a+"_Panel";this.C(d.a,f);this.C(d.a,e);var g=C(f);a=C(e);d.k(g);d.k(a);this.C(g.a,f+"_Centred");d=C(f);g.Ia(2);g.k(d);d=new ba(this);d.B(f,b);d.ra();f=e+"_Toolbar";e+="_Comments";this.C(a.a,e);this.C(a.a,f);g=C(e);K(g.h,0,25,1E3,1E3,!1,!0,!1,!1,-1,-1);g.l=L|O|R|Q;a.k(g);g=C(f);K(g.h,0,0,1E3,1E3,!0,!0,!1,!0,-1,25);g.l=O|R|L;a.k(g);a=new Cb(this);a.B(e,b);e=new Mb(this);e.B(f,b,{$:[1]});this.P.push(d);this.P.push(a);this.P.push(e);this.ma=c;this.q();Rb(b)};r.q=function(){this.ma&&this.ma.sa(this.ma.a.clientWidth,this.ma.a.clientHeight);for(var a=0,b=this.P.length;a<b;a++)this.P[a].q()};r.C=function(a,b){var c=document.createElement("div");c.setAttribute("id",b);c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("oncontextmenu","return false;");a.appendChild(c);return c};r.ig=function(a){this.Y=a};r.gg=function(){this.Bc&&rb(this.Bc,0)};r.Ue=function(){this.Bc&&rb(this.Bc,16)};r.zg=function(a){if(this.Wa){var b=this.Wa;b.Nd=a;Eb(b)}};r.Ag=function(a){if(this.Wa){var b=this.Wa;b.Pd=a;Eb(b)}};r.Bg=function(a){if(this.Xa){var b=this.Xa;b.Nd=a;Eb(b)}};r.Cg=function(a){if(this.Xa){var b=this.Xa;b.Pd=a;Eb(b)}};r.kc=function(a,b){this.Wa&&this.Wa.kc(a);this.Xa&&this.Xa.kc(b)};r.lc=function(a,b){this.Wa&&this.Wa.lc(a);this.Xa&&this.Xa.lc(b)};r.ub=function(a){for(var b=0,c=this.o.ce.length;b<c;b++)qb(this.o.ce[b],a.Za);b=0;for(c=this.o.de.length;b<c;b++)qb(this.o.de[b],a.Za);b=0;for(c=this.o.Za.length;b<c;b++)qb(this.o.Za[b],a.Za);b=0;for(c=this.o.ab.length;b<c;b++)qb(this.o.ab[b],a.ab);b=0;for(c=this.o.xe.length;b<c;b++)qb(this.o.xe[b],a.ab);b=0;for(c=this.o.we.length;b<c;b++)qb(this.o.we[b],a.ab);b=0;for(c=this.o.sb.length;b<c;b++)qb(this.o.sb[b],a.sb);b=0;for(c=this.o.tb.length;b<c;b++)qb(this.o.tb[b],a.tb);b=0;for(c=this.o.he.length;b<c;b++)sb(this.o.he[b],0===a.Ea);b=0;for(c=this.o.je.length;b<c;b++)sb(this.o.je[b],1===a.Ea);b=0;for(c=this.o.ge.length;b<c;b++)sb(this.o.ge[b],2===a.Ea);b=0;for(c=this.o.me.length;b<c;b++)sb(this.o.me[b],3===a.Ea);b=0;for(c=this.o.ke.length;b<c;b++)sb(this.o.ke[b],4===a.Ea);b=0;for(c=this.o.fe.length;b<c;b++)sb(this.o.fe[b],5===a.Ea);b=0;for(c=this.o.ne.length;b<c;b++)sb(this.o.ne[b],6===a.Ea);b=0;for(c=this.o.le.length;b<c;b++)sb(this.o.le[b],7===a.Ea);b=0;for(c=this.o.ie.length;b<c;b++)sb(this.o.ie[b],8===a.Ea);this.Bf&&(b=this.Bf,!0!==b.pc&&Sb(b,a.qg,!0))};r.fd=function(a){for(var b=0,c=this.hf.length;b<c;b++)this.hf[b].fd(a)};var Tb=0,Ub=1,Ya=2,x=new function(){this.Pf=this.g=this.f=0;this.Qb=Ub;this.ha=this.qa=this.Kc=!1;this.ca=null;this.gc=-1;this.cg=this.bg=this.$b=0;this.Ne=this.Rc=!1},ia=new function(){this.ha=this.qa=this.Kc=!1;this.ca=null;this.Sc=this.dh=0};function ha(a){ia.Kc=a.altKey;ia.qa=void 0!==a.metaKey?a.ctrlKey||a.metaKey:a.ctrlKey;ia.ha=a.shiftKey;ia.ca=a.srcElement?a.srcElement:a.target;ia.dh=a.charCode;ia.Sc=a.keyCode;ia.ri=a.which}function ca(a){if(!a.Rc||a.Ne){if(a.pageX||a.pageY)x.f=a.pageX,x.g=a.pageY;else if(a.clientX||a.clientY)x.f=a.clientX,x.g=a.clientY;x.Kc=a.altKey;x.ha=a.shiftKey;x.qa=a.ctrlKey||a.metaKey;x.Qb=Ub;x.Rc||(x.ca=a.srcElement?a.srcElement:a.target);if(3<Math.abs(x.f-x.bg)||3<Math.abs(x.g-x.cg))x.gc=-1,x.$b=0}}function ga(a){if(a.pageX||a.pageY)x.f=a.pageX,x.g=a.pageY;else if(a.clientX||a.clientY)x.f=a.clientX,x.g=a.clientY;x.bg=x.f;x.cg=x.g;x.Kc=a.altKey;x.ha=a.shiftKey;x.qa=a.ctrlKey||a.metaKey;x.Qb=Tb;x.Pf=a.button;x.ca=a.srcElement?a.srcElement:a.target;a=(new Date).getTime();0==x.$b?(x.$b=1,x.gc=a):500>a-x.gc?(x.gc=a,x.$b++):(x.$b=1,x.gc=a);window.Gg=!1}window.onmousemove=function(a){x.Rc&&void 0!=x.ca&&null!=x.ca&&void 0!=x.ca.onmousemove&&null!=x.ca.onmousemove&&(x.Ne=!0,x.ca.onmousemove(a),x.Ne=!1)};window.onmouseup=function(a){if(!1===window.Gg){window.Gg=!0;if(x.Rc&&x.ca&&void 0!=x.ca.onmouseup&&null!=x.ca.onmouseup)x.ca.onmouseup(a,!0);x.ca=null}};function Vb(){this.tb=this.sb=this.ab=this.Za=!0;this.qg=this.Ea=0};var za=-1,Wa=0,Va=1,Ua=2,Ra=3,Xa=4,Sa=5,Ta=6;function F(a,b,c,d){this.Pg={f:void 0===a?0:a,g:void 0==b?0:b};this.u=void 0===c?Wa:c;this.Sd=void 0===d?"":d}F.prototype.bc=function(){return this.Pg.f};F.prototype.cc=function(){return this.Pg.g};F.prototype.Ia=function(a){this.u=a};function Nb(a){this.j=a;this.c=null;this.w=new Wb;this.pd=this.od=!0;this.a={d:null,K:{d:null},Selection:{d:null},ob:{d:null},F:{d:null},Xe:{d:null},Re:{d:null},hh:{d:null},U:null,W:null,qb:null,vb:null,ad:0,$c:0};this.ib=new v(231,188,95,255);this.zf=new v(0,0,0,255);this.ua=null;this.b={G:0,A:0,K:null,Jb:null,Rb:null,Lc:null,hd:null,Ge:null,Yf:null,Ae:null,Xf:null,Ee:null,Ze:null,Eg:null,cf:null,Ke:null,He:null,Ie:null,Je:null,Le:null,Be:null,Ce:null,De:null,Fe:null,ef:null,$e:null,af:null,bf:null,df:null,tg:null,wg:null,ug:null,xg:null,vg:null,yg:null,Sa:null,ob:null,ga:null,eb:0};this.D={f:0,g:0};this.Tb=!1;this.Gh=!0;this.wa={G:0,A:0,f:0,g:0};var b=this;this.Nf=function(){return setTimeout(function(){b.Kf()},20)};this.Ec=function(a){b.Tb||(b.c&&b.c.ra(),ga(a),a=b.Gc(x.f,x.g),a=b.w.M(a.f,a.g),a.ec()&&b.c&&y(b.c,a))};this.Zd=function(a){b.Tb||(ca(a),a=b.Gc(x.f,x.g),b.mb(a.f,a.g))};this.Fc=function(){b.Tb||b.mb(-1,-1)};this.Tg=function(a){if(b.Tb)return!1;var d=0,d=void 0!=a.wheelDelta?0<a.wheelDelta?-45:45:0<a.detail?45:-45;a.preventDefault&&a.preventDefault();var f=20+24*(b.w.w.length+1)-b.a.K.d.a.height;b.D.g-=d;b.D.g=Math.min(0,Math.max(b.D.g,-f));Xb(b);b.Zd(a);Yb(b);return!1};this.Yd=function(){b.c&&b.c.ra()};this.ii=function(){b.a.U.style.opacity=.7;b.a.qb.style.opacity=.3;b.a.qb.style.display="block"};this.fi=function(){b.a.U.style.opacity=.5;b.a.qb.style.opacity=0;b.a.qb.style.display="none"};this.ji=function(){b.a.W.style.opacity=.7;b.a.vb.style.opacity=.3;b.a.vb.style.display="block"};this.gi=function(){b.a.W.style.opacity=.5;b.a.vb.style.opacity=0;b.a.vb.style.display="none"};this.Sg=function(){b.Tb=!0};this.Rg=function(){b.Tb=!1};this.Th=function(a){var d=b.b.G;b.D.f=-((a-2)/(d-4-b.a.ad)*(20+24*(Zb(b.w)+1)-d));Xb(b)};this.ai=function(a,d){var f=b.b.A;b.D.g=-((d-2)/(f-4-b.a.$c)*(20+24*(b.w.w.length+1)-f));Xb(b)}}r=Nb.prototype;r.B=function(a,b){this.j&&(this.j.zd=this);this.c=b;this.c.I=this;this.w.c=b;this.a.d=C(a);var c=this.a.d.a,d=this.a.d,f=a+"_Board",e=a+"_Selection",g=a+"_Current",h=a+"_Lines",k=a+"_Shadows",l=a+"_Nodes",m=a+"_Events";this.ka(c,f);this.ka(c,e);this.ka(c,g);this.ka(c,h);this.ka(c,k);this.ka(c,l);var n=this.ea(c,m);this.a.qb=this.ea(c,a+"HorScroll_BG");this.a.U=this.ea(c,a+"HorScroll");this.a.vb=this.ea(c,a+"VerScroll_BG");this.a.W=this.ea(c,a+"VerScroll");this.a.qb.style.background="rgb(0,0,0)";this.a.qb.style.display="none";this.a.vb.style.background="rgb(0,0,0)";this.a.vb.style.display="none";this.a.U.onmouseover=this.ii;this.a.U.onmouseout=this.fi;this.a.W.onmouseover=this.ji;this.a.W.onmouseout=this.gi;c=C(a+"HorScroll_BG");K(c.h,2,0,2,4,!0,!1,!0,!0,-1,8);c.l=O|Q|R;d.k(c);c=C(a+"VerScroll_BG");K(c.h,0,2,4,2,!1,!0,!0,!0,8,-1);c.l=L|Q|R;d.k(c);this.Z(this.a.K,d,f);this.Z(this.a.Selection,d,e);this.Z(this.a.ob,d,g);this.Z(this.a.F,d,h);this.Z(this.a.Xe,d,k);this.Z(this.a.Re,d,l);this.Z(this.a.hh,d,m);n.onmousedown=this.Ec;n.onmousemove=this.Zd;n.onmouseout=this.Fc;n.onmousewheel=this.Tg;n.addEventListener&&n.addEventListener("DOMMouseScroll",this.Tg,!1);n.onfocus=this.Yd;n.tabIndex=-1;n.style.Fh=!0;n.style.outline=0;d=this.a.Re.d.a.getContext("2d");this.b.Jb=d.createImageData(20,20);this.b.Rb=d.createImageData(20,20);this.b.Lc=d.createImageData(20,20);this.b.hd=d.createImageData(20,20);d=this.b.Jb.data;f=this.b.Rb.data;e=this.b.Lc.data;g=this.b.hd.data;h=Math.sqrt(3);for(k=0;20>k;k++)for(l=0;20>l;l++){var c=k-9.5,t=l-9.5,p=9.3-Math.sqrt(c*c+t*t),m=4*(20*k+20-l-1);if(0<=p){var s=9.3*9.3-c*c-t*t,s=0<s?Math.sqrt(s)*h:0,w=c,J=t,n=Math.sqrt(6*(w*w+J*J+s*s)),n=(2*s-w+J)/n,s=0;.9<n&&(s=10*(n-.9));w=255;.8>=p&&(p=(.8-p)/.8,w=.7,3.1>c-t&&(w=1),w=parseInt(255*(1-p*w)));c=parseInt(10+10*n+140*s);d[m+0]=c;d[m+1]=c;d[m+2]=c;d[m+3]=w;e[m+0]=c;e[m+1]=c;e[m+2]=c;e[m+3]=parseInt(.5*w);c=parseInt(200+10*n+45*s);f[m+0]=c;f[m+1]=c;f[m+2]=c;f[m+3]=w;g[m+0]=c;g[m+1]=c;g[m+2]=c;g[m+3]=parseInt(.7*w)}else d[m+0]=0,d[m+1]=0,d[m+2]=0,d[m+3]=0,g[m+0]=0,g[m+1]=0,g[m+2]=0,g[m+3]=0}this.Xd();d=this.a.Selection.d.a.getContext("2d");this.b.Sa=d.createImageData(24,24);this.b.ob=d.createImageData(24,24);f=this.b.Sa.data;e=this.b.ob.data;for(g=0;24>g;g++)for(h=0;24>h;h++)k=4*(h+24*g),f[k+3]=255,e[k+3]=255,0===h&&23===g||23===h&&0===g?(f[k+0]=135,f[k+1]=125,f[k+2]=135,e[k+0]=216):23===h||23===g?(f[k+0]=89,f[k+1]=89,f[k+2]=89,e[k+0]=178):(0===g||0===h?(f[k+0]=182,f[k+1]=182,f[k+2]=182):(f[k+0]=128,f[k+1]=128,f[k+2]=128),e[k+0]=255),e[k+1]=0,e[k+2]=0;d.putImageData(this.b.Sa,0,0);d.putImageData(this.b.ob,0,30);this.Jf()};r.q=function(a){var b=this.a.d.a.clientWidth,c=this.a.d.a.clientHeight;this.a.d.sa(b,c);this.Ca(b,c,a)};function ja(a){if(!(0>=a.b.G||0>=a.b.A)){var b=a.b.G,c=a.b.A,d=20+24*(Zb(a.w)+1),f=20+24*(a.w.w.length+1);d>b?(a.a.ad=Math.max(50,b*b/d),a.a.U.style.width=Math.max(50,b*b/d)+"px",a.a.U.style.display="block",a.a.U.style.position="absolute",a.a.U.style.top=c-12+"px",a.a.U.style.height="8px",a.a.U.style.background="rgb(0,0,0)",a.a.U.style.opacity=.5,$b(a.a.U,2,b-a.a.ad-2,c-12,c-12),a.a.U.oa=a.Th,a.a.U.Wd=a.Sg,a.a.U.Vd=a.Rg):a.a.U.style.display="none";f>c?(a.a.$c=Math.max(50,c*c/f),a.a.W.style.height=Math.max(50,c*c/f)+"px",a.a.W.style.display="block",a.a.W.style.position="absolute",a.a.W.style.left=b-12+"px",a.a.W.style.width="8px",a.a.W.style.background="rgb(0,0,0)",a.a.W.style.opacity=.5,$b(a.a.W,b-12,b-12,2,c-a.a.$c-2),a.a.W.oa=a.ai,a.a.W.Wd=a.Sg,a.a.W.Vd=a.Rg):a.a.W.style.display="none";a.wa.A=-1;a.wa.G=-1;Xb(a);Yb(a)}}r.$a=function(){this.w.$a();this.wa.A=-1;this.wa.G=-1};function ac(a,b){a.od=!0;var c=a.b.G,d=a.b.A;if(!(0>=c||0>=d)){var f=a.c.i.na,e=f.f,f=f.g,g=10+a.D.f+24*e,h=10+a.D.g+24*f;if(0!=b&&!0===a.Gh&&(10>=g||g>=c-10||10>=h||h>=d-10)){var k=20+24*(a.w.w.length+1)-d,l=20+24*(Zb(a.w)+1)-c;10>=g?a.D.f=24*-e:g>=c-10&&(a.D.f=c-24-10-10-24*e);10>=h?a.D.g=24*-f:h>=d-10&&(a.D.g=d-24-10-10-24*f);a.D.f=Math.min(0,Math.max(a.D.f,-l));a.D.g=Math.min(0,Math.max(a.D.g,-k));Yb(a);Xb(a)}}}function Lb(a){if(a.od&&a.c){var b=a.b.G,c=a.b.A;if(!(0>=b||0>=c)){var d=a.c.i.na,f=10+a.D.f+24*d.f,d=10+a.D.g+24*d.g,e=a.a.ob.d.a.getContext("2d");e.clearRect(0,0,b,c);-24<=f&&f<=b+24&&-24<=d&&d<=c+24&&e.putImageData(a.b.ob,f,d);a.od=!1}}if(a.pd&&(b=a.b.G,c=a.b.A,0!==b&&0!==c)){if(!(a.wa.G===b&&a.wa.A===c&&1>Math.abs(a.D.f-a.wa.f)&&1>Math.abs(a.D.g-a.wa.g))){a.wa.G=b;a.wa.A=c;a.wa.f=a.D.f;a.wa.g=a.D.g;var f=a.a.F.d.a.getContext("2d"),d=a.a.Xe.d.a.getContext("2d"),e=a.a.Re.d.a.getContext("2d"),g=a.a.Selection.d.a.getContext("2d");e.clearRect(0,0,b,c);d.clearRect(0,0,b,c);f.clearRect(0,0,b,c);g.clearRect(0,0,b,c);for(var g=10+a.D.f,h=10+a.D.g,k=a.w.w.length,l=0;l<=k-1;l++){var m=h+24*l;if(-24<=m&&m<=c+24)for(var n=a.w.w[l].length-1,t=0;t<=n;t++){var p=g+24*t;if(-24<=p&&p<=b+24){var s=a.w.M(t,l);if(!1===s.ec()){var w=s.Ob();switch(s.u){case bc:w.fb?f.putImageData(a.b.Ze,p,m):f.putImageData(a.b.ef,p,m);break;case cc:w.fb?1===w.mg?f.putImageData(a.b.$e,p,m):f.putImageData(a.b.af,p,m):f.putImageData(a.b.bf,p,m);break;case dc:w.fb?f.putImageData(a.b.cf,p,m):f.putImageData(a.b.df,p,m)}}else{var w=s.Ob(),J=s.Oa.u,N=""+s.na.Se,z=e.measureText(N).width,M=s.jb;D===J?(w&&d.putImageData(a.b.ga,p+2+a.b.eb,m+2+a.b.eb),e.putImageData(w?a.b.Jb:a.b.Lc,p+2,m+2),""===M?(e.font="bold 10px sans-serif",e.fillStyle=w?"#CCC":"rgb(192, 192, 192)",e.fillText(N,p+12-z/2,m+12+3)):e.putImageData(w?a.b.ug:a.b.vg,p+2,m+2)):E===J?(w&&d.putImageData(a.b.ga,p+2+a.b.eb,m+2+a.b.eb),e.putImageData(w?a.b.Rb:a.b.hd,p+2,m+2),""===M?(e.font="bold 10px sans-serif",e.fillStyle=w?"#000":"rgb(56, 56, 56)",e.fillText(N,p+12-z/2,m+12+3)):e.putImageData(w?a.b.xg:a.b.yg,p+2,m+2)):e.putImageData(w?a.b.tg:a.b.wg,p+2,m+2);N=A(s);s=s.T;0===t?0!==N&&(1===N?w?f.putImageData(a.b.Ge,p,m):f.putImageData(a.b.Ke,p,m):w?0==s?f.putImageData(a.b.He,p,m):f.putImageData(a.b.Ie,p,m):f.putImageData(a.b.Je,p,m)):0===N?w?f.putImageData(a.b.Ee,p,m):f.putImageData(a.b.Fe,p,m):1===N?w?f.putImageData(a.b.Ae,p,m):f.putImageData(a.b.Le,p,m):w?0===s?f.putImageData(a.b.Be,p,m):f.putImageData(a.b.Ce,p,m):f.putImageData(a.b.De,p,m);D!==J&&E!==J||f.clearRect(p+3,m+3,18,18)}}}}}a.pd=!1}}function Kb(a){return a.od||a.pd?!0:!1}r.ka=function(a,b){var c=document.createElement("canvas");c.setAttribute("id",b);c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("oncontextmenu","return false;");a.appendChild(c);return c};r.ea=function(a,b){var c=document.createElement("div");c.setAttribute("id",b);c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("oncontextmenu","return false;");a.appendChild(c);return c};r.Z=function(a,b,c){a.d=C(c);a=a.d;K(a.h,0,0,1E3,1E3,!1,!1,!1,!1,-1,-1);a.l=L|O|Q|R;b.k(a)};r.Ca=function(a,b){var c=this.a.K.d.a.getContext("2d");a!==this.b.G||b!==this.b.A||null===this.b.K||null!==this.ua?(this.b.G=a,this.b.A=b,c.fillStyle=S(this.ib),c.fillRect(0,0,a,b),null!==this.ua&&clearTimeout(this.ua),this.ua=this.Nf()):c.putImageData(this.b.K,0,0);ja(this)};r.Kf=function(){this.ua=null;var a=this.b.G,b=this.b.A,c=this.a.K.d.a.getContext("2d");if(0!==a&&0!==b){for(var d=c.createImageData(a,b),f=this.ib.v,e=this.ib.t,g=this.ib.s,h=Array(a),k=0;k<a;k++)h[k]=(Math.tan(300*k/a)+1)/2+(Math.tan(100*k/a)+1)/10;for(var l=Array(b),m=0;m<b;m++)l[m]=.02*Math.tan(m/b);var n,t,p;p=.9;for(m=0;m<b;m++)for(k=0;k<a;k++){p=40*(h[k]+l[m])+.5;p-=Math.floor(p);p=.2>p?1-p/2:.4>p?1-(.4-p)/2:1;if(m==b-1||m==b-2&&k<a-2||k>=a-1||k==a-2&&m<b-1)p/=2;0==m||1==m&&1<k||0==k||1==k&&1<m?(n=128+f*p/2,t=128+e*p/2,p=128+g*p/2):(n=f*p,t=e*p,p*=g);var s=4*(k+m*a);d.data[s+0]=n;d.data[s+1]=t;d.data[s+2]=p;d.data[s+3]=255}this.b.K=d;c.putImageData(this.b.K,0,0)}};r.Xd=function(){var a=this.a.F.d.a.getContext("2d");this.b.Ge=a.createImageData(24,24);this.b.Yf=a.createImageData(24,24);this.b.Ae=a.createImageData(24,24);this.b.Xf=a.createImageData(24,24);this.b.Ee=a.createImageData(24,24);this.b.Ze=a.createImageData(24,24);this.b.Eg=a.createImageData(24,24);this.b.cf=a.createImageData(24,24);this.b.Ke=a.createImageData(24,24);this.b.He=a.createImageData(24,24);this.b.Ie=a.createImageData(24,24);this.b.Je=a.createImageData(24,24);this.b.Le=a.createImageData(24,24);this.b.Be=a.createImageData(24,24);this.b.Ce=a.createImageData(24,24);this.b.De=a.createImageData(24,24);this.b.Fe=a.createImageData(24,24);this.b.ef=a.createImageData(24,24);this.b.$e=a.createImageData(24,24);this.b.af=a.createImageData(24,24);this.b.bf=a.createImageData(24,24);this.b.df=a.createImageData(24,24);for(var a=this.b.Ge.data,b=this.b.Yf.data,c=this.b.Ae.data,d=this.b.Xf.data,f=this.b.Ee.data,e=this.b.Ze.data,g=this.b.Eg.data,h=this.b.cf.data,k=this.b.Ke.data,l=this.b.He.data,m=this.b.Ie.data,n=this.b.Je.data,t=this.b.Le.data,p=this.b.Be.data,s=this.b.Ce.data,w=this.b.De.data,J=this.b.Fe.data,N=this.b.ef.data,z=this.b.$e.data,M=this.b.af.data,P=this.b.bf.data,aa=this.b.df.data,u=new v(28,28,28,255),H=0;24>H;H++)for(var I=0;24>I;I++){var q=4*(24*H+I);12<=I&&(11===H||12===H)?(a[q+0]=u.v,a[q+1]=u.s,a[q+2]=u.t,a[q+3]=255,k[q+0]=u.v,k[q+1]=u.s,k[q+2]=u.t,k[q+3]=96):(a[q+3]=0,k[q+3]=0);11<=I&&(11===H||12===H)||12<=H&&(11===I||12===I)?(b[q+0]=u.v,b[q+1]=u.s,b[q+2]=u.t,b[q+3]=255,n[q+0]=u.v,n[q+1]=u.s,n[q+2]=u.t,n[q+3]=96):(b[q+3]=0,n[q+3]=0);11<=I&&(11===H||12===H)?(l[q+0]=u.v,l[q+1]=u.s,l[q+2]=u.t,l[q+3]=255):12<=H&&(11===I||12===I)?(l[q+0]=u.v,l[q+1]=u.s,l[q+2]=u.t,l[q+3]=96):l[q+3]=0;12<=H&&(11===I||12===I)?(m[q+0]=u.v,m[q+1]=u.s,m[q+2]=u.t,m[q+3]=255):11<=I&&(11===H||12===H)?(m[q+0]=u.v,m[q+1]=u.s,m[q+2]=u.t,m[q+3]=96):m[q+3]=0;11===H||12===H?(c[q+0]=u.v,c[q+1]=u.s,c[q+2]=u.t,c[q+3]=255,t[q+0]=u.v,t[q+1]=u.s,t[q+2]=u.t,t[q+3]=96):(c[q+3]=0,t[q+3]=0);11===H||12===H||12<=H&&(11===I||12===I)?(d[q+0]=u.v,d[q+1]=u.s,d[q+2]=u.t,d[q+3]=255,w[q+0]=u.v,w[q+1]=u.s,w[q+2]=u.t,w[q+3]=96):(d[q+3]=0,w[q+3]=0);11===H||12===H?(p[q+0]=u.v,p[q+1]=u.s,p[q+2]=u.t,p[q+3]=255):12<=H&&(11===I||12===I)?(p[q+0]=u.v,p[q+1]=u.s,p[q+2]=u.t,p[q+3]=96):p[q+3]=0;(11===H||12===H)&&12>=I||12<=H&&(11===I||12===I)?(s[q+0]=u.v,s[q+1]=u.s,s[q+2]=u.t,s[q+3]=255):(11===H||12===H)&&12<I?(s[q+0]=u.v,s[q+1]=u.s,s[q+2]=u.t,s[q+3]=96):(d[q+3]=0,w[q+3]=0);11>=I&&(11===H||12===H)?(f[q+0]=u.v,f[q+1]=u.s,f[q+2]=u.t,f[q+3]=255,J[q+0]=u.v,J[q+1]=u.s,J[q+2]=u.t,J[q+3]=96):(f[q+3]=0,J[q+3]=0);11===I||12===I?(e[q+0]=u.v,e[q+1]=u.s,e[q+2]=u.t,e[q+3]=255,N[q+0]=u.v,N[q+1]=u.s,N[q+2]=u.t,N[q+3]=96):(e[q+3]=0,N[q+3]=0);11===I||12===I||12<=I&&(11===H||12===H)?(g[q+0]=u.v,g[q+1]=u.s,g[q+2]=u.t,g[q+3]=255,P[q+0]=u.v,P[q+1]=u.s,P[q+2]=u.t,P[q+3]=96):(g[q+3]=0,P[q+3]=0);(11===I||12===I)&&12>=H||12<=I&&(11===H||12===H)?(z[q+0]=u.v,z[q+1]=u.s,z[q+2]=u.t,z[q+3]=255):(11===I||12===I)&&12<H?(z[q+0]=u.v,z[q+1]=u.s,z[q+2]=u.t,z[q+3]=96):z[q+3]=0;11===I||12===I?(M[q+0]=u.v,M[q+1]=u.s,M[q+2]=u.t,M[q+3]=255):12<I&&(11===H||12===H)?(M[q+0]=u.v,M[q+1]=u.s,M[q+2]=u.t,M[q+3]=96):M[q+3]=0;11>=H&&(11===I||12===I)||11<=I&&(11===H||12===H)?(h[q+0]=u.v,h[q+1]=u.s,h[q+2]=u.t,h[q+3]=255,aa[q+0]=u.v,aa[q+1]=u.s,aa[q+2]=u.t,aa[q+3]=96):(h[q+3]=0,aa[q+3]=0)}this.b.tg=this.aa(20,20,20*.07,u,1,null);this.b.wg=this.aa(20,20,20*.07,new v(28,28,28,96),1,null);this.b.ug=this.aa(20,20,1.2,new v(255,255,255,255),1,this.b.Jb);this.b.xg=this.aa(20,20,1.2,new v(0,0,0,255),1,this.b.Rb);this.b.vg=this.aa(20,20,1.2,new v(255,255,255,96),1,this.b.Lc);this.b.yg=this.aa(20,20,1.2,new v(0,0,0,96),1,this.b.hd)};r.aa=function(a,b,c,d,f,e){void 0===f&&(f=1);var g=this.a.F.d.a.getContext("2d");g.clearRect(0,0,a,b);null!==e&&g.putImageData(e,0,0);g.globalAlpha=f;g.strokeStyle=S(d);g.fillStyle=S(d);g.lineWidth=c;f=a/2;d=3*b/4;var h=.1*a;c=Math.sqrt(f*f-(d-f)*(d-f))+f-h;f=-Math.sqrt(f*f-(d-f)*(d-f))+f+h;null!==e&&(c=Math.floor(c-.5),f=Math.ceil(f+.5),h=Math.ceil(h+.5),d=Math.floor(d-.5));g.beginPath();g.moveTo(a/2,h);g.lineTo(c,d);g.lineTo(f,d);g.closePath();g.stroke();a=g.getImageData(0,0,a,b);g.putImageData(a,0,0);return a};r.Jf=function(){var a=this.a.Xe.d.a.getContext("2d");this.b.ga=a.createImageData(20,20);a=this.b.ga.data;this.b.eb=Math.max(3,3);for(var b=0;20>b;b++)for(var c=0;20>c;c++){var d=Math.abs(b-8.5),f=Math.abs(c-8.5),d=Math.sqrt(f*f+d*d)/8.5,d=1>d?.15+.75*(1-d):0,f=4*(20*b+c);a[f+0]=0;a[f+1]=0;a[f+2]=0;a[f+3]=parseInt(255*d)}};function Xb(a){a.pd=!0;ac(a,!1)}r.Gc=function(a,b){var c=Ea(this.a.K.d.a);return{f:(a-c.f-10-this.D.f)/24|0,g:(b-c.g-10-this.D.g)/24|0}};r.mb=function(a,b){var c=this.b.G,d=this.b.A;if(!(0>=c||0>=d)){var f=this.a.Selection.d.a.getContext("2d");f.clearRect(0,0,c,d);0<=a&&0<=b&&(c=10+this.D.f+24*a,d=10+this.D.g+24*b,this.w.M(a,b).ec()&&f.putImageData(this.b.Sa,c,d))}};function Yb(a){var b=a.b.G,c=a.b.A,c=-a.D.g/(20+24*(a.w.w.length+1)-c)*(c-4-a.a.$c)+2;a.a.U.style.left=-a.D.f/(20+24*(Zb(a.w)+1)-b)*(b-4-a.a.ad)+2+"px";a.a.W.style.top=c+"px"};var bc=-9,cc=-8,dc=-7;function ec(a,b,c){this.u=a;this.O=b;this.Ad=c}ec.prototype.ec=function(){return!1};ec.prototype.N=function(){return this.Ad};ec.prototype.Ob=function(){if(-10!==this.u)if(bc===this.u){if(this.O.Ob()&&0<A(this.O)&&this.O.N().na.g>=this.Ad.na.g)return{fb:!0}}else if(cc===this.u){if(!this.O.Ob())return{fb:!1};var a=this.Ad.na.g,b=this.O.N().na.g;if(a<b)return{fb:!0,mg:0};if(a===b)return{fb:!0,mg:1}}else if(dc===this.u)return{fb:this.Ad.Ob()};return{fb:!1}};function Wb(){this.w=[];this.c=null;this.da=0}Wb.prototype.ba=function(){this.w=[];this.da=0};Wb.prototype.$a=function(){this.c&&(this.ba(),fc(this,this.c.va,0,0))};function fc(a,b,c,d){var f,e=1;for(f=b;0<A(f);)e++,f=f.N(0);for(f=e;!gc(a,c,d,f);)d++;var e=c,g=d,h=b;for(a.V(e,g,b);0<A(h);)e++,h=h.N(0),a.V(e,g,h);for(e=b;0<A(e);)e=e.N(0);c+=f-1;for(f={Dg:d};;){for(var g=d,h=a.da,k=A(e),l=1;l<k;l++){a.da=h;var m=d,n=fc(a,e.N(l),c+1,d+1);d=n.g;for(m+=1;m<=d;m++)if(m===n.Dg)if(k-1===l){a.V(c,m,new ec(dc,e,e.N(l)));break}else a.V(c,m,new ec(cc,e,e.N(l)));else m<n.Dg?a.V(c,m,new ec(bc,e,e.N(l))):a.V(c,m,new ec(bc,e,e.N(l+1)))}a.da=h;if(e===b)break;e.Nb()&&a.da--;e=e.O;c--;d=g}f.g=d;return f}Wb.prototype.M=function(a,b){return void 0===this.w[b]||void 0===this.w[b][a]?new ec(-10,null,null):this.w[b][a]};Wb.prototype.V=function(a,b,c){void 0===this.w[b]&&(this.w[b]=[]);if(c.ec())if(c.Nb()){this.da++;var d=this.da;c.na.f=a;c.na.g=b;c.na.Se=d}else c.na.f=a,c.na.g=b,c.na.Se=-1;this.w[b][a]=c};function gc(a,b,c,d){for(var f=0;f<d;f++){var e=b+f;if(!1===(void 0===a.w[c]||void 0===a.w[c][e]||-10===a.w[c][e].u?!0:!1))return!1}return!0}function Zb(a){for(var b=0,c=a.w.length,d=0;d<c;d++){var f=a.w[d].length-1;f>b&&(b=f)}return b};function hc(a){if(this.c=a)a.j=this;this.ma=null;this.P=[];this.a={Qe:null,pg:null,hg:null,eg:null,Wc:null,Yc:null,Nc:null};this.Va=this.sd=this.Aa=0}r=hc.prototype;r.B=function(a,b){ic(this,b);var c=this.c,d=C(a),f=a+"_Board",e=a+"_Message",g=a+"_Next";this.C(d.a,f);var h=this.C(d.a,g),k=this.C(d.a,e);k.style.backgroundColor="rgb(255,255,255)";k.style["border-radius"]="6px";k.style["-webkit-border-radius"]="6px";k.style["-moz-border-radius"]="5px";k.style["-khtml-border-radius"]="10px";k.style.borderColor="#e3e3e3";k.style.borderWidth="5px";k.style.borderStyle="ridge";k.style.display="block";var l=C(f);K(l.h,0,0,1E3,1E3,!1,!1,!1,!1,-1,-1);l.l=L|O|R|Q;d.k(l);this.C(l.a,f+"_Centred");var m=C(f);l.Ia(2);l.k(m);l=C(e);K(l.h,350,350,650,650,!1,!1,!1,!1,-1,-1);l.l=L|O|R|Q;d.k(l);m=new ba(this);m.B(f,c);m.Fb=this;var n=C(g);K(n.h,0,0,1E3,1E3,!1,!1,!1,!1,-1,-1);n.l=L|O|R|Q;d.k(n);c=g+"_Centred";this.C(n.a,c);f=C(c);n.Ia(2);n.k(f);n=c+"_Next";g=jc(f.a,n);g.value="\u0414\u0430\u043b\u0435\u0435";g.style.display="none";var t=c+"_Prev",c=jc(f.a,t);c.value="\u041d\u0430\u0437\u0430\u0434";c.style.display="none";var p=this;g.onclick=function(){p.a.Wc.style.display="none";p.a.Yc.style.display="none";kc(p)};c.onclick=function(){p.a.Wc.style.display="none";p.a.Yc.style.display="none";lc(p)};n=C(n);K(n.h,501,0,2,2,!1,!1,!0,!0,-1,25);n.l=O|R|Q;f.k(n);n=C(t);K(n.h,2,0,499,2,!0,!1,!1,!0,-1,25);n.l=O|R|Q;f.k(n);var s=e+"_Text",t=e+"_Next",w=e+"_Prev",e=this.C(k,s);e.style.fontFamily="verdana";e.style.textAlign="justify";e.style.si="center";e.style.overflowY="scroll";f=jc(k,t);n=jc(k,w);n.onclick=function(){lc(p)};f.onclick=function(){kc(p)};s=C(s);K(s.h,0,0,1E3,35,!1,!1,!1,!0,-1,-1);s.l=L|O|Q|R;l.k(s);t=C(t);K(t.h,0,0,5,5,!1,!1,!0,!0,100,25);t.l=Q|R;l.k(t);t=C(w);K(t.h,5,0,0,5,!0,!1,!1,!0,100,25);t.l=Q|O;l.k(t);this.a.Qe=k;this.a.pg=e;this.a.hg=n;this.a.eg=f;this.a.Wc=g;this.a.Yc=c;this.a.Nc=h;this.P.push(m);this.ma=d;this.q();mc(this,0,0)};r.q=function(){this.ma&&this.ma.sa(this.ma.a.clientWidth,this.ma.a.clientHeight);for(var a=0,b=this.P.length;a<b;a++)this.P[a].q()};function ab(a){return null===a.L[a.Aa].fa||void 0===a.L[a.Aa].fa.Rf?0:a.L[a.Aa].fa.Rf}function bb(a){null!==a.L[a.Aa].fa&&!0===a.L[a.Aa].fa.Ah?(a.a.Nc.style.display="block",a.a.Wc.style.display="block",a.a.Yc.style.display="block"):a.ui(a.Aa,2)}r.ig=function(){};r.fd=function(){};r.ub=function(){};r.zg=function(){};r.Bg=function(){};r.Ag=function(){};r.Cg=function(){};r.lc=function(){};r.kc=function(){};r.Ue=function(){};r.gg=function(){};function ic(a,b){var c=b.length;a.sd=c;a.L=[];for(var d=0;d<c;d++)a.L[d]={},a.L[d].We=b[d].Sgf,a.L[d].mi=b[d].Before,a.L[d].li=b[d].After,a.L[d].Pe=b[d].Message,null===b[d].SgfPr?a.L[d].fa=null:(a.L[d].fa={},a.L[d].fa.Rf=b[d].SgfPr.Count,a.L[d].fa.Ah=b[d].SgfPr.WaitOnEnd,a.L[d].fa.ac={},b[d].SgfPr.Flags&&(a.L[d].fa.ac.Vc=b[d].SgfPr.Flags.NewNode,a.L[d].fa.ac.Tc=b[d].SgfPr.Flags.Move,a.L[d].fa.ac.qe=b[d].SgfPr.Flags.ChangeBoardMode,a.L[d].fa.ac.Oe=b[d].SgfPr.Flags.LoadFile))}function kc(a){var b=a.Aa;0===a.Va?null!==a.L[b].We?mc(a,b,1):(a.Va=1,kc(a)):1!==a.Va||b>=a.sd-1||(null!==a.L[b+1].Pe?mc(a,b+1,0):(a.Aa++,a.Va=0,kc(a)))}function lc(a){var b=a.Aa;0===a.Va?0>=b||(null!==a.L[b-1].We?mc(a,b-1,1):(a.Aa--,a.Va=1,lc(a))):1===a.Va&&(null!==a.L[b].Pe?mc(a,b,0):(a.Va=0,lc(a)))}function mc(a,b,c){if(!(0>b||b>=a.sd)){a.Aa=b;a.Va=c;var d=a.L[b].We,f=a.L[b].fa,e=a.L[b].Pe;0===c?(a.a.Nc.style.display="block",null!==e?(c=0===b?null:"\u041d\u0430\u0437\u0430\u0434",b=b===a.sd-1&&null===d?null:"\u0414\u0430\u043b\u0435\u0435",d=a.a.hg,f=a.a.eg,a.a.Qe.style.display="block",a.a.pg.innerHTML=e,null===c?d.style.display="none":(d.style.display="block",d.value=c),null===b?f.style.display="none":(f.style.display="block",f.value=b)):kc(a)):1===c&&(a.a.Nc.style.display="none",null!==d?(a.a.Qe.style.display="none",a.c.p=4294967295,a.c.Pb(d),nc(a.c,f.ac),a.c.ra()):kc(a))}}r.C=function(a,b){var c=document.createElement("div");c.setAttribute("id",b);c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("oncontextmenu","return false;");a.appendChild(c);return c};function jc(a,b){var c=document.createElement("input");c.setAttribute("id",b);c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("type","button");a.appendChild(c);return c};var oc=0,Qb=0,Pb=1;function Ob(a){this.j=a;this.c=null;this.u=oc;this.a={d:null,rb:null,Ve:null,Ye:null};this.vf=new v(217,217,217,255);this.Lh=new v(54,101,179,255);this.Nh=new v(140,140,140,255);this.Oh=new v(0,0,0,255);this.rd=this.Ub=this.H=0;this.hb=7;this.Ma=10;this.pc=!1;var b=this;this.Qh=function(a){var d=b.H-b.rd;0!==d&&(Sb(b,(a-b.Ma)/d,!1),pc(b,!1))};this.Mf=function(){b.pc=!0;pc(b,!1)};this.Sh=function(a){b.pc=!1;var d=b.H-b.rd;0!==d&&(Sb(b,(a-b.Ma)/d,!1),pc(b,!0))}}Ob.prototype.B=function(a,b,c,d){this.c=b;this.u=c;switch(c){case Qb:this.j.Cc=this;break;case Pb:this.j.Bf=this}this.a.d=C(a);c=this.a.d.a;c.style.backgroundColor=S(this.vf);c.style.vi=S(new v(255,255,255,255));var f=a+"_Left";b=a+"_Right";a+="_Slider";this.a.rb=this.ea(c,f);this.a.Ve=this.ea(c,b);this.a.Ye=this.ea(c,a);a=C(f);K(a.h,this.Ma,this.hb,500,this.hb,!0,!0,!1,!0,-1,-1);a.l=L|O|Q|R;this.a.d.k(a);a.a.style.background=S(this.Lh);a=C(b);K(a.h,500,this.hb,this.Ma,this.hb,!1,!0,!0,!0,-1,-1);a.l=L|O|Q|R;this.a.d.k(a);a.a.style.background=S(this.Nh);this.q();Sb(this,d)};Ob.prototype.q=function(){var a=this.a.d.a.clientWidth,b=this.a.d.a.clientHeight;this.H=a-2*this.Ma;this.a.d.sa(a,b);this.Ca(a,b);Sb(this,this.Ub,!0)};Ob.prototype.Ca=function(a,b){var c=b-2*this.hb;this.rd=c;var d=this.a.Ye;d.style.width=c+"px";d.style.height=c+"px";d.style.display="block";d.style.position="absolute";d.style.backgroundColor=S(this.Oh);d.style.top=this.hb+"px";d.style.left=this.Ma+"px";$b(d,this.Ma,a-this.Ma-c,this.hb,this.hb);d.oa=this.Qh;d.Wd=this.Mf;d.Vd=this.Sh;d=this.a.rb;d.style.fontSize=c+"px";d.style.color="rgb(255,255,255)";d.style.textOverflow="clip";d.style.overflow="hidden"};Ob.prototype.ea=function(a,b){var c=document.createElement("div");c.setAttribute("id",b);c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("oncontextmenu","return false;");a.appendChild(c);return c};function Sb(a,b,c){a.Ub=Math.min(1,Math.max(b,0));b=a.Ub*a.H;a.a.rb.style.width=b+"px";a.a.Ve.style.left=b+a.Ma+"px";a.a.Ve.style.width=a.H-b+"px";!1!==c&&(a.a.Ye.style.left=a.Ub*(a.H-a.rd)+a.Ma+"px")}function pc(a,b){if(a.c)switch(a.u){case Qb:var c=a.c,d=a.Ub;c.rc=d;if(c.j){var f=c.j;f.Cc&&(f=f.Cc,!0!==f.pc&&Sb(f,d,!0))}null!==c.Ab&&ub(c);b?(a.a.rb.innerText="",a.a.rb.innerHTML=""):(c=((100+19900*(1-a.c.rc))/1E3*1E3|0)/1E3,a.a.rb.innerText=c+" seconds for move",a.a.rb.innerHTML=c+" seconds for move");break;case Pb:c=a.c;d=c.va;for(f=1;0<A(d);)f++,d=d.N();d=a.Ub*(f-1);for(f=c.va;0<A(f)&&0<d;)d--,f=f.N();y(c,f)}};function Mb(a){this.j=a;this.c=null;this.a={d:null};this.Ih=new v(217,217,217,255);this.jf=[]}Mb.prototype.B=function(a,b,c){this.c=b;this.a.d=C(a);var d=this.a.d.a,f=this.a.d;d.style.backgroundColor=S(this.Ih);for(var e=0,g=c.$.length;e<g;e++){var h=c.$[e],k=null;switch(h){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:case 20:k=new nb(this.j)}if(null!==k){var l=a+e;this.ea(d,l);this.Z(f,l,e/g,(e+1)/g);k.B(l,b,h);this.jf.push(k)}}this.q()};Mb.prototype.q=function(){this.a.d.sa(this.a.d.a.clientWidth,this.a.d.a.clientHeight);for(var a=0,b=this.jf.length;a<b;a++)this.jf[a].q()};Mb.prototype.ea=function(a,b){var c=document.createElement("div");c.setAttribute("id",b);c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("oncontextmenu","return false;");a.appendChild(c);return c};Mb.prototype.Z=function(a,b,c,d){b=C(b);K(b.h,1E3*c,0,1E3*d,1E3,!1,!1,!1,!1,-1,-1);b.l=L|O|Q|R;a.k(b)};function qc(){this.a={d:null,Me:null,$f:null,Qf:null,Zb:null,pe:null,dc:null,Lb:null,Kb:null,Mb:null,pb:null,cb:null,bb:null,Qa:null};this.Mh=new v(166,166,166,255);this.Jh=new v(185,185,185,255);this.vf=new v(217,217,217,255);this.R=this.H=-1;var a=this;this.Vh=function(){var b=parseInt(a.a.d.a.style.left),c=parseInt(a.a.d.a.style.width),d=parseInt(a.a.dc.style.left);60>c-d||(a.a.d.a.style.left=b+d+"px",a.a.d.a.style.width=c-d+"px");a.a.dc.style.left="0px";a.q()};this.Yh=function(){var b=parseInt(a.a.d.a.style.width),c=parseInt(a.a.Lb.style.left)+6-b;60>b+c?a.a.Lb.style.left=b-6+"px":(a.a.d.a.style.width=b+c+"px",a.a.Lb.style.left=b+c-6+"px",a.q())};this.Rh=function(){var b=parseInt(a.a.d.a.style.height),c=parseInt(a.a.Kb.style.top)+6-b;60>b+c?a.a.Kb.style.top=b-6+"px":(a.a.d.a.style.height=b+c+"px",a.a.Kb.style.top=b+c-6+"px",a.q())};this.$h=function(){var b=parseInt(a.a.d.a.style.top),c=parseInt(a.a.d.a.style.height),d=parseInt(a.a.Mb.style.top);60>c-d?a.a.Mb.style.top="0px":(a.a.d.a.style.top=b+d+"px",a.a.d.a.style.height=c-d+"px",a.a.Mb.style.top="0px",a.q())};this.Wh=function(){var b=parseInt(a.a.d.a.style.top),c=parseInt(a.a.d.a.style.height),d=parseInt(a.a.pb.style.top);60>c-d||(a.a.d.a.style.top=b+d+"px",a.a.d.a.style.height=c-d+"px");a.a.pb.style.top="0px";b=parseInt(a.a.d.a.style.left);c=parseInt(a.a.d.a.style.width);d=parseInt(a.a.pb.style.left);60>c-d||(a.a.d.a.style.left=b+d+"px",a.a.d.a.style.width=c-d+"px");a.a.pb.style.left="0px";a.q()};this.Zh=function(){var b=parseInt(a.a.d.a.style.top),c=parseInt(a.a.d.a.style.height),d=parseInt(a.a.cb.style.top);60>c-d||(a.a.d.a.style.top=b+d+"px",a.a.d.a.style.height=c-d+"px");a.a.cb.style.top="0px";b=parseInt(a.a.d.a.style.width);c=parseInt(a.a.cb.style.left)+6-b;60>b+c?a.a.cb.style.left=b-6+"px":(a.a.d.a.style.width=b+c+"px",a.a.cb.style.left=b+c-6+"px");a.q()};this.Uh=function(){var b=parseInt(a.a.d.a.style.left),c=parseInt(a.a.d.a.style.width),d=parseInt(a.a.bb.style.left);60>c-d||(a.a.d.a.style.left=b+d+"px",a.a.d.a.style.width=c-d+"px");a.a.bb.style.left="0px";b=parseInt(a.a.d.a.style.height);c=parseInt(a.a.bb.style.top)+6-b;60>b+c?a.a.bb.style.top=b-6+"px":(a.a.d.a.style.height=b+c+"px",a.a.bb.style.top=b+c-6+"px");a.q()};this.Xh=function(){var b=parseInt(a.a.d.a.style.width),c=parseInt(a.a.Qa.style.left)+6-b;60>b+c?a.a.Qa.style.left=b-6+"px":(a.a.d.a.style.width=b+c+"px",a.a.Qa.style.left=b+c-6+"px");b=parseInt(a.a.d.a.style.height);c=parseInt(a.a.Qa.style.top)+6-b;60>b+c?a.a.Qa.style.top=b-6+"px":(a.a.d.a.style.height=b+c+"px",a.a.Qa.style.top=b+c-6+"px");a.q()}}qc.prototype.B=function(a){var b=this;this.a.d=C(a);var c=this.a.d.a,d=this.a.d;c.style.border="1px solid "+S(this.Mh);c.style.backgroundColor=S(this.vf);var f=a+"_Inner",e=U(c,f),f=C(f);K(f.h,6,29,8,8,!0,!0,!0,!0,-1,-1);f.l=L|O|Q|R;d.k(f);e.style.border="1px solid "+S(this.Jh);e.style.backgroundColor=S(new v(255,255,255,255));e.style.overflow="hidden";this.a.Me=e;this.a.$f=f;f=a+"_Caption";U(c,f);e=C(f);K(e.h,0,0,1E3,1E3,!1,!1,!1,!1,-1,30);e.l=L|O|R;d.k(e);var g=f+"_Text",f=U(c,g),g=C(g);K(g.h,15,0,55,1E3,!0,!1,!0,!1,-1,30);g.l=L|O|R|Q;e.k(g);f.innerText="Caption";f.style.fontFamily="Tahoma, Sans serif";f.style.fontSize="13pt";f.style.textAlign="center";f.style.height="29px";f.style.lineHeight="29px";f.style.overflow="hidden";f.style.textOverflow="ellipsis";f.style["-o-text-overflow"]="ellipsis";f.style.cursor="default";this.a.pe=f;f=a+"_Caption2";e=U(c,f);f=C(f);K(f.h,0,0,1E3,1E3,!1,!1,!1,!1,-1,30);f.l=L|O|R;d.k(f);this.a.Zb=e;$b(e);e.oa=function(){var a=parseInt(b.a.d.a.style.top),c=parseInt(b.a.Zb.style.top);b.a.d.a.style.left=parseInt(b.a.d.a.style.left)+parseInt(b.a.Zb.style.left)+"px";b.a.d.a.style.top=a+c+"px";b.a.Zb.style.left="0px";b.a.Zb.style.top="0px";b.q()};f=a+"_LeftHandler";e=U(c,f);f=C(f);K(f.h,0,6,1E3,6,!1,!0,!1,!0,6,-1);f.l=L|O|Q;d.k(f);e.style.cursor="w-resize";this.a.dc=e;f=a+"_RightHandler";e=U(c,f);f=C(f);K(f.h,0,6,0,6,!1,!0,!0,!0,6,-1);f.l=L|R|Q;d.k(f);e.style.cursor="w-resize";this.a.Lb=e;f=a+"_BottomHandler";e=U(c,f);f=C(f);K(f.h,6,0,6,0,!0,!1,!0,!0,-1,6);f.l=Q|R|O;d.k(f);e.style.cursor="s-resize";this.a.Kb=e;f=a+"_TopHandler";e=U(c,f);f=C(f);K(f.h,6,0,6,1E3,!0,!0,!0,!1,-1,6);f.l=L|R|O;d.k(f);e.style.cursor="s-resize";this.a.Mb=e;f=a+"_LeftTopHandler";e=U(c,f);f=C(f);K(f.h,0,0,1E3,1E3,!1,!1,!1,!1,6,6);f.l=L|O;d.k(f);e.style.cursor="se-resize";this.a.pb=e;f=a+"_RightTopHandler";e=U(c,f);f=C(f);K(f.h,0,0,0,1E3,!1,!1,!0,!1,6,6);f.l=L|R;d.k(f);e.style.cursor="ne-resize";this.a.cb=e;f=a+"_LeftBottomHandler";e=U(c,f);f=C(f);K(f.h,0,0,0,1E3,!1,!1,!1,!1,6,6);f.l=Q|O;d.k(f);e.style.cursor="ne-resize";this.a.bb=e;f=a+"_RightBottomHandler";e=U(c,f);f=C(f);K(f.h,0,0,0,1E3,!1,!1,!0,!1,6,6);f.l=Q|R;d.k(f);e.style.cursor="se-resize";this.a.Qa=e;a+="_Close";c=U(c,a);e=C(a);K(e.h,0,0,6,1E3,!1,!0,!0,!1,45,20);e.l=L|R;d.k(e);c.style.backgroundColor=S(new v(255,0,0,255));d=new nb(this.j);d.B(a,this,19);d.Bd=new v(199,80,80,255);d.Dc=new v(224,67,67,255);d.vd=new v(153,61,61,255);this.a.Qf=d;$b(this.a.dc,null,null,null,null);this.a.dc.oa=this.Vh;$b(this.a.Lb,null,null,null,null);this.a.Lb.oa=this.Yh;$b(this.a.Mb,null,null,null,null);this.a.Mb.oa=this.$h;$b(this.a.Kb,null,null,null,null);this.a.Kb.oa=this.Rh;$b(this.a.pb,null,null,null,null);this.a.pb.oa=this.Wh;$b(this.a.cb,null,null,null,null);this.a.cb.oa=this.Zh;$b(this.a.bb,null,null,null,null);this.a.bb.oa=this.Uh;$b(this.a.Qa,null,null,null,null);this.a.Qa.oa=this.Xh;this.q(!0)};qc.prototype.q=function(a){var b=this.a.d.a.clientWidth,c=this.a.d.a.clientHeight;if(b!==this.H||c!==this.R||!0===a)this.H=b,this.R=c,this.a.d.sa(b,c),this.a.Qf.q()};function wb(a){a=a.a.d.a;a.parentNode.removeChild(a)}qc.prototype.ra=function(){};function U(a,b){var c=document.createElement("div");c.setAttribute("id",b);c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("oncontextmenu","return false;");a.appendChild(c);return c}function xb(){xb.Hc.constructor.call(this);this.a.Te=null;this.a.oe=null;this.r={};this.c=null}rc(xb);xb.prototype.B=function(a,b){xb.Hc.B.call(this,a);this.c=b;this.a.pe.innerText="Game info";this.a.pe.innerHTML="Game info";var c=this.a.Me,d=this.a.$f,f=c.id,e=f+"Content",g=f+"Buttons",f=U(c,e),h=U(c,g),c=C(e);K(c.h,0,0,0,40,!0,!0,!0,!0,-1,-1);c.l=O|L|Q|R;d.k(c);var k=C(g);K(k.h,0,0,0,0,!0,!1,!0,!0,-1,40);k.l=O|Q|R;d.k(k);h.style.borderTop="1px solid rgb(172,172,172)";h.style.backgroundColor="rgb(240,240,240)";k=g+"OK";U(h,k);var l=C(k);K(l.h,0,9,85,1E3,!1,!0,!0,!1,66,21);l.l=L|R;d.k(l);l=new nb(this.j);l.B(k,this,21);this.a.Te=l;l.Af=new v(234,234,234,255);l.Bd=new v(172,172,172,255);l.xd=new v(227,240,252,255);l.Dc=new v(126,180,234,255);l.uf=new v(207,230,252,255);l.vd=new v(86,157,229,255);l.xf=new v(239,239,239,255);l.yf=new v(217,217,217,255);!0!==(b.p&16?!0:!1)&&qb(l,!1);g+="Cancel";U(h,g);h=C(g);K(h.h,0,9,11,1E3,!1,!0,!0,!1,66,21);h.l=L|R;d.k(h);d=new nb(this.j);d.B(g,this,22);this.a.oe=d;d.Af=new v(234,234,234,255);d.Bd=new v(172,172,172,255);d.xd=new v(227,240,252,255);d.Dc=new v(126,180,234,255);d.uf=new v(207,230,252,255);d.vd=new v(86,157,229,255);d.xf=new v(239,239,239,255);d.yf=new v(217,217,217,255);d=c;c=f;f=e;c.style.overflowX="hidden";c.style.overflowY="scroll";e=10;g=b.p&16?!0:!1;this.r.jh=V(this,c,d,f,"Game name",b.Id,e,g);e+=25;this.r.rh=V(this,c,d,f,"Result",b.Qd,e,g);e+=25;this.r.th=V(this,c,d,f,"Rules",b.Rd,e,g);e+=25;this.r.mh=V(this,c,d,f,"Komi",b.wc,e,g);e+=25;this.r.lh=V(this,c,d,f,"Handicap",b.qd,e,g);e+=25;this.r.yh=V(this,c,d,f,"Time settings",b.td+(""===b.Od?"":" + "+b.Od),e,g);e+=25;this.r.Zg=V(this,c,d,f,"Black",b.Cf,e,g);e+=25;this.r.$g=V(this,c,d,f,"Black rank",b.Df,e,g);e+=25;this.r.Bh=V(this,c,d,f,"White",b.Ff,e,g);e+=25;this.r.Ch=V(this,c,d,f,"White rank",b.Gf,e,g);e+=25;this.r.eh=V(this,c,d,f,"Copyright",b.Cd,e,g);e+=25;this.r.Qc=V(this,c,d,f,"Game info",b.Hd,e,g);e+=25;this.r.Date=V(this,c,d,f,"Date",b.Dd,e,g);e+=25;this.r.Event=V(this,c,d,f,"Event",b.Fd,e,g);e+=25;this.r.sh=V(this,c,d,f,"Round",b.Kd,e,g);e+=25;this.r.oh=V(this,c,d,f,"Place",b.Jd,e,g);e+=25;this.r.Yg=V(this,c,d,f,"Annotator",b.Ed,e,g);e+=25;this.r.ih=V(this,c,d,f,"Fuseki",b.Gd,e,g);e+=25;this.r.wh=V(this,c,d,f,"Source",b.Ld,e,g);e+=25;this.r.zh=V(this,c,d,f,"Transcriber",b.Md,e,g);e+=25;U(c,f+"Bottom");f=C(f+"Bottom");K(f.h,0,e,1E3,1E3,!0,!0,!1,!1,0,10);f.l=O|L|R;d.k(f);this.q(!0)};xb.prototype.q=function(a){xb.Hc.q.call(this,a);this.a.Te&&this.a.Te.q();this.a.oe&&this.a.oe.q()};xb.prototype.ea=function(a,b,c){var d=document.createElement("div");d.setAttribute("id",b);d.setAttribute("style","position:absolute;padding:0;margin:0;");d.setAttribute("oncontextmenu","return false;");d.style.fontFamily="Tahoma, Sans serif";d.style.fontSize=15*c/20+"px";d.style.lineHeight=c+"px";d.style.height=c+"px";a.appendChild(d);return d};function V(a,b,c,d,f,e,g,h){var k;k=30;d+=f;a=a.ea(b,d,20);var l=C(d);K(l.h,10,g,1E3,1E3,!0,!0,!1,!1,100,20);l.l=O|L;c.k(l);a.innerText=f;a.innerHTML=f;d+="Value";f=document.createElement("input");f.setAttribute("id",d);f.setAttribute("style","position:absolute;padding:0;margin:0;");f.setAttribute("oncontextmenu","return false;");f.setAttribute("type","text");f.style.fontFamily="Tahoma, Sans serif";f.style.fontSize="10pt";f.style.outline="none";!1===h&&(f.disabled="disabled");b.appendChild(f);b=C(d);K(b.h,110,g+1,k,1E3,!0,!0,!0,!1,-1,18);b.l=O|L|R;c.k(b);f.value=e;return f}function sc(){sc.Hc.constructor.call(this)}rc(sc);sc.prototype.B=function(a,b){xb.Hc.B.call(this,a);var c=this.a.Me;c.style.fontFamily="Tahoma, Sans serif";c.style.fontSize="16px";c.innerHTML=b;c.innerText=b};function W(){}r=W.prototype;r.fh=function(){return new tc};r.ve=function(a,b){(new Jb(a)).ve(b)};r.te=function(a,b){(new Jb(a)).te(b)};r.se=function(a,b){(new Jb(a)).se(b)};r.gh=function(a,b,c){(new hc(a)).B(b,c)};r.ue=function(a,b,c){(new Jb(a)).ue(b);b=.3;c.TutorTime&&(b=parseFloat(c.TutorTime));a.Ac=c.TutorColor&&"Black"===c.TutorColor?D:E;void 0!==b&&(a.tf=1E3*b);a.p=0;void 0!==c.NewNode&&(nc(a,{Vc:!0}),(c=c.NewNode)&&""!==c||(c="Wrong.\nOut of variants."),a.Ef=c)};r.uh=function(a,b){var c={};c.Vc=b.NewNode;c.Tc=b.Move;c.qe=b.ChangeBoardMode;c.Oe=b.LoadFile;c.Qc=b.GameInfo;nc(a,c)};r.Pb=function(a,b){var c=a.p;a.p=4294967295;a.Pb(b);a.p=c};r.q=function(a){a.q()};window.GoBoardApi=new W;W.prototype.Create_GameTree=W.prototype.fh;W.prototype.Create_SimpleBoard=W.prototype.ve;W.prototype.Create_BoardWithNavigateButtons=W.prototype.te;W.prototype.Create_BoardCommentsButtonsNavigator=W.prototype.se;W.prototype.Create_Presentation=W.prototype.gh;W.prototype.Create_Problems=W.prototype.ue;W.prototype.Set_Permissions=W.prototype.uh;W.prototype.Load_Sgf=W.prototype.Pb;W.prototype.Update_Size=W.prototype.q;var uc={};function vc(a,b,c){this.u=void 0===a?0:a;this.Qg=void 0===b?null:b;this.Lg=void 0===c?0:c}vc.prototype.la=function(){return this.Qg};vc.prototype.Ia=function(a){this.u=a};vc.prototype.cd=function(a){this.Qg=a};function wc(){Y=X=0}function v(a,b,c,d){this.v=a;this.t=b;this.s=c;this.gf="undefined"===typeof d?255:d}v.prototype={};function S(a){return"rgba("+a.v+","+a.t+","+a.s+","+a.gf/255+")"}function T(a){var b=new wc;b.f=a&255;b.g=a>>8&255;return b}function xc(a){for(var b=[],c=0,d=a.length;c<d;c++)b.push(a[c]);return b}function Ea(a){if("undefined"!=typeof a.offsetParent){for(var b=0,c=0;a;a=a.offsetParent)b+=a.offsetLeft,c+=a.offsetTop;return{f:b,g:c}}return{f:a.x,g:a.y}}function Ja(a){if("string"!=typeof a)return!1;for(var b=0;b<a.length;b++){var c=a.charCodeAt(b);if(48>c||57<c)return!1}return!0}function ib(a,b){return a>b?1:b>a?-1:0}var yc=null;function $b(a,b,c,d,f){a.onmousedown=zc;a.Ka=!0;a.Pa=!0;a.root=a;a.Ka&&isNaN(parseInt(a.root.style.left))&&(a.root.style.left="0px");a.Pa&&isNaN(parseInt(a.root.style.top))&&(a.root.style.top="350px");!a.Ka&&isNaN(parseInt(a.root.style.right))&&(a.root.style.right="0px");!a.Pa&&isNaN(parseInt(a.root.style.bottom))&&(a.root.style.bottom="0px");a.kb="undefined"!=typeof b?b:null;a.lb="undefined"!=typeof d?d:null;a.Gb="undefined"!=typeof c?c:null;a.Hb="undefined"!=typeof f?f:null;a.Wg=null;a.Xg=null;a.root.Wd=new Function;a.root.Vd=new Function;a.root.oa=new Function}function zc(a){var b=yc=this;a=Ac(a);var c=parseInt(b.Pa?b.root.style.top:b.root.style.bottom),d=parseInt(b.Ka?b.root.style.left:b.root.style.right);b.root.Wd(d,c);b.Hg=a.clientX;b.Ig=a.clientY;b.Ka?(null!=b.kb&&(b.Td=a.clientX-d+b.kb),null!=b.Gb&&(b.Hf=b.Td+b.Gb-b.kb)):(null!=b.kb&&(b.Hf=-b.kb+a.clientX+d),null!=b.Gb&&(b.Td=-b.Gb+a.clientX+d));b.Pa?(null!=b.lb&&(b.Ud=a.clientY-c+b.lb),null!=b.Hb&&(b.If=b.Ud+b.Hb-b.lb)):(null!=b.lb&&(b.If=-b.lb+a.clientY+c),null!=b.Hb&&(b.Ud=-b.Hb+a.clientY+c));document.onmousemove=Bc;document.onmouseup=Cc;return!1}function Bc(a){a=Ac(a);var b=yc,c=a.clientY;a=a.clientX;var d=parseInt(b.Pa?b.root.style.top:b.root.style.bottom),f=parseInt(b.Ka?b.root.style.left:b.root.style.right),e,g;null!=b.kb&&(a=b.Ka?Math.max(a,b.Td):Math.min(a,b.Hf));null!=b.Gb&&(a=b.Ka?Math.min(a,b.Hf):Math.max(a,b.Td));null!=b.lb&&(c=b.Pa?Math.max(c,b.Ud):Math.min(c,b.If));null!=b.Hb&&(c=b.Pa?Math.min(c,b.If):Math.max(c,b.Ud));e=f+(a-b.Hg)*(b.Ka?1:-1);g=d+(c-b.Ig)*(b.Pa?1:-1);b.Wg?e=b.Wg(d):b.Xg&&(g=b.Xg(f));null!=b.kb&&(e=Math.max(e,b.kb));null!=b.Gb&&(e=Math.min(e,b.Gb));null!=b.lb&&(g=Math.max(g,b.lb));null!=b.Hb&&(g=Math.min(g,b.Hb));yc.root.style[b.Ka?"left":"right"]=e+"px";yc.root.style[b.Pa?"top":"bottom"]=g+"px";yc.Hg=a;yc.Ig=c;yc.root.oa(e,g);return!1}function Cc(){document.onmousemove=null;document.onmouseup=null;yc.root.Vd(parseInt(yc.root.style[yc.Ka?"left":"right"]),parseInt(yc.root.style[yc.Pa?"top":"bottom"]));yc=null}function Ac(a){"undefined"==typeof a&&(a=window.event);"undefined"==typeof a.layerX&&(a.layerX=a.offsetX);"undefined"==typeof a.layerY&&(a.layerY=a.offsetY);return a}function rc(a){function b(){}b.prototype=qc.prototype;a.prototype=new b;a.prototype.constructor=a;a.Hc=qc.prototype};var G=0,D=1,E=2,Dc=2,ra=0,qa=2,Ha=460,Fa=Ha,Ia=17.51/23.61,Ga=Ia;var Ba=4,Ec=4294967295^Ba;function tc(a,b){this.ja=b;this.j=a;this.Kh=new Vb;this.Y=new Fc;this.I=this.n=null;this.i=this.va=new Gc;this.Db=this.Bb=0;this.gb=D;this.vc=this.qf=this.Og=this.Kg=this.qd=this.wc=0;this.Od=this.Gd=this.Hd=this.Id=this.Fd=this.Dd=this.Cd=this.Df=this.Ed="";this.Cf="Black";this.Jd="";this.Ff="White";this.Ld=this.Rd=this.Kd=this.Qd="";this.td=0;this.Gf=this.Md="";this.uc=Dc;this.p=4294967295;this.Ab=null;this.rc=.75;this.Jg=-1;this.Ac=G;this.tf=300;this.Ef="";this.sf=null}function ub(a){if(2&a.p){vb(a);a.j&&a.j.gg();var b=function(){0<A(a.i)&&oa(a,1);0<A(a.i)?(a.Jg=(new Date).getTime(),a.Ab=setTimeout(b,100+19900*(1-a.rc))):(a.Ab=null,a.j&&a.j.Ue())},c=100+19900*(1-a.rc)-((new Date).getTime()-a.Jg);0>=c?b():a.Ab=setTimeout(b,c)}}function vb(a){a.j&&a.j.Ue();null!==a.Ab&&(clearTimeout(a.Ab),a.Ab=null)}function Rb(a){a.I&&a.I.$a();if(a.j){a.ub();var b=a.j;b.Cc&&(b=b.Cc,!0!==b.pc&&Sb(b,a.rc,!0))}}r=tc.prototype;r.q=function(){this.j&&this.j.q()};r.ra=function(){this.n&&this.n.ra()};r.Pb=function(a){if(this.p&8){var b=new Hc(this),c=this.p;this.p=4294967295;if(void 0!==a&&""!==a){b.m=[];b.e=0;b.Vb=0;b.kf=[];b.Ua=!0;for(var d=b.xc=0,f=a.length,e=[],g=!1;d<f;){(g||32<a.charCodeAt(d))&&e.push(a.charAt(d));if(3<=e.length&&"["==e[e.length-1]){var h=e[e.length-3]+e[e.length-2];if("C"==e[e.length-2]&&"UC"!=h||"AN"==h||"BR"==h||"BT"==h||"CP"==h||"DT"==h||"EV"==h||"GN"==h||"GC"==h||"ON"==h||"OT"==h||"PB"==h||"PC"==h||"PW"==h||"RE"==h||"RO"==h||"RU"==h||"SO"==h||"TM"==h||"US"==h||"WR"==h||"WT"==h)g=!0}else g&&1<=e.length&&"]"==e[e.length-1]&&(2>e.length||"\\"!=e[e.length-2])&&(g=!1);d++}b.m=e;b.xc=b.m.length;Ic(b)||alert("Error occurs, while read SGF")}this.I&&(this.I.$a(),ja(this.I));y(this,this.va);this.p=c;this.n&&(a=this.n,null!==a.Fb&&$a(a.c.i)>=ab(a.Fb)&&bb(a.Fb))}};r.hc=function(){this.va=new Gc;this.Rd=this.Qd=this.Id="";this.wc=0;this.qd="0";this.Od=this.td="";yb(this,"Black");zb(this,"");Ab(this,"White");Bb(this,"");this.Md=this.Ld=this.Gd=this.Ed=this.Jd=this.Kd=this.Fd=this.Dd=this.Hd=this.Cd="";this.uc=0;Jc(this)};function ka(a){var b=a.p;G!==a.Ac&&nc(a,{Tc:!0});y(a,a.va);a.p=b}function la(a,b){for(var c=a.i;null!=c.O&&0<b;)c=c.O,b--;y(a,c)}function oa(a,b){if(1===b)na(a)&&gb(a);else{for(var c=0;c<b;c++)na(a);y(a,a.i)}}function ma(a){var b=a.i.O;if(null!==b){var c=b.T;0<A(b)&&0<c&&y(a,b.N(c-1))}}function pa(a){var b=a.i.O;if(null!==b){var c=b.T;c<A(b)-1&&y(a,b.N(c+1))}}r.ze=function(){for(var a=this.i;!Kc(a);){var b=a.O;if(null===b&&a!==this.va)return;a=b}a.ze();y(this,a)};r.ic=function(a){this.gb=a;this.i.ic(a)};r.Ib=function(a,b,c){this.i.Ib(a,b,c)};function fb(a,b,c){if(!(a.p&1))return!1;var d=new Gc,f=d.O=a.i;f.ya.push(d);if(!0===c||-1===f.T)f.T=f.ya.length-1;a.i=d;a.vc++;!0===b&&a.I&&(a.I.$a(),ja(a.I));return!0}r.Ic=function(a,b){this.i.Ic(a,b)};r.Jc=function(a){var b=this.i.jb;this.i.Jc(a);this.I&&""===b&&""!==a&&ja(this.I)};r.bd=function(a){var b=this.i.jb;this.i.bd(a);this.I&&(""===b&&""!==a||""!==b&&""===a)&&ja(this.I)};r.pa=function(a,b){this.i.pa(a,b)};r.Ra=function(a){this.i.pa(513,a)};r.Yb=function(a,b){this.i.Yb(a,b)};r.ae=function(a,b){this.i.Ba.xb||(this.i.Ba.xb=!0);for(var c=0,d=b.length;c<d;c++)this.i.ae(b[c],a)};r.$d=function(a){this.i.$d(a)};r.be=function(a){this.i.be(a)};r.re=function(){!0===this.i.Ba.xb&&(this.i.Ba.xb=!1,this.i.re());this.n&&(this.n.ia={},Ma(this.n))};r.Nb=function(){return this.i.Nb()};function gb(a){a.n&&(1===a.n.La&&B(a.n,0),a.n.ia={},a.dd());for(var b=0,c=a.i.ta.length;b<c;b++){var d=a.i.ta[b],f=d.la(),e=d.Lg;switch(d.u){case 1:d=T(f);Lc(a,d.f,d.g,D,!1);break;case 2:d=T(f);Lc(a,d.f,d.g,E,!1);break;case 257:for(var g=0;g<e;g++)d=T(f[g]),Mc(a,d.f,d.g,D,-1);break;case 258:for(g=0;g<e;g++)d=T(f[g]),Mc(a,d.f,d.g,E,-1);break;case 259:for(g=0;g<e;g++)d=T(f[g]),Mc(a,d.f,d.g,G,-1);break;case 260:a.gb=f;break;case 529:if(a.n)for(g=0;g<e;g++)d=T(f[g]),a.n.pa(new F(d.f,d.g,Ua,""));break;case 530:if(a.n)for(g=0;g<e;g++)d=T(f[g]),a.n.pa(new F(d.f,d.g,Xa,""));break;case 531:if(a.n)for(g=0;g<e;g++)d=T(f[g]),a.n.pa(new F(d.f,d.g,Va,""));break;case 532:if(a.n)for(g=0;g<e;g++)d=T(f[g]),a.n.pa(new F(d.f,d.g,Wa,""));break;case 533:a.n&&(d=T(f.qh),a.n.pa(new F(d.f,d.g,Ra,f.Text)));break;case 513:if(a.n)for(g=0;g<e;g++)d=T(f[g]),a.n.Ra(d.f,d.g)}}a.n&&(a.i.Nb()?(c=a.i.Oa,b=c.bc(),c=c.cc(),Pa(a.n,b,c)):Pa(a.n,-1,-1),a.i.Ba.xb&&B(a.n,1),Ma(a.n));a.j&&a.j.fd(a.i.jb);a.I&&ac(a.I,!0);a.ub();if(a.gb===a.Ac&&null===a.sf&&0<=A(a.i)){var h=a.p;a.sf=setTimeout(function(){a.p=4294967295;oa(a,1);a.p=h;a.sf=null},a.tf);a.p=0}}function Lc(a,b,c,d,f){if(0!=b||0!=c){a.ja&&!0!==f&&a.ja.qi();Mc(a,b,c,d,a.qf+1,f);var e=null;if(null!==(e=kb(a.Y,b,c,d,!1))&&0<e.Q()){b=e.Q();for(c=0;c<b;c++){var g=T(e.la(c));Mc(a,g.f,g.g,G,-1)}a.ja&&!0!==f&&a.ja.ph(e);D===d?a.Bb+=b:a.Db+=b}else if(null!==(e=lb(a.Y,b,c,d))&&0<e.Q()){b=e.Q();for(c=0;c<b;c++)g=T(e.la(c)),Mc(a,g.f,g.g,G,-1);a.ja&&!0!==f&&a.ja.ph(g_nGroupSize);D===d?a.Db+=b:a.Bb+=b}else a.Y.Eb.hc()}a.gb=D===d?E:D;a.qf++}function na(a){if(!(a.p&2)||0===A(a.i)||-1===a.i.T)return!1;a.i=a.i.N(a.i.T);a.vc++;return!0}r.dd=function(){this.n&&this.i.dd(this.uc,this.n)};r.Pc=function(){if(this.n){var a=this.Y.Pc(this.n);Ma(this.n);this.i.Ba.xb||(this.i.Ba.xb=!0);var b=this.Y,c=this.i.Ba;c.za={};for(var d=b.Q(),f=1;f<=d.g;f++)for(var e=1;e<=d.f;e++){var g=b.Ta[Ca(b,e,f)],h=(f<<8)+e;if(D===g||E===g)c.za[""+h]=g}this.Kg=a.Jb+this.Bb;this.Og=a.Rb+this.Db+this.wc;this.ub()}};function y(a,b){if(a.p&2){vb(a);Jc(a);a.Y.ba();a.ja&&a.ja.oi();var c;a:{c=!1;for(var d=b.O,f=b;null!=d;){for(var e=!1,g=0,h=A(d);g<h;g++)if(f===d.N(g)){g!==d.T&&(c=!0);mb(d,g);e=!0;break}if(!e){c=!1;break a}f=d;d=d.O}}for(a.i=a.va;a.i!=b&&0<A(a.i);){d=a.i.ta.length;for(f=0;f<d;f++)switch(h=a.i.ta[f],e=h.la(),g=h.Lg,h.u){case 1:h=T(e);Lc(a,h.f,h.g,D,!0);break;case 2:h=T(e);Lc(a,h.f,h.g,E,!0);break;case 257:for(var k=0;k<g;k++)h=T(e[k]),a.Y.V(h.f,h.g,D,-1);break;case 258:for(k=0;k<g;k++)h=T(e[k]),a.Y.V(h.f,h.g,E,-1);break;case 259:for(k=0;k<g;k++)h=T(e[k]),a.Y.V(h.f,h.g,G,-1)}if(!na(a))break}a.n&&La(a.n);gb(a);a.I&&!0===c&&ja(a.I);a.ja&&a.ja.pi()}}function sa(a,b){b!==a.uc&&(a.uc=b,a.dd())}function zb(a,b){a.Df=b;a.j&&a.j.Ag(a.Df)}function yb(a,b){a.Cf=b;a.j&&a.j.zg(a.Cf)}function Ab(a,b){a.Ff=b;a.j&&a.j.Bg(a.Ff)}function Bb(a,b){a.Gf=b;a.j&&a.j.Cg(a.Gf)}function Jc(a){a.i=a.va;a.Bb=0;a.Db=0;a.qf=0;a.vc=0;a.gb=D}function Mc(a,b,c,d,f,e){a.Y.V(b,c,d,f);a.n&&!0!==e&&ya(a.n,b,c,d)}r.ub=function(){if(this.j){var a=this.Kh,b=this.i.O;a.Za=null===this.i.O?!1:!0;a.ab=0>=A(this.i)?!1:!0;if(null!==b){var c=b.T;a.sb=c<A(b)-1?!0:!1;a.tb=0<c?!0:!1}else a.sb=!1,a.tb=!1;this.n&&(a.Ea=this.n.La);for(var b=this.va,d=c=1;0<A(b);)c++,b=b.N(),b===this.i&&(d=c);a.qg=0<c?(d-1)/(c-1):1;this.j.ub(a);this.n&&1===this.n.La?this.j.lc(this.Kg,this.Og):this.j.kc(this.Bb,this.Db)}};function nc(a,b){b&&(!0===b.Vc?a.p|=1:!1===b.Vc&&(a.p&=-2),!0===b.Tc?a.p|=2:!1===b.Tc&&(a.p&=-3),!0===b.qe?a.p|=Ba:!1===b.qe&&(a.p&=Ec),!0===b.Oe?a.p|=8:!1===b.Oe&&(a.p&=-9),!0===b.Qc?a.p|=16:!1===b.Qc&&(a.p&=-17))};"use strict;";function jb(){this.Cb=this.da=0}jb.prototype.hc=function(){this.Cb=this.da=0};jb.prototype.V=function(a,b){this.da=a;this.Cb=b};function Nc(a,b){this.pf=void 0===a?G:a;this.rf=void 0===b?-1:b}Nc.prototype.ba=function(){this.pf=G;this.rf=-1};Nc.prototype.cd=function(a){this.pf=a};Nc.prototype.la=function(){return this.pf};Nc.prototype.ye=function(){return this.rf};function Oc(){this.oc=[];this.Sb=[]}Oc.prototype.Q=function(){return this.Sb.length};Oc.prototype.la=function(a){return this.Sb[a]};function Pc(a,b,c){b=(c<<8)+b;c=0;for(var d=a.Sb.length;c<d;c++)if(a.Sb[c]==b)return!0;return!1}function Qc(){this.za={}}Qc.prototype.ba=function(){this.za={}};Qc.prototype.fc=function(a,b){var c=(b<<8)+a;if(void 0!==this.za[c])return!0;this.za[c]=1;return!1};function Rc(){this.S={};this.yc=G}Rc.prototype.ba=function(){this.S={};this.yc=G};Rc.prototype.fc=function(a,b){var c=(b<<8)+a;if(void 0!==this.S[c])return!0;this.S[c]=1;return!1};function eb(a,b,c){c=void 0===c?a.yc:c;for(var d in a.S)a=T(d|0),b.Ta[Ca(b,a.f,a.g)]=c}function Fc(a,b){this.H=void 0===a?19:a;this.R=void 0===b?19:b;this.wb=null;Sc(this);this.Eb=new jb;this.Ta=null;this.S=new Rc;this.wd=new Qc}r=Fc.prototype;r.ba=function(){for(var a=this.H*this.R,b=0;b<a;b++)this.wb[b].ba()};r.Q=function(){return{f:this.H,g:this.R}};r.V=function(a,b,c,d){a=Ca(this,a,b);this.wb[a].cd(c);void 0!==d&&null!==d&&-1!==d&&(this.wb[a].rf=d)};r.M=function(a,b){return this.wb[Ca(this,a,b)].la()};r.ye=function(a,b){return this.wb[Ca(this,a,b)].ye()};function lb(a,b,c,d){var f=new Oc;Tc(a,b,c,d,f);return 0<f.Q()?f:null}function kb(a,b,c,d,f){var e;switch(d){case D:e=E;break;case E:e=D;break;default:return null}d=new Oc;!0!==Pc(d,b+1,c)&&Tc(a,b+1,c,e,d);!0!==Pc(d,b-1,c)&&Tc(a,b-1,c,e,d);!0!==Pc(d,b,c+1)&&Tc(a,b,c+1,e,d);!0!==Pc(d,b,c-1)&&Tc(a,b,c-1,e,d);e=d.Q();if(1==e){b=(c<<8)+b;c=d.la(0);e=a.Eb;if(c===e.da&&b===e.Cb&&1==f)return null;a.Eb.V(b,c)}else if(1<e)a.Eb.hc();else if(0>=e)return null;return d}function Sc(a){var b=a.H*a.R;a.wb=Array(b);for(var c=0;c<b;c++)a.wb[c]=new Nc}function Ca(a,b,c){return(c-1)*a.H+(b-1)}function Uc(a,b,c,d,f){if(b>a.H||1>b||c>a.R||1>c)return!1;var e=a.M(b,c);return G===e?!0:d===e?Vc(a,b,c,d,f):!1}function Vc(a,b,c,d,f){var e;a:{e=(c<<8)+b;for(var g=0,h=f.oc.length;g<h;g++)if(f.oc[g]==e){e=!0;break a}f.oc.push(e);e=!1}return!0===e?!1:!0===Uc(a,b+1,c,d,f)||!0===Uc(a,b-1,c,d,f)||!0===Uc(a,b,c+1,d,f)||!0===Uc(a,b,c-1,d,f)?!0:!1}function Tc(a,b,c,d,f){b>a.H||1>b||c>a.R||1>c||d!==a.M(b,c)||(!0!==Vc(a,b,c,d,f)&&(f.Sb=f.Sb.concat(f.oc)),f.oc=[])}r.Pc=function(a){for(var b=0,c=0,d=1;d<=this.R;d++)for(var f=1;f<=this.H;f++){var e=null,g=this.Ta[Ca(this,f,d)];D===g?(e=new F(f,d,Sa,""),E===this.M(f,d)?b+=2:b++):E===g&&(e=new F(f,d,Ta,""),D===this.M(f,d)?c+=2:c++);null===e?a.Ra(f,d):a.pa(e)}return{Jb:b,Rb:c}};function Wc(a,b,c){if(!(b>a.H||1>b||c>a.R||1>c)){var d=a.M(b,c);if(G!==a.M(b,c))switch(b=a.S.yc,b){case G:a.S.yc=d;break;case D:case E:b!==d&&(a.S.yc=3)}else!1===a.S.fc(b,c)&&(Wc(a,b+1,c),Wc(a,b-1,c),Wc(a,b,c+1),Wc(a,b,c-1))}}function cb(a,b,c,d){b>a.H||1>b||c>a.R||1>c||(3-d===a.M(b,c)?d===a.Ta[Ca(a,b,c)]&&a.wd.fc(b,c):!0!==a.S.fc(b,c)&&(cb(a,b+1,c,d),cb(a,b-1,c,d),cb(a,b,c+1,d),cb(a,b,c-1,d)))}function db(a,b,c,d){if(!(b>a.H||1>b||c>a.R||1>c)&&3-d!==a.M(b,c)){if(d===a.M(b,c)){var f=a.wd,e=(c<<8)+b;void 0!==f.za[e]&&delete f.za[e]}!0!==a.S.fc(b,c)&&(db(a,b+1,c,d),db(a,b-1,c,d),db(a,b,c+1,d),db(a,b,c-1,d))}}function Da(a,b){for(var c=1;c<=a.R;c++)for(var d=1;d<=a.H;d++)G===a.M(d,c)&&(G===a.Ta[Ca(a,d,c)]||!0===b&&3===a.Ta[Ca(a,d,c)])&&(a.S.ba(),Wc(a,d,c),eb(a.S,a))};function Xc(a,b){this.ud=a;this.u=b}r=Xc.prototype;r.bc=function(){return T(this.ud).f};r.cc=function(){return T(this.ud).g};r.la=function(){return this.ud};r.cd=function(a){this.ud=a};r.Ia=function(a){this.u=a};function Gc(){this.ya=[];this.T=-1;this.O=null;this.ta=[];this.Oa=new Xc(0,G);this.jb="";this.Ba=new Yc;this.na={f:-1,g:-1,Se:-1}}r=Gc.prototype;r.ec=function(){return!0};r.ba=function(){this.ya=[];this.T=-1;this.ta=[];this.Oa=new Xc(0,G);this.jb="";this.Ba=new Yc};r.N=function(a){return void 0!==this.ya[a]?this.ya[a]:this.ya[this.T]};function mb(a,b){a.T=b>=a.ya.length?a.ya.length-1:b}function A(a){return a.ya.length}r.Nb=function(){return G===this.Oa.u?!1:!0};r.Jc=function(a){this.jb+=a};r.bd=function(a){this.jb=a};r.ae=function(a,b){this.Ba.za[""+a]=b};r.re=function(){this.Ba.za={}};r.ze=function(){for(var a=this;0<A(a);)mb(a,0),a=a.N(0)};function Kc(a){for(var b=null;null!==(b=a.O);){if(0!=b.T)return!1;a=b}return!0}r.Ob=function(){for(var a=this,b=null;null!=(b=a.O);){if(b.N(b.T)!=a)return!1;a=b}return!0};r.Ib=function(a,b,c){a=(b<<8)+a;this.ta.push(new vc(D===c?1:2,a));G===this.Oa.u&&(this.Oa.cd(a),this.Oa.Ia(c))};r.Ic=function(a,b){var c=new vc(D===a?257:E===a?258:259,xc(b),b.length);this.ta.push(c)};r.pa=function(a,b){var c=0;switch(a){case Ua:c=529;break;case za:c=uc.ni;break;case Va:c=531;break;case Wa:c=532;break;case Ra:c=533;break;case Xa:c=530}c=new vc(c,xc(b),b.length);this.ta.push(c)};r.Yb=function(a,b){this.ta.push(new vc(533,{Text:a,qh:b}))};r.ic=function(a){this.ta.push(new vc(260,a))};r.$d=function(a){this.ta.push(new vc(769,a))};r.be=function(a){this.ta.push(new vc(770,a))};r.dd=function(a,b){b.a.gd.d.a.getContext("2d").clearRect(0,0,b.b.G,b.b.A);switch(a){case Dc:Zc(this,b,-1);break;case 1:var c=this.O;null!==c&&Zc(c,b,this.Oa.la())}};function $a(a){for(var b=1,c=null;null!==(c=a.O);)b++,a=c;return b}function Zc(a,b,c){if(b)for(var d=0,f=A(a);d<f;d++){var e=a.N(d).Oa;if(G!==e.u&&c!==e.la()){var g=T(e.la()),e=b;if(e.b.F){var h=(e.b.xa/2-1)/2,k=e.b.F,l=k[g.f-1].f,g=k[g.g-1].g,k=e.a.gd.d.a.getContext("2d");k.fillStyle=S(e.Ph);k.beginPath();k.arc(l,g,h,0,2*Math.PI,!1);k.fill()}}}};function Hc(a){this.c=a;this.m=[];this.Vb=this.e=0;this.kf=[];this.Ua=!0;this.xc=0}function Ic(a){a.c.hc();if("("===a.m[0]&&";"===a.m[1])for(a.e++;a.e<a.xc&&(")"!==a.m[a.e]||0!==a.Vb);){var b=a.m[a.e];if(";"===b){1!=a.e?fb(a.c,!1,!1):a.c.i=a.c.va;a:{b=a;b.e++;for(var c=b.m[b.e],d=b.m[b.e+1];void 0!==c&&")"!==c&&";"!==c&&"("!==c;){switch(c){case "A":switch(d){case "B":$c(b,D);break;case "E":$c(b,G);break;case "W":$c(b,E);break;case "N":c=b;c.e+=3;d=Z(c);c.c.Ed=d;break;case "P":c=b;c.e+=3;Z(c);break;default:$(b)}break;case "B":switch(d){case "[":ad(b,D);break;case "R":c=b;c.e+=3;zb(c.c,Z(c));break;case "T":c=b;c.e+=3;Z(c);break;case "L":c=b;c.e+=3;c.c.$d(bd(c));break;default:$(b)}break;case "C":switch(d){case "[":c=b;c.e+=2;for(d="";"]"!==c.m[c.e]||"\\"===c.m[c.e-1];)"]"===c.m[c.e+1]&&"\\"===c.m[c.e]?(d+="]",c.e++):d+=c.m[c.e],c.e++;c.e++;c.c.Jc(d);break;case "A":c=b;c.e+=3;Z(c);break;case "P":c=b;c.e+=3;d=Z(c);c.c.Cd=d;break;case "R":cd(b,Ua);break;default:$(b)}break;case "D":switch(d){case "D":c=b;c.e+=3;d=Z(c);c.c.Dd=d;break;default:$(b)}break;case "E":switch(d){case "V":c=b;c.e+=3;d=Z(c);c.c.Fd=d;break;default:$(b)}break;case "F":switch(d){case "F":$(b);break;default:$(b)}break;case "G":switch(d){case "N":c=b;c.e+=3;d=Z(c);c.c.Id=d;break;case "C":c=b;c.e+=3;d=Z(c);c.c.Hd=d;break;case "M":c=b;c.e+=3;1!==dd(c)&&(c.Ua=!1);break;default:$(b)}break;case "H":switch(d){case "A":c=b;c.e+=3;d=dd(c);c.c.qd=d;break;default:$(b)}break;case "K":switch(d){case "M":c=b;c.e+=3;d=bd(c);c.c.wc=d;break;default:$(b)}break;case "L":switch(d){case "B":c=b;for(c.e+=3;;){d=c.m[c.e];c.e++;var f=c.m[c.e];c.e++;d=d.charCodeAt(0)-96;f=f.charCodeAt(0)-96;c.e++;for(var e="";"]"!==c.m[c.e]&&c.e<c.xc;)e+=c.m[c.e],c.e++;c.c.Yb(e,(f<<8)+d);if("]"!==c.m[c.e]){c.Ua=!1;break}c.e++;if("["!==c.m[c.e])break;c.e++}break;default:$(b)}break;case "M":switch(d){case "A":cd(b,Xa);break;default:$(b)}break;case "O":switch(d){case "N":c=b;c.e+=3;d=Z(c);c.c.Gd=d;break;case "T":c=b;c.e+=3;d=Z(c);c.c.Od=d;break;default:$(b)}break;case "P":switch(d){case "B":c=b;c.e+=3;yb(c.c,Z(c));break;case "C":c=b;c.e+=3;d=Z(c);c.c.Jd=d;break;case "W":c=b;c.e+=3;Ab(c.c,Z(c));break;case "L":c=b;c.e+=3;"W"===Z(c)?c.c.ic(E):c.c.ic(D);break;default:$(b)}break;case "R":switch(d){case "E":c=b;c.e+=3;d=Z(c);c.c.Qd=d;break;case "O":c=b;c.e+=3;d=Z(c);c.c.Kd=d;break;case "U":c=b;c.e+=3;d=Z(c);c.c.Rd=d;break;default:$(b)}break;case "S":switch(d){case "Q":cd(b,Va);break;case "T":c=b;c.e+=3;switch(dd(c)){case 0:sa(c.c,Dc);break;case 1:sa(c.c,1);break;default:sa(c.c,0)}break;case "Z":c=b;c.e+=3;f=dd(c);0>=f&&(f=19);c=c.c;d=f;f=d=Math.max(d,f,2);e=c.Y.Q();if(d!==e.f||f!==e.g)e=c.Y,e.H=d,e.R=f,Sc(e),e.Eb.hc(),c.n&&(c=c.n,ta(c),c.Ca(!0));break;case "O":c=b;c.e+=3;d=Z(c);c.c.Ld=d;break;default:$(b)}break;case "T":switch(d){case "R":cd(b,Wa);break;case "M":c=b;c.e+=3;d=Z(c);c.c.td=d;break;case "B":ed(b,D);break;case "W":ed(b,E);break;default:$(b)}break;case "U":switch(d){case "S":c=b;c.e+=3;d=Z(c);c.c.Md=d;break;default:$(b)}break;case "W":switch(d){case "[":ad(b,E);break;case "R":c=b;c.e+=3;Bb(c.c,Z(c));break;case "T":c=b;c.e+=3;Z(c);break;case "L":c=b;c.e+=3;c.c.be(bd(c));break;default:$(b)}break;default:$(b)}if(!b.Ua){b=!1;break a}c=b.m[b.e];d=b.m[b.e+1]}b=!0}if(!b)return!1}else if("("===b)a.kf[a.Vb]=a.c.i,a.Vb++,a.e++;else if(")"===b)a.Vb--,a.c.i=a.kf[a.Vb],a.e++;else return!1}else return!1;return!0}function Z(a,b){void 0===b&&(b="]");for(var c="";void 0!==a.m[a.e]&&b!==a.m[a.e];)c+=a.m[a.e],a.e++;void 0===a.m[a.e]&&(a.Ua=!1);a.e++;return c}function bd(a){a=parseFloat(Z(a,void 0));return isNaN(a)?0:a}function dd(a){a=parseInt(Z(a,void 0));return isNaN(a)?0:a}function $(a){for(;;){for(;void 0!==a.m[a.e]&&"]"!==a.m[a.e]&&a.e<a.xc;)for(a.e++;"]"===a.m[a.e]&&"\\"===a.m[a.e-1];)a.e++;a.e++;if("["!==a.m[a.e])break}}function $c(a,b){a.e+=3;var c=[];if("]"!==a.m[a.e]){for(;;){var d=a.m[a.e];a.e++;var f=a.m[a.e];a.e++;var e=d.charCodeAt(0)-96,g=f.charCodeAt(0)-96;if(":"===a.m[a.e])for(a.e++,d=a.m[a.e],a.e++,f=a.m[a.e],a.e++,d=d.charCodeAt(0)-96,f=f.charCodeAt(0)-96;g<=f;g++)for(var h=e;h<=d;h++)c.push((g<<8)+h);else c.push((g<<8)+e);if("]"!==a.m[a.e]){a.Ua=!1;return}a.e++;if("["!==a.m[a.e])break;a.e++}a.c.Ic(b,c)}}function ad(a,b){a.e+=2;if("]"==a.m[a.e])a.c.Ib(0,0,b);else{var c=a.m[a.e];a.e++;var d=a.m[a.e];a.e++;var f=a.c.Y.Q();"t"===c&&"t"===d&&19>=f.f&&19>=f.g?a.c.Ib(0,0,b):(a.c.Ib(c.charCodeAt(0)-96,d.charCodeAt(0)-96,b),"]"!==a.m[a.e]&&(a.Ua=!1))}a.e++}function cd(a,b){a.e+=3;var c=[];if("]"!==a.m[a.e]){for(;;){var d=a.m[a.e];a.e++;var f=a.m[a.e];a.e++;var e=d.charCodeAt(0)-96,g=f.charCodeAt(0)-96;if(":"===a.m[a.e])for(a.e++,d=a.m[a.e],a.e++,f=a.m[a.e],a.e++,d=d.charCodeAt(0)-96,f=f.charCodeAt(0)-96;g<=f;g++)for(var h=e;h<=d;h++)c.push((g<<8)+h);else c.push((g<<8)+e);if("]"!==a.m[a.e]){a.Ua=!1;return}a.e++;if("["!==a.m[a.e])break;a.e++}a.c.pa(b,c)}}function ed(a,b){a.e+=3;var c=[];if("]"!==a.m[a.e]){for(;;){var d=a.m[a.e];a.e++;var f=a.m[a.e];a.e++;var e=d.charCodeAt(0)-96,g=f.charCodeAt(0)-96;if(":"===a.m[a.e])for(a.e++,d=a.m[a.e],a.e++,f=a.m[a.e],a.e++,d=d.charCodeAt(0)-96,f=f.charCodeAt(0)-96;g<=f;g++)for(var h=e;h<=d;h++)c.push((g<<8)+h);else c.push((g<<8)+e);if("]"!==a.m[a.e]){a.Ua=!1;return}a.e++;if("["!==a.m[a.e])break;a.e++}a.c.ae(b,c)}};function Yc(){this.xb=!1;this.za={}};}());