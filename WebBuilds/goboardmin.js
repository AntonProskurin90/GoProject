/*
 * Copyright (C) 2014  Ilya Kirillov 
 * email: ilya_kirillov@inbox.ru
 * 
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 3.0 of the License, or (at your option) any later version.
 * 
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
*/
(function(){var n;function aa(){this.o=this.d=null;this.na=0;this.Za=!1;this.mc=this.$a=this.ab=this.xa=this.ya=0;this.Ia=null;this.c={R:0,t:0,Q:0,Kc:0,Cc:2,p:null,Bc:null,w:null,Pb:null,hc:[],Sc:Array(361),nb:null,Ab:null,Va:null,Wa:null,Pc:null,Qc:null,Lc:null,Mc:null,Nc:null,Oc:null,Ec:null,yc:null,zc:null};this.oc=new q(231,188,95,255);this.Xc=new q(0,0,0,255);this.wd=new q(255,0,0,128);this.Ja={cd:new q(232,196,115,255),od:new q(255,255,255,255),bd:new q(0,0,0,255),ld:new q(141,141,141,255),fd:new q(112,95,54,255),gd:new q(112,95,54,255)};this.b={g:null,w:{g:null},p:{g:null},Ua:{g:null},ea:{g:null},zb:{g:null},Y:{g:null},xb:{g:null},Event:{g:null}};this.aa={e:-1,f:-1};this.C={};this.Ib=-1;var a=this;this.Bd=function(c){ea(c);c=fa(a);c=ga(a,c.e,c.f);ha(a,c.e,c.f,!1)};this.vc=function(c){ea(c);qa(a)};this.uc=function(c){if(c.pageX||c.pageY)t.e=c.pageX,t.f=c.pageY;else if(c.clientX||c.clientY)t.e=c.clientX,t.f=c.clientY;t.Fc=t.e;t.Gc=t.f;t.mb=c.altKey;t.F=c.shiftKey;t.M=c.ctrlKey||c.metaKey;t.Rc=ra;t.xc=c.button;t.N=c.srcElement?c.srcElement:c.target;var b=(new Date).getTime();0==t.Na?(t.Na=1,t.Ra=b):500>b-t.Ra?(t.Ra=b,t.Na++):(t.Na=1,t.Ra=b);window.Tc=!1;a.b.Event.g.b.focus();b=fa(a);b=ga(a,b.e,b.f);a.tc(b.e,b.f,t);c.preventDefault();c.stopPropagation();return!1};this.zd=function(c){sa(c);if(16===u.tb&&2===a.na)t.F=!0,ta(a);else{var b=u,d=b.tb;if(8===d||46===d){if(b=a.d,d=b.h.K,null!==d)for(var f=0,e=d.q.length;f<e;f++)if(b.h===va(d,f)){e=d;e.q.splice(f,1);e.J>=f&&e.J--; -1===e.J&&0<e.q.length&&(e.J=0);b.h=d;y(b,d);break}}else if(13===d)b=prompt("Enter here code of ur sgf file",""),a.d.Sa(b);else if(37===d)b.M&&b.F?(b=a.d,y(b,b.U)):b.M?wa(a.d,5):wa(a.d,1);else if(38===d)b.M?a.d.qb():xa(a.d);else if(39===d)if(b.M&&b.F){for(b=a.d;ya(b););y(b,b.h)}else b.M?Ga(a.d,5):Ga(a.d,1);else 40===d?Ha(a.d):112===d?z(a,0):113===d?z(a,1):114===d?z(a,2):115===d?z(a,3):116===d?z(a,4):117===d?z(a,5):118===d?z(a,6):119===d?z(a,7):120===d?z(a,8):189===d?(b=a.d.Fb,b++,b>Ia&&(b=Ja),Ka(a.d,b)):192===d&&(b=!0===a.Za?!1:!0,b!==a.Za&&(a.Za=b,La(a),a.Ka(!0)))}c.preventDefault()};this.Ad=function(c){sa(c);16===u.tb&&2===a.na&&(t.F=!1,ta(a))};this.Ed=function(){return setTimeout(function(){var c=a.b.w.g.b.width,b=a.b.w.g.b.height,d=a.b.w.g.b.getContext("2d");if(0!==c&&0!==b){for(var f=d.createImageData(c,b),e=.9,g=a.oc.Ca,h=a.oc.va,m=a.oc.ua,k=Array(c),l=0;l<c;l++)k[l]=(Math.tan(300*l/c)+1)/2+(Math.tan(100*l/c)+1)/10;for(var p=Array(b),r=0;r<b;r++)p[r]=.02*Math.tan(r/b);for(var D,I,Gb,r=0;r<b;r++)for(l=0;l<c;l++){e=40*(k[l]+p[r])+.5;e-=Math.floor(e);e=.2>e?1-e/2:.4>e?1-(.4-e)/2:1;if(r==b-1||r==b-2&&l<c-2||l>=c-1||l==c-2&&r<b-1)e/=2;0==r||1==r&&1<l||0==l||1==l&&1<r?(D=128+g*e/2,I=128+h*e/2,Gb=128+m*e/2):(D=g*e,I=h*e,Gb=m*e);var eb=4*(l+r*c);f.data[eb+0]=D;f.data[eb+1]=I;f.data[eb+2]=Gb;f.data[eb+3]=255}a.c.w=f;a.c.R=c;a.c.t=b;a.Ia=null}var fb=a.c.R,Hb=a.c.t;if(0!==fb&&0!==Hb){for(var yc=a.xa*fb,zc=a.ya*Hb,ud=a.$a*Hb,vd=a.ab*fb,Ac=a.o.A(),Bc=Array(Ac.e),Cc=yc,Dc=zc,Pa=0;Pa<Ac.e;Pa++)Cc=yc+Pa*vd,Dc=zc+Pa*ud,Bc[Pa]={e:Math.floor(Cc+.5),f:Math.floor(Dc+.5)};a.c.p=Bc;for(var V=Math.max(2,Math.ceil(a.mc*fb/2)),M=2*V+1,wd=a.c,S=a.Xc,P=document.createElement("canvas").getContext("2d").createImageData(M,M),ia=V,ja=-1,xd=ia*ia,Ec=0;ia>ja;){ja++;var Fc=Math.sqrt(xd-ja*ja),Ib=Math.ceil(Fc)-Fc;Ib<=Ec&&ia--;var ka=Math.floor(255*(1-Ib)),Jb=V+ia,Kb=V+ia,Lb=V+ja,Mb=V+ja,Nb=V-ia,Ob=V-ia,Pb=V-ja,Qb=V-ja;A(P,Jb,Mb,ka,M,S);A(P,Lb,Kb,ka,M,S);A(P,Nb,Mb,ka,M,S);A(P,Pb,Kb,ka,M,S);A(P,Jb,Qb,ka,M,S);A(P,Lb,Ob,ka,M,S);A(P,Nb,Qb,ka,M,S);A(P,Pb,Ob,ka,M,S);for(var Gc=Jb-1,Hc=Kb-1,Ic=Nb+1,Jc=Ob+1,yd=P,zd=Gc,Ad=Mb,Bd=M,Cd=S,Rb=Ic;Rb<=zd;Rb++)A(yd,Rb,Ad,255,Bd,Cd);for(var Dd=P,Ed=Hc,Fd=Lb,Gd=M,Hd=S,Sb=Jc;Sb<=Ed;Sb++)A(Dd,Fd,Sb,255,Gd,Hd);for(var Id=P,Jd=Gc,Kd=Qb,Ld=M,Md=S,Tb=Ic;Tb<=Jd;Tb++)A(Id,Tb,Kd,255,Ld,Md);for(var Nd=P,Od=Hc,Pd=Pb,Qd=M,Rd=S,Ub=Jc;Ub<=Od;Ub++)A(Nd,Pd,Ub,255,Qd,Rd);Ec=Ib}wd.Bc=P;a.c.Cc=V}var ba=a.b.w.g.b.width,za=a.b.w.g.b.height,Qa=a.b.Ua.g.b.getContext("2d"),E=2*Math.floor(Math.floor(a.ab*ba)/2)+1;a.c.Q=E;a.c.Pb=Qa.createImageData(E,E);a.c.nd=Qa.createImageData(E,E);a.c.nb=Qa.createImageData(E,E);a.c.Ab=Qa.createImageData(E,E);for(var la=a.c.Pb.data,Q=a.c.nd.data,ma=a.c.nb.data,ca=a.c.Ab.data,Vb=E/2-.5,gb=Vb-.2,Sd=Math.sqrt(3),na=0;na<E;na++)for(var oa=0;oa<E;oa++){var Aa=na-Vb,Ba=oa-Vb,Ra=gb-Math.sqrt(Aa*Aa+Ba*Ba),s=4*(na*E+E-oa-1);if(0<=Ra){var Ca=gb*gb-Aa*Aa-Ba*Ba,Ca=0<Ca?Math.sqrt(Ca)*Sd:0,Wb=Aa,Xb=Ba,Da=Math.sqrt(6*(Wb*Wb+Xb*Xb+Ca*Ca)),Da=(2*Ca-Wb+Xb)/Da,Yb=0;.9<Da&&(Yb=10*(Da-.9));var Sa=255;if(.8>=Ra){var Ra=(.8-Ra)/.8,Kc=.7;Aa-Ba<gb/3&&(Kc=1);Sa=parseInt(255*(1-Ra*Kc))}var R=parseInt(10+10*Da+140*Yb);la[s+0]=R;la[s+1]=R;la[s+2]=R;la[s+3]=Sa;ma[s+0]=R;ma[s+1]=R;ma[s+2]=R;ma[s+3]=parseInt(Sa/2);R=parseInt(200+10*Da+45*Yb);Q[s+0]=R;Q[s+1]=R;Q[s+2]=R;Q[s+3]=Sa;ca[s+0]=R;ca[s+1]=R;ca[s+2]=R;ca[s+3]=parseInt(Sa/2)}else la[s+0]=0,la[s+1]=0,la[s+2]=0,la[s+3]=0,ma[s+0]=0,ma[s+1]=0,ma[s+2]=0,ma[s+3]=0,Q[s+0]=0,Q[s+1]=0,Q[s+2]=0,Q[s+3]=0,ca[s+0]=0,ca[s+1]=0,ca[s+2]=0,ca[s+3]=0}for(var Zb=[],da=[],s=0;28>s;s++)for(Zb[s]=Qa.createImageData(E,E),da[s]=Zb[s].data,na=0;na<E;na++)for(oa=0;oa<E;oa++){var pa=4*(na*E+oa);da[s][pa+0]=Q[pa+0];da[s][pa+1]=Q[pa+1];da[s][pa+2]=Q[pa+2];da[s][pa+3]=Q[pa+3]}da.push(ca);da.push(Q);for(var N=.9,Lc=Array(ba),J=0;J<ba;J++)Lc[J]=(Math.sin(18*J/ba)+1)/20+(Math.sin(3*J/ba)+1)/10;for(var Mc=Array(za),K=0;K<za;K++)Mc[K]=.2*Math.cos(5*K/za)+.1*Math.sin(11*K/za);for(var Nc=Array(ba*za),K=0;K<za;K++)for(J=0;J<ba;J++)N=75*(Lc[J]+Mc[K])+.5,N-=Math.floor(N),N=.2>N?1-N/2:.4>N?1-(.4-N)/2:1,Nc[J+K*ba]=N;for(var Oc=a.c.p,Pc=(a.c.Q-1)/2,Td=da.length,hb=0;hb<Td;hb++){var Ea=da[hb],w=0,x=0;switch(hb){case 0:w=0;x=3;break;case 1:w=0;x=4;break;case 2:w=0;x=5;break;case 3:w=0;x=6;break;case 4:w=1;x=3;break;case 5:w=1;x=4;break;case 6:w=1;x=5;break;case 7:w=1;x=6;break;case 8:w=2;x=3;break;case 9:w=2;x=4;break;case 10:w=2;x=5;break;case 11:w=2;x=6;break;case 12:x=w=3;break;case 13:w=3;x=4;break;case 14:w=3;x=5;break;case 15:w=3;x=6;break;case 16:w=4;x=3;break;case 17:x=w=4;break;case 18:w=4;x=5;break;case 19:w=4;x=6;break;case 20:w=5;x=3;break;case 21:w=5;x=4;break;case 22:x=w=5;break;case 23:w=5;x=6;break;case 24:w=6;x=3;break;case 25:w=6;x=4;break;case 26:w=6;x=5;break;case 27:x=w=6}for(var Ud=Oc[w].e-Pc,Vd=Oc[x].f-Pc,K=0;K<E;K++)for(J=0;J<E;J++){var N=Nc[Ud+J+(Vd+K)*ba],Fa=4*(J+K*E);Ea[Fa+0]*=N;Ea[Fa+1]*=N;Ea[Fa+2]*=N}}a.c.hc=Zb;for(var $b=0;19>$b;$b++)for(var ac=0;19>ac;ac++)a.c.Sc[ac+19*$b]=Math.floor(Math.random()*(a.c.hc.length-1));var Wd=a.b.ea.g.b.getContext("2d"),ua=a.c.Q;a.c.ea=Wd.createImageData(ua,ua);var ib=a.c.ea.data;a.c.Kc=Math.max(parseInt(.15*ua),3);for(var bc=(ua-5)/2+1,jb=0;jb<ua;jb++)for(var kb=0;kb<ua;kb++){var Qc=Math.abs(jb-bc),Rc=Math.abs(kb-bc),Sc=Math.sqrt(Rc*Rc+Qc*Qc)/bc,Xd=1>Sc?.15+.75*(1-Sc):0,lb=4*(ua*jb+kb);ib[lb+0]=0;ib[lb+1]=0;ib[lb+2]=0;ib[lb+3]=parseInt(255*Xd)}var v=a.c.Q;a.c.Va=Ma(a,v,v,.05*v,new q(0,0,0,255));a.c.Wa=Ma(a,v,v,.05*v,new q(255,255,255,255));a.c.Pc=a.ia(v,v,.05*v,new q(0,0,0,255));a.c.Qc=a.ia(v,v,.05*v,new q(255,255,255,255));a.c.Lc=Na(a,v,v,.05*v,new q(0,0,0,255));a.c.Mc=Na(a,v,v,.05*v,new q(255,255,255,255));a.c.Nc=Oa(a,v,v,new q(0,0,0,255));a.c.Oc=Oa(a,v,v,new q(255,255,255,255));a.c.Ec=Ta(a,v,v,.05*v,new q(255,0,0,255));a.c.yc=Ta(a,v,v,.05*v,new q(0,0,0,255));a.c.zc=Ta(a,v,v,.05*v,new q(255,255,255,255));a.Ka()},20)};this.xd=function(a){a.preventDefault();return!1};this.yd=function(c){c.preventDefault();if(0<c.dataTransfer.files.length&&FileReader){c=c.dataTransfer.files[0];var b=new FileReader;b.onload=function(b){a.d.Sa(b.target.result)};b.readAsText(c);Ua(a)}}}n=aa.prototype;n.Ea=function(a,c){this.d=c;this.o=c.B;this.d.l=this;this.b.g=Va(a);var b=this.b.g.b,d=a+"_BoardCanvas",f=a+"_LinesCanvas",e=a+"_ShadowsCanvas",g=a+"_StonesCanvas",h=a+"_VariantsCanvas",m=a+"_MarksCanvas",k=a+"_TargetCanvas",l=a+"_EventDiv";Wa(b,d);Wa(b,f);Wa(b,e);Wa(b,g);Wa(b,h);Wa(b,m);Wa(b,k);var b=this.sc(b,l),p=this.b.g;this.ca(this.b.w,p,d);this.ca(this.b.p,p,f);this.ca(this.b.ea,p,e);this.ca(this.b.Ua,p,g);this.ca(this.b.zb,p,h);this.ca(this.b.Y,p,m);this.ca(this.b.xb,p,k);this.ca(this.b.Event,p,l);b.onmousemove=this.Bd;b.onmouseout=this.vc;b.onmousedown=this.uc;b.onkeydown=this.zd;b.onkeyup=this.Ad;b.tabIndex=-1;b.style.Pd=!0;b.style.outline=0;b.ondragover=this.xd;b.ondrop=this.yd;return p};function Ua(a){a.b.Event.g.b.focus()}n.G=function(){var a=this.b.g.b.clientWidth,c=this.b.g.b.clientHeight;a!==c&&(c=a=Math.min(a,c));this.b.g.ma(a,c);La(this);this.Ka()};function Xa(a,c,b,d){if(a.c.p){var f=a.b.Ua.g.b.getContext("2d"),e=a.b.ea.g.b.getContext("2d"),g=a.c.Q,h=(g-1)/2,m=a.c.p,k=a.c.Kc,l=m[c-1].e-h,h=m[b-1].f-h;switch(d){case B:f.putImageData(a.c.Pb,l,h);e.putImageData(a.c.ea,l+k,h+k);break;case C:f.putImageData(a.c.hc[a.c.Sc[c-1+19*(b-1)]],l,h);e.putImageData(a.c.ea,l+k,h+k);break;default:f.clearRect(l,h,g,g),e.clearRect(l+k,h+k,g,g)}c===a.aa.e&&b===a.aa.f&&(B===d||C===d?qa(a):ta(a))}}n.da=function(a,c){var b=(c<<8)+a;delete this.C[""+b];b===this.Ib&&(this.C[""+b]=new F(a,c,Ya,""))};n.L=function(a){Za(this,a.Oa(),a.Pa(),a)};function z(a,c){if(a.na!==c){a.na=c;ta(a);if(1===c){var b=a.o;b.ga=[];for(var d=1;d<=b.u;d++)for(var f=1;f<=b.s;f++)b.ga[G(b,f,d)]=H;$a(b,!1);a.d.pb()}a.d.yb()}}function Wa(a,c){var b=document.createElement("canvas");b.setAttribute("id",c);b.setAttribute("style","position:absolute;padding:0;margin:0;");b.setAttribute("oncontextmenu","return false;");a.appendChild(b)}n.sc=function(a,c){var b=document.createElement("div");b.setAttribute("id",c);b.setAttribute("style","position:absolute;padding:0;margin:0;");b.setAttribute("oncontextmenu","return false;");a.appendChild(b);return b};n.ca=function(a,c,b){a.g=Va(b);a=a.g;ab(a.i,0,1E3,1E3,!1,-1);a.ra=bb|cb|db|mb;c.qa(a)};function fa(a){var c,b=t.e,d=t.f;c=a.b.w.g.b;if("undefined"!=typeof c.offsetParent){for(var f=a=0;c;c=c.offsetParent)a+=c.offsetLeft,f+=c.offsetTop;c=f}else a=c.x,c=c.y;return{e:b-a,f:d-c}}function La(a){var c=a.o.A(),b=c.e,d=c.f;if(!0===a.Za){var c=nb/(2*ob+b),b=(nb-b*c)/2,f=pb/(2*qb+d),d=(pb-d*f)/2;a.ya=(d+f/2)/pb;a.xa=(b+c/2)/nb}else c=nb/(2*ob+b-1),b=(nb-(b-1)*c)/2,f=pb/(2*qb+d-1),d=(pb-(d-1)*f)/2,a.ya=d/pb,a.xa=b/nb;a.ab=c/nb;a.$a=f/pb;a.mc=4/nb}n.Ka=function(a){var c=this.b.w.g.b.width,b=this.b.w.g.b.height;if(c!=this.c.R||b!=this.c.t||null===this.c.w||null!==this.Ia||!0===a){if(null!==this.Ia&&clearTimeout(this.Ia),this.Ia=this.Ed(),0!==c&&0!==b){a=this.b.w.g.b.getContext("2d");a.fillStyle=L(this.Ja.cd);a.fillRect(0,0,c,b);var d=this.b.p.g.b.getContext("2d");a=this.xa*c;var f=this.ya*b,e=this.ab*c,g=this.$a*b,h=this.o.A();d.clearRect(0,0,c,b);d.strokeStyle=L(this.Ja.gd);for(var m=c-a,k=0;k<h.f;k++){var l=f+k*g;d.beginPath();d.moveTo(a,l);d.lineTo(m,l);d.stroke()}for(var m=b-f,p=0;p<h.e;p++)l=a+p*e,d.beginPath(),d.moveTo(l,f),d.lineTo(l,m),d.stroke();if(h.e===h.f&&(9===h.e||13===h.e||19===h.e)){d.fillStyle=L(this.Ja.fd);k=Math.max(2,this.mc*c/2);p=[];switch(h.e){case 9:p=[[2,2],[2,6],[4,4],[6,2],[6,6]];break;case 13:p=[[3,3],[3,6],[3,9],[6,3],[6,6],[6,9],[9,3],[9,6],[9,9]];break;case 19:p=[[3,3],[3,9],[3,15],[9,3],[9,9],[9,15],[15,3],[15,9],[15,15]]}for(var r=0,D=p.length;r<D;r++)m=a+p[r][0]*e,l=f+p[r][1]*e,d.beginPath(),d.arc(m,l,k,0,2*Math.PI,!1),d.fill()}d=this.b.Ua.g.b.getContext("2d");d.clearRect(0,0,c,b);d.strokeStyle=L(this.Ja.ld);d.lineWidth=1;r=L(this.Ja.bd);D=L(this.Ja.od);for(k=1;k<=h.f;k++)for(p=1;p<=h.e;p++){m=O(this.o,p,k);if(B===m)d.fillStyle=r;else if(C===m)d.fillStyle=D;else continue;m=a+(p-1)*e;l=f+(k-1)*g;d.beginPath();d.arc(m,l,e/2,0,2*Math.PI,!1);d.fill();d.stroke()}this.b.ea.g.b.getContext("2d").clearRect(0,0,c,b);this.b.zb.g.b.getContext("2d").clearRect(0,0,c,b);this.b.Y.g.b.getContext("2d").clearRect(0,0,c,b);this.b.xb.g.b.getContext("2d").clearRect(0,0,c,b)}}else{this.b.w.g.b.getContext("2d").putImageData(this.c.w,0,0);if(!0===this.Za&&this.c.p){c=this.b.w.g.b.getContext("2d");b=this.c.R;g=this.c.t;a=this.o.A();for(h=0;h<a.e;h++){d=2*this.c.Q/3;f=(d-1)/2;m=this.c.p;e=m[h].e-f;m=this.ya*g/3-f;l=new String;switch(h+1){case 1:l="A";break;case 2:l="B";break;case 3:l="C";break;case 4:l="D";break;case 5:l="E";break;case 6:l="F";break;case 7:l="G";break;case 8:l="H";break;case 9:l="J";break;case 10:l="K";break;case 11:l="L";break;case 12:l="M";break;case 13:l="N";break;case 14:l="O";break;case 15:l="P";break;case 16:l="Q";break;case 17:l="R";break;case 18:l="S";break;case 19:l="T";break;case 20:l="a";break;case 21:l="b";break;case 22:l="c";break;case 23:l="d";break;case 24:l="e";break;case 25:l="f";break;case 26:l="g";break;case 27:l="h";break;case 28:l="j";break;case 29:l="k";break;case 30:l="l";break;case 31:l="m";break;case 32:l="n";break;case 33:l="o";break;case 34:l="p";break;case 35:l="q";break;case 36:l="r";break;case 37:l="s";break;case 38:l="t"}k=2*d/3;p=rb(l)?"Arial":"Helvetica, Arial, Verdana";p=k+"px "+p;c.fillStyle="rgb(0,0,0)";c.font=p;k=d/2+k/3;d=(d-c.measureText(l).width)/2;c.fillText(l,e+d,m+k);m=g-this.ya*g/3-f;c.fillText(l,e+d,m+k)}for(g=0;g<a.f;g++)d=2*this.c.Q/3,f=(d-1)/2,m=this.c.p,e=this.xa*b/3-f,m=m[g].f-f,l=a.f-g+"",k=2*d/3,p=rb(l)?"Arial":"Helvetica, Arial, Verdana",p=k+"px "+p,c.fillStyle="rgb(0,0,0)",c.font=p,k=d/2+k/3,d=(d-c.measureText(l).width)/2,c.fillText(l,e+d,m+k),e=b-this.xa*b/3-f,c.fillText(l,e+d,m+k)}sb(this);tb(this);ub(this)}};function sb(a,c){if(a.c.p){var b=a.c.R,d=a.c.t,f=a.b.p.g.b.getContext("2d"),e=a.o.A(),g=a.c.p;f.clearRect(0,0,b,d);if(e.e===e.f&&(9===e.e||13===e.e||19===e.e)){var d=a.c.Bc,h=a.c.Cc,m=[];switch(e.e){case 9:m=[[2,2],[2,6],[4,4],[6,2],[6,6]];break;case 13:m=[[3,3],[3,6],[3,9],[6,3],[6,6],[6,9],[9,3],[9,6],[9,9]];break;case 19:m=[[3,3],[3,9],[3,15],[9,3],[9,9],[9,15],[15,3],[15,9],[15,15]]}for(var k=0,l=m.length;k<l;k++)f.putImageData(d,g[m[k][0]].e-h,g[m[k][1]].f-h)}for(var h=g[0].e,m=g[g.length-1].e,k=g[0].f,l=g[g.length-1].f,p=f.createImageData(1,l-k),r=f.createImageData(m-h,1),D=a.Xc,I=0;I<l-k;I++)d=4*I,p.data[d+0]=D.Ca,p.data[d+1]=D.va,p.data[d+2]=D.ua,p.data[d+3]=D.ic;for(I=0;I<m-h;I++)d=4*I,r.data[d+0]=D.Ca,r.data[d+1]=D.va,r.data[d+2]=D.ua,r.data[d+3]=D.ic;for(I=0;I<e.e;I++)f.putImageData(p,g[I].e,g[0].f),f.putImageData(r,g[0].e,g[I].f);if(void 0!==c)for(b=(2*Math.floor(parseInt(a.$a*b)/2)+1-1)/2,e=g[1].e-g[0].e+2,h=g[1].f-g[0].f+2,d=0;d<c.length;d++)m=c[d].e,k=c[d].f,H===O(a.o,m,k)&&f.clearRect(g[m-1].e-b,g[k-1].f-b,e,h)}}function A(a,c,b,d,f,e){c=4*(c+b*f);a.data[c+0]=e.Ca;a.data[c+1]=e.va;a.data[c+2]=e.ua;a.data[c+3]=d}function tb(a){var c=a.c.R,b=a.c.t;a.b.Ua.g.b.getContext("2d").clearRect(0,0,c,b);a.b.ea.g.b.getContext("2d").clearRect(0,0,c,b);c=a.o.A();for(b=1;b<=c.f;b++)for(var d=1;d<=c.e;d++)Xa(a,d,b,O(a.o,d,b))}function ta(a){ha(a,a.aa.e,a.aa.f,!0)}function ha(a,c,b,d){var f=t;if(-1===c||-1===b||0===c||0===b)qa(a);else if(null===a.Ia&&null!==a.c.p&&(void 0===d&&(d=!1),c!==a.aa.e||b!==a.aa.f||!0===d)){a.aa.e=c;a.aa.f=b;var e=a.c.R,g=a.c.t;d=a.b.xb.g.b.getContext("2d");d.clearRect(0,0,e,g);var g=(a.c.Q-1)/2,h=a.c.p,e=h[c-1].e-g,g=h[b-1].f-g;c=O(a.o,c,b);switch(a.na){case 0:H===c&&(B===a.d.Ga?d.putImageData(a.c.nb,e,g):d.putImageData(a.c.Ab,e,g));break;case 1:B===c?d.putImageData(a.c.Wa,e,g):C===c&&d.putImageData(a.c.Va,e,g);break;case 2:B===c?d.putImageData(a.c.Wa,e,g):C===c?d.putImageData(a.c.Va,e,g):f.F?d.putImageData(a.c.Ab,e,g):d.putImageData(a.c.nb,e,g);break;default:B===c?d.putImageData(a.c.Wa,e,g):d.putImageData(a.c.Va,e,g)}}}function qa(a){var c=a.c.R,b=a.c.t;a.b.xb.g.b.getContext("2d").clearRect(0,0,c,b);a.aa.e=-1;a.aa.f=-1}function ga(a,c,b){var d=a.c.R,f=a.c.t,e=a.xa*d,g=a.ya*f,f=a.$a*f,d=a.ab*d,h=0;a=a.o.A();for(h=0;h<a.f-1&&b>g+f*h+f/2;h++);for(b=b=0;b<a.e-1&&c>e+d*b+d/2;b++);return{e:b+1,f:h+1}}function Ma(a,c,b,d,f){a=a.b.Y.g.b.getContext("2d");a.clearRect(0,0,c,b);a.strokeStyle=L(f);a.fillStyle=L(f);a.lineWidth=d;a.beginPath();a.moveTo(1*c/4,1*b/4);a.lineTo(3*c/4,3*b/4);a.moveTo(3*c/4,1*b/4);a.lineTo(1*c/4,3*b/4);a.stroke();return a.getImageData(0,0,c,b)}n.ia=function(a,c,b,d,f){void 0===f&&(f=1);var e=this.b.Y.g.b.getContext("2d");e.clearRect(0,0,a,c);e.globalAlpha=f;e.strokeStyle=L(d);e.fillStyle=L(d);e.lineWidth=b;var g=a/2;b=3*c/4;d=.1*a;f=Math.sqrt(g*g-(b-g)*(b-g))+g;g=-Math.sqrt(g*g-(b-g)*(b-g))+g;e.beginPath();e.moveTo(a/2,d);e.lineTo(f-d,b);e.lineTo(g+d,b);e.closePath();e.stroke();return e.getImageData(0,0,a,c)};function Na(a,c,b,d,f){a=a.b.Y.g.b.getContext("2d");a.clearRect(0,0,c,b);a.strokeStyle=L(f);a.fillStyle=L(f);a.lineWidth=Math.floor(d+.5);var e=c/2,g=-b/2*Math.sqrt(2)/2+b/2;f=Math.floor(Math.sqrt(e*e-(g-e)*(g-e))+e-d);e=Math.ceil(-Math.sqrt(e*e-(g-e)*(g-e))+e+d);g=Math.ceil(g+d);d=Math.floor(b/2*Math.sqrt(2)/2+b/2-d);a.beginPath();a.moveTo(f,g);a.lineTo(e,g);a.lineTo(e,d);a.lineTo(f,d);a.closePath();a.stroke();return a.getImageData(0,0,c,b)}function Oa(a,c,b,d){a=a.b.Y.g.b.getContext("2d").createImageData(c,b);for(var f=0;f<b;f++)for(var e=0;e<c;e++){var g=4*(f*c+e);f>=b/3&&f<=2*b/3&&e>=c/3&&e<=2*c/3?(a.data[g+0]=d.Ca,a.data[g+1]=d.va,a.data[g+2]=d.ua,a.data[g+3]=255):a.data[g+3]=0}return a}function Ta(a,c,b,d,f){a=a.b.Y.g.b.getContext("2d");a.clearRect(0,0,c,b);var e=c/2,g=4*d;a.strokeStyle=L(f);a.fillStyle=L(f);a.lineWidth=d;a.beginPath();a.arc(c/2,b/2,e-g,0,2*Math.PI,!1);a.stroke();return a.getImageData(0,0,c,b)}function vb(a,c,b){a=a.C[""+((b<<8)+c)];return void 0!==a?a:null}function Za(a,c,b,d){Ya===d.n?wb(a,c,b):a.C[""+((b<<8)+c)]=d}function wb(a,c,b){if(0>=c||0>=b)a.Ib=0;else{var d=(b<<8)+c;void 0===a.C[""+d]&&(a.C[""+d]=new F(c,b,Ya,""));a.Ib=d}}function ub(a){a.b.Y.g.b.getContext("2d").clearRect(0,0,a.c.R,a.c.t);var c=[],b;for(b in a.C){var d=a.C[b];xb(a,d);T===d.n&&c.push({e:d.Oa(),f:d.Pa()})}sb(a,c)}function xb(a,c){if(a.c.p){var b=c.Oa(),d=c.Pa(),f=c.n,e=a.b.Y.g.b.getContext("2d"),g=a.c.Q,h=(g-1)/2,m=a.c.p,k=m[b-1].e-h,h=m[d-1].f-h,b=O(a.o,b,d);switch(f){case yb:e.putImageData(a.c.Nc,k,h);break;case zb:e.putImageData(a.c.Oc,k,h);break;case Ya:e.putImageData(a.c.Ec,k,h);break;case Ab:e.putImageData(b===B?a.c.zc:a.c.yc,k,h);break;case Bb:e.putImageData(b===B?a.c.Mc:a.c.Lc,k,h);break;case Cb:e.putImageData(b===B?a.c.Qc:a.c.Pc,k,h);break;case Db:e.putImageData(b===B?a.c.Wa:a.c.Va,k,h);break;case T:f=c.Jb,d=2>=f.length?2*g/3:g/2,m=d+"px "+(rb(f)?"Arial":"Helvetica, Arial, Verdana"),e.fillStyle=b===B?"rgb(255,255,255)":"rgb(0,0,0)",e.font=m,e.fillText(f,k+(g-e.measureText(f).width)/2,h+(g/2+d/3))}}}n.tc=function(a,c,b){switch(this.na){case 0:if(Eb==b.xc)1<=this.d.eb&&(wa(this.d,1),Fb(this,a,c));else if(b.F&&b.M)this.d.fc(B===this.d.Ga?C:B),ta(this);else if(!0===b.M){var d=new String;switch(a){case 1:d="A";break;case 2:d="B";break;case 3:d="C";break;case 4:d="D";break;case 5:d="E";break;case 6:d="F";break;case 7:d="G";break;case 8:d="H";break;case 9:d="J";break;case 10:d="K";break;case 11:d="L";break;case 12:d="M";break;case 13:d="N";break;case 14:d="O";break;case 15:d="P";break;case 16:d="Q";break;case 17:d="R";break;case 18:d="S";break;case 19:d="T"}this.d.lb(d+c)}else if(b.F){d=this.d;d.H&&d.H.kd(!0);var f=d.h;y(d,d.U);for(b=0;1E3>b&&H===O(d.B,a,c);)Ga(d,1),b++;H===O(d.B,a,c)&&y(d,f);d.H&&d.H.kd(!1)}else Fb(this,a,c);break;case 1:if(!0===b.M)this.d.Zb(),z(this,0);else{d=this.o;f=O(d,a,c);if(H!==f)if(d.Hb.O(),b=d.ga[G(d,a,c)],B!==b&&C!==b){d.r.O();cc(d,a,c,f);for(var e in d.Hb.T)b=U(e|0),d.r.O(),dc(d,b.e,b.f,3-f),ec(d.r,d,3);$a(d,!0);d.r.O();cc(d,a,c,f);ec(d.r,d,3-f)}else d.r.O(),cc(d,a,c,f),ec(d.r,d,3),$a(d,!0);this.d.pb()}break;case 2:!0===this.d.h.rb()&&(fc(this.d),gc(this.d));d=B;H!==O(this.o,a,c)?d=H:b.F&&(d=C);Xa(this,a,c,d);this.o.P(a,c,d,-1);this.d.kb(d,[(c<<8)+a]);break;case 3:hc(this,Cb,a,c);break;case 4:hc(this,Bb,a,c);break;case 5:hc(this,Ab,a,c);break;case 6:hc(this,Db,a,c);break;case 7:a:{f=vb(this,a,c);if(null!==f&&T===f.n)this.d.da([(c<<8)+a]),this.da(a,c);else{f="";b.F&&(f=prompt("Enter the label that you want to add to board here. For best results, keep your label to one or two letters.",""));if(void 0==f||""===f||null===f){f=[];b=-1;for(d in this.C)if(e=this.C[d],T==e.n){e=e.Jb;var g=e.charCodeAt(0);1==e.length&&65<=g&&90>=g&&(f[g]=1)}for(d=65;90>=d;d++)if(void 0===f[d]||""==f[d]){b=d;break}f=-1==b?null:String.fromCharCode(b);if(null===f){alert("Sorry, all the standard labels are used up! To add more labels, you will have to shift click on the board and make up ur own labels to add.");break a}}d=new F(a,c,T,f);this.d.Ma(f,(c<<8)+a);Za(this,a,c,d)}ub(this)}break;case 8:a:{d=vb(this,a,c);if(null!==d&&T===d.n)this.d.da([(c<<8)+a]),this.da(a,c);else{d="";if(b.F){d=this.o.dc(a,c);if(-1==d){alert("Sorry, no move has been made at that location, so you can't mark it with the move number!");break a}d=""+d}if(void 0===d||""===d||null===d){d=[];b=0;for(f in this.C)e=this.C[f],T===e.n&&rb(e.Jb)&&(d[b]=parseInt(e.Jb),b++);if(0>=b)d="1";else{d.sort(ic);e=f=0;for(var g=!1,h=0;h<b;h++){if(d[h]>f+1){e=f+1;g=!0;break}f=d[h]}g||(e=f+1);d=""+e}}f=new F(a,c,T,d);this.d.Ma(d,(c<<8)+a);Za(this,a,c,f)}ub(this)}}};function hc(a,c,b,d){var f=vb(a,b,d);if(null!==f&&c===f.n){if(a.d.da([(d<<8)+b]),a.da(b,d),a.c.p){c=(a.c.Q-1)/2;var e=a.c.p,f=e[b-1].e-c,e=e[d-1].f-c;a.b.Y.g.b.getContext("2d").clearRect(f,e,2*c,2*c);c=U(a.Ib);b===c.e&&d===c.f&&(wb(a,b,d),xb(a,vb(a,b,d)))}}else f=new F(b,d,c,""),a.d.L(c,[(d<<8)+b]),Za(a,b,d,f),xb(a,f)}function Fb(a,c,b){if(H===O(a.o,c,b)){var d=B===a.d.Ga?B:C,f=!1,e=new jc,f=a.o.Ba;e.Aa=f.Aa;e.za=f.za;a.o.P(c,b,d,-1);f=null!==kc(a.o,c,b,d,!0)?!0:null!==lc(a.o,c,b,d)?!1:!0;a.o.P(c,b,H,-1);var g=a.o.Ba;g.Aa=e.Aa;g.za=e.za;if(1==f){a:{for(var e=a.d,f=(b<<8)+c,g=0,h=e.h.q.length;g<h;g++){var m=va(e.h,g),k=m.oa,l=k.n;if(f===k.I()&&d===l&&(B===d||C===d)){mc(e.h,g);e.h=m;e.eb++;break a}}fc(e,!1);e.h.Da(c,b,d);e.Od&&(e.ud.Gd(),e.m.md())}gc(a.d)}}};function nc(a){this.m=a;this.d=null;this.v=this.n=0;this.lc=!1;this.c={Ac:null,Ic:null,Dc:null,wc:null,Jc:null};this.b={g:null,ob:{g:null}};this.Yc=new q(217,217,217,255);this.vd=new q(0,0,0,255);this.pc=new q(54,101,179,255);this.qc=new q(255,255,255,255);this.sd=new q(140,140,140,255);this.u=this.s=0;var c=this;this.uc=function(){c.ad();3!==c.v&&(c.v=1,oc(c),c.tc())};this.Dd=function(){3!==c.v&&(c.v=2,oc(c))};this.Cd=function(){3!==c.v&&(1!==c.v&&(c.v=2),oc(c))};this.vc=function(){3!==c.v&&(c.v=c.lc?4:0,oc(c))};this.ad=function(){if(c.d){var a=c.d;a.l&&Ua(a.l)}}}n=nc.prototype;n.Ea=function(a,c,b){this.d=c;this.n=b;if(this.m)switch(this.n){case 1:this.m.j.Nb.push(this);break;case 2:this.m.j.Ob.push(this);break;case 3:this.m.j.ka.push(this);break;case 4:this.m.j.la.push(this);break;case 5:this.m.j.cc.push(this);break;case 6:this.m.j.bc.push(this);break;case 7:this.m.j.sa.push(this);break;case 8:this.m.j.ta.push(this);break;case 9:this.m.j.Sb.push(this);break;case 10:this.m.j.Ub.push(this);break;case 11:this.m.j.Rb.push(this);break;case 12:this.m.j.Xb.push(this);break;case 13:this.m.j.Vb.push(this);break;case 14:this.m.j.Qb.push(this);break;case 15:this.m.j.Yb.push(this);break;case 16:this.m.j.Wb.push(this);break;case 17:this.m.j.Tb.push(this)}this.b.g=Va(a);c=this.b.g.b;c.setAttribute("title",pc(this));b=document.createElement("canvas");b.setAttribute("id",a+"_canvas");b.setAttribute("style","position:absolute;padding:0;margin:0;");b.setAttribute("oncontextmenu","return false;");c.appendChild(b);this.b.ob.g=Va(a+"_canvas");a=this.b.ob.g;ab(a.i,0,1E3,1E3,!1,-1);a.ra=bb|cb|db|mb;this.b.g.qa(a);c.onmousedown=this.uc;c.onmouseup=this.Dd;c.onmouseover=this.Cd;c.onmouseout=this.vc;c.onfocus=this.ad;c.tabIndex=-1;this.G()};n.G=function(){this.s=this.b.g.b.clientWidth;this.u=this.b.g.b.clientHeight;this.b.g.ma(this.s,this.u);this.Ka()};function qc(a,c){!0===c&&3===a.v?(a.v=0,oc(a)):!1===c&&3!==a.v&&(a.v=3,oc(a))}function rc(a,c){a.lc!==c&&(a.lc=c,!0===c&&0===a.v?(a.v=4,oc(a)):!1===c&&4===a.v&&(a.v=0,oc(a)))}n.Ka=function(){var a=this.u,c=this.s;0!==c&&0!==a&&(this.c.wc=sc(this,this.pc,this.qc,c,a),this.c.Dc=sc(this,this.pc,this.qc,c,a),this.c.Ic=sc(this,this.Yc,this.vd,c,a),this.c.Ac=sc(this,this.Yc,this.sd,c,a),this.c.Jc=sc(this,this.pc,this.qc,c,a),oc(this))};function sc(a,c,b,d,f){var e=a.b.ob.g.b.getContext("2d");e.fillStyle=L(c);e.fillStyle=L(c);e.fillRect(0,0,d,f);e.fillStyle=L(b);e.strokeStyle=L(b);b=Math.min(d,f);var g=(d-b)/2,h=(f-b)/2;switch(a.n){case 1:a.ia(b,g,h,e,-1);g=Math.ceil(g+b/10+.5);h=Math.ceil(h+b/5+.5);c=Math.floor(b/10+.5);a=Math.floor(3*b/5+.5);e.fillRect(g,h,c,a);break;case 2:a.ia(b,g-b/10,h,e,-1);g=Math.ceil(g+8*b/10+.5);h=Math.ceil(h+b/5+.5);c=Math.floor(b/10+.5);a=Math.floor(3*b/5+.5);e.fillRect(g,h,c,a);break;case 3:a.ia(b,g-b/10,h,e,-1);break;case 4:a.ia(b,g-b/10,h,e,1);break;case 5:a.ia(b,g+b/10,h,e,1);g=Math.ceil(g+b/10+.5);h=Math.ceil(h+b/5+.5);c=Math.floor(b/10+.5);a=Math.floor(3*b/5+.5);e.fillRect(g,h,c,a);break;case 6:a.ia(b,g,h,e,1);g=Math.ceil(g+8*b/10+.5);h=Math.ceil(h+b/5+.5);c=Math.floor(b/10+.5);a=Math.floor(3*b/5+.5);e.fillRect(g,h,c,a);break;case 7:c=Math.ceil(g+.2*b+.5);a=Math.ceil(g+.35*b+.5);var m=Math.ceil(g+.57*b+.5),g=Math.ceil(g+.92*b+.5),k=Math.ceil(h+.2*b+.5),l=Math.ceil(h+.38*b+.5),p=Math.ceil(h+.52*b+.5),r=Math.ceil(h+.6*b+.5),D=Math.ceil(h+.68*b+.5);b=Math.ceil(h+.84*b+.5);e.beginPath();e.moveTo(c,k);e.lineTo(a,k);e.lineTo(a,p);e.lineTo(m,p);e.lineTo(m,l);e.lineTo(g,r);e.lineTo(m,b);e.lineTo(m,D);e.lineTo(c,D);e.closePath();e.fill();break;case 8:c=Math.ceil(g+.2*b+.5);a=Math.ceil(g+.35*b+.5);m=Math.ceil(g+.57*b+.5);g=Math.ceil(g+.92*b+.5);k=Math.ceil(h+.8*b+.5);l=Math.ceil(h+.62*b+.5);p=Math.ceil(h+.48*b+.5);r=Math.ceil(h+.4*b+.5);D=Math.ceil(h+(1-.68)*b+.5);b=Math.ceil(h+(1-.84)*b+.5);e.beginPath();e.moveTo(c,k);e.lineTo(a,k);e.lineTo(a,p);e.lineTo(m,p);e.lineTo(m,l);e.lineTo(g,r);e.lineTo(m,b);e.lineTo(m,D);e.lineTo(c,D);e.closePath();e.fill();break;case 9:m=Math.ceil(g+.5*b-b/10+.5);k=Math.ceil(h+.5*b-b/10+.5);c=Math.ceil(.25*b+.5);e.fillStyle=L(new q(255,255,255));e.strokeStyle=L(new q(0,0,0));e.beginPath();e.arc(m,k,c,0,2*Math.PI,!1);e.fill();e.stroke();e.fillStyle=L(new q(0,0,0));m=Math.ceil(g+.5*b+b/10+.5);k=Math.ceil(h+.5*b+b/10+.5);c=Math.ceil(.25*b+.5);e.beginPath();e.arc(m,k,c,0,2*Math.PI,!1);e.fill();break;case 10:a=e.createImageData(b,b);m=b/5|0;k=4*b/5|0;for(l=0;l<b;l++)for(p=0;p<b;p++)r=4*(l*b+p),l>=m&&l<=k&&p>=m&&p<=k?b-l>=p||l===m||l===k||p===m||p===k?(a.data[r+0]=0,a.data[r+1]=0,a.data[r+2]=0):(a.data[r+0]=255,a.data[r+1]=255,a.data[r+2]=255):(a.data[r+0]=c.Ca,a.data[r+1]=c.va,a.data[r+2]=c.ua),a.data[r+3]=255;e.putImageData(a,g,h);break;case 11:m=Math.ceil(g+.75*b+.5);k=Math.ceil(h+.125*b+.5);c=Math.ceil(.25*b+.5);a=Math.ceil(.02*b+.5);e.fillRect(m,k,c,a);m=Math.ceil(g+.875*b+.5);k=Math.ceil(h+.5);c=Math.ceil(.02*b+.5);a=Math.ceil(.25*b+.5);e.fillRect(m,k,c,a);m=Math.ceil(g+.5);k=Math.ceil(h+.875*b+.5);c=Math.ceil(.25*b+.5);a=Math.ceil(.02*b+.5);e.fillRect(m,k,c,a);m=Math.ceil(g+.5*b-b/10+.5);k=Math.ceil(h+.5*b-b/10+.5);c=Math.ceil(.25*b+.5);e.fillStyle=L(new q(255,255,255));e.strokeStyle=L(new q(0,0,0));e.beginPath();e.arc(m,k,c,0,2*Math.PI,!1);e.fill();e.stroke();e.fillStyle=L(new q(0,0,0));m=Math.ceil(g+.5*b+b/10+.5);k=Math.ceil(h+.5*b+b/10+.5);c=Math.ceil(.25*b+.5);e.beginPath();e.arc(m,k,c,0,2*Math.PI,!1);e.fill();break;case 12:k=b/2;a=3*b/4;c=.1*b;l=Math.sqrt(k*k-(a-k)*(a-k))+k;p=-Math.sqrt(k*k-(a-k)*(a-k))+k;e.lineWidth=Math.ceil(.05*b+.5);e.beginPath();e.moveTo(g+b/2,h+2*c);e.lineTo(g+l-c,h+a+c);e.lineTo(g+p+c,h+a+c);e.closePath();e.stroke();break;case 13:k=b/2;c=.05*b;m=-b/2*Math.sqrt(2)/2+b/2;a=b/2*Math.sqrt(2)/2+b/2;l=Math.sqrt(k*k-(m-k)*(m-k))+k;p=-Math.sqrt(k*k-(m-k)*(m-k))+k;k=Math.floor(g+l-c);g=Math.ceil(g+p+c);m=Math.ceil(h+m+c);h=Math.floor(h+a-c);e.lineWidth=Math.ceil(.05*b+.5);e.beginPath();e.moveTo(k,m);e.lineTo(g,m);e.lineTo(g,h);e.lineTo(k,h);e.closePath();e.stroke();break;case 14:a=.05*b;k=b/2;c=4*a;e.lineWidth=Math.ceil(a+.5);e.beginPath();e.arc(g+b/2,h+b/2,k-c,0,2*Math.PI,!1);e.stroke();break;case 15:c=g+.25*b;a=g+.75*b;k=h+.25*b;l=h+.75*b;e.lineWidth=Math.ceil(.05*b+.5);e.beginPath();e.moveTo(c,k);e.lineTo(a,l);e.moveTo(a,k);e.lineTo(c,l);e.stroke();break;case 16:c="A";a=.8*b;m=g+(b-e.measureText(c).width)/2;e.font=a+"px Arial";e.fillText(c,m,h+b/2+a/3);break;case 17:c="1",a=.8*b,m=g+(b-e.measureText(c).width)/2,e.font=a+"px Helvetica, Arial, Verdana",e.fillText(c,m,h+b/2+a/3)}return e.getImageData(0,0,d,f)}n.ia=function(a,c,b,d,f){var e=Math.ceil(c+a/5+.5);c=Math.ceil(c+4*a/5+.5);var g=Math.ceil(b+a/5+.5),h=Math.ceil(b+a/2+.5);a=Math.ceil(b+4*a/5+.5);0>f?(d.beginPath(),d.moveTo(e,h),d.lineTo(c,g),d.lineTo(c,a)):(d.beginPath(),d.moveTo(e,g),d.lineTo(c,h),d.lineTo(e,a));d.closePath();d.fill()};function oc(a){var c=a.b.ob.g.b.getContext("2d"),b=null;switch(a.v){case 2:b=a.c.Dc;break;case 1:b=a.c.wc;break;case 3:b=a.c.Ac;break;case 4:b=a.c.Jc;break;default:case 0:b=a.c.Ic}c.putImageData(b,0,0)}n.tc=function(){if(this.d)switch(this.n){case 1:var a=this.d;y(a,a.U);break;case 2:wa(this.d,5);break;case 3:wa(this.d,1);break;case 4:Ga(this.d,1);break;case 5:Ga(this.d,5);break;case 6:for(a=this.d;ya(a););y(a,a.h);break;case 7:Ha(this.d);break;case 8:xa(this.d);break;case 9:z(this.d.l,0);break;case 10:z(this.d.l,1);break;case 11:z(this.d.l,2);break;case 12:z(this.d.l,3);break;case 13:z(this.d.l,4);break;case 14:z(this.d.l,5);break;case 15:z(this.d.l,6);break;case 16:z(this.d.l,7);break;case 17:z(this.d.l,8)}};function pc(a){switch(a.n){case 1:return"Back to the start";case 2:return"Back 5 moves";case 3:return"Back";case 4:return"Forward";case 5:return"Forward 5 moves";case 6:return"Go to the end";case 7:return"Next variant";case 8:return"Previous variant";case 9:return"Moves (F1)";case 10:return"Count Scores (F2)";case 11:return"Editor (F3)";case 12:return"Triangles (F4)";case 13:return"Squares (F5)";case 14:return"Circles (F6)";case 15:return"X marks (F7)";case 16:return"Text labels (F8)";case 17:return"Numeric labels (F9)"}};function tc(){this.V=this.Z=this.$=this.X=0;this.Bb=this.Db=this.Eb=this.Cb=!1;this.La=this.pa=-1}function ab(a,c,b,d,f,e){a.X=c;a.$=0;a.Z=b;a.V=d;a.Cb=!1;a.Eb=!1;a.Db=!1;a.Bb=f;a.pa=-1;a.La=e}var cb=1,bb=2,mb=4,db=8;function uc(){this.i=new tc;this.ra=cb|bb;this.b=this.ub=this.Hc=null;this.ja=new tc;this.D=[]}uc.prototype.qa=function(a){a.ub=this;this.D[this.D.length]=a};uc.prototype.ma=function(a,c){if(null==this.ub){if(this.ja.X=0,this.ja.$=0,this.ja.Z=a,this.ja.V=c,null!=this.b)for(var b=this.D.length,d=0;d<b;d++)this.D[d].ma(a,c)}else{var f=0,e=0,g=0,h=0,f=this.ra&5,b=this.ra&10;cb==f?(f=this.i.Cb?this.i.X:this.i.X*a/1E3,g=-1!=this.i.pa?f+this.i.pa:this.i.Db?a-this.i.Z:this.i.Z*a/1E3):mb==f?(g=this.i.Db?a-this.i.Z:this.i.Z*a/1E3,f=-1!=this.i.pa?g-this.i.pa:this.i.Cb?this.i.X:this.i.X*a/1E3):(cb|mb)==f?(f=this.i.Cb?this.i.X:this.i.X*a/1E3,g=this.i.Db?a-this.i.Z:this.i.Z*a/1E3):(f=this.i.X,g=this.i.Z);bb==b?(e=this.i.Eb?this.i.$:this.i.$*c/1E3,h=-1!=this.i.La?e+this.i.La:this.i.Bb?c-this.i.V:this.i.V*c/1E3):db==b?(h=this.i.Bb?c-this.i.V:this.i.V*c/1E3,e=-1!=this.i.La?h-this.i.La:this.i.Eb?this.i.$:this.i.$*c/1E3):(bb|db)==b?(e=this.i.Eb?this.i.$:this.i.$*c/1E3,h=this.i.Bb?c-this.i.V:this.i.V*c/1E3):(e=this.i.$,h=this.i.V);g<f&&(g=f);h<e&&(h=e);-2===this.i.pa?g=f+(h-e)*g_dKoef_Board_W_to_H:-3===this.i.pa&&(f=(h-e)*g_dKoef_Board_W_to_H);this.ja.X=f;this.ja.$=e;this.ja.Z=g;this.ja.V=h;this.b.style.left=parseInt(f+.5)+"px";this.b.style.top=parseInt(e+.5)+"px";this.b.style.width=parseInt(g-f+.5)+"px";this.b.style.height=parseInt(h-e+.5)+"px";this.b.width=parseInt(g-f+.5);this.b.height=parseInt(h-e+.5);b=this.D.length;for(d=0;d<b;d++)this.D[d].ma(g-f,h-e)}};function Va(a){var c=new uc;c.Hc=a;c.b=document.getElementById(a);return c}function vc(){this.b=this.ub=null;this.t=0;this.D=[]}vc.prototype.P=function(a){this.t=a};vc.prototype.qa=function(a){a.ub=this;this.D[this.D.length]=a};vc.prototype.ma=function(a,c){var b=c-this.t,d=a;d!==b&&(b=d=Math.min(d,b));var f=(c-this.t-b)/2;this.b.style.left=parseInt((a-d)/2+.5)+"px";this.b.style.top=parseInt(f+.5)+"px";this.b.style.width=parseInt(d+.5)+"px";this.b.style.height=parseInt(b+this.t+.5)+"px";this.b.width=parseInt(d+.5);this.b.height=parseInt(b+this.t+.5);for(var f=this.D.length,e=0;e<f;e++)this.D[e].ma(d,b+this.t)};var ra=0,wc=1,Eb=2,t=new function(){this.xc=this.f=this.e=0;this.Rc=wc;this.F=this.M=this.mb=!1;this.N=null;this.Ra=-1;this.Gc=this.Fc=this.Na=0;this.ec=this.sb=!1},u=new function(){this.F=this.M=this.mb=!1;this.N=null;this.tb=this.dd=0};function sa(a){u.mb=a.altKey;u.M=void 0!==a.metaKey?a.ctrlKey||a.metaKey:a.ctrlKey;u.F=a.shiftKey;u.N=a.srcElement?a.srcElement:a.target;u.dd=a.charCode;u.tb=a.keyCode;u.Md=a.which}function ea(a){if(!a.sb||a.ec){if(a.pageX||a.pageY)t.e=a.pageX,t.f=a.pageY;else if(a.clientX||a.clientY)t.e=a.clientX,t.f=a.clientY;t.mb=a.altKey;t.F=a.shiftKey;t.M=a.ctrlKey||a.metaKey;t.Rc=wc;t.sb||(t.N=a.srcElement?a.srcElement:a.target);if(3<Math.abs(t.e-t.Fc)||3<Math.abs(t.f-t.Gc))t.Ra=-1,t.Na=0}}window.onmousemove=function(a){t.sb&&void 0!=t.N&&null!=t.N&&void 0!=t.N.onmousemove&&null!=t.N.onmousemove&&(t.ec=!0,t.N.onmousemove(a),t.ec=!1)};window.onmouseup=function(a){if(!1===window.Tc&&(window.Tc=!0,t.sb&&void 0!=t.N.onmouseup&&null!=t.N.onmouseup))t.N.onmouseup(a,!0)};var Ya=-1,Cb=0,Bb=1,Ab=2,T=3,Db=4,yb=5,zb=6;function F(a,c,b,d){this.Zc={e:void 0===a?0:a,f:void 0==c?0:c};this.n=void 0===b?Cb:b;this.Jb=void 0===d?"":d}F.prototype.Oa=function(){return this.Zc.e};F.prototype.Pa=function(){return this.Zc.f};F.prototype.gc=function(a){this.n=a};function xc(a){this.m=a;this.d=null;this.b={g:null};this.rd=new q(217,217,217,255);this.jc=[]}xc.prototype.Ea=function(a,c,b){this.d=c;this.b.g=Va(a);var d=this.b.g.b,f=this.b.g;d.style.backgroundColor=L(this.rd);for(var e=0,g=b.D.length;e<g;e++){var h=b.D[e],m=null;switch(h){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:m=new nc(this.m)}if(null!==m){var k=a+e;this.sc(d,k);this.ca(f,k,e/g,(e+1)/g);m.Ea(k,c,h);this.jc.push(m)}}this.G()};xc.prototype.G=function(){this.b.g.ma(this.b.g.b.clientWidth,this.b.g.b.clientHeight);for(var a=0,c=this.jc.length;a<c;a++)this.jc[a].G()};xc.prototype.sc=function(a,c){var b=document.createElement("div");b.setAttribute("id",c);b.setAttribute("style","position:absolute;padding:0;margin:0;");b.setAttribute("oncontextmenu","return false;");a.appendChild(b);return b};xc.prototype.ca=function(a,c,b,d){c=Va(c);ab(c.i,1E3*b,1E3*d,1E3,!1,-1);c.ra=bb|cb|db|mb;a.qa(c)};function Uc(a){if(this.d=a)a.m=this;this.jb=null;this.Ya=[];this.j={Nb:[],Ob:[],ka:[],la:[],cc:[],bc:[],sa:[],ta:[],Sb:[],Ub:[],Rb:[],Xb:[],Vb:[],Qb:[],Yb:[],Wb:[],Tb:[]};this.Uc=[]}Uc.prototype.ac=function(a){var c=new aa;c.Ea(a,this.d);Ua(c);this.Ya.push(c);this.G()};Uc.prototype.$b=function(a){var c=this.d,b=Va(a);Vc(b.b,a+"div");var d=a+"div",f=new vc;f.Hc=d;f.b=document.getElementById(d);f.P(25);var e=f.b;b.qa(f);d=a+"_Board";a+="_Toolbar";Vc(e,d);Vc(e,a);e=Va(d);ab(e.i,0,1E3,25,!0,-1);e.ra=bb|cb|mb;f.qa(e);e=new aa;e.Ea(d,c);Ua(e);d=Va(a);ab(d.i,0,1E3,0,!0,25);d.ra=cb|db|mb;f.qa(d);f=new xc(this);f.Ea(a,c,{D:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17]});this.jb=b;this.Ya.push(e);this.Ya.push(f);this.G()};Uc.prototype.G=function(){this.jb&&this.jb.ma(this.jb.b.clientWidth,this.jb.b.clientHeight);for(var a=0,c=this.Ya.length;a<c;a++)this.Ya[a].G()};function Vc(a,c){var b=document.createElement("div");b.setAttribute("id",c);b.setAttribute("style","position:absolute;padding:0;margin:0;");b.setAttribute("oncontextmenu","return false;");a.appendChild(b)}Uc.prototype.yb=function(a){for(var c=0,b=this.j.Nb.length;c<b;c++)qc(this.j.Nb[c],a.ka);c=0;for(b=this.j.Ob.length;c<b;c++)qc(this.j.Ob[c],a.ka);c=0;for(b=this.j.ka.length;c<b;c++)qc(this.j.ka[c],a.ka);c=0;for(b=this.j.la.length;c<b;c++)qc(this.j.la[c],a.la);c=0;for(b=this.j.cc.length;c<b;c++)qc(this.j.cc[c],a.la);c=0;for(b=this.j.bc.length;c<b;c++)qc(this.j.bc[c],a.la);c=0;for(b=this.j.sa.length;c<b;c++)qc(this.j.sa[c],a.sa);c=0;for(b=this.j.ta.length;c<b;c++)qc(this.j.ta[c],a.ta);c=0;for(b=this.j.Sb.length;c<b;c++)rc(this.j.Sb[c],0===a.W);c=0;for(b=this.j.Ub.length;c<b;c++)rc(this.j.Ub[c],1===a.W);c=0;for(b=this.j.Rb.length;c<b;c++)rc(this.j.Rb[c],2===a.W);c=0;for(b=this.j.Xb.length;c<b;c++)rc(this.j.Xb[c],3===a.W);c=0;for(b=this.j.Vb.length;c<b;c++)rc(this.j.Vb[c],4===a.W);c=0;for(b=this.j.Qb.length;c<b;c++)rc(this.j.Qb[c],5===a.W);c=0;for(b=this.j.Yb.length;c<b;c++)rc(this.j.Yb[c],6===a.W);c=0;for(b=this.j.Wb.length;c<b;c++)rc(this.j.Wb[c],7===a.W);c=0;for(b=this.j.Tb.length;c<b;c++)rc(this.j.Tb[c],8===a.W)};function Wc(a,c){for(var b=0,d=a.Uc.length;b<d;b++)Wc(a.Uc[b],c)};function Xc(){this.ta=this.sa=this.la=this.ka=!0;this.W=0};var Yc={};function Zc(a,c,b){this.n=void 0===a?0:a;this.$c=void 0===c?null:c;this.Wc=void 0===b?0:b}Zc.prototype.I=function(){return this.$c};Zc.prototype.gc=function(a){this.n=a};Zc.prototype.vb=function(a){this.$c=a};function $c(){Y=X=0}function q(a,c,b,d){this.Ca=a;this.va=c;this.ua=b;this.ic="undefined"===typeof d?255:d}q.prototype={};function L(a){return"rgba("+a.Ca+","+a.va+","+a.ua+","+a.ic/255+")"}function U(a){var c=new $c;c.e=a&255;c.f=a>>8&255;return c}function ad(a){for(var c=[],b=0,d=a.length;b<d;b++)c.push(a[b]);return c}function rb(a){if("string"!=typeof a)return!1;for(var c=0;c<a.length;c++){var b=a.charCodeAt(c);if(48>b||57<b)return!1}return!0}function ic(a,c){return a>c?1:c>a?-1:0};var H=0,B=1,C=2,Ja=0,Ia=2,pb=460,nb=pb,qb=17.51/23.61,ob=qb;function bd(a,c,b,d){this.ud=c;this.H=b;this.m=a;this.C=d;this.td=new Xc;this.B=new cd;this.l=null;this.Vc=[];this.U=new dd(this);this.qd=0;this.h=this.U;this.ib=this.cb=0;this.Ga=B;this.eb=this.nc=0;this.Fb=2}n=bd.prototype;n.G=function(){this.m&&this.m.G()};n.Sa=function(a){var c=new ed(this);if(void 0!==a&&""!==a){c.k=[];c.a=0;c.Ha=0;c.kc=[];c.ha=!0;for(var b=c.fb=0,d=a.length,f=[],e=!1;b<d;){(e||32<a.charCodeAt(b))&&f.push(a.charAt(b));if(3<=f.length&&"["==f[f.length-1]){var g=f[f.length-3]+f[f.length-2];if("C"==f[f.length-2]&&"UC"!=g||"AN"==g||"BR"==g||"BT"==g||"CP"==g||"DT"==g||"EV"==g||"GN"==g||"GC"==g||"ON"==g||"OT"==g||"PB"==g||"PC"==g||"PW"==g||"RE"==g||"RO"==g||"RU"==g||"SO"==g||"TM"==g||"US"==g||"WR"==g||"WT"==g)e=!0}else e&&1<=f.length&&"]"==f[f.length-1]&&(2>f.length||"\\"!=f[f.length-2])&&(e=!1);b++}c.k=f;c.fb=c.k.length;fd(c)||alert("Error occurs, while read SGF")}y(this,this.U);this.U.qb()};n.Ta=function(){this.Vc=[];this.U=new dd(this);gd(this)};function wa(a,c){for(var b=a.h;null!=b.K&&0<c;)b=b.K,c--;y(a,b)}function Ga(a,c){if(1===c)ya(a)&&gc(a);else{for(var b=0;b<c;b++)ya(a);y(a,a.h)}}function xa(a){var c=a.h.K;if(null!==c){var b=c.J;0<c.q.length&&0<b&&y(a,va(c,b-1))}}function Ha(a){var c=a.h.K;if(null!==c){var b=c.J;b<c.q.length-1&&y(a,va(c,b+1))}}n.qb=function(){for(var a=this.h;!hd(a);){var c=a.K;if(null===c&&a!==this.U)return;a=c}a.qb();y(this,a)};n.fc=function(a){this.Ga=a;this.h.fc(a)};n.Da=function(a,c,b){this.h.Da(a,c,b)};function fc(a,c){var b=new dd(a),d=b.K=a.h;d.q.push(b);d.J=d.q.length-1;a.h=b;a.eb++;!0===c&&a.m.md()}n.kb=function(a,c){this.h.kb(a,c)};n.lb=function(a){this.h.lb(a)};n.L=function(a,c){this.h.L(a,c)};n.da=function(a){this.h.L(513,a)};n.Ma=function(a,c){this.h.Ma(a,c)};n.Lb=function(a,c){this.h.ba.wa||(this.h.ba.wa=!0);for(var b=0,d=c.length;b<d;b++)this.h.Lb(c[b],a)};n.Kb=function(a){this.h.Kb(a)};n.Mb=function(a){this.h.Mb(a)};n.Zb=function(){!0===this.h.ba.wa&&(this.h.ba.wa=!1,this.h.Zb());this.l&&(this.l.C={},ub(this.l))};n.rb=function(){return this.h.rb()};function gc(a){a.l&&(1===a.l.na&&z(a.l,0),a.l.C={},a.wb());for(var c=0,b=a.h.S.length;c<b;c++){var d=a.h.S[c],f=d.I(),e=d.Wc;switch(d.n){case 1:d=U(f);id(a,d.e,d.f,B,!1);break;case 2:d=U(f);id(a,d.e,d.f,C,!1);break;case 257:for(var g=0;g<e;g++)d=U(f[g]),jd(a,d.e,d.f,B,-1);break;case 258:for(g=0;g<e;g++)d=U(f[g]),jd(a,d.e,d.f,C,-1);break;case 259:for(g=0;g<e;g++)d=U(f[g]),jd(a,d.e,d.f,H,-1);break;case 260:a.Ga=f;break;case 529:if(a.l)for(g=0;g<e;g++)d=U(f[g]),a.l.L(new F(d.e,d.f,Ab,""));break;case 530:if(a.l)for(g=0;g<e;g++)d=U(f[g]),a.l.L(new F(d.e,d.f,Db,""));break;case 531:if(a.l)for(g=0;g<e;g++)d=U(f[g]),a.l.L(new F(d.e,d.f,Bb,""));break;case 532:if(a.l)for(g=0;g<e;g++)d=U(f[g]),a.l.L(new F(d.e,d.f,Cb,""));break;case 533:a.l&&(d=U(f.jd),a.l.L(new F(d.e,d.f,T,f.Text)));break;case 513:if(a.l)for(g=0;g<e;g++)d=U(f[g]),a.l.da(d.e,d.f)}}a.l&&(a.h.ba.wa&&z(a.l,1),a.h.rb()?(b=a.h.oa,c=b.Oa(),b=b.Pa(),wb(a.l,c,b)):wb(a.l,-1,-1),ub(a.l));a.m&&Wc(a.m,a.h.rc);a.yb()}function id(a,c,b,d,f){if(0!=c||0!=b){a.H&&!0!==f&&a.H.Kd();jd(a,c,b,d,a.nc+1,f);var e=null;if(null!==(e=kc(a.B,c,b,d,!1))&&0<e.A()){c=e.A();for(b=0;b<c;b++){var g=U(e.I(b));jd(a,g.e,g.f,H,-1)}a.H&&!0!==f&&a.H.hd(e);B===d?a.cb+=c:a.ib+=c}else if(null!==(e=lc(a.B,c,b,d))&&0<e.A()){c=e.A();for(b=0;b<c;b++)g=U(e.I(b)),jd(a,g.e,g.f,H,-1);a.H&&!0!==f&&a.H.hd(g_nGroupSize);B===d?a.ib+=c:a.cb+=c}else a.B.Ba.Ta()}a.Ga=B===d?C:B;a.nc++}function ya(a){if(0===a.h.q.length||-1===a.h.J)return!1;a.h=va(a.h,a.h.J);a.eb++;return!0}n.wb=function(){this.l&&this.h.wb(this.Fb,this.l)};n.pb=function(){if(this.l){this.B.pb(this.l);ub(this.l);this.h.ba.wa||(this.h.ba.wa=!0);var a=this.B,c=this.h.ba;c.T={};for(var b=a.A(),d=1;d<=b.f;d++)for(var f=1;f<=b.e;f++){var e=a.ga[G(a,f,d)],g=(d<<8)+f;if(B===e||C===e)c.T[""+g]=e}}};function y(a,c){for(var b=a.B,d=new cd(b.s,b.u),f=b.s*b.u,e=0;e<f;e++){var g=b.fa[e],h=d.fa[e];h.bb=g.bb;h.gb=g.gb}gd(a);a.B.O();a.H&&a.H.Id();a:{b=c.K;for(d=c;null!=b;){f=!1;e=0;for(g=b.q.length;e<g;e++)if(d===va(b,e)){mc(b,e);f=!0;break}if(!f){b=!1;break a}d=b;b=b.K}b=!0}if(b){for(a.h=a.U;a.h!=c&&0<a.h.q.length;){b=a.h.S.length;for(d=0;d<b;d++)switch(g=a.h.S[d],f=g.I(),e=g.Wc,g.n){case 1:g=U(f);id(a,g.e,g.f,B,!0);break;case 2:g=U(f);id(a,g.e,g.f,C,!0);break;case 257:for(h=0;h<e;h++)g=U(f[h]),a.B.P(g.e,g.f,B,-1);break;case 258:for(h=0;h<e;h++)g=U(f[h]),a.B.P(g.e,g.f,C,-1);break;case 259:for(h=0;h<e;h++)g=U(f[h]),a.B.P(g.e,g.f,H,-1)}if(!ya(a))break}a.l&&tb(a.l);gc(a);a.H&&a.H.Jd()}}function Ka(a,c){c!==a.Fb&&(a.Fb=c,a.wb())}function gd(a){a.h=a.U;a.cb=0;a.ib=0;a.nc=0;a.eb=0}function jd(a,c,b,d,f,e){a.B.P(c,b,d,f);a.l&&!0!==e&&Xa(a.l,c,b,d)}n.yb=function(){if(this.m){var a=this.td,c=this.h.K;a.ka=null===this.h.K?!1:!0;a.la=0>=this.h.q.length?!1:!0;if(null!==c){var b=c.J;a.sa=b<c.q.length-1?!0:!1;a.ta=0<b?!0:!1}else a.sa=!1,a.ta=!1;this.l&&(a.W=this.l.na);this.m.yb(a)}};"use strict;";function jc(){this.za=this.Aa=0}jc.prototype.Ta=function(){this.za=this.Aa=0};jc.prototype.P=function(a,c){this.Aa=a;this.za=c};function kd(a,c){this.bb=void 0===a?H:a;this.gb=void 0===c?-1:c}kd.prototype.O=function(){this.bb=H;this.gb=-1};kd.prototype.vb=function(a){this.bb=a};kd.prototype.I=function(){return this.bb};kd.prototype.dc=function(){return this.gb};function ld(){this.Xa=[];this.Fa=[]}ld.prototype.A=function(){return this.Fa.length};ld.prototype.I=function(a){return this.Fa[a]};function md(a,c,b){c=(b<<8)+c;b=0;for(var d=a.Fa.length;b<d;b++)if(a.Fa[b]==c)return!0;return!1}function nd(){this.T={}}nd.prototype.O=function(){this.T={}};nd.prototype.Qa=function(a,c){var b=(c<<8)+a;if(void 0!==this.T[b])return!0;this.T[b]=1;return!1};function od(){this.r={};this.hb=H}od.prototype.O=function(){this.r={};this.hb=H};od.prototype.Qa=function(a,c){var b=(c<<8)+a;if(void 0!==this.r[b])return!0;this.r[b]=1;return!1};function ec(a,c,b){b=void 0===b?a.hb:b;for(var d in a.r)a=U(d|0),c.ga[G(c,a.e,a.f)]=b}function cd(a,c){this.s=void 0===a?19:a;this.u=void 0===c?19:c;this.fa=null;pd(this);this.Ba=new jc;this.ga=null;this.r=new od;this.Hb=new nd}n=cd.prototype;n.O=function(){for(var a=this.s*this.u,c=0;c<a;c++)this.fa[c].O()};n.A=function(){return{e:this.s,f:this.u}};n.P=function(a,c,b,d){a=G(this,a,c);this.fa[a].vb(b);void 0!==d&&null!==d&&-1!==d&&(this.fa[a].gb=d)};function O(a,c,b){return a.fa[G(a,c,b)].I()}n.dc=function(a,c){return this.fa[G(this,a,c)].dc()};function lc(a,c,b,d){var f=new ld;qd(a,c,b,d,f);return 0<f.A()?f:null}function kc(a,c,b,d,f){var e;switch(d){case B:e=C;break;case C:e=B;break;default:return null}d=new ld;!0!==md(d,c+1,b)&&qd(a,c+1,b,e,d);!0!==md(d,c-1,b)&&qd(a,c-1,b,e,d);!0!==md(d,c,b+1)&&qd(a,c,b+1,e,d);!0!==md(d,c,b-1)&&qd(a,c,b-1,e,d);e=d.A();if(1==e){c=(b<<8)+c;b=d.I(0);e=a.Ba;if(b===e.Aa&&c===e.za&&1==f)return null;a.Ba.P(c,b)}else if(1<e)a.Ba.Ta();else if(0>=e)return null;return d}function pd(a){var c=a.s*a.u;a.fa=Array(c);for(var b=0;b<c;b++)a.fa[b]=new kd}function G(a,c,b){return(b-1)*a.s+(c-1)}function rd(a,c,b,d,f){if(c>a.s||1>c||b>a.u||1>b)return!1;var e=O(a,c,b);return H===e?!0:d===e?sd(a,c,b,d,f):!1}function sd(a,c,b,d,f){var e;a:{e=(b<<8)+c;for(var g=0,h=f.Xa.length;g<h;g++)if(f.Xa[g]==e){e=!0;break a}f.Xa.push(e);e=!1}return!0===e?!1:!0===rd(a,c+1,b,d,f)||!0===rd(a,c-1,b,d,f)||!0===rd(a,c,b+1,d,f)||!0===rd(a,c,b-1,d,f)?!0:!1}function qd(a,c,b,d,f){c>a.s||1>c||b>a.u||1>b||d!==O(a,c,b)||(!0!==sd(a,c,b,d,f)&&(f.Fa=f.Fa.concat(f.Xa)),f.Xa=[])}n.pb=function(a){for(var c=0,b=0,d=1;d<=this.u;d++)for(var f=1;f<=this.s;f++){var e=null,g=this.ga[G(this,f,d)];B===g?(e=new F(f,d,yb,""),C===O(this,f,d)?c+=2:c++):C===g&&(e=new F(f,d,zb,""),B===O(this,f,d)?b+=2:b++);null===e?a.da(f,d):a.L(e)}return{Fd:c,Nd:b}};function td(a,c,b){if(!(c>a.s||1>c||b>a.u||1>b)){var d=O(a,c,b);if(H!==O(a,c,b))switch(c=a.r.hb,c){case H:a.r.hb=d;break;case B:case C:c!==d&&(a.r.hb=3)}else!1===a.r.Qa(c,b)&&(td(a,c+1,b),td(a,c-1,b),td(a,c,b+1),td(a,c,b-1))}}function cc(a,c,b,d){c>a.s||1>c||b>a.u||1>b||(3-d===O(a,c,b)?d===a.ga[G(a,c,b)]&&a.Hb.Qa(c,b):!0!==a.r.Qa(c,b)&&(cc(a,c+1,b,d),cc(a,c-1,b,d),cc(a,c,b+1,d),cc(a,c,b-1,d)))}function dc(a,c,b,d){if(!(c>a.s||1>c||b>a.u||1>b)&&3-d!==O(a,c,b)){if(d===O(a,c,b)){var f=a.Hb,e=(b<<8)+c;void 0!==f.T[e]&&delete f.T[e]}!0!==a.r.Qa(c,b)&&(dc(a,c+1,b,d),dc(a,c-1,b,d),dc(a,c,b+1,d),dc(a,c,b-1,d))}}function $a(a,c){for(var b=1;b<=a.u;b++)for(var d=1;d<=a.s;d++)H===O(a,d,b)&&(H===a.ga[G(a,d,b)]||!0===c&&3===a.ga[G(a,d,b)])&&(a.r.O(),td(a,d,b),ec(a.r,a))};function Yd(a,c){this.Gb=a;this.n=c}n=Yd.prototype;n.Oa=function(){return U(this.Gb).e};n.Pa=function(){return U(this.Gb).f};n.I=function(){return this.Gb};n.vb=function(a){this.Gb=a};n.gc=function(a){this.n=a};function dd(a){this.pd=++a.qd;this.q=[];this.J=-1;this.K=null;this.S=[];this.oa=new Yd(0,H);this.rc="";this.ba=new Zd;a.Vc[this.pd]=this}function va(a,c){return void 0!==a.q[c]?a.q[c]:a.q[a.J]}function mc(a,c){a.J=c>=a.q.length?a.q.length-1:c}n=dd.prototype;n.rb=function(){return H===this.oa.n?!1:!0};n.lb=function(a){this.rc+=a};n.Lb=function(a,c){this.ba.T[""+a]=c};n.Zb=function(){this.ba.T={}};n.qb=function(){for(var a=this;0<a.q.length;)mc(a,0),a=va(a,0)};function hd(a){for(var c=null;null!==(c=a.K);){if(0!=c.J)return!1;a=c}return!0}n.Da=function(a,c,b){a=(c<<8)+a;this.S.push(new Zc(B===b?1:2,a));H===this.oa.n&&(this.oa.vb(a),this.oa.gc(b))};n.kb=function(a,c){var b=new Zc(B===a?257:C===a?258:259,ad(c),c.length);this.S.push(b)};n.L=function(a,c){var b=0;switch(a){case Ab:b=529;break;case Ya:b=Yc.Hd;break;case Bb:b=531;break;case Cb:b=532;break;case T:b=Yc.Ld;break;case Db:b=Yc.e}b=new Zc(b,ad(c),c.length);this.S.push(b)};n.Ma=function(a,c){this.S.push(new Zc(533,{Text:a,jd:c}))};n.fc=function(a){this.S.push(new Zc(260,a))};n.Kb=function(a){this.S.push(new Zc(769,a))};n.Mb=function(a){this.S.push(new Zc(770,a))};n.wb=function(a,c){c.b.zb.g.b.getContext("2d").clearRect(0,0,c.c.R,c.c.t);switch(a){case 2:$d(this,c,-1);break;case 1:var b=this.K;null!==b&&$d(b,c,this.oa.I())}};function $d(a,c,b){if(c)for(var d=0,f=a.q.length;d<f;d++){var e=va(a,d).oa;if(H!==e.n&&b!==e.I()){var g=U(e.I()),e=c;if(e.c.p){var h=(e.c.Q/2-1)/2,m=e.c.p,k=m[g.e-1].e,g=m[g.f-1].f,m=e.b.zb.g.b.getContext("2d");m.fillStyle=L(e.wd);m.beginPath();m.arc(k,g,h,0,2*Math.PI,!1);m.fill()}}}};function ed(a){this.d=a;this.k=[];this.Ha=this.a=0;this.kc=[];this.ha=!0;this.fb=0}function fd(a){a.d.Ta();if("("===a.k[0]&&";"===a.k[1])for(a.a++;a.a<a.fb&&(")"!==a.k[a.a]||0!==a.Ha);){var c=a.k[a.a];if(";"===c){1!=a.a?fc(a.d,!1):a.d.h=a.d.U;a:{c=a;c.a++;for(var b=c.k[c.a],d=c.k[c.a+1];void 0!==b&&")"!==b&&";"!==b&&"("!==b;){switch(b){case "A":switch(d){case "B":ae(c,B);break;case "E":ae(c,H);break;case "W":ae(c,C);break;case "N":b=c;b.a+=3;W(b);break;case "P":b=c;b.a+=3;W(b);break;default:Z(c)}break;case "B":switch(d){case "[":be(c,B);break;case "R":b=c;b.a+=3;W(b);break;case "T":b=c;b.a+=3;W(b);break;case "L":b=c;b.a+=3;b.d.Kb(ce(b));break;default:Z(c)}break;case "C":switch(d){case "[":b=c;b.a+=2;for(d="";"]"!==b.k[b.a]||"\\"===b.k[b.a-1];)"]"==-b.k[b.a+1]&&"\\"===b.k[b.a]?(d+="]",b.a++):d+=b.k[b.a],b.a++;b.a++;b.d.lb(d);break;case "A":b=c;b.a+=3;W(b);break;case "P":b=c;b.a+=3;W(b);break;case "R":de(c,Ab);break;default:Z(c)}break;case "D":switch(d){case "D":b=c;b.a+=3;W(b);break;default:Z(c)}break;case "E":switch(d){case "V":b=c;b.a+=3;W(b);break;default:Z(c)}break;case "F":switch(d){case "F":Z(c);break;default:Z(c)}break;case "G":switch(d){case "N":b=c;b.a+=3;W(b);break;case "C":b=c;b.a+=3;W(b);break;case "M":b=c;b.a+=3;1!==ee(b)&&(b.ha=!1);break;default:Z(c)}break;case "H":switch(d){case "A":b=c;b.a+=3;ee(b);break;default:Z(c)}break;case "K":switch(d){case "M":b=c;b.a+=3;ce(b);break;default:Z(c)}break;case "L":switch(d){case "B":b=c;for(b.a+=3;;){d=b.k[b.a];b.a++;var f=b.k[b.a];b.a++;d=d.charCodeAt(0)-96;f=f.charCodeAt(0)-96;b.a++;for(var e="";"]"!==b.k[b.a]&&b.a<b.fb;)e+=b.k[b.a],b.a++;b.d.Ma(e,(f<<8)+d);if("]"!==b.k[b.a]){b.ha=!1;break}b.a++;if("["!==b.k[b.a])break;b.a++}break;default:Z(c)}break;case "M":switch(d){case "A":de(c,Db);break;default:Z(c)}break;case "O":switch(d){case "N":b=c;b.a+=3;W(b);break;case "T":b=c;b.a+=3;W(b);break;default:Z(c)}break;case "P":switch(d){case "B":b=c;b.a+=3;W(b);break;case "C":b=c;b.a+=3;W(b);break;case "W":b=c;b.a+=3;W(b);break;default:Z(c)}break;case "R":switch(d){case "E":b=c;b.a+=3;W(b);break;case "O":b=c;b.a+=3;W(b);break;case "U":b=c;b.a+=3;W(b);break;default:Z(c)}break;case "S":switch(d){case "Q":de(c,Bb);break;case "T":b=c;b.a+=3;switch(ee(b)){case 0:Ka(b.d,2);break;case 1:Ka(b.d,1);break;default:Ka(b.d,0)}break;case "Z":d=c;d.a+=3;b=ee(d);0>=b&&(b=19);d=d.d;f=d.B;e=b;f.s=b;f.u=e;pd(f);f.Ba.Ta();d.l&&(b=d.l,La(b),b.Ka(!0));break;case "O":b=c;b.a+=3;W(b);break;default:Z(c)}break;case "T":switch(d){case "R":de(c,Cb);break;case "M":b=c;b.a+=3;W(b);break;case "B":fe(c,B);break;case "W":fe(c,C);break;default:Z(c)}break;case "U":switch(d){case "S":b=c;b.a+=3;W(b);break;default:Z(c)}break;case "W":switch(d){case "[":be(c,C);break;case "R":b=c;b.a+=3;W(b);break;case "T":b=c;b.a+=3;W(b);break;case "L":b=c;b.a+=3;b.d.Mb(ce(b));break;default:Z(c)}break;default:Z(c)}if(!c.ha){c=!1;break a}b=c.k[c.a];d=c.k[c.a+1]}c=!0}if(!c)return!1}else if("("===c)a.kc[a.Ha]=a.d.h,a.Ha++,a.a++;else if(")"===c)a.Ha--,a.d.h=a.kc[a.Ha],a.a++;else return!1}else return!1;return!0}function W(a,c){void 0===c&&(c="]");for(var b="";void 0!==a.k[a.a]&&c!==a.k[a.a];)b+=a.k[a.a],a.a++;void 0===a.k[a.a]&&(a.ha=!1);a.a++;return b}function ce(a){a=parseFloat(W(a,void 0));return isNaN(a)?0:a}function ee(a){a=parseInt(W(a,void 0));return isNaN(a)?0:a}function Z(a){for(;;){for(;void 0!==a.k[a.a]&&"]"!==a.k[a.a]&&a.a<a.fb;)for(a.a++;"]"===a.k[a.a]&&"\\"===a.k[a.a-1];)a.a++;a.a++;if("["!==a.k[a.a])break}}function ae(a,c){a.a+=3;var b=[];if("]"!==a.k[a.a]){for(;;){var d=a.k[a.a];a.a++;var f=a.k[a.a];a.a++;b.push((f.charCodeAt(0)-96<<8)+(d.charCodeAt(0)-96));if("]"!==a.k[a.a]){a.ha=!1;return}a.a++;if("["!==a.k[a.a])break;a.a++}a.d.kb(c,b)}}function be(a,c){a.a+=2;if("]"==a.k[a.a])a.d.Da(0,0,c);else{var b=a.k[a.a];a.a++;var d=a.k[a.a];a.a++;var f=a.d.B.A();"t"===b&&"t"===d&&19>=f.e&&19>=f.f?a.d.Da(0,0,c):(a.d.Da(b.charCodeAt(0)-96,d.charCodeAt(0)-96,c),"]"!==a.k[a.a]&&(a.ha=!1))}a.a++}function de(a,c){var b=0;a.a+=3;var d=[];if("]"!==a.k[a.a]){for(;;){var f=a.k[a.a];a.a++;var e=a.k[a.a];a.a++;d[b]=(e.charCodeAt(0)-96<<8)+(f.charCodeAt(0)-96);b++;if("]"!==a.k[a.a]){a.ha=!1;return}a.a++;if("["!==a.k[a.a])break;a.a++}a.d.L(c,d)}}function fe(a,c){var b=0;a.a+=3;var d=[];if("]"!==a.k[a.a]){for(;;){var f=a.k[a.a];a.a++;var e=a.k[a.a];a.a++;d[b]=(e.charCodeAt(0)-96<<8)+(f.charCodeAt(0)-96);b++;if("]"!==a.k[a.a]){a.ha=!1;return}a.a++;if("["!==a.k[a.a])break;a.a++}a.d.Lb(c,d)}};function Zd(){this.wa=!1;this.T={}};function $(){}n=$.prototype;n.ed=function(){return new bd};n.ac=function(a,c){(new Uc(a)).ac(c)};n.$b=function(a,c){(new Uc(a)).$b(c)};n.Sa=function(a,c){a.Sa(c)};n.G=function(a){a.G()};window.GoBoardApi=new $;$.prototype.Create_GameTree=$.prototype.ed;$.prototype.Create_SimpleBoard=$.prototype.ac;$.prototype.Create_BoardWithNavigateButtons=$.prototype.$b;$.prototype.Load_Sgf=$.prototype.Sa;$.prototype.Update_Size=$.prototype.G;}());