/*
 * Copyright (C) 2014  Ilya Kirillov 
 * email: ilya_kirillov@inbox.ru
 * 
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 3.0 of the License, or (at your option) any later version.
 * 
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
*/
(function(){var n;function aa(){this.l=this.d=null;this.qa=0;this.Sa=!1;this.Rb=this.Ta=this.Ua=this.oa=this.pa=0;this.Ba=null;this.c={N:0,q:0,M:0,lc:0,ec:2,n:null,dc:null,t:null,Fb:null,Nb:[],tc:Array(361),hb:null,tb:null,Oa:null,Pa:null,qc:null,rc:null,mc:null,nc:null,oc:null,pc:null,gc:null,bc:null,cc:null};this.Tb=new q(231,188,95,255);this.zc=new q(0,0,0,255);this.Wc=new q(255,0,0,128);this.Ca={Dc:new q(232,196,115,255),Oc:new q(255,255,255,255),Cc:new q(0,0,0,255),Lc:new q(141,141,141,255),Gc:new q(112,95,54,255),Hc:new q(112,95,54,255)};this.b={g:null,t:{g:null},n:{g:null},Na:{g:null},aa:{g:null},sb:{g:null},U:{g:null},rb:{g:null},Event:{g:null}};this.X={e:-1,f:-1};this.w={};this.Ub=-1;var a=this;this.bd=function(c){ea(c);c=fa(a);c=oa(a,c.e,c.f);pa(a,c.e,c.f,!1)};this.Zb=function(c){ea(c);qa(a)};this.Yb=function(c){if(c.pageX||c.pageY)t.e=c.pageX,t.f=c.pageY;else if(c.clientX||c.clientY)t.e=c.clientX,t.f=c.clientY;t.hc=t.e;t.ic=t.f;t.gb=c.altKey;t.B=c.shiftKey;t.H=c.ctrlKey||c.metaKey;t.sc=sa;t.ac=c.button;t.I=c.srcElement?c.srcElement:c.target;var b=(new Date).getTime();0==t.Ga?(t.Ga=1,t.Ka=b):500>b-t.Ka?(t.Ka=b,t.Ga++):(t.Ga=1,t.Ka=b);window.uc=!1;a.b.Event.g.b.focus();b=fa(a);b=oa(a,b.e,b.f);a.Xb(b.e,b.f,t);c.preventDefault();c.stopPropagation();return!1};this.$c=function(c){ta(c);if(16===u.nb&&2===a.qa)t.B=!0,ua(a);else{var b=u,d=b.nb;if(8===d||46===d){if(b=a.d,d=b.h.R,null!==d)for(var f=0,e=d.r.length;f<e;f++)if(b.h===va(d,f)){e=d;e.r.splice(f,1);e.K>=f&&e.K--; -1===e.K&&0<e.r.length&&(e.K=0);b.h=d;y(b,d);break}}else if(13===d)b=prompt("Enter here code of ur sgf file",""),a.d.La(b);else if(37===d)b.H&&b.B?(b=a.d,y(b,b.Q)):b.H?Da(a.d,5):Da(a.d,1);else if(38===d)b.H?a.d.kb():Ea(a.d);else if(39===d)if(b.H&&b.B){for(b=a.d;Fa(b););y(b,b.h)}else b.H?Ga(a.d,5):Ga(a.d,1);else 40===d?Ha(a.d):112===d?z(a,0):113===d?z(a,1):114===d?z(a,2):115===d?z(a,3):116===d?z(a,4):117===d?z(a,5):118===d?z(a,6):119===d?z(a,7):120===d?z(a,8):189===d?(b=a.d.yb,b++,b>Ia&&(b=Ja),Ka(a.d,b)):192===d&&(b=!0===a.Sa?!1:!0,b!==a.Sa&&(a.Sa=b,Pa(a),a.Da(!0)))}c.preventDefault()};this.ad=function(c){ta(c);16===u.nb&&2===a.qa&&(t.B=!1,ua(a))};this.ed=function(){return setTimeout(function(){var c=a.b.t.g.b.width,b=a.b.t.g.b.height,d=a.b.t.g.b.getContext("2d");if(0!==c&&0!==b){for(var f=d.createImageData(c,b),e=.9,g=a.Tb.ua,h=a.Tb.ma,m=a.Tb.la,k=Array(c),l=0;l<c;l++)k[l]=(Math.tan(300*l/c)+1)/2+(Math.tan(100*l/c)+1)/10;for(var p=Array(b),r=0;r<b;r++)p[r]=.02*Math.tan(r/b);for(var D,I,Bb,r=0;r<b;r++)for(l=0;l<c;l++){e=40*(k[l]+p[r])+.5;e-=Math.floor(e);e=.2>e?1-e/2:.4>e?1-(.4-e)/2:1;if(r==b-1||r==b-2&&l<c-2||l>=c-1||l==c-2&&r<b-1)e/=2;0==r||1==r&&1<l||0==l||1==l&&1<r?(D=128+g*e/2,I=128+h*e/2,Bb=128+m*e/2):(D=g*e,I=h*e,Bb=m*e);var ab=4*(l+r*c);f.data[ab+0]=D;f.data[ab+1]=I;f.data[ab+2]=Bb;f.data[ab+3]=255}a.c.t=f;a.c.N=c;a.c.q=b;a.Ba=null}var bb=a.c.N,Cb=a.c.q;if(0!==bb&&0!==Cb){for(var xc=a.oa*bb,yc=a.pa*Cb,rd=a.Ta*Cb,sd=a.Ua*bb,zc=a.l.u(),Ac=Array(zc.e),Bc=xc,Cc=yc,La=0;La<zc.e;La++)Bc=xc+La*sd,Cc=yc+La*rd,Ac[La]={e:Math.floor(Bc+.5),f:Math.floor(Cc+.5)};a.c.n=Ac;for(var V=Math.max(2,Math.ceil(a.Rb*bb/2)),M=2*V+1,td=a.c,S=a.zc,P=document.createElement("canvas").getContext("2d").createImageData(M,M),ga=V,ha=-1,ud=ga*ga,Dc=0;ga>ha;){ha++;var Ec=Math.sqrt(ud-ha*ha),Db=Math.ceil(Ec)-Ec;Db<=Dc&&ga--;var ia=Math.floor(255*(1-Db)),Eb=V+ga,Fb=V+ga,Gb=V+ha,Hb=V+ha,Ib=V-ga,Jb=V-ga,Kb=V-ha,Lb=V-ha;A(P,Eb,Hb,ia,M,S);A(P,Gb,Fb,ia,M,S);A(P,Ib,Hb,ia,M,S);A(P,Kb,Fb,ia,M,S);A(P,Eb,Lb,ia,M,S);A(P,Gb,Jb,ia,M,S);A(P,Ib,Lb,ia,M,S);A(P,Kb,Jb,ia,M,S);for(var Fc=Eb-1,Gc=Fb-1,Hc=Ib+1,Ic=Jb+1,vd=P,wd=Fc,xd=Hb,yd=M,zd=S,Mb=Hc;Mb<=wd;Mb++)A(vd,Mb,xd,255,yd,zd);for(var Ad=P,Bd=Gc,Cd=Gb,Dd=M,Ed=S,Nb=Ic;Nb<=Bd;Nb++)A(Ad,Cd,Nb,255,Dd,Ed);for(var Fd=P,Gd=Fc,Hd=Lb,Id=M,Jd=S,Ob=Hc;Ob<=Gd;Ob++)A(Fd,Ob,Hd,255,Id,Jd);for(var Kd=P,Ld=Gc,Md=Kb,Nd=M,Od=S,Pb=Ic;Pb<=Ld;Pb++)A(Kd,Md,Pb,255,Nd,Od);Dc=Db}td.dc=P;a.c.ec=V}var ba=a.b.t.g.b.width,wa=a.b.t.g.b.height,Ma=a.b.Na.g.b.getContext("2d"),E=2*Math.floor(Math.floor(a.Ua*ba)/2)+1;a.c.M=E;a.c.Fb=Ma.createImageData(E,E);a.c.Nc=Ma.createImageData(E,E);a.c.hb=Ma.createImageData(E,E);a.c.tb=Ma.createImageData(E,E);for(var ja=a.c.Fb.data,Q=a.c.Nc.data,ka=a.c.hb.data,ca=a.c.tb.data,Qb=E/2-.5,cb=Qb-.2,Pd=Math.sqrt(3),la=0;la<E;la++)for(var ma=0;ma<E;ma++){var xa=la-Qb,ya=ma-Qb,Na=cb-Math.sqrt(xa*xa+ya*ya),s=4*(la*E+E-ma-1);if(0<=Na){var za=cb*cb-xa*xa-ya*ya,za=0<za?Math.sqrt(za)*Pd:0,Rb=xa,Sb=ya,Aa=Math.sqrt(6*(Rb*Rb+Sb*Sb+za*za)),Aa=(2*za-Rb+Sb)/Aa,Tb=0;.9<Aa&&(Tb=10*(Aa-.9));var Oa=255;if(.8>=Na){var Na=(.8-Na)/.8,Jc=.7;xa-ya<cb/3&&(Jc=1);Oa=parseInt(255*(1-Na*Jc))}var R=parseInt(10+10*Aa+140*Tb);ja[s+0]=R;ja[s+1]=R;ja[s+2]=R;ja[s+3]=Oa;ka[s+0]=R;ka[s+1]=R;ka[s+2]=R;ka[s+3]=parseInt(Oa/2);R=parseInt(200+10*Aa+45*Tb);Q[s+0]=R;Q[s+1]=R;Q[s+2]=R;Q[s+3]=Oa;ca[s+0]=R;ca[s+1]=R;ca[s+2]=R;ca[s+3]=parseInt(Oa/2)}else ja[s+0]=0,ja[s+1]=0,ja[s+2]=0,ja[s+3]=0,ka[s+0]=0,ka[s+1]=0,ka[s+2]=0,ka[s+3]=0,Q[s+0]=0,Q[s+1]=0,Q[s+2]=0,Q[s+3]=0,ca[s+0]=0,ca[s+1]=0,ca[s+2]=0,ca[s+3]=0}for(var Ub=[],da=[],s=0;28>s;s++)for(Ub[s]=Ma.createImageData(E,E),da[s]=Ub[s].data,la=0;la<E;la++)for(ma=0;ma<E;ma++){var na=4*(la*E+ma);da[s][na+0]=Q[na+0];da[s][na+1]=Q[na+1];da[s][na+2]=Q[na+2];da[s][na+3]=Q[na+3]}da.push(ca);da.push(Q);for(var N=.9,Kc=Array(ba),J=0;J<ba;J++)Kc[J]=(Math.sin(18*J/ba)+1)/20+(Math.sin(3*J/ba)+1)/10;for(var Lc=Array(wa),K=0;K<wa;K++)Lc[K]=.2*Math.cos(5*K/wa)+.1*Math.sin(11*K/wa);for(var Mc=Array(ba*wa),K=0;K<wa;K++)for(J=0;J<ba;J++)N=75*(Kc[J]+Lc[K])+.5,N-=Math.floor(N),N=.2>N?1-N/2:.4>N?1-(.4-N)/2:1,Mc[J+K*ba]=N;for(var Nc=a.c.n,Oc=(a.c.M-1)/2,Qd=da.length,db=0;db<Qd;db++){var Ba=da[db],w=0,x=0;switch(db){case 0:w=0;x=3;break;case 1:w=0;x=4;break;case 2:w=0;x=5;break;case 3:w=0;x=6;break;case 4:w=1;x=3;break;case 5:w=1;x=4;break;case 6:w=1;x=5;break;case 7:w=1;x=6;break;case 8:w=2;x=3;break;case 9:w=2;x=4;break;case 10:w=2;x=5;break;case 11:w=2;x=6;break;case 12:x=w=3;break;case 13:w=3;x=4;break;case 14:w=3;x=5;break;case 15:w=3;x=6;break;case 16:w=4;x=3;break;case 17:x=w=4;break;case 18:w=4;x=5;break;case 19:w=4;x=6;break;case 20:w=5;x=3;break;case 21:w=5;x=4;break;case 22:x=w=5;break;case 23:w=5;x=6;break;case 24:w=6;x=3;break;case 25:w=6;x=4;break;case 26:w=6;x=5;break;case 27:x=w=6}for(var Rd=Nc[w].e-Oc,Sd=Nc[x].f-Oc,K=0;K<E;K++)for(J=0;J<E;J++){var N=Mc[Rd+J+(Sd+K)*ba],Ca=4*(J+K*E);Ba[Ca+0]*=N;Ba[Ca+1]*=N;Ba[Ca+2]*=N}}a.c.Nb=Ub;for(var Vb=0;19>Vb;Vb++)for(var Wb=0;19>Wb;Wb++)a.c.tc[Wb+19*Vb]=Math.floor(Math.random()*(a.c.Nb.length-1));var Td=a.b.aa.g.b.getContext("2d"),ra=a.c.M;a.c.aa=Td.createImageData(ra,ra);var eb=a.c.aa.data;a.c.lc=Math.max(parseInt(.15*ra),3);for(var Xb=(ra-5)/2+1,fb=0;fb<ra;fb++)for(var gb=0;gb<ra;gb++){var Pc=Math.abs(fb-Xb),Qc=Math.abs(gb-Xb),Rc=Math.sqrt(Qc*Qc+Pc*Pc)/Xb,Ud=1>Rc?.15+.75*(1-Rc):0,hb=4*(ra*fb+gb);eb[hb+0]=0;eb[hb+1]=0;eb[hb+2]=0;eb[hb+3]=parseInt(255*Ud)}var v=a.c.M;a.c.Oa=Qa(a,v,v,.05*v,new q(0,0,0,255));a.c.Pa=Qa(a,v,v,.05*v,new q(255,255,255,255));a.c.qc=a.ea(v,v,.05*v,new q(0,0,0,255));a.c.rc=a.ea(v,v,.05*v,new q(255,255,255,255));a.c.mc=Ra(a,v,v,.05*v,new q(0,0,0,255));a.c.nc=Ra(a,v,v,.05*v,new q(255,255,255,255));a.c.oc=Sa(a,v,v,new q(0,0,0,255));a.c.pc=Sa(a,v,v,new q(255,255,255,255));a.c.gc=Ta(a,v,v,.05*v,new q(255,0,0,255));a.c.bc=Ta(a,v,v,.05*v,new q(0,0,0,255));a.c.cc=Ta(a,v,v,.05*v,new q(255,255,255,255));a.Da()},20)};this.Xc=function(a){a.preventDefault();return!1};this.Yc=function(c){c.preventDefault();if(0<c.dataTransfer.files.length&&FileReader){c=c.dataTransfer.files[0];var b=new FileReader;b.onload=function(b){a.d.La(b.target.result)};b.readAsText(c);Ua(a)}}}n=aa.prototype;n.wa=function(a,c){this.d=c;this.l=c.v;this.d.k=this;this.b.g=Va(a);var b=this.b.g.b,d=a+"_BoardCanvas",f=a+"_LinesCanvas",e=a+"_ShadowsCanvas",g=a+"_StonesCanvas",h=a+"_VariantsCanvas",m=a+"_MarksCanvas",k=a+"_TargetCanvas",l=a+"_EventDiv";Wa(b,d);Wa(b,f);Wa(b,e);Wa(b,g);Wa(b,h);Wa(b,m);Wa(b,k);var b=this.Wb(b,l),p=this.b.g;this.Z(this.b.t,p,d);this.Z(this.b.n,p,f);this.Z(this.b.aa,p,e);this.Z(this.b.Na,p,g);this.Z(this.b.sb,p,h);this.Z(this.b.U,p,m);this.Z(this.b.rb,p,k);this.Z(this.b.Event,p,l);b.onmousemove=this.bd;b.onmouseout=this.Zb;b.onmousedown=this.Yb;b.onkeydown=this.$c;b.onkeyup=this.ad;b.tabIndex=-1;b.style.qd=!0;b.style.outline=0;b.ondragover=this.Xc;b.ondrop=this.Yc;return p};function Ua(a){a.b.Event.g.b.focus()}n.C=function(){var a=this.b.g.b.clientWidth,c=this.b.g.b.clientHeight;a!==c&&(c=a=Math.min(a,c));this.b.g.ga(a,c);Pa(this);this.Da()};function Xa(a,c,b,d){if(a.c.n){var f=a.b.Na.g.b.getContext("2d"),e=a.b.aa.g.b.getContext("2d"),g=a.c.M,h=(g-1)/2,m=a.c.n,k=a.c.lc,l=m[c-1].e-h,h=m[b-1].f-h;switch(d){case B:f.putImageData(a.c.Fb,l,h);e.putImageData(a.c.aa,l+k,h+k);break;case C:f.putImageData(a.c.Nb[a.c.tc[c-1+19*(b-1)]],l,h);e.putImageData(a.c.aa,l+k,h+k);break;default:f.clearRect(l,h,g,g),e.clearRect(l+k,h+k,g,g)}c===a.X.e&&b===a.X.f&&(B===d||C===d?qa(a):ua(a))}}n.$=function(a,c){var b=(c<<8)+a;delete this.w[""+b];b===this.Ub&&(this.w[""+b]=new F(a,c,Ya,""))};n.G=function(a){Za(this,a.Ha(),a.Ia(),a)};function z(a,c){if(a.qa!==c&&(a.qa=c,ua(a),1===c)){var b=a.l;b.ca=[];for(var d=1;d<=b.s;d++)for(var f=1;f<=b.p;f++)b.ca[G(b,f,d)]=H;$a(b,!1);a.d.jb()}}function Wa(a,c){var b=document.createElement("canvas");b.setAttribute("id",c);b.setAttribute("style","position:absolute;padding:0;margin:0;");b.setAttribute("oncontextmenu","return false;");a.appendChild(b)}n.Wb=function(a,c){var b=document.createElement("div");b.setAttribute("id",c);b.setAttribute("style","position:absolute;padding:0;margin:0;");b.setAttribute("oncontextmenu","return false;");a.appendChild(b);return b};n.Z=function(a,c,b){a.g=Va(b);a=a.g;ib(a.i,0,1E3,1E3,!1,-1);a.ka=jb|kb|lb|mb;c.ja(a)};function fa(a){var c,b=t.e,d=t.f;c=a.b.t.g.b;if("undefined"!=typeof c.offsetParent){for(var f=a=0;c;c=c.offsetParent)a+=c.offsetLeft,f+=c.offsetTop;c=f}else a=c.x,c=c.y;return{e:b-a,f:d-c}}function Pa(a){var c=a.l.u(),b=c.e,d=c.f;if(!0===a.Sa){var c=nb/(2*ob+b),b=(nb-b*c)/2,f=pb/(2*qb+d),d=(pb-d*f)/2;a.pa=(d+f/2)/pb;a.oa=(b+c/2)/nb}else c=nb/(2*ob+b-1),b=(nb-(b-1)*c)/2,f=pb/(2*qb+d-1),d=(pb-(d-1)*f)/2,a.pa=d/pb,a.oa=b/nb;a.Ua=c/nb;a.Ta=f/pb;a.Rb=4/nb}n.Da=function(a){var c=this.b.t.g.b.width,b=this.b.t.g.b.height;if(c!=this.c.N||b!=this.c.q||null===this.c.t||null!==this.Ba||!0===a){if(null!==this.Ba&&clearTimeout(this.Ba),this.Ba=this.ed(),0!==c&&0!==b){a=this.b.t.g.b.getContext("2d");a.fillStyle=L(this.Ca.Dc);a.fillRect(0,0,c,b);var d=this.b.n.g.b.getContext("2d");a=this.oa*c;var f=this.pa*b,e=this.Ua*c,g=this.Ta*b,h=this.l.u();d.clearRect(0,0,c,b);d.strokeStyle=L(this.Ca.Hc);for(var m=c-a,k=0;k<h.f;k++){var l=f+k*g;d.beginPath();d.moveTo(a,l);d.lineTo(m,l);d.stroke()}for(var m=b-f,p=0;p<h.e;p++)l=a+p*e,d.beginPath(),d.moveTo(l,f),d.lineTo(l,m),d.stroke();if(h.e===h.f&&(9===h.e||13===h.e||19===h.e)){d.fillStyle=L(this.Ca.Gc);k=Math.max(2,this.Rb*c/2);p=[];switch(h.e){case 9:p=[[2,2],[2,6],[4,4],[6,2],[6,6]];break;case 13:p=[[3,3],[3,6],[3,9],[6,3],[6,6],[6,9],[9,3],[9,6],[9,9]];break;case 19:p=[[3,3],[3,9],[3,15],[9,3],[9,9],[9,15],[15,3],[15,9],[15,15]]}for(var r=0,D=p.length;r<D;r++)m=a+p[r][0]*e,l=f+p[r][1]*e,d.beginPath(),d.arc(m,l,k,0,2*Math.PI,!1),d.fill()}d=this.b.Na.g.b.getContext("2d");d.clearRect(0,0,c,b);d.strokeStyle=L(this.Ca.Lc);d.lineWidth=1;r=L(this.Ca.Cc);D=L(this.Ca.Oc);for(k=1;k<=h.f;k++)for(p=1;p<=h.e;p++){m=O(this.l,p,k);if(B===m)d.fillStyle=r;else if(C===m)d.fillStyle=D;else continue;m=a+(p-1)*e;l=f+(k-1)*g;d.beginPath();d.arc(m,l,e/2,0,2*Math.PI,!1);d.fill();d.stroke()}this.b.aa.g.b.getContext("2d").clearRect(0,0,c,b);this.b.sb.g.b.getContext("2d").clearRect(0,0,c,b);this.b.U.g.b.getContext("2d").clearRect(0,0,c,b);this.b.rb.g.b.getContext("2d").clearRect(0,0,c,b)}}else{this.b.t.g.b.getContext("2d").putImageData(this.c.t,0,0);if(!0===this.Sa&&this.c.n){c=this.b.t.g.b.getContext("2d");b=this.c.N;g=this.c.q;a=this.l.u();for(h=0;h<a.e;h++){d=2*this.c.M/3;f=(d-1)/2;m=this.c.n;e=m[h].e-f;m=this.pa*g/3-f;l=new String;switch(h+1){case 1:l="A";break;case 2:l="B";break;case 3:l="C";break;case 4:l="D";break;case 5:l="E";break;case 6:l="F";break;case 7:l="G";break;case 8:l="H";break;case 9:l="J";break;case 10:l="K";break;case 11:l="L";break;case 12:l="M";break;case 13:l="N";break;case 14:l="O";break;case 15:l="P";break;case 16:l="Q";break;case 17:l="R";break;case 18:l="S";break;case 19:l="T";break;case 20:l="a";break;case 21:l="b";break;case 22:l="c";break;case 23:l="d";break;case 24:l="e";break;case 25:l="f";break;case 26:l="g";break;case 27:l="h";break;case 28:l="j";break;case 29:l="k";break;case 30:l="l";break;case 31:l="m";break;case 32:l="n";break;case 33:l="o";break;case 34:l="p";break;case 35:l="q";break;case 36:l="r";break;case 37:l="s";break;case 38:l="t"}k=2*d/3;p=rb(l)?"Arial":"Helvetica, Arial, Verdana";p=k+"px "+p;c.fillStyle="rgb(0,0,0)";c.font=p;k=d/2+k/3;d=(d-c.measureText(l).width)/2;c.fillText(l,e+d,m+k);m=g-this.pa*g/3-f;c.fillText(l,e+d,m+k)}for(g=0;g<a.f;g++)d=2*this.c.M/3,f=(d-1)/2,m=this.c.n,e=this.oa*b/3-f,m=m[g].f-f,l=a.f-g+"",k=2*d/3,p=rb(l)?"Arial":"Helvetica, Arial, Verdana",p=k+"px "+p,c.fillStyle="rgb(0,0,0)",c.font=p,k=d/2+k/3,d=(d-c.measureText(l).width)/2,c.fillText(l,e+d,m+k),e=b-this.oa*b/3-f,c.fillText(l,e+d,m+k)}sb(this);tb(this);ub(this)}};function sb(a,c){if(a.c.n){var b=a.c.N,d=a.c.q,f=a.b.n.g.b.getContext("2d"),e=a.l.u(),g=a.c.n;f.clearRect(0,0,b,d);if(e.e===e.f&&(9===e.e||13===e.e||19===e.e)){var d=a.c.dc,h=a.c.ec,m=[];switch(e.e){case 9:m=[[2,2],[2,6],[4,4],[6,2],[6,6]];break;case 13:m=[[3,3],[3,6],[3,9],[6,3],[6,6],[6,9],[9,3],[9,6],[9,9]];break;case 19:m=[[3,3],[3,9],[3,15],[9,3],[9,9],[9,15],[15,3],[15,9],[15,15]]}for(var k=0,l=m.length;k<l;k++)f.putImageData(d,g[m[k][0]].e-h,g[m[k][1]].f-h)}for(var h=g[0].e,m=g[g.length-1].e,k=g[0].f,l=g[g.length-1].f,p=f.createImageData(1,l-k),r=f.createImageData(m-h,1),D=a.zc,I=0;I<l-k;I++)d=4*I,p.data[d+0]=D.ua,p.data[d+1]=D.ma,p.data[d+2]=D.la,p.data[d+3]=D.Ob;for(I=0;I<m-h;I++)d=4*I,r.data[d+0]=D.ua,r.data[d+1]=D.ma,r.data[d+2]=D.la,r.data[d+3]=D.Ob;for(I=0;I<e.e;I++)f.putImageData(p,g[I].e,g[0].f),f.putImageData(r,g[0].e,g[I].f);if(void 0!==c)for(b=(2*Math.floor(parseInt(a.Ta*b)/2)+1-1)/2,e=g[1].e-g[0].e+2,h=g[1].f-g[0].f+2,d=0;d<c.length;d++)m=c[d].e,k=c[d].f,H===O(a.l,m,k)&&f.clearRect(g[m-1].e-b,g[k-1].f-b,e,h)}}function A(a,c,b,d,f,e){c=4*(c+b*f);a.data[c+0]=e.ua;a.data[c+1]=e.ma;a.data[c+2]=e.la;a.data[c+3]=d}function tb(a){var c=a.c.N,b=a.c.q;a.b.Na.g.b.getContext("2d").clearRect(0,0,c,b);a.b.aa.g.b.getContext("2d").clearRect(0,0,c,b);c=a.l.u();for(b=1;b<=c.f;b++)for(var d=1;d<=c.e;d++)Xa(a,d,b,O(a.l,d,b))}function ua(a){pa(a,a.X.e,a.X.f,!0)}function pa(a,c,b,d){var f=t;if(-1!==c&&-1!==b&&null===a.Ba&&null!==a.c.n&&(void 0===d&&(d=!1),c!==a.X.e||b!==a.X.f||!0===d)){a.X.e=c;a.X.f=b;var e=a.c.N,g=a.c.q;d=a.b.rb.g.b.getContext("2d");d.clearRect(0,0,e,g);var g=(a.c.M-1)/2,h=a.c.n,e=h[c-1].e-g,g=h[b-1].f-g;c=O(a.l,c,b);switch(a.qa){case 0:H===c&&(B===a.d.ya?d.putImageData(a.c.hb,e,g):d.putImageData(a.c.tb,e,g));break;case 1:B===c?d.putImageData(a.c.Pa,e,g):C===c&&d.putImageData(a.c.Oa,e,g);break;case 2:B===c?d.putImageData(a.c.Pa,e,g):C===c?d.putImageData(a.c.Oa,e,g):f.B?d.putImageData(a.c.tb,e,g):d.putImageData(a.c.hb,e,g);break;default:B===c?d.putImageData(a.c.Pa,e,g):d.putImageData(a.c.Oa,e,g)}}}function qa(a){var c=a.c.N,b=a.c.q;a.b.rb.g.b.getContext("2d").clearRect(0,0,c,b);a.X.e=-1;a.X.f=-1}function oa(a,c,b){var d=a.c.N,f=a.c.q,e=a.oa*d,g=a.pa*f,f=a.Ta*f,d=a.Ua*d,h=0;a=a.l.u();for(h=0;h<a.f-1&&b>g+f*h+f/2;h++);for(b=b=0;b<a.e-1&&c>e+d*b+d/2;b++);return{e:b+1,f:h+1}}function Qa(a,c,b,d,f){a=a.b.U.g.b.getContext("2d");a.clearRect(0,0,c,b);a.strokeStyle=L(f);a.fillStyle=L(f);a.lineWidth=d;a.beginPath();a.moveTo(1*c/4,1*b/4);a.lineTo(3*c/4,3*b/4);a.moveTo(3*c/4,1*b/4);a.lineTo(1*c/4,3*b/4);a.stroke();return a.getImageData(0,0,c,b)}n.ea=function(a,c,b,d,f){void 0===f&&(f=1);var e=this.b.U.g.b.getContext("2d");e.clearRect(0,0,a,c);e.globalAlpha=f;e.strokeStyle=L(d);e.fillStyle=L(d);e.lineWidth=b;var g=a/2;b=3*c/4;d=.1*a;f=Math.sqrt(g*g-(b-g)*(b-g))+g;g=-Math.sqrt(g*g-(b-g)*(b-g))+g;e.beginPath();e.moveTo(a/2,d);e.lineTo(f-d,b);e.lineTo(g+d,b);e.closePath();e.stroke();return e.getImageData(0,0,a,c)};function Ra(a,c,b,d,f){a=a.b.U.g.b.getContext("2d");a.clearRect(0,0,c,b);a.strokeStyle=L(f);a.fillStyle=L(f);a.lineWidth=Math.floor(d+.5);var e=c/2,g=-b/2*Math.sqrt(2)/2+b/2;f=Math.floor(Math.sqrt(e*e-(g-e)*(g-e))+e-d);e=Math.ceil(-Math.sqrt(e*e-(g-e)*(g-e))+e+d);g=Math.ceil(g+d);d=Math.floor(b/2*Math.sqrt(2)/2+b/2-d);a.beginPath();a.moveTo(f,g);a.lineTo(e,g);a.lineTo(e,d);a.lineTo(f,d);a.closePath();a.stroke();return a.getImageData(0,0,c,b)}function Sa(a,c,b,d){a=a.b.U.g.b.getContext("2d").createImageData(c,b);for(var f=0;f<b;f++)for(var e=0;e<c;e++){var g=4*(f*c+e);f>=b/3&&f<=2*b/3&&e>=c/3&&e<=2*c/3?(a.data[g+0]=d.ua,a.data[g+1]=d.ma,a.data[g+2]=d.la,a.data[g+3]=255):a.data[g+3]=0}return a}function Ta(a,c,b,d,f){a=a.b.U.g.b.getContext("2d");a.clearRect(0,0,c,b);var e=c/2,g=4*d;a.strokeStyle=L(f);a.fillStyle=L(f);a.lineWidth=d;a.beginPath();a.arc(c/2,b/2,e-g,0,2*Math.PI,!1);a.stroke();return a.getImageData(0,0,c,b)}function vb(a,c,b){a=a.w[""+((b<<8)+c)];return void 0!==a?a:null}function Za(a,c,b,d){Ya===d.m?wb(a,c,b):a.w[""+((b<<8)+c)]=d}function wb(a,c,b){var d=(b<<8)+c;void 0===a.w[""+d]&&(a.w[""+d]=new F(c,b,Ya,""));a.Ub=d}function ub(a){a.b.U.g.b.getContext("2d").clearRect(0,0,a.c.N,a.c.q);var c=[],b;for(b in a.w){var d=a.w[b];xb(a,d);T===d.m&&c.push({e:d.Ha(),f:d.Ia()})}sb(a,c)}function xb(a,c){if(a.c.n){var b=c.Ha(),d=c.Ia(),f=c.m,e=a.b.U.g.b.getContext("2d"),g=a.c.M,h=(g-1)/2,m=a.c.n,k=m[b-1].e-h,h=m[d-1].f-h,b=O(a.l,b,d);switch(f){case yb:e.putImageData(a.c.oc,k,h);break;case zb:e.putImageData(a.c.pc,k,h);break;case Ya:e.putImageData(a.c.gc,k,h);break;case Ab:e.putImageData(b===B?a.c.cc:a.c.bc,k,h);break;case Yb:e.putImageData(b===B?a.c.nc:a.c.mc,k,h);break;case Zb:e.putImageData(b===B?a.c.rc:a.c.qc,k,h);break;case $b:e.putImageData(b===B?a.c.Pa:a.c.Oa,k,h);break;case T:f=c.Bb,d=2>=f.length?2*g/3:g/2,m=d+"px "+(rb(f)?"Arial":"Helvetica, Arial, Verdana"),e.fillStyle=b===B?"rgb(255,255,255)":"rgb(0,0,0)",e.font=m,e.fillText(f,k+(g-e.measureText(f).width)/2,h+(g/2+d/3))}}}n.Xb=function(a,c,b){switch(this.qa){case 0:if(ac==b.ac)1<=this.d.Xa&&(Da(this.d,1),bc(this,a,c));else if(b.B&&b.H)this.d.Lb(B===this.d.ya?C:B),ua(this);else if(!0===b.H){var d=new String;switch(a){case 1:d="A";break;case 2:d="B";break;case 3:d="C";break;case 4:d="D";break;case 5:d="E";break;case 6:d="F";break;case 7:d="G";break;case 8:d="H";break;case 9:d="J";break;case 10:d="K";break;case 11:d="L";break;case 12:d="M";break;case 13:d="N";break;case 14:d="O";break;case 15:d="P";break;case 16:d="Q";break;case 17:d="R";break;case 18:d="S";break;case 19:d="T"}this.d.fb(d+c)}else if(b.B){d=this.d;d.D&&d.D.Kc(!0);var f=d.h;y(d,d.Q);for(b=0;1E3>b&&H===O(d.v,a,c);)Ga(d,1),b++;H===O(d.v,a,c)&&y(d,f);d.D&&d.D.Kc(!1)}else bc(this,a,c);break;case 1:if(!0===b.H)this.d.Gb(),z(this,0);else{d=this.l;f=O(d,a,c);if(H!==f)if(d.Ab.L(),b=d.ca[G(d,a,c)],B!==b&&C!==b){d.o.L();cc(d,a,c,f);for(var e in d.Ab.P)b=U(e|0),d.o.L(),dc(d,b.e,b.f,3-f),ec(d.o,d,3);$a(d,!0);d.o.L();cc(d,a,c,f);ec(d.o,d,3-f)}else d.o.L(),cc(d,a,c,f),ec(d.o,d,3),$a(d,!0);this.d.jb()}break;case 2:!0===this.d.h.lb()&&(fc(this.d),gc(this.d));d=B;H!==O(this.l,a,c)?d=H:b.B&&(d=C);Xa(this,a,c,d);this.l.J(a,c,d,-1);this.d.eb(d,[(c<<8)+a]);break;case 3:hc(this,Zb,a,c);break;case 4:hc(this,Yb,a,c);break;case 5:hc(this,Ab,a,c);break;case 6:hc(this,$b,a,c);break;case 7:a:{f=vb(this,a,c);if(null!==f&&T===f.m)this.d.$([(c<<8)+a]),this.$(a,c);else{f="";b.B&&(f=prompt("Enter the label that you want to add to board here. For best results, keep your label to one or two letters.",""));if(void 0==f||""===f||null===f){f=[];b=-1;for(d in this.w)if(e=this.w[d],T==e.m){e=e.Bb;var g=e.charCodeAt(0);1==e.length&&65<=g&&90>=g&&(f[g]=1)}for(d=65;90>=d;d++)if(void 0===f[d]||""==f[d]){b=d;break}f=-1==b?null:String.fromCharCode(b);if(null===f){alert("Sorry, all the standard labels are used up! To add more labels, you will have to shift click on the board and make up ur own labels to add.");break a}}d=new F(a,c,T,f);this.d.Fa(f,(c<<8)+a);Za(this,a,c,d)}ub(this)}break;case 8:a:{d=vb(this,a,c);if(null!==d&&T===d.m)this.d.$([(c<<8)+a]),this.$(a,c);else{d="";if(b.B){d=this.l.Jb(a,c);if(-1==d){alert("Sorry, no move has been made at that location, so you can't mark it with the move number!");break a}d=""+d}if(void 0===d||""===d||null===d){d=[];b=0;for(f in this.w)e=this.w[f],T===e.m&&rb(e.Bb)&&(d[b]=parseInt(e.Bb),b++);if(0>=b)d="1";else{d.sort(ic);e=f=0;for(var g=!1,h=0;h<b;h++){if(d[h]>f+1){e=f+1;g=!0;break}f=d[h]}g||(e=f+1);d=""+e}}f=new F(a,c,T,d);this.d.Fa(d,(c<<8)+a);Za(this,a,c,f)}ub(this)}}};function hc(a,c,b,d){var f=vb(a,b,d);if(null!==f&&c===f.m){if(a.d.$([(d<<8)+b]),a.$(b,d),a.c.n){c=(a.c.M-1)/2;var e=a.c.n,f=e[b-1].e-c,e=e[d-1].f-c;a.b.U.g.b.getContext("2d").clearRect(f,e,2*c,2*c);c=U(a.Ub);b===c.e&&d===c.f&&(wb(a,b,d),xb(a,vb(a,b,d)))}}else f=new F(b,d,c,""),a.d.G(c,[(d<<8)+b]),Za(a,b,d,f),xb(a,f)}function bc(a,c,b){if(H===O(a.l,c,b)){var d=B===a.d.ya?B:C,f=!1,e=new jc,f=a.l.ta;e.sa=f.sa;e.ra=f.ra;a.l.J(c,b,d,-1);f=null!==kc(a.l,c,b,d,!0)?!0:null!==lc(a.l,c,b,d)?!1:!0;a.l.J(c,b,H,-1);var g=a.l.ta;g.sa=e.sa;g.ra=e.ra;if(1==f){a:{for(var e=a.d,f=(b<<8)+c,g=0,h=e.h.r.length;g<h;g++){var m=va(e.h,g),k=m.ha,l=k.m;if(f===k.F()&&d===l&&(B===d||C===d)){mc(e.h,g);e.h=m;e.Xa++;break a}}fc(e,!1);e.h.va(c,b,d);e.pd&&(e.Tc.gd(),e.cb.Mc())}gc(a.d)}}};function nc(){this.d=null;this.za=this.m=0;this.c={kc:null,fc:null,$b:null};this.b={g:null,ib:{g:null}};this.Uc=new q(217,217,217,255);this.Vc=new q(0,0,0,255);this.xc=new q(54,101,179,255);this.yc=new q(255,255,255,255);this.s=this.p=0;var a=this;this.Yb=function(){a.za=1;oc(a);a.Xb()};this.dd=function(){a.za=2;oc(a)};this.cd=function(){1!==a.za&&(a.za=2);oc(a)};this.Zb=function(){a.za=0;oc(a)};this.Zc=function(){if(a.d){var c=a.d;c.k&&Ua(c.k)}}}n=nc.prototype;n.wa=function(a,c,b){this.d=c;this.m=b;this.b.g=Va(a);c=this.b.g.b;c.setAttribute("title",pc(this));b=document.createElement("canvas");b.setAttribute("id",a+"_canvas");b.setAttribute("style","position:absolute;padding:0;margin:0;");b.setAttribute("oncontextmenu","return false;");c.appendChild(b);this.b.ib.g=Va(a+"_canvas");a=this.b.ib.g;ib(a.i,0,1E3,1E3,!1,-1);a.ka=jb|kb|lb|mb;this.b.g.ja(a);c.onmousedown=this.Yb;c.onmouseup=this.dd;c.onmouseover=this.cd;c.onmouseout=this.Zb;c.onfocus=this.Zc;c.tabIndex=-1;this.C()};n.C=function(){this.p=this.b.g.b.clientWidth;this.s=this.b.g.b.clientHeight;this.b.g.ga(this.p,this.s);this.Da()};n.Da=function(){var a=this.s,c=this.p;0!==c&&0!==a&&(this.c.$b=qc(this,this.xc,this.yc,c,a),this.c.fc=qc(this,this.xc,this.yc,c,a),this.c.kc=qc(this,this.Uc,this.Vc,c,a))};function qc(a,c,b,d,f){var e=a.b.ib.g.b.getContext("2d");e.fillStyle=L(c);e.fillRect(0,0,d,f);e.fillStyle=L(b);e.strokeStyle=L(b);b=Math.min(d,f);var g=(d-b)/2,h=(f-b)/2;switch(a.m){case 1:a.ea(b,g,h,e,-1);g=Math.ceil(g+b/10+.5);h=Math.ceil(h+b/5+.5);c=Math.floor(b/10+.5);a=Math.floor(3*b/5+.5);e.fillRect(g,h,c,a);break;case 2:a.ea(b,g-b/10,h,e,-1);g=Math.ceil(g+8*b/10+.5);h=Math.ceil(h+b/5+.5);c=Math.floor(b/10+.5);a=Math.floor(3*b/5+.5);e.fillRect(g,h,c,a);break;case 3:a.ea(b,g-b/10,h,e,-1);break;case 4:a.ea(b,g-b/10,h,e,1);break;case 5:a.ea(b,g+b/10,h,e,1);g=Math.ceil(g+b/10+.5);h=Math.ceil(h+b/5+.5);c=Math.floor(b/10+.5);a=Math.floor(3*b/5+.5);e.fillRect(g,h,c,a);break;case 6:a.ea(b,g,h,e,1);g=Math.ceil(g+8*b/10+.5);h=Math.ceil(h+b/5+.5);c=Math.floor(b/10+.5);a=Math.floor(3*b/5+.5);e.fillRect(g,h,c,a);break;case 7:c=Math.ceil(g+.2*b+.5);a=Math.ceil(g+.35*b+.5);var m=Math.ceil(g+.57*b+.5),g=Math.ceil(g+.92*b+.5),k=Math.ceil(h+.2*b+.5),l=Math.ceil(h+.38*b+.5),p=Math.ceil(h+.52*b+.5),r=Math.ceil(h+.6*b+.5),D=Math.ceil(h+.68*b+.5);b=Math.ceil(h+.84*b+.5);e.beginPath();e.moveTo(c,k);e.lineTo(a,k);e.lineTo(a,p);e.lineTo(m,p);e.lineTo(m,l);e.lineTo(g,r);e.lineTo(m,b);e.lineTo(m,D);e.lineTo(c,D);e.closePath();e.fill();break;case 8:c=Math.ceil(g+.2*b+.5);a=Math.ceil(g+.35*b+.5);m=Math.ceil(g+.57*b+.5);g=Math.ceil(g+.92*b+.5);k=Math.ceil(h+.8*b+.5);l=Math.ceil(h+.62*b+.5);p=Math.ceil(h+.48*b+.5);r=Math.ceil(h+.4*b+.5);D=Math.ceil(h+(1-.68)*b+.5);b=Math.ceil(h+(1-.84)*b+.5);e.beginPath();e.moveTo(c,k);e.lineTo(a,k);e.lineTo(a,p);e.lineTo(m,p);e.lineTo(m,l);e.lineTo(g,r);e.lineTo(m,b);e.lineTo(m,D);e.lineTo(c,D);e.closePath();e.fill();break;case 9:m=Math.ceil(g+.5*b-b/10+.5);k=Math.ceil(h+.5*b-b/10+.5);c=Math.ceil(.25*b+.5);e.fillStyle=L(new q(255,255,255));e.strokeStyle=L(new q(0,0,0));e.beginPath();e.arc(m,k,c,0,2*Math.PI,!1);e.fill();e.stroke();e.fillStyle=L(new q(0,0,0));m=Math.ceil(g+.5*b+b/10+.5);k=Math.ceil(h+.5*b+b/10+.5);c=Math.ceil(.25*b+.5);e.beginPath();e.arc(m,k,c,0,2*Math.PI,!1);e.fill();break;case 10:a=e.createImageData(b,b);m=b/5|0;k=4*b/5|0;for(l=0;l<b;l++)for(p=0;p<b;p++)r=4*(l*b+p),l>=m&&l<=k&&p>=m&&p<=k?b-l>=p||l===m||l===k||p===m||p===k?(a.data[r+0]=0,a.data[r+1]=0,a.data[r+2]=0):(a.data[r+0]=255,a.data[r+1]=255,a.data[r+2]=255):(a.data[r+0]=c.ua,a.data[r+1]=c.ma,a.data[r+2]=c.la),a.data[r+3]=255;e.putImageData(a,g,h);break;case 11:m=Math.ceil(g+.75*b+.5);k=Math.ceil(h+.125*b+.5);c=Math.ceil(.25*b+.5);a=Math.ceil(.02*b+.5);e.fillRect(m,k,c,a);m=Math.ceil(g+.875*b+.5);k=Math.ceil(h+.5);c=Math.ceil(.02*b+.5);a=Math.ceil(.25*b+.5);e.fillRect(m,k,c,a);m=Math.ceil(g+.5);k=Math.ceil(h+.875*b+.5);c=Math.ceil(.25*b+.5);a=Math.ceil(.02*b+.5);e.fillRect(m,k,c,a);m=Math.ceil(g+.5*b-b/10+.5);k=Math.ceil(h+.5*b-b/10+.5);c=Math.ceil(.25*b+.5);e.fillStyle=L(new q(255,255,255));e.strokeStyle=L(new q(0,0,0));e.beginPath();e.arc(m,k,c,0,2*Math.PI,!1);e.fill();e.stroke();e.fillStyle=L(new q(0,0,0));m=Math.ceil(g+.5*b+b/10+.5);k=Math.ceil(h+.5*b+b/10+.5);c=Math.ceil(.25*b+.5);e.beginPath();e.arc(m,k,c,0,2*Math.PI,!1);e.fill();break;case 12:k=b/2;a=3*b/4;c=.1*b;l=Math.sqrt(k*k-(a-k)*(a-k))+k;p=-Math.sqrt(k*k-(a-k)*(a-k))+k;e.lineWidth=Math.ceil(.05*b+.5);e.beginPath();e.moveTo(g+b/2,h+2*c);e.lineTo(g+l-c,h+a+c);e.lineTo(g+p+c,h+a+c);e.closePath();e.stroke();break;case 13:k=b/2;c=.05*b;m=-b/2*Math.sqrt(2)/2+b/2;a=b/2*Math.sqrt(2)/2+b/2;l=Math.sqrt(k*k-(m-k)*(m-k))+k;p=-Math.sqrt(k*k-(m-k)*(m-k))+k;k=Math.floor(g+l-c);g=Math.ceil(g+p+c);m=Math.ceil(h+m+c);h=Math.floor(h+a-c);e.lineWidth=Math.ceil(.05*b+.5);e.beginPath();e.moveTo(k,m);e.lineTo(g,m);e.lineTo(g,h);e.lineTo(k,h);e.closePath();e.stroke();break;case 14:a=.05*b;k=b/2;c=4*a;e.lineWidth=Math.ceil(a+.5);e.beginPath();e.arc(g+b/2,h+b/2,k-c,0,2*Math.PI,!1);e.stroke();break;case 15:c=g+.25*b;a=g+.75*b;k=h+.25*b;l=h+.75*b;e.lineWidth=Math.ceil(.05*b+.5);e.beginPath();e.moveTo(c,k);e.lineTo(a,l);e.moveTo(a,k);e.lineTo(c,l);e.stroke();break;case 16:c="A";a=.8*b;m=g+(b-e.measureText(c).width)/2;e.font=a+"px Arial";e.fillText(c,m,h+b/2+a/3);break;case 17:c="1",a=.8*b,m=g+(b-e.measureText(c).width)/2,e.font=a+"px Helvetica, Arial, Verdana",e.fillText(c,m,h+b/2+a/3)}return e.getImageData(0,0,d,f)}n.ea=function(a,c,b,d,f){var e=Math.ceil(c+a/5+.5);c=Math.ceil(c+4*a/5+.5);var g=Math.ceil(b+a/5+.5),h=Math.ceil(b+a/2+.5);a=Math.ceil(b+4*a/5+.5);0>f?(d.beginPath(),d.moveTo(e,h),d.lineTo(c,g),d.lineTo(c,a)):(d.beginPath(),d.moveTo(e,g),d.lineTo(c,h),d.lineTo(e,a));d.closePath();d.fill()};function oc(a){var c=a.b.ib.g.b.getContext("2d"),b=null;switch(a.za){case 2:b=a.c.fc;break;case 1:b=a.c.$b;break;default:case 0:b=a.c.kc}c.putImageData(b,0,0)}n.Xb=function(){if(this.d)switch(this.m){case 1:var a=this.d;y(a,a.Q);break;case 2:Da(this.d,5);break;case 3:Da(this.d,1);break;case 4:Ga(this.d,1);break;case 5:Ga(this.d,5);break;case 6:for(a=this.d;Fa(a););y(a,a.h);break;case 7:Ha(this.d);break;case 8:Ea(this.d);break;case 9:z(this.d.k,0);break;case 10:z(this.d.k,1);break;case 11:z(this.d.k,2);break;case 12:z(this.d.k,3);break;case 13:z(this.d.k,4);break;case 14:z(this.d.k,5);break;case 15:z(this.d.k,6);break;case 16:z(this.d.k,7);break;case 17:z(this.d.k,8)}};function pc(a){switch(a.m){case 1:return"Back to the start";case 2:return"Back 5 moves";case 3:return"Back";case 4:return"Forward";case 5:return"Forward 5 moves";case 6:return"Go to the end";case 7:return"Next variant";case 8:return"Previous variant";case 9:return"Moves (F1)";case 10:return"Count Scores (F2)";case 11:return"Editor (F3)";case 12:return"Triangles (F4)";case 13:return"Squares (F5)";case 14:return"Circles (F6)";case 15:return"X marks (F7)";case 16:return"Text labels (F8)";case 17:return"Numeric labels (F9)"}};function rc(){this.S=this.V=this.W=this.T=0;this.ub=this.wb=this.xb=this.vb=!1;this.Ea=this.ia=-1}function ib(a,c,b,d,f,e){a.T=c;a.W=0;a.V=b;a.S=d;a.vb=!1;a.xb=!1;a.wb=!1;a.ub=f;a.ia=-1;a.Ea=e}var kb=1,jb=2,mb=4,lb=8;function sc(){this.i=new rc;this.ka=kb|jb;this.b=this.ob=this.jc=null;this.fa=new rc;this.A=[]}sc.prototype.ja=function(a){a.ob=this;this.A[this.A.length]=a};sc.prototype.ga=function(a,c){if(null==this.ob){if(this.fa.T=0,this.fa.W=0,this.fa.V=a,this.fa.S=c,null!=this.b)for(var b=this.A.length,d=0;d<b;d++)this.A[d].ga(a,c)}else{var f=0,e=0,g=0,h=0,f=this.ka&5,b=this.ka&10;kb==f?(f=this.i.vb?this.i.T:this.i.T*a/1E3,g=-1!=this.i.ia?f+this.i.ia:this.i.wb?a-this.i.V:this.i.V*a/1E3):mb==f?(g=this.i.wb?a-this.i.V:this.i.V*a/1E3,f=-1!=this.i.ia?g-this.i.ia:this.i.vb?this.i.T:this.i.T*a/1E3):(kb|mb)==f?(f=this.i.vb?this.i.T:this.i.T*a/1E3,g=this.i.wb?a-this.i.V:this.i.V*a/1E3):(f=this.i.T,g=this.i.V);jb==b?(e=this.i.xb?this.i.W:this.i.W*c/1E3,h=-1!=this.i.Ea?e+this.i.Ea:this.i.ub?c-this.i.S:this.i.S*c/1E3):lb==b?(h=this.i.ub?c-this.i.S:this.i.S*c/1E3,e=-1!=this.i.Ea?h-this.i.Ea:this.i.xb?this.i.W:this.i.W*c/1E3):(jb|lb)==b?(e=this.i.xb?this.i.W:this.i.W*c/1E3,h=this.i.ub?c-this.i.S:this.i.S*c/1E3):(e=this.i.W,h=this.i.S);g<f&&(g=f);h<e&&(h=e);-2===this.i.ia?g=f+(h-e)*g_dKoef_Board_W_to_H:-3===this.i.ia&&(f=(h-e)*g_dKoef_Board_W_to_H);this.fa.T=f;this.fa.W=e;this.fa.V=g;this.fa.S=h;this.b.style.left=parseInt(f+.5)+"px";this.b.style.top=parseInt(e+.5)+"px";this.b.style.width=parseInt(g-f+.5)+"px";this.b.style.height=parseInt(h-e+.5)+"px";this.b.width=parseInt(g-f+.5);this.b.height=parseInt(h-e+.5);b=this.A.length;for(d=0;d<b;d++)this.A[d].ga(g-f,h-e)}};function Va(a){var c=new sc;c.jc=a;c.b=document.getElementById(a);return c}function tc(){this.b=this.ob=null;this.q=0;this.A=[]}tc.prototype.J=function(a){this.q=a};tc.prototype.ja=function(a){a.ob=this;this.A[this.A.length]=a};tc.prototype.ga=function(a,c){var b=c-this.q,d=a;d!==b&&(b=d=Math.min(d,b));var f=(c-this.q-b)/2;this.b.style.left=parseInt((a-d)/2+.5)+"px";this.b.style.top=parseInt(f+.5)+"px";this.b.style.width=parseInt(d+.5)+"px";this.b.style.height=parseInt(b+this.q+.5)+"px";this.b.width=parseInt(d+.5);this.b.height=parseInt(b+this.q+.5);for(var f=this.A.length,e=0;e<f;e++)this.A[e].ga(d,b+this.q)};var sa=0,vc=1,ac=2,t=new function(){this.ac=this.f=this.e=0;this.sc=vc;this.B=this.H=this.gb=!1;this.I=null;this.Ka=-1;this.ic=this.hc=this.Ga=0;this.Kb=this.mb=!1},u=new function(){this.B=this.H=this.gb=!1;this.I=null;this.nb=this.Ec=0};function ta(a){u.gb=a.altKey;u.H=void 0!==a.metaKey?a.ctrlKey||a.metaKey:a.ctrlKey;u.B=a.shiftKey;u.I=a.srcElement?a.srcElement:a.target;u.Ec=a.charCode;u.nb=a.keyCode;u.nd=a.which}function ea(a){if(!a.mb||a.Kb){if(a.pageX||a.pageY)t.e=a.pageX,t.f=a.pageY;else if(a.clientX||a.clientY)t.e=a.clientX,t.f=a.clientY;t.gb=a.altKey;t.B=a.shiftKey;t.H=a.ctrlKey||a.metaKey;t.sc=vc;t.mb||(t.I=a.srcElement?a.srcElement:a.target);if(3<Math.abs(t.e-t.hc)||3<Math.abs(t.f-t.ic))t.Ka=-1,t.Ga=0}}window.onmousemove=function(a){t.mb&&void 0!=t.I&&null!=t.I&&void 0!=t.I.onmousemove&&null!=t.I.onmousemove&&(t.Kb=!0,t.I.onmousemove(a),t.Kb=!1)};window.onmouseup=function(a){if(!1===window.uc&&(window.uc=!0,t.mb&&void 0!=t.I.onmouseup&&null!=t.I.onmouseup))t.I.onmouseup(a,!0)};var Ya=-1,Zb=0,Yb=1,Ab=2,T=3,$b=4,yb=5,zb=6;function F(a,c,b,d){this.Ac={e:void 0===a?0:a,f:void 0==c?0:c};this.m=void 0===b?Zb:b;this.Bb=void 0===d?"":d}F.prototype.Ha=function(){return this.Ac.e};F.prototype.Ia=function(){return this.Ac.f};F.prototype.Mb=function(a){this.m=a};function wc(){this.d=null;this.b={g:null};this.Rc=new q(217,217,217,255);this.Pb=[]}wc.prototype.wa=function(a,c,b){this.d=c;this.b.g=Va(a);var d=this.b.g.b,f=this.b.g;d.style.backgroundColor=L(this.Rc);for(var e=0,g=b.A.length;e<g;e++){var h=b.A[e],m=null;switch(h){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:m=new nc}if(null!==m){var k=a+e;this.Wb(d,k);this.Z(f,k,e/g,(e+1)/g);m.wa(k,c,h);this.Pb.push(m)}}this.C()};wc.prototype.C=function(){this.b.g.ga(this.b.g.b.clientWidth,this.b.g.b.clientHeight);for(var a=0,c=this.Pb.length;a<c;a++)this.Pb[a].C()};wc.prototype.Wb=function(a,c){var b=document.createElement("div");b.setAttribute("id",c);b.setAttribute("style","position:absolute;padding:0;margin:0;");b.setAttribute("oncontextmenu","return false;");a.appendChild(b);return b};wc.prototype.Z=function(a,c,b,d){c=Va(c);ib(c.i,1E3*b,1E3*d,1E3,!1,-1);c.ka=jb|kb|lb|mb;a.ja(c)};function Sc(a){if(this.d=a)a.cb=this;this.bb=null;this.Ra=[]}Sc.prototype.Ib=function(a){var c=new aa;c.wa(a,this.d);Ua(c);this.Ra.push(c);this.C()};Sc.prototype.Hb=function(a){var c=this.d,b=Va(a);Tc(b.b,a+"div");var d=a+"div",f=new tc;f.jc=d;f.b=document.getElementById(d);f.J(25);var e=f.b;b.ja(f);d=a+"_Board";a+="_Toolbar";Tc(e,d);Tc(e,a);e=Va(d);ib(e.i,0,1E3,25,!0,-1);e.ka=jb|kb|mb;f.ja(e);e=new aa;e.wa(d,c);Ua(e);d=Va(a);ib(d.i,0,1E3,0,!0,25);d.ka=kb|lb|mb;f.ja(d);f=new wc;f.wa(a,c,{A:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17]});this.bb=b;this.Ra.push(e);this.Ra.push(f);this.C()};Sc.prototype.C=function(){this.bb&&this.bb.ga(this.bb.b.clientWidth,this.bb.b.clientHeight);for(var a=0,c=this.Ra.length;a<c;a++)this.Ra[a].C()};function Tc(a,c){var b=document.createElement("div");b.setAttribute("id",c);b.setAttribute("style","position:absolute;padding:0;margin:0;");b.setAttribute("oncontextmenu","return false;");a.appendChild(b)};var Uc={};function Vc(a,c,b){this.m=void 0===a?0:a;this.Bc=void 0===c?null:c;this.wc=void 0===b?0:b}Vc.prototype.F=function(){return this.Bc};Vc.prototype.Mb=function(a){this.m=a};Vc.prototype.pb=function(a){this.Bc=a};function Wc(){Y=X=0}function q(a,c,b,d){this.ua=a;this.ma=c;this.la=b;this.Ob="undefined"===typeof d?255:d}q.prototype={};function L(a){return"rgba("+a.ua+","+a.ma+","+a.la+","+a.Ob/255+")"}function U(a){var c=new Wc;c.e=a&255;c.f=a>>8&255;return c}function Xc(a){for(var c=[],b=0,d=a.length;b<d;b++)c.push(a[b]);return c}function rb(a){if("string"!=typeof a)return!1;for(var c=0;c<a.length;c++){var b=a.charCodeAt(c);if(48>b||57<b)return!1}return!0}function ic(a,c){return a>c?1:c>a?-1:0};var H=0,B=1,C=2,Ja=0,Ia=2,pb=460,nb=pb,qb=17.51/23.61,ob=qb;function Yc(a,c,b,d){this.Tc=c;this.D=b;this.cb=a;this.w=d;this.v=new Zc;this.k=null;this.vc=[];this.Q=new $c(this);this.Qc=0;this.h=this.Q;this.ab=this.Wa=0;this.ya=B;this.Xa=this.Sb=0;this.yb=2}n=Yc.prototype;n.C=function(){this.cb&&this.cb.C()};n.La=function(a){var c=new ad(this);if(void 0!==a&&""!==a){c.j=[];c.a=0;c.Aa=0;c.Qb=[];c.da=!0;for(var b=c.Ya=0,d=a.length,f=[],e=!1;b<d;){(e||32<a.charCodeAt(b))&&f.push(a.charAt(b));if(3<=f.length&&"["==f[f.length-1]){var g=f[f.length-3]+f[f.length-2];if("C"==f[f.length-2]&&"UC"!=g||"AN"==g||"BR"==g||"BT"==g||"CP"==g||"DT"==g||"EV"==g||"GN"==g||"GC"==g||"ON"==g||"OT"==g||"PB"==g||"PC"==g||"PW"==g||"RE"==g||"RO"==g||"RU"==g||"SO"==g||"TM"==g||"US"==g||"WR"==g||"WT"==g)e=!0}else e&&1<=f.length&&"]"==f[f.length-1]&&(2>f.length||"\\"!=f[f.length-2])&&(e=!1);b++}c.j=f;c.Ya=c.j.length;bd(c)||alert("Error occurs, while read SGF")}y(this,this.Q);this.Q.kb()};n.Ma=function(){this.vc=[];this.Q=new $c(this);cd(this)};function Da(a,c){for(var b=a.h;null!=b.R&&0<c;)b=b.R,c--;y(a,b)}function Ga(a,c){if(1===c)Fa(a)&&gc(a);else{for(var b=0;b<c;b++)Fa(a);y(a,a.h)}}function Ea(a){var c=a.h.R;if(null!==c){var b=c.K;0<c.r.length&&0<b&&y(a,va(c,b-1))}}function Ha(a){var c=a.h.R;if(null!==c){var b=c.K;b<c.r.length-1&&y(a,va(c,b+1))}}n.kb=function(){for(var a=this.h;!dd(a);){var c=a.R;if(null===c&&a!==this.Q)return;a=c}a.kb();y(this,a)};n.Lb=function(a){this.ya=a;this.h.Lb(a)};n.va=function(a,c,b){this.h.va(a,c,b)};function fc(a,c){var b=new $c(a),d=b.R=a.h;d.r.push(b);d.K=d.r.length-1;a.h=b;a.Xa++;!0===c&&a.cb.Mc()}n.eb=function(a,c){this.h.eb(a,c)};n.fb=function(a){this.h.fb(a)};n.G=function(a,c){this.h.G(a,c)};n.$=function(a){this.h.G(513,a)};n.Fa=function(a,c){this.h.Fa(a,c)};n.Db=function(a,c){this.h.Y.na||(this.h.Y.na=!0);for(var b=0,d=c.length;b<d;b++)this.h.Db(c[b],a)};n.Cb=function(a){this.h.Cb(a)};n.Eb=function(a){this.h.Eb(a)};n.Gb=function(){!0===this.h.Y.na&&(this.h.Y.na=!1,this.h.Gb());this.k&&(this.k.w={},ub(this.k))};n.lb=function(){return this.h.lb()};function gc(a){a.k&&(1===a.k.qa&&z(a.k,0),a.k.w={},a.qb());for(var c=0,b=a.h.O.length;c<b;c++){var d=a.h.O[c],f=d.F(),e=d.wc;switch(d.m){case 1:d=U(f);ed(a,d.e,d.f,B,!1);break;case 2:d=U(f);ed(a,d.e,d.f,C,!1);break;case 257:for(var g=0;g<e;g++)d=U(f[g]),fd(a,d.e,d.f,B,-1);break;case 258:for(g=0;g<e;g++)d=U(f[g]),fd(a,d.e,d.f,C,-1);break;case 259:for(g=0;g<e;g++)d=U(f[g]),fd(a,d.e,d.f,H,-1);break;case 260:a.ya=f;break;case 529:if(a.k)for(g=0;g<e;g++)d=U(f[g]),a.k.G(new F(d.e,d.f,Ab,""));break;case 530:if(a.k)for(g=0;g<e;g++)d=U(f[g]),a.k.G(new F(d.e,d.f,$b,""));break;case 531:if(a.k)for(g=0;g<e;g++)d=U(f[g]),a.k.G(new F(d.e,d.f,Yb,""));break;case 532:if(a.k)for(g=0;g<e;g++)d=U(f[g]),a.k.G(new F(d.e,d.f,Zb,""));break;case 533:a.k&&(d=U(f.Jc),a.k.G(new F(d.e,d.f,T,f.Text)));break;case 513:if(a.k)for(g=0;g<e;g++)d=U(f[g]),a.k.$(d.e,d.f)}}a.k&&(a.h.Y.na&&z(a.k,1),a.h.lb()&&(b=a.h.ha,c=b.Ha(),b=b.Ia(),0!=c&&0!=b&&wb(a.k,c,b)),ub(a.k));a.Sc&&a.Sc.J(a.h.Vb)}function ed(a,c,b,d,f){if(0!=c||0!=b){a.D&&!0!==f&&a.D.ld();fd(a,c,b,d,a.Sb+1,f);var e=null;if(null!==(e=kc(a.v,c,b,d,!1))&&0<e.u()){c=e.u();for(b=0;b<c;b++){var g=U(e.F(b));fd(a,g.e,g.f,H,-1)}a.D&&!0!==f&&a.D.Ic(e);B===d?a.Wa+=c:a.ab+=c}else if(null!==(e=lc(a.v,c,b,d))&&0<e.u()){c=e.u();for(b=0;b<c;b++)g=U(e.F(b)),fd(a,g.e,g.f,H,-1);a.D&&!0!==f&&a.D.Ic(g_nGroupSize);B===d?a.ab+=c:a.Wa+=c}else a.v.ta.Ma()}a.ya=B===d?C:B;a.Sb++}function Fa(a){if(0===a.h.r.length||-1===a.h.K)return!1;a.h=va(a.h,a.h.K);a.Xa++;return!0}n.qb=function(){this.k&&this.h.qb(this.yb,this.k)};n.jb=function(){if(this.k){this.v.jb(this.k);ub(this.k);this.h.Y.na||(this.h.Y.na=!0);var a=this.v,c=this.h.Y;c.P={};for(var b=a.u(),d=1;d<=b.f;d++)for(var f=1;f<=b.e;f++){var e=a.ca[G(a,f,d)],g=(d<<8)+f;if(B===e||C===e)c.P[""+g]=e}}};function y(a,c){for(var b=a.v,d=new Zc(b.p,b.s),f=b.p*b.s,e=0;e<f;e++){var g=b.ba[e],h=d.ba[e];h.Va=g.Va;h.Za=g.Za}cd(a);a.v.L();a.D&&a.D.jd();a:{b=c.R;for(d=c;null!=b;){f=!1;e=0;for(g=b.r.length;e<g;e++)if(d===va(b,e)){mc(b,e);f=!0;break}if(!f){b=!1;break a}d=b;b=b.R}b=!0}if(b){for(a.h=a.Q;a.h!=c&&0<a.h.r.length;){b=a.h.O.length;for(d=0;d<b;d++)switch(g=a.h.O[d],f=g.F(),e=g.wc,g.m){case 1:g=U(f);ed(a,g.e,g.f,B,!0);break;case 2:g=U(f);ed(a,g.e,g.f,C,!0);break;case 257:for(h=0;h<e;h++)g=U(f[h]),a.v.J(g.e,g.f,B,-1);break;case 258:for(h=0;h<e;h++)g=U(f[h]),a.v.J(g.e,g.f,C,-1);break;case 259:for(h=0;h<e;h++)g=U(f[h]),a.v.J(g.e,g.f,H,-1)}if(!Fa(a))break}a.k&&tb(a.k);gc(a);a.D&&a.D.kd()}}function Ka(a,c){c!==a.yb&&(a.yb=c,a.qb())}function cd(a){a.h=a.Q;a.Wa=0;a.ab=0;a.Sb=0;a.Xa=0}function fd(a,c,b,d,f,e){a.v.J(c,b,d,f);a.k&&!0!==e&&Xa(a.k,c,b,d)};"use strict;";function jc(){this.ra=this.sa=0}jc.prototype.Ma=function(){this.ra=this.sa=0};jc.prototype.J=function(a,c){this.sa=a;this.ra=c};function gd(a,c){this.Va=void 0===a?H:a;this.Za=void 0===c?-1:c}gd.prototype.L=function(){this.Va=H;this.Za=-1};gd.prototype.pb=function(a){this.Va=a};gd.prototype.F=function(){return this.Va};gd.prototype.Jb=function(){return this.Za};function hd(){this.Qa=[];this.xa=[]}hd.prototype.u=function(){return this.xa.length};hd.prototype.F=function(a){return this.xa[a]};function id(a,c,b){c=(b<<8)+c;b=0;for(var d=a.xa.length;b<d;b++)if(a.xa[b]==c)return!0;return!1}function jd(){this.P={}}jd.prototype.L=function(){this.P={}};jd.prototype.Ja=function(a,c){var b=(c<<8)+a;if(void 0!==this.P[b])return!0;this.P[b]=1;return!1};function kd(){this.o={};this.$a=H}kd.prototype.L=function(){this.o={};this.$a=H};kd.prototype.Ja=function(a,c){var b=(c<<8)+a;if(void 0!==this.o[b])return!0;this.o[b]=1;return!1};function ec(a,c,b){b=void 0===b?a.$a:b;for(var d in a.o)a=U(d|0),c.ca[G(c,a.e,a.f)]=b}function Zc(a,c){this.p=void 0===a?19:a;this.s=void 0===c?19:c;this.ba=null;ld(this);this.ta=new jc;this.ca=null;this.o=new kd;this.Ab=new jd}n=Zc.prototype;n.L=function(){for(var a=this.p*this.s,c=0;c<a;c++)this.ba[c].L()};n.u=function(){return{e:this.p,f:this.s}};n.J=function(a,c,b,d){a=G(this,a,c);this.ba[a].pb(b);void 0!==d&&null!==d&&-1!==d&&(this.ba[a].Za=d)};function O(a,c,b){return a.ba[G(a,c,b)].F()}n.Jb=function(a,c){return this.ba[G(this,a,c)].Jb()};function lc(a,c,b,d){var f=new hd;md(a,c,b,d,f);return 0<f.u()?f:null}function kc(a,c,b,d,f){var e;switch(d){case B:e=C;break;case C:e=B;break;default:return null}d=new hd;!0!==id(d,c+1,b)&&md(a,c+1,b,e,d);!0!==id(d,c-1,b)&&md(a,c-1,b,e,d);!0!==id(d,c,b+1)&&md(a,c,b+1,e,d);!0!==id(d,c,b-1)&&md(a,c,b-1,e,d);e=d.u();if(1==e){c=(b<<8)+c;b=d.F(0);e=a.ta;if(b===e.sa&&c===e.ra&&1==f)return null;a.ta.J(c,b)}else if(1<e)a.ta.Ma();else if(0>=e)return null;return d}function ld(a){var c=a.p*a.s;a.ba=Array(c);for(var b=0;b<c;b++)a.ba[b]=new gd}function G(a,c,b){return(b-1)*a.p+(c-1)}function nd(a,c,b,d,f){if(c>a.p||1>c||b>a.s||1>b)return!1;var e=O(a,c,b);return H===e?!0:d===e?od(a,c,b,d,f):!1}function od(a,c,b,d,f){var e;a:{e=(b<<8)+c;for(var g=0,h=f.Qa.length;g<h;g++)if(f.Qa[g]==e){e=!0;break a}f.Qa.push(e);e=!1}return!0===e?!1:!0===nd(a,c+1,b,d,f)||!0===nd(a,c-1,b,d,f)||!0===nd(a,c,b+1,d,f)||!0===nd(a,c,b-1,d,f)?!0:!1}function md(a,c,b,d,f){c>a.p||1>c||b>a.s||1>b||d!==O(a,c,b)||(!0!==od(a,c,b,d,f)&&(f.xa=f.xa.concat(f.Qa)),f.Qa=[])}n.jb=function(a){for(var c=0,b=0,d=1;d<=this.s;d++)for(var f=1;f<=this.p;f++){var e=null,g=this.ca[G(this,f,d)];B===g?(e=new F(f,d,yb,""),C===O(this,f,d)?c+=2:c++):C===g&&(e=new F(f,d,zb,""),B===O(this,f,d)?b+=2:b++);null===e?a.$(f,d):a.G(e)}return{fd:c,od:b}};function pd(a,c,b){if(!(c>a.p||1>c||b>a.s||1>b)){var d=O(a,c,b);if(H!==O(a,c,b))switch(c=a.o.$a,c){case H:a.o.$a=d;break;case B:case C:c!==d&&(a.o.$a=3)}else!1===a.o.Ja(c,b)&&(pd(a,c+1,b),pd(a,c-1,b),pd(a,c,b+1),pd(a,c,b-1))}}function cc(a,c,b,d){c>a.p||1>c||b>a.s||1>b||(3-d===O(a,c,b)?d===a.ca[G(a,c,b)]&&a.Ab.Ja(c,b):!0!==a.o.Ja(c,b)&&(cc(a,c+1,b,d),cc(a,c-1,b,d),cc(a,c,b+1,d),cc(a,c,b-1,d)))}function dc(a,c,b,d){if(!(c>a.p||1>c||b>a.s||1>b)&&3-d!==O(a,c,b)){if(d===O(a,c,b)){var f=a.Ab,e=(b<<8)+c;void 0!==f.P[e]&&delete f.P[e]}!0!==a.o.Ja(c,b)&&(dc(a,c+1,b,d),dc(a,c-1,b,d),dc(a,c,b+1,d),dc(a,c,b-1,d))}}function $a(a,c){for(var b=1;b<=a.s;b++)for(var d=1;d<=a.p;d++)H===O(a,d,b)&&(H===a.ca[G(a,d,b)]||!0===c&&3===a.ca[G(a,d,b)])&&(a.o.L(),pd(a,d,b),ec(a.o,a))};function qd(a,c){this.zb=a;this.m=c}n=qd.prototype;n.Ha=function(){return U(this.zb).e};n.Ia=function(){return U(this.zb).f};n.F=function(){return this.zb};n.pb=function(a){this.zb=a};n.Mb=function(a){this.m=a};function $c(a){this.Pc=++a.Qc;this.r=[];this.K=-1;this.R=null;this.O=[];this.ha=new qd(0,H);this.Vb="";this.Y=new Vd;a.vc[this.Pc]=this}function va(a,c){return void 0!==a.r[c]?a.r[c]:a.r[a.K]}function mc(a,c){a.K=c>=a.r.length?a.r.length-1:c}n=$c.prototype;n.lb=function(){return H===this.ha.m?!1:!0};n.fb=function(a){this.Vb+=a};n.Db=function(a,c){this.Y.P[""+a]=c};n.Gb=function(){this.Y.P={}};n.kb=function(){for(var a=this;0<a.r.length;)mc(a,0),a=va(a,0)};function dd(a){for(var c=null;null!==(c=a.R);){if(0!=c.K)return!1;a=c}return!0}n.va=function(a,c,b){a=(c<<8)+a;this.O.push(new Vc(B===b?1:2,a));H===this.ha.m&&(this.ha.pb(a),this.ha.Mb(b))};n.eb=function(a,c){var b=new Vc(B===a?257:C===a?258:259,Xc(c),c.length);this.O.push(b)};n.G=function(a,c){var b=0;switch(a){case Ab:b=529;break;case Ya:b=Uc.hd;break;case Yb:b=531;break;case Zb:b=532;break;case T:b=Uc.md;break;case $b:b=Uc.e}b=new Vc(b,Xc(c),c.length);this.O.push(b)};n.Fa=function(a,c){this.O.push(new Vc(533,{Text:a,Jc:c}))};n.Lb=function(a){this.O.push(new Vc(260,a))};n.Cb=function(a){this.O.push(new Vc(769,a))};n.Eb=function(a){this.O.push(new Vc(770,a))};n.qb=function(a,c){c.b.sb.g.b.getContext("2d").clearRect(0,0,c.c.N,c.c.q);switch(a){case 2:Wd(this,c,-1);break;case 1:var b=this.R;null!==b&&Wd(b,c,this.ha.F())}};function Wd(a,c,b){if(c)for(var d=0,f=a.r.length;d<f;d++){var e=va(a,d).ha;if(H!==e.m&&b!==e.F()){var g=U(e.F()),e=c;if(e.c.n){var h=(e.c.M/2-1)/2,m=e.c.n,k=m[g.e-1].e,g=m[g.f-1].f,m=e.b.sb.g.b.getContext("2d");m.fillStyle=L(e.Wc);m.beginPath();m.arc(k,g,h,0,2*Math.PI,!1);m.fill()}}}};function ad(a){this.d=a;this.j=[];this.Aa=this.a=0;this.Qb=[];this.da=!0;this.Ya=0}function bd(a){a.d.Ma();if("("===a.j[0]&&";"===a.j[1])for(a.a++;a.a<a.Ya&&(")"!==a.j[a.a]||0!==a.Aa);){var c=a.j[a.a];if(";"===c){1!=a.a?fc(a.d,!1):a.d.h=a.d.Q;a:{c=a;c.a++;for(var b=c.j[c.a],d=c.j[c.a+1];void 0!==b&&")"!==b&&";"!==b&&"("!==b;){switch(b){case "A":switch(d){case "B":Xd(c,B);break;case "E":Xd(c,H);break;case "W":Xd(c,C);break;case "N":b=c;b.a+=3;W(b);break;case "P":b=c;b.a+=3;W(b);break;default:Z(c)}break;case "B":switch(d){case "[":Yd(c,B);break;case "R":b=c;b.a+=3;W(b);break;case "T":b=c;b.a+=3;W(b);break;case "L":b=c;b.a+=3;b.d.Cb(Zd(b));break;default:Z(c)}break;case "C":switch(d){case "[":b=c;b.a+=2;for(d="";"]"!==b.j[b.a]||"\\"===b.j[b.a-1];)"]"==-b.j[b.a+1]&&"\\"===b.j[b.a]?(d+="]",b.a++):d=13==b.j[b.a].charCodeAt(0)?d+"<br>\n":10==b.j[b.a].charCodeAt(0)?d+"<br>\n":133==b.j[b.a].charCodeAt(0)?d+"<br>\n":d+b.j[b.a],b.a++;b.a++;b.d.fb(d);break;case "A":b=c;b.a+=3;W(b);break;case "P":b=c;b.a+=3;W(b);break;case "R":$d(c,Ab);break;default:Z(c)}break;case "D":switch(d){case "D":b=c;b.a+=3;W(b);break;default:Z(c)}break;case "E":switch(d){case "V":b=c;b.a+=3;W(b);break;default:Z(c)}break;case "F":switch(d){case "F":Z(c);break;default:Z(c)}break;case "G":switch(d){case "N":b=c;b.a+=3;W(b);break;case "C":b=c;b.a+=3;W(b);break;case "M":b=c;b.a+=3;1!==ae(b)&&(b.da=!1);break;default:Z(c)}break;case "H":switch(d){case "A":b=c;b.a+=3;ae(b);break;default:Z(c)}break;case "K":switch(d){case "M":b=c;b.a+=3;Zd(b);break;default:Z(c)}break;case "L":switch(d){case "B":b=c;for(b.a+=3;;){d=b.j[b.a];b.a++;var f=b.j[b.a];b.a++;d=d.charCodeAt(0)-96;f=f.charCodeAt(0)-96;b.a++;for(var e="";"]"!==b.j[b.a]&&b.a<b.Ya;)e+=b.j[b.a],b.a++;b.d.Fa(e,(f<<8)+d);if("]"!==b.j[b.a]){b.da=!1;break}b.a++;if("["!==b.j[b.a])break;b.a++}break;default:Z(c)}break;case "M":switch(d){case "A":$d(c,$b);break;default:Z(c)}break;case "O":switch(d){case "N":b=c;b.a+=3;W(b);break;case "T":b=c;b.a+=3;W(b);break;default:Z(c)}break;case "P":switch(d){case "B":b=c;b.a+=3;W(b);break;case "C":b=c;b.a+=3;W(b);break;case "W":b=c;b.a+=3;W(b);break;default:Z(c)}break;case "R":switch(d){case "E":b=c;b.a+=3;W(b);break;case "O":b=c;b.a+=3;W(b);break;case "U":b=c;b.a+=3;W(b);break;default:Z(c)}break;case "S":switch(d){case "Q":$d(c,Yb);break;case "T":b=c;b.a+=3;switch(ae(b)){case 0:Ka(b.d,2);break;case 1:Ka(b.d,1);break;default:Ka(b.d,0)}break;case "Z":d=c;d.a+=3;b=ae(d);0>=b&&(b=19);d=d.d;f=d.v;e=b;f.p=b;f.s=e;ld(f);f.ta.Ma();d.k&&(b=d.k,Pa(b),b.Da());break;case "O":b=c;b.a+=3;W(b);break;default:Z(c)}break;case "T":switch(d){case "R":$d(c,Zb);break;case "M":b=c;b.a+=3;W(b);break;case "B":be(c,B);break;case "W":be(c,C);break;default:Z(c)}break;case "U":switch(d){case "S":b=c;b.a+=3;W(b);break;default:Z(c)}break;case "W":switch(d){case "[":Yd(c,C);break;case "R":b=c;b.a+=3;W(b);break;case "T":b=c;b.a+=3;W(b);break;case "L":b=c;b.a+=3;b.d.Eb(Zd(b));break;default:Z(c)}break;default:Z(c)}if(!c.da){c=!1;break a}b=c.j[c.a];d=c.j[c.a+1]}c=!0}if(!c)return!1}else if("("===c)a.Qb[a.Aa]=a.d.h,a.Aa++,a.a++;else if(")"===c)a.Aa--,a.d.h=a.Qb[a.Aa],a.a++;else return!1}else return!1;return!0}function W(a,c){void 0===c&&(c="]");for(var b="";void 0!==a.j[a.a]&&c!==a.j[a.a];)b+=a.j[a.a],a.a++;void 0===a.j[a.a]&&(a.da=!1);a.a++;return b}function Zd(a){a=parseFloat(W(a,void 0));return isNaN(a)?0:a}function ae(a){a=parseInt(W(a,void 0));return isNaN(a)?0:a}function Z(a){for(;;){for(;void 0!==a.j[a.a]&&"]"!==a.j[a.a]&&a.a<a.Ya;)for(a.a++;"]"===a.j[a.a]&&"\\"===a.j[a.a-1];)a.a++;a.a++;if("["!==a.j[a.a])break}}function Xd(a,c){a.a+=3;var b=[];if("]"!==a.j[a.a]){for(;;){var d=a.j[a.a];a.a++;var f=a.j[a.a];a.a++;b.push((f.charCodeAt(0)-96<<8)+(d.charCodeAt(0)-96));if("]"!==a.j[a.a]){a.da=!1;return}a.a++;if("["!==a.j[a.a])break;a.a++}a.d.eb(c,b)}}function Yd(a,c){a.a+=2;if("]"==a.j[a.a])a.d.va(0,0,c);else{var b=a.j[a.a];a.a++;var d=a.j[a.a];a.a++;var f=a.d.v.u();"t"===b&&"t"===d&&19>=f.e&&19>=f.f?a.d.va(0,0,c):(a.d.va(b.charCodeAt(0)-96,d.charCodeAt(0)-96,c),"]"!==a.j[a.a]&&(a.da=!1))}a.a++}function $d(a,c){var b=0;a.a+=3;var d=[];if("]"!==a.j[a.a]){for(;;){var f=a.j[a.a];a.a++;var e=a.j[a.a];a.a++;d[b]=(e.charCodeAt(0)-96<<8)+(f.charCodeAt(0)-96);b++;if("]"!==a.j[a.a]){a.da=!1;return}a.a++;if("["!==a.j[a.a])break;a.a++}a.d.G(c,d)}}function be(a,c){var b=0;a.a+=3;var d=[];if("]"!==a.j[a.a]){for(;;){var f=a.j[a.a];a.a++;var e=a.j[a.a];a.a++;d[b]=(e.charCodeAt(0)-96<<8)+(f.charCodeAt(0)-96);b++;if("]"!==a.j[a.a]){a.da=!1;return}a.a++;if("["!==a.j[a.a])break;a.a++}a.d.Db(c,d)}};function Vd(){this.na=!1;this.P={}};function $(){}n=$.prototype;n.Fc=function(){return new Yc};n.Ib=function(a,c){(new Sc(a)).Ib(c)};n.Hb=function(a,c){(new Sc(a)).Hb(c)};n.La=function(a,c){a.La(c)};n.C=function(a){a.C()};window.GoBoardApi=new $;$.prototype.Create_GameTree=$.prototype.Fc;$.prototype.Create_SimpleBoard=$.prototype.Ib;$.prototype.Create_BoardWithNavigateButtons=$.prototype.Hb;$.prototype.Load_Sgf=$.prototype.La;$.prototype.Update_Size=$.prototype.C;}());