/*
 * Copyright (C) 2014  Ilya Kirillov 
 * email: ilya_kirillov@inbox.ru
 * 
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 3.0 of the License, or (at your option) any later version.
 * 
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
*/
(function(){var r;function aa(a){this.j=a;this.C=this.e=null;this.Xa=0;this.Xb=!1;this.pe=this.Zb=this.$b=this.mb=this.nb=0;this.te={};this.ra=null;this.b={A:0,t:0,ua:0,Va:0,Le:2,w:null,Ke:null,D:null,kd:null,je:[],pf:Array(361),qc:null,Ic:null,Tb:null,Ub:null,ef:null,ff:null,Ye:null,Ze:null,af:null,bf:null,Pe:null,He:null,Ie:null};this.Za=new x(231,188,95,255);this.we=new x(0,0,0,255);this.dg=new x(255,0,0,128);this.Fb={Ff:new x(232,196,115,255),Tf:new x(255,255,255,255),Ef:new x(0,0,0,255),Qf:new x(141,141,141,255),Kf:new x(112,95,54,255),Lf:new x(112,95,54,255)};this.a={d:null,D:{d:null},w:{d:null},Rb:{d:null},da:{d:null},Gc:{d:null},Da:{d:null},Ma:{d:null},Event:{d:null}};this.Ia={f:-1,g:-1};this.ga={};this.Tc=-1;this.tb=null;var b=this;this.dd=function(a){ba(a);a=b.lc(y.f,y.g);a=ca(b,a.f,a.g);da(b,a.f,a.g,!1)};this.kc=function(a){ba(a);ea(b)};this.jc=function(a){fa(a);b.a.Event.d.a.focus();var d=b.lc(y.f,y.g),d=ca(b,d.f,d.g);b.Ce(d.f,d.g,y);a.preventDefault();a.stopPropagation();return!1};this.lg=function(a){ga(a);if(16===ha.vc&&2===b.Xa)y.ea=!0,b.cb();else{var d=ha,f=d.vc;if(8===f||46===f)if(d=b.e,f=d.i.L,null===f)d.i.aa(),d.B&&(d.B.Sa(),ia(d.B)),z(d,d.i);else for(var e=0,g=A(f);e<g;e++){if(d.i===f.J(e)){g=f;g.va.splice(e,1);g.Q>=e&&g.Q--; -1===g.Q&&0<g.va.length&&(g.Q=0);d.i=f;d.B&&(d.B.Sa(),ia(d.B));z(d,f);break}}else if(13===f)d=prompt("Enter here code of ur sgf file",""),b.e.zb(d);else if(37===f)d.na&&d.ea?(d=b.e,z(d,d.fa)):d.na?ja(b.e,5):ja(b.e,1);else if(38===f)d.na?b.e.Cd():ka(b.e);else if(39===f)if(d.na&&d.ea){for(d=b.e;la(d););z(d,d.i)}else d.na?ma(b.e,5):ma(b.e,1);else 40===f?na(b.e):112===f?E(b,0):113===f?E(b,1):114===f?E(b,2):115===f?E(b,3):116===f?E(b,4):117===f?E(b,5):118===f?E(b,6):119===f?E(b,7):120===f?E(b,8):189===f?(d=b.e.bc,d++,d>oa&&(d=pa),qa(b.e,d)):192===f&&(d=!0===b.Xb?!1:!0,d!==b.Xb&&(b.Xb=d,ra(b),b.za(!0)))}a.preventDefault()};this.mg=function(a){ga(a);16===ha.vc&&2===b.Xa&&(y.ea=!1,b.cb())};this.De=function(){return setTimeout(function(){b.Be();b.bd();if(b.b.w){var a=b.a.D.d.a.width,d=b.a.D.d.a.height,f=b.a.Rb.d.a.getContext("2d"),e=2*Math.floor(Math.floor(b.$b*a)/2)+1;b.b.ua=e;b.b.kd=f.createImageData(e,e);b.b.Sf=f.createImageData(e,e);b.b.qc=f.createImageData(e,e);b.b.Ic=f.createImageData(e,e);for(var g=b.b.kd.data,h=b.b.Sf.data,l=b.b.qc.data,k=b.b.Ic.data,m=e/2-.5,n=m-.2,t=Math.sqrt(3),p=0;p<e;p++)for(var u=0;u<e;u++){var v=p-m,D=u-m,M=n-Math.sqrt(v*v+D*D),w=4*(p*e+e-u-1);if(0<=M){var K=n*n-v*v-D*D,K=0<K?Math.sqrt(K)*t:0,P=v,Z=D,s=Math.sqrt(6*(P*P+Z*Z+K*K)),s=(2*K-P+Z)/s,K=0;.9<s&&(K=10*(s-.9));P=255;.8>=M&&(M=(.8-M)/.8,P=.7,v-D<n/3&&(P=1),P=parseInt(255*(1-M*P)));v=parseInt(10+10*s+140*K);g[w+0]=v;g[w+1]=v;g[w+2]=v;g[w+3]=P;l[w+0]=v;l[w+1]=v;l[w+2]=v;l[w+3]=parseInt(P/2);v=parseInt(200+10*s+45*K);h[w+0]=v;h[w+1]=v;h[w+2]=v;h[w+3]=P;k[w+0]=v;k[w+1]=v;k[w+2]=v;k[w+3]=parseInt(P/2)}else g[w+0]=0,g[w+1]=0,g[w+2]=0,g[w+3]=0,l[w+0]=0,l[w+1]=0,l[w+2]=0,l[w+3]=0,h[w+0]=0,h[w+1]=0,h[w+2]=0,h[w+3]=0,k[w+0]=0,k[w+1]=0,k[w+2]=0,k[w+3]=0}g=[];l=[];for(w=0;28>w;w++)for(g[w]=f.createImageData(e,e),l[w]=g[w].data,p=0;p<e;p++)for(u=0;u<e;u++)m=4*(p*e+u),l[w][m+0]=h[m+0],l[w][m+1]=h[m+1],l[w][m+2]=h[m+2],l[w][m+3]=h[m+3];l.push(k);l.push(h);h=.9;u=Array(a);for(k=0;k<a;k++)u[k]=(Math.sin(18*k/a)+1)/20+(Math.sin(3*k/a)+1)/10;w=Array(d);for(p=0;p<d;p++)w[p]=.2*Math.cos(5*p/d)+.1*Math.sin(11*p/d);f=Array(a*d);for(p=0;p<d;p++)for(k=0;k<a;k++)h=75*(u[k]+w[p])+.5,h-=Math.floor(h),h=.2>h?1-h/2:.4>h?1-(.4-h)/2:1,f[k+p*a]=h;d=b.C.N().f;u=b.b.w;w=(b.b.ua-1)/2;m=l.length;for(n=0;n<m;n++){t=l[n];h=k=0;p=n;if(9===d){if(1===n||9===n||13===n||11===n||21===n||23===n||25===n)p=n-1}else 13!==d||3!==n&&7!==n&&11!==n&&15!==n&&23!==n&&27!==n||(p=n-1);switch(p){case 0:k=0;h=3;break;case 1:k=0;h=4;break;case 2:k=0;h=5;break;case 3:k=0;h=6;break;case 4:k=1;h=3;break;case 5:k=1;h=4;break;case 6:k=1;h=5;break;case 7:k=1;h=6;break;case 8:k=2;h=3;break;case 9:k=2;h=4;break;case 10:k=2;h=5;break;case 11:k=2;h=6;break;case 12:h=k=3;break;case 13:k=3;h=4;break;case 14:k=3;h=5;break;case 15:k=3;h=6;break;case 16:k=4;h=3;break;case 17:h=k=4;break;case 18:k=4;h=5;break;case 19:k=4;h=6;break;case 20:k=5;h=3;break;case 21:k=5;h=4;break;case 22:h=k=5;break;case 23:k=5;h=6;break;case 24:k=6;h=3;break;case 25:k=6;h=4;break;case 26:k=6;h=5;break;case 27:h=k=6}s=u[k].f-w;v=u[h].g-w;for(p=0;p<e;p++)for(k=0;k<e;k++)h=f[s+k+(v+p)*a],D=4*(k+p*e),t[D+0]*=h,t[D+1]*=h,t[D+2]*=h}b.b.je=g;a=b.C.N();for(e=0;e<a.g;e++)for(d=0;d<a.f;d++)b.b.pf[d+e*a.f]=Math.floor(Math.random()*(b.b.je.length-1))}b.Ae();b.b.w&&(a=b.b.ua,b.b.Tb=sa(b,a,a,.05*a,new x(0,0,0,255)),b.b.Ub=sa(b,a,a,.05*a,new x(255,255,255,255)),b.b.ef=b.X(a,a,.05*a,new x(0,0,0,255)),b.b.ff=b.X(a,a,.05*a,new x(255,255,255,255)),b.b.Ye=ta(b,a,a,.05*a,new x(0,0,0,255)),b.b.Ze=ta(b,a,a,.05*a,new x(255,255,255,255)),b.b.af=ua(b,a,a,new x(0,0,0,255)),b.b.bf=ua(b,a,a,new x(255,255,255,255)),b.b.Pe=va(b,a,a,.05*a,new x(255,0,0,255)),b.b.He=va(b,a,a,.05*a,new x(0,0,0,255)),b.b.Ie=va(b,a,a,.05*a,new x(255,255,255,255)));b.za()},20)};this.jg=function(a){a.preventDefault();return!1};this.kg=function(a){a.preventDefault();if(0<a.dataTransfer.files.length&&FileReader){a=a.dataTransfer.files[0];var d=new FileReader;d.onload=function(a){b.e.zb(a.target.result)};d.readAsText(a);wa(b)}}}r=aa.prototype;r.P=function(a,b){this.j&&this.j.We(this);this.e=b;this.C=b.V;this.e.l=this;this.a.d=F(a);var c=this.a.d.a,d=a+"_BoardCanvas",f=a+"_LinesCanvas",e=a+"_ShadowsCanvas",g=a+"_StonesCanvas",h=a+"_VariantsCanvas",l=a+"_MarksCanvas",k=a+"_TargetCanvas",m=a+"_EventDiv";this.ia(c,d);this.ia(c,f);this.ia(c,e);this.ia(c,g);this.ia(c,h);this.ia(c,l);this.ia(c,k);var c=this.la(c,m),n=this.a.d;this.W(this.a.D,n,d);this.W(this.a.w,n,f);this.W(this.a.da,n,e);this.W(this.a.Rb,n,g);this.W(this.a.Gc,n,h);this.W(this.a.Da,n,l);this.W(this.a.Ma,n,k);this.W(this.a.Event,n,m);c.onmousemove=this.dd;c.onmouseout=this.kc;c.onmousedown=this.jc;c.onkeydown=this.lg;c.onkeyup=this.mg;c.tabIndex=-1;c.style.Uf=!0;c.style.outline=0;c.ondragover=this.jg;c.ondrop=this.kg;return n};function wa(a){a.a.Event.d.a.focus()}r.K=function(){var a=this.a.d.a.clientWidth,b=this.a.d.a.clientHeight;a!==b&&(b=a=Math.min(a,b));this.a.d.ta(a,b);ra(this);this.za()};function xa(a,b,c,d){if(a.b.w&&d!==a.te[(c<<8)+b]){var f=a.a.Rb.d.a.getContext("2d"),e=a.a.da.d.a.getContext("2d"),g=a.b.ua,h=(g-1)/2,l=a.b.w,k=a.b.Va,m=l[b-1].f-h,h=l[c-1].g-h;switch(d){case G:f.putImageData(a.b.kd,m,h);e.putImageData(a.b.da,m+k,h+k);break;case H:f.putImageData(a.b.je[a.b.pf[b-1+(c-1)*a.C.N().f]],m,h);e.putImageData(a.b.da,m+k,h+k);break;default:f.clearRect(m,h,g,g),e.clearRect(m+k,h+k,g,g)}a.te[(c<<8)+b]=d;b===a.Ia.f&&c===a.Ia.g&&(G===d||H===d?ea(a):a.cb())}}r.La=function(a,b){var c=(b<<8)+a;delete this.ga[""+c];c===this.Tc&&(this.ga[""+c]=new I(a,b,ya,""))};r.ma=function(a){za(this,a.Lb(),a.Mb(),a)};function E(a,b){if(a.e.F&Aa&&a.Xa!==b){a.Xa=b;a.cb();if(1===b){var c=a.C;c.Na=[];for(var d=1;d<=c.$;d++)for(var f=1;f<=c.I;f++)c.Na[Ba(c,f,d)]=J;Ca(c,!1);a.e.tc()}a.e.Bb()}}r.ia=function(a,b){var c=document.createElement("canvas");c.setAttribute("id",b);c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("oncontextmenu","return false;");a.appendChild(c);return c};r.la=function(a,b){var c=document.createElement("div");c.setAttribute("id",b);c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("oncontextmenu","return false;");a.appendChild(c);return c};r.W=function(a,b,c){a.d=F(c);a=a.d;L(a.h,0,0,1E3,1E3,!1,!1,!1,!1,-1,-1);a.u=N|O|Q|R;b.s(a)};r.lc=function(a,b){var c=Da(this.a.D.d.a);return{f:a-c.f,g:b-c.g}};function ra(a){var b=a.C.N(),c=b.f,d=b.g;if(!0===a.Xb){var b=Ea/(2*Fa+c),c=(Ea-c*b)/2,f=Ga/(2*Ha+d),d=(Ga-d*f)/2;a.nb=(d+f/2)/Ga;a.mb=(c+b/2)/Ea}else b=Ea/(2*Fa+c-1),c=(Ea-(c-1)*b)/2,f=Ga/(2*Ha+d-1),d=(Ga-(d-1)*f)/2,a.nb=d/Ga,a.mb=c/Ea;a.$b=b/Ea;a.Zb=f/Ga;a.pe=4/Ea}r.za=function(a){var b=this.a.D.d.a.width,c=this.a.D.d.a.height;if(b!=this.b.A||c!=this.b.t||null===this.b.D||null!==this.ra||!0===a){if(null!==this.ra&&clearTimeout(this.ra),this.ra=this.De(),this.bd(),0!==b&&0!==c){a=this.a.D.d.a.getContext("2d");a.fillStyle=S(this.Fb.Ff);a.fillRect(0,0,b,c);var d=this.a.w.d.a.getContext("2d");a=this.mb*b;var f=this.nb*c,e=this.$b*b,g=this.Zb*c,h=this.C.N();d.clearRect(0,0,b,c);d.strokeStyle=S(this.Fb.Lf);for(var l=b-a,k=0;k<h.g;k++){var m=f+k*g;d.beginPath();d.moveTo(a,m);d.lineTo(l,m);d.stroke()}for(var l=c-f,n=0;n<h.f;n++)m=a+n*e,d.beginPath(),d.moveTo(m,f),d.lineTo(m,l),d.stroke();if(h.f===h.g&&(9===h.f||13===h.f||19===h.f)){d.fillStyle=S(this.Fb.Kf);k=Math.max(2,this.pe*b/2);n=[];switch(h.f){case 9:n=[[2,2],[2,6],[4,4],[6,2],[6,6]];break;case 13:n=[[3,3],[3,6],[3,9],[6,3],[6,6],[6,9],[9,3],[9,6],[9,9]];break;case 19:n=[[3,3],[3,9],[3,15],[9,3],[9,9],[9,15],[15,3],[15,9],[15,15]]}for(var t=0,p=n.length;t<p;t++)l=a+n[t][0]*e,m=f+n[t][1]*e,d.beginPath(),d.arc(l,m,k,0,2*Math.PI,!1),d.fill()}d=this.a.Rb.d.a.getContext("2d");d.clearRect(0,0,b,c);d.strokeStyle=S(this.Fb.Qf);d.lineWidth=1;t=S(this.Fb.Ef);p=S(this.Fb.Tf);for(k=1;k<=h.g;k++)for(n=1;n<=h.f;n++){l=this.C.H(n,k);if(G===l)d.fillStyle=t;else if(H===l)d.fillStyle=p;else continue;l=a+(n-1)*e;m=f+(k-1)*g;d.beginPath();d.arc(l,m,e/2,0,2*Math.PI,!1);d.fill();d.stroke()}this.a.da.d.a.getContext("2d").clearRect(0,0,b,c);this.a.Gc.d.a.getContext("2d").clearRect(0,0,b,c);this.a.Da.d.a.getContext("2d").clearRect(0,0,b,c);this.a.Ma.d.a.getContext("2d").clearRect(0,0,b,c)}}else{this.a.D.d.a.getContext("2d").putImageData(this.b.D,0,0);if(!0===this.Xb&&this.b.w){b=this.a.D.d.a.getContext("2d");c=this.b.A;g=this.b.t;a=this.C.N();for(h=0;h<a.f;h++){d=2*this.b.ua/3;f=(d-1)/2;l=this.b.w;e=l[h].f-f;l=this.nb*g/3-f;m=new String;switch(h+1){case 1:m="A";break;case 2:m="B";break;case 3:m="C";break;case 4:m="D";break;case 5:m="E";break;case 6:m="F";break;case 7:m="G";break;case 8:m="H";break;case 9:m="J";break;case 10:m="K";break;case 11:m="L";break;case 12:m="M";break;case 13:m="N";break;case 14:m="O";break;case 15:m="P";break;case 16:m="Q";break;case 17:m="R";break;case 18:m="S";break;case 19:m="T";break;case 20:m="a";break;case 21:m="b";break;case 22:m="c";break;case 23:m="d";break;case 24:m="e";break;case 25:m="f";break;case 26:m="g";break;case 27:m="h";break;case 28:m="j";break;case 29:m="k";break;case 30:m="l";break;case 31:m="m";break;case 32:m="n";break;case 33:m="o";break;case 34:m="p";break;case 35:m="q";break;case 36:m="r";break;case 37:m="s";break;case 38:m="t"}k=2*d/3;n=Ia(m)?"Arial":"Helvetica, Arial, Verdana";n=k+"px "+n;b.fillStyle="rgb(0,0,0)";b.font=n;k=d/2+k/3;d=(d-b.measureText(m).width)/2;b.fillText(m,e+d,l+k);l=g-this.nb*g/3-f;b.fillText(m,e+d,l+k)}for(g=0;g<a.g;g++)d=2*this.b.ua/3,f=(d-1)/2,l=this.b.w,e=this.mb*c/3-f,l=l[g].g-f,m=a.g-g+"",k=2*d/3,n=Ia(m)?"Arial":"Helvetica, Arial, Verdana",n=k+"px "+n,b.fillStyle="rgb(0,0,0)",b.font=n,k=d/2+k/3,d=(d-b.measureText(m).width)/2,b.fillText(m,e+d,l+k),e=c-this.mb*c/3-f,b.fillText(m,e+d,l+k)}Ja(this);b=this.b.A;c=this.b.t;this.a.Rb.d.a.getContext("2d").clearRect(0,0,b,c);this.a.da.d.a.getContext("2d").clearRect(0,0,b,c);this.te={};Ka(this);La(this)}};r.Be=function(){var a=this.a.D.d.a.width,b=this.a.D.d.a.height,c=this.a.D.d.a.getContext("2d");if(0!==a&&0!==b){for(var c=c.createImageData(a,b),d=.9,f=this.Za.r,e=this.Za.o,g=this.Za.n,h=Array(a),l=0;l<a;l++)h[l]=(Math.tan(300*l/a)+1)/2+(Math.tan(100*l/a)+1)/10;for(var k=Array(b),m=0;m<b;m++)k[m]=.02*Math.tan(m/b);for(var n,t,m=0;m<b;m++)for(l=0;l<a;l++){d=40*(h[l]+k[m])+.5;d-=Math.floor(d);d=.2>d?1-d/2:.4>d?1-(.4-d)/2:1;if(m==b-1||m==b-2&&l<a-2||l>=a-1||l==a-2&&m<b-1)d/=2;0==m||1==m&&1<l||0==l||1==l&&1<m?(n=128+f*d/2,t=128+e*d/2,d=128+g*d/2):(n=f*d,t=e*d,d*=g);var p=4*(l+m*a);c.data[p+0]=n;c.data[p+1]=t;c.data[p+2]=d;c.data[p+3]=255}this.b.D=c;this.b.A=a;this.b.t=b;this.ra=null}};r.bd=function(){var a=this.b.A,b=this.b.t;if(0!==a&&0!==b){for(var c=this.mb*a,d=this.nb*b,b=this.Zb*b,f=this.$b*a,e=this.C.N(),g=Array(e.f),h=c,l=d,k=0;k<e.f;k++)h=c+k*f,l=d+k*b,g[k]={f:Math.floor(h+.5),g:Math.floor(l+.5)};this.b.w=g;a=Math.max(2,Math.ceil(this.pe*a/2));c=2*a+1;d=this.b;b=this.we;f=document.createElement("canvas").getContext("2d").createImageData(c,c);e=a;g=-1;h=e*e;for(k=0;e>g;){g++;l=Math.sqrt(h-g*g);l=Math.ceil(l)-l;l<=k&&e--;var m=Math.floor(255*(1-l)),n=a+e,t=a+e,p=a+g,u=a+g,v=a-e,D=a-e,k=a-g,M=a-g;Ma(f,n,u,m,c,b);Ma(f,p,t,m,c,b);Ma(f,v,u,m,c,b);Ma(f,k,t,m,c,b);Ma(f,n,M,m,c,b);Ma(f,p,D,m,c,b);Ma(f,v,M,m,c,b);Ma(f,k,D,m,c,b);for(var m=n-1,t=t-1,v=v+1,D=D+1,n=f,w=m,K=c,P=b,Z=v;Z<=w;Z++)Ma(n,Z,u,255,K,P);u=f;n=t;w=c;K=b;for(P=D;P<=n;P++)Ma(u,p,P,255,w,K);p=f;u=c;for(n=b;v<=m;v++)Ma(p,v,M,255,u,n);M=f;v=c;for(m=b;D<=t;D++)Ma(M,k,D,255,v,m);k=l}d.Ke=f;this.b.Le=a}};function Ja(a,b){if(a.b.w){var c=a.b.A,d=a.b.t,f=a.a.w.d.a.getContext("2d"),e=a.C.N(),g=a.b.w;f.clearRect(0,0,c,d);if(e.f===e.g&&(9===e.f||13===e.f||19===e.f)){var d=a.b.Ke,h=a.b.Le,l=[];switch(e.f){case 9:l=[[2,2],[2,6],[4,4],[6,2],[6,6]];break;case 13:l=[[3,3],[3,6],[3,9],[6,3],[6,6],[6,9],[9,3],[9,6],[9,9]];break;case 19:l=[[3,3],[3,9],[3,15],[9,3],[9,9],[9,15],[15,3],[15,9],[15,15]]}for(var k=0,m=l.length;k<m;k++)f.putImageData(d,g[l[k][0]].f-h,g[l[k][1]].g-h)}for(var h=g[0].f,l=g[g.length-1].f,k=g[0].g,m=g[g.length-1].g,n=f.createImageData(1,m-k),t=f.createImageData(l-h,1),p=a.we,u=0;u<m-k;u++)d=4*u,n.data[d+0]=p.r,n.data[d+1]=p.o,n.data[d+2]=p.n,n.data[d+3]=p.ke;for(u=0;u<l-h;u++)d=4*u,t.data[d+0]=p.r,t.data[d+1]=p.o,t.data[d+2]=p.n,t.data[d+3]=p.ke;for(u=0;u<e.f;u++)f.putImageData(n,g[u].f,g[0].g),f.putImageData(t,g[0].f,g[u].g);if(void 0!==b)for(c=(2*Math.floor(parseInt(a.Zb*c)/2)+1-1)/2,e=g[1].f-g[0].f+2,h=g[1].g-g[0].g+2,d=0;d<b.length;d++)l=b[d].f,k=b[d].g,J===a.C.H(l,k)&&f.clearRect(g[l-1].f-c,g[k-1].g-c,e,h)}}function Ma(a,b,c,d,f,e){b=4*(b+c*f);a.data[b+0]=e.r;a.data[b+1]=e.o;a.data[b+2]=e.n;a.data[b+3]=d}function Ka(a){for(var b=a.C.N(),c=1;c<=b.g;c++)for(var d=1;d<=b.f;d++)xa(a,d,c,a.C.H(d,c))}r.Ae=function(){if(this.b.w){var a=this.a.da.d.a.getContext("2d"),b=this.b.ua;this.b.da=a.createImageData(b,b);a=this.b.da.data;this.b.Va=Math.max(parseInt(.15*b),3);for(var c=(b-5)/2+1,d=0;d<b;d++)for(var f=0;f<b;f++){var e=Math.abs(d-c),g=Math.abs(f-c),e=Math.sqrt(g*g+e*e)/c,e=1>e?.15+.75*(1-e):0,g=4*(b*d+f);a[g+0]=0;a[g+1]=0;a[g+2]=0;a[g+3]=parseInt(255*e)}}};r.cb=function(){da(this,this.Ia.f,this.Ia.g,!0)};function da(a,b,c,d){var f=y;if(-1===b||-1===c||0===b||0===c)ea(a);else if(null===a.ra&&null!==a.b.w&&(void 0===d&&(d=!1),b!==a.Ia.f||c!==a.Ia.g||!0===d)){a.Ia.f=b;a.Ia.g=c;var e=a.b.A,g=a.b.t;d=a.a.Ma.d.a.getContext("2d");d.clearRect(0,0,e,g);var g=(a.b.ua-1)/2,h=a.b.w,e=h[b-1].f-g,g=h[c-1].g-g;b=a.C.H(b,c);switch(a.Xa){case 0:J===b&&(G===a.e.qb?d.putImageData(a.b.qc,e,g):d.putImageData(a.b.Ic,e,g));break;case 1:G===b?d.putImageData(a.b.Ub,e,g):H===b&&d.putImageData(a.b.Tb,e,g);break;case 2:G===b?d.putImageData(a.b.Ub,e,g):H===b?d.putImageData(a.b.Tb,e,g):f.ea?d.putImageData(a.b.Ic,e,g):d.putImageData(a.b.qc,e,g);break;default:G===b?d.putImageData(a.b.Ub,e,g):d.putImageData(a.b.Tb,e,g)}}}function ea(a){var b=a.b.A,c=a.b.t;a.a.Ma.d.a.getContext("2d").clearRect(0,0,b,c);a.Ia.f=-1;a.Ia.g=-1}function ca(a,b,c){var d=a.b.A,f=a.b.t,e=a.mb*d,g=a.nb*f,f=a.Zb*f,d=a.$b*d,h=0;a=a.C.N();for(h=0;h<a.g-1&&c>g+f*h+f/2;h++);for(c=c=0;c<a.f-1&&b>e+d*c+d/2;c++);return{f:c+1,g:h+1}}function sa(a,b,c,d,f){a=a.a.Da.d.a.getContext("2d");a.clearRect(0,0,b,c);a.strokeStyle=S(f);a.fillStyle=S(f);a.lineWidth=d;a.beginPath();a.moveTo(1*b/4,1*c/4);a.lineTo(3*b/4,3*c/4);a.moveTo(3*b/4,1*c/4);a.lineTo(1*b/4,3*c/4);a.stroke();return a.getImageData(0,0,b,c)}r.X=function(a,b,c,d,f){void 0===f&&(f=1);var e=this.a.Da.d.a.getContext("2d");e.clearRect(0,0,a,b);e.globalAlpha=f;e.strokeStyle=S(d);e.fillStyle=S(d);e.lineWidth=c;var g=a/2;c=3*b/4;d=.1*a;f=Math.sqrt(g*g-(c-g)*(c-g))+g;g=-Math.sqrt(g*g-(c-g)*(c-g))+g;e.beginPath();e.moveTo(a/2,d);e.lineTo(f-d,c);e.lineTo(g+d,c);e.closePath();e.stroke();return e.getImageData(0,0,a,b)};function ta(a,b,c,d,f){a=a.a.Da.d.a.getContext("2d");a.clearRect(0,0,b,c);a.strokeStyle=S(f);a.fillStyle=S(f);a.lineWidth=Math.floor(d+.5);var e=b/2,g=-c/2*Math.sqrt(2)/2+c/2;f=Math.floor(Math.sqrt(e*e-(g-e)*(g-e))+e-d);e=Math.ceil(-Math.sqrt(e*e-(g-e)*(g-e))+e+d);g=Math.ceil(g+d);d=Math.floor(c/2*Math.sqrt(2)/2+c/2-d);a.beginPath();a.moveTo(f,g);a.lineTo(e,g);a.lineTo(e,d);a.lineTo(f,d);a.closePath();a.stroke();return a.getImageData(0,0,b,c)}function ua(a,b,c,d){a=a.a.Da.d.a.getContext("2d").createImageData(b,c);for(var f=0;f<c;f++)for(var e=0;e<b;e++){var g=4*(f*b+e);f>=c/3&&f<=2*c/3&&e>=b/3&&e<=2*b/3?(a.data[g+0]=d.r,a.data[g+1]=d.o,a.data[g+2]=d.n,a.data[g+3]=255):a.data[g+3]=0}return a}function va(a,b,c,d,f){a=a.a.Da.d.a.getContext("2d");a.clearRect(0,0,b,c);var e=b/2,g=4*d;a.strokeStyle=S(f);a.fillStyle=S(f);a.lineWidth=d;a.beginPath();a.arc(b/2,c/2,e-g,0,2*Math.PI,!1);a.stroke();return a.getImageData(0,0,b,c)}function Na(a,b,c){a=a.ga[""+((c<<8)+b)];return void 0!==a?a:null}function za(a,b,c,d){ya===d.p?Oa(a,b,c):a.ga[""+((c<<8)+b)]=d}function Oa(a,b,c){if(0>=b||0>=c)a.Tc=0;else{var d=(c<<8)+b;void 0===a.ga[""+d]&&(a.ga[""+d]=new I(b,c,ya,""));a.Tc=d}}function La(a){a.a.Da.d.a.getContext("2d").clearRect(0,0,a.b.A,a.b.t);var b=[],c;for(c in a.ga){var d=a.ga[c];Pa(a,d);Qa===d.p&&b.push({f:d.Lb(),g:d.Mb()})}Ja(a,b)}function Pa(a,b){if(a.b.w){var c=b.Lb(),d=b.Mb(),f=b.p,e=a.a.Da.d.a.getContext("2d"),g=a.b.ua,h=(g-1)/2,l=a.b.w,k=l[c-1].f-h,h=l[d-1].g-h,c=a.C.H(c,d);switch(f){case Ra:e.putImageData(a.b.af,k,h);break;case Sa:e.putImageData(a.b.bf,k,h);break;case ya:e.putImageData(a.b.Pe,k,h);break;case Ta:e.putImageData(c===G?a.b.Ie:a.b.He,k,h);break;case Ua:e.putImageData(c===G?a.b.Ze:a.b.Ye,k,h);break;case Va:e.putImageData(c===G?a.b.ff:a.b.ef,k,h);break;case Wa:e.putImageData(c===G?a.b.Ub:a.b.Tb,k,h);break;case Qa:f=b.Wc,d=2>=f.length?2*g/3:g/2,l=d+"px "+(Ia(f)?"Arial":"Helvetica, Arial, Verdana"),e.fillStyle=c===G?"rgb(255,255,255)":"rgb(0,0,0)",e.font=l,e.fillText(f,k+(g-e.measureText(f).width)/2,h+(g/2+d/3))}}}r.Ce=function(a,b,c){switch(this.Xa){case 0:if(Xa==c.Fe)1<=this.e.dc&&(ja(this.e,1),Ya(this,a,b));else if(c.ea&&c.na)this.e.Zd(G===this.e.qb?H:G),this.cb();else if(!0===c.na){var d=new String;switch(a){case 1:d="A";break;case 2:d="B";break;case 3:d="C";break;case 4:d="D";break;case 5:d="E";break;case 6:d="F";break;case 7:d="G";break;case 8:d="H";break;case 9:d="J";break;case 10:d="K";break;case 11:d="L";break;case 12:d="M";break;case 13:d="N";break;case 14:d="O";break;case 15:d="P";break;case 16:d="Q";break;case 17:d="R";break;case 18:d="S";break;case 19:d="T"}this.e.nc(d+b)}else if(c.ea){d=this.e;d.ha&&d.ha.Pf(!0);var f=d.i;z(d,d.fa);for(c=0;1E3>c&&J===d.V.H(a,b);)ma(d,1),c++;J===d.V.H(a,b)&&z(d,f);d.ha&&d.ha.Pf(!1)}else Ya(this,a,b),null!==this.tb&&Za(this.e.i)>=$a(this.tb)&&ab(this.tb);break;case 1:if(!0===c.na)this.e.vd(),E(this,0);else{d=this.C;f=d.H(a,b);if(J!==f)if(d.Sc.aa(),c=d.Na[Ba(d,a,b)],G!==c&&H!==c){d.O.aa();bb(d,a,b,f);for(var e in d.Sc.wa)c=T(e|0),d.O.aa(),cb(d,c.f,c.g,3-f),db(d.O,d,3);Ca(d,!0);d.O.aa();bb(d,a,b,f);db(d.O,d,3-f)}else d.O.aa(),bb(d,a,b,f),db(d.O,d,3),Ca(d,!0);this.e.tc()}break;case 2:!0===this.e.i.xb()&&(eb(this.e,!0,!0),fb(this.e));d=G;J!==this.C.H(a,b)?d=J:c.ea&&(d=H);xa(this,a,b,d);this.C.S(a,b,d,-1);this.e.mc(d,[(b<<8)+a]);break;case 3:gb(this,Va,a,b);break;case 4:gb(this,Ua,a,b);break;case 5:gb(this,Ta,a,b);break;case 6:gb(this,Wa,a,b);break;case 7:a:{f=Na(this,a,b);if(null!==f&&Qa===f.p)this.e.La([(b<<8)+a]),this.La(a,b);else{f="";c.ea&&(f=prompt("Enter the label that you want to add to board here. For best results, keep your label to one or two letters.",""));if(void 0==f||""===f||null===f){f=[];c=-1;for(d in this.ga)if(e=this.ga[d],Qa==e.p){e=e.Wc;var g=e.charCodeAt(0);1==e.length&&65<=g&&90>=g&&(f[g]=1)}for(d=65;90>=d;d++)if(void 0===f[d]||""==f[d]){c=d;break}f=-1==c?null:String.fromCharCode(c);if(null===f){alert("Sorry, all the standard labels are used up! To add more labels, you will have to shift click on the board and make up ur own labels to add.");break a}}d=new I(a,b,Qa,f);this.e.Hb(f,(b<<8)+a);za(this,a,b,d)}La(this)}break;case 8:a:{d=Na(this,a,b);if(null!==d&&Qa===d.p)this.e.La([(b<<8)+a]),this.La(a,b);else{d="";if(c.ea){d=this.C.Bd(a,b);if(-1==d){alert("Sorry, no move has been made at that location, so you can't mark it with the move number!");break a}d=""+d}if(void 0===d||""===d||null===d){d=[];c=0;for(f in this.ga)e=this.ga[f],Qa===e.p&&Ia(e.Wc)&&(d[c]=parseInt(e.Wc),c++);if(0>=c)d="1";else{d.sort(hb);e=f=0;for(var g=!1,h=0;h<c;h++){if(d[h]>f+1){e=f+1;g=!0;break}f=d[h]}g||(e=f+1);d=""+e}}f=new I(a,b,Qa,d);this.e.Hb(d,(b<<8)+a);za(this,a,b,f)}La(this)}}};function gb(a,b,c,d){var f=Na(a,c,d);if(null!==f&&b===f.p){if(a.e.La([(d<<8)+c]),a.La(c,d),a.b.w){b=(a.b.ua-1)/2;var e=a.b.w,f=e[c-1].f-b,e=e[d-1].g-b;a.a.Da.d.a.getContext("2d").clearRect(f,e,2*b,2*b);b=T(a.Tc);c===b.f&&d===b.g&&(Oa(a,c,d),Pa(a,Na(a,c,d)))}}else f=new I(c,d,b,""),a.e.ma(b,[(d<<8)+c]),za(a,c,d,f),Pa(a,f)}function Ya(a,b,c){if(J===a.C.H(b,c)){var d=G===a.e.qb?G:H,f=!1,e=new ib,f=a.C.sb;e.ba=f.ba;e.pb=f.pb;a.C.S(b,c,d,-1);f=null!==jb(a.C,b,c,d,!0)?!0:null!==kb(a.C,b,c,d)?!1:!0;a.C.S(b,c,J,-1);var g=a.C.sb;g.ba=e.ba;g.pb=e.pb;if(1==f){a:{for(var e=a.e,h=(c<<8)+b,f=0,l=A(e.i);f<l;f++){var g=e.i.J(f),k=g.Ja,m=k.p;if(h===k.ja()&&d===m&&(G===d||H===d)){b=e.i.Q;lb(e.i,f);e.i=g;e.dc++;e.B&&b!==f&&ia(e.B);break a}}e.F&1&&(eb(e,!1,!0),e.i.wb(b,c,d),e.B&&(e.B.Sa(),ia(e.B)))}fb(a.e)}}};function mb(a){this.j=a;this.e=null;this.U=this.p=0;this.gc=16;this.oe=!1;this.b={Je:null,Ue:null,Oe:null,Ee:null,Xe:null};this.a={d:null,sc:{d:null}};this.vf=new x(217,217,217,255);this.ag=new x(0,0,0,255);this.ue=new x(54,101,179,255);this.ve=new x(255,255,255,255);this.Yf=new x(140,140,140,255);this.$=this.I=0;var b=this;this.jc=function(){b.cd();4!==b.U&&(b.U=1,nb(b),b.Ce())};this.sg=function(){4!==b.U&&(b.U=2,nb(b))};this.pg=function(){4!==b.U&&(1!==b.U&&(b.U=2),nb(b))};this.kc=function(){4!==b.U&&(b.U=b.oe?8:0,nb(b))};this.cd=function(){b.e&&ob(b.e)}}r=mb.prototype;r.P=function(a,b,c){this.e=b;this.p=c;if(this.j)switch(this.p){case 1:this.j.k.hd.push(this);break;case 2:this.j.k.jd.push(this);break;case 3:this.j.k.Ra.push(this);break;case 4:this.j.k.Ta.push(this);break;case 5:this.j.k.Ad.push(this);break;case 6:this.j.k.zd.push(this);break;case 7:this.j.k.hb.push(this);break;case 8:this.j.k.ib.push(this);break;case 9:this.j.k.nd.push(this);break;case 10:this.j.k.pd.push(this);break;case 11:this.j.k.md.push(this);break;case 12:this.j.k.sd.push(this);break;case 13:this.j.k.qd.push(this);break;case 14:this.j.k.ld.push(this);break;case 15:this.j.k.td.push(this);break;case 16:this.j.k.rd.push(this);break;case 17:this.j.k.od.push(this);break;case 18:this.j.rb=this}this.a.d=F(a);b=this.a.d.a;b.setAttribute("title",pb(this));c=document.createElement("canvas");c.setAttribute("id",a+"_canvas");c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("oncontextmenu","return false;");b.appendChild(c);this.a.sc.d=F(a+"_canvas");a=this.a.sc.d;L(a.h,0,0,1E3,1E3,!1,!1,!1,!1,-1,-1);a.u=N|O|Q|R;this.a.d.s(a);b.onmousedown=this.jc;b.onmouseup=this.sg;b.onmouseover=this.pg;b.onmouseout=this.kc;b.onfocus=this.cd;b.tabIndex=-1;this.K()};r.K=function(){this.I=this.a.d.a.clientWidth;this.$=this.a.d.a.clientHeight;this.a.d.ta(this.I,this.$);this.za()};function qb(a,b){!0===b&&4===a.U?(a.U=0,nb(a)):!1===b&&4!==a.U&&(a.U=4,nb(a))}function rb(a,b){a.gc!==b&&(a.gc=b,a.za(),a.a.d.a.setAttribute("title",pb(a)))}function sb(a,b){a.oe!==b&&(a.oe=b,!0===b&&0===a.U?(a.U=8,nb(a)):!1===b&&8===a.U&&(a.U=0,nb(a)))}r.za=function(){var a=this.$,b=this.I;0!==b&&0!==a&&(this.b.Ee=tb(this,this.ue,this.ve,b,a),this.b.Oe=tb(this,this.ue,this.ve,b,a),this.b.Ue=tb(this,this.vf,this.ag,b,a),this.b.Je=tb(this,this.vf,this.Yf,b,a),this.b.Xe=tb(this,this.ue,this.ve,b,a),nb(this))};function tb(a,b,c,d,f){var e=a.a.sc.d.a.getContext("2d");e.fillStyle=S(b);e.fillStyle=S(b);e.fillRect(0,0,d,f);e.fillStyle=S(c);e.strokeStyle=S(c);c=Math.min(d,f);var g=(d-c)/2,h=(f-c)/2;switch(a.p){case 1:a.X(c,g,h,e,-1);var l=Math.ceil(g+c/10+.5),g=Math.ceil(h+c/5+.5);b=Math.floor(c/10+.5);a=Math.floor(3*c/5+.5);e.fillRect(l,g,b,a);break;case 2:a.X(c,g-c/10,h,e,-1);l=Math.ceil(g+8*c/10+.5);g=Math.ceil(h+c/5+.5);b=Math.floor(c/10+.5);a=Math.floor(3*c/5+.5);e.fillRect(l,g,b,a);break;case 3:a.X(c,g-c/10,h,e,-1);break;case 4:a.X(c,g-c/10,h,e,1);break;case 5:a.X(c,g+c/10,h,e,1);l=Math.ceil(g+c/10+.5);g=Math.ceil(h+c/5+.5);b=Math.floor(c/10+.5);a=Math.floor(3*c/5+.5);e.fillRect(l,g,b,a);break;case 6:a.X(c,g,h,e,1);l=Math.ceil(g+8*c/10+.5);g=Math.ceil(h+c/5+.5);b=Math.floor(c/10+.5);a=Math.floor(3*c/5+.5);e.fillRect(l,g,b,a);break;case 7:b=Math.ceil(g+.2*c+.5);a=Math.ceil(g+.35*c+.5);var l=Math.ceil(g+.57*c+.5),g=Math.ceil(g+.92*c+.5),k=Math.ceil(h+.2*c+.5),m=Math.ceil(h+.38*c+.5),n=Math.ceil(h+.52*c+.5),t=Math.ceil(h+.6*c+.5),p=Math.ceil(h+.68*c+.5);c=Math.ceil(h+.84*c+.5);e.beginPath();e.moveTo(b,k);e.lineTo(a,k);e.lineTo(a,n);e.lineTo(l,n);e.lineTo(l,m);e.lineTo(g,t);e.lineTo(l,c);e.lineTo(l,p);e.lineTo(b,p);e.closePath();e.fill();break;case 8:b=Math.ceil(g+.2*c+.5);a=Math.ceil(g+.35*c+.5);l=Math.ceil(g+.57*c+.5);g=Math.ceil(g+.92*c+.5);k=Math.ceil(h+.8*c+.5);m=Math.ceil(h+.62*c+.5);n=Math.ceil(h+.48*c+.5);t=Math.ceil(h+.4*c+.5);p=Math.ceil(h+(1-.68)*c+.5);c=Math.ceil(h+(1-.84)*c+.5);e.beginPath();e.moveTo(b,k);e.lineTo(a,k);e.lineTo(a,n);e.lineTo(l,n);e.lineTo(l,m);e.lineTo(g,t);e.lineTo(l,c);e.lineTo(l,p);e.lineTo(b,p);e.closePath();e.fill();break;case 9:l=Math.ceil(g+.5*c-c/10+.5);k=Math.ceil(h+.5*c-c/10+.5);b=Math.ceil(.25*c+.5);e.fillStyle=S(new x(255,255,255));e.strokeStyle=S(new x(0,0,0));e.beginPath();e.arc(l,k,b,0,2*Math.PI,!1);e.fill();e.stroke();e.fillStyle=S(new x(0,0,0));l=Math.ceil(g+.5*c+c/10+.5);k=Math.ceil(h+.5*c+c/10+.5);b=Math.ceil(.25*c+.5);e.beginPath();e.arc(l,k,b,0,2*Math.PI,!1);e.fill();break;case 10:a=e.createImageData(c,c);l=c/5|0;k=4*c/5|0;for(m=0;m<c;m++)for(n=0;n<c;n++)t=4*(m*c+n),m>=l&&m<=k&&n>=l&&n<=k?c-m>=n||m===l||m===k||n===l||n===k?(a.data[t+0]=0,a.data[t+1]=0,a.data[t+2]=0):(a.data[t+0]=255,a.data[t+1]=255,a.data[t+2]=255):(a.data[t+0]=b.r,a.data[t+1]=b.o,a.data[t+2]=b.n),a.data[t+3]=255;e.putImageData(a,g,h);break;case 11:l=Math.ceil(g+.75*c+.5);k=Math.ceil(h+.125*c+.5);b=Math.ceil(.25*c+.5);a=Math.ceil(.02*c+.5);e.fillRect(l,k,b,a);l=Math.ceil(g+.875*c+.5);k=Math.ceil(h+.5);b=Math.ceil(.02*c+.5);a=Math.ceil(.25*c+.5);e.fillRect(l,k,b,a);l=Math.ceil(g+.5);k=Math.ceil(h+.875*c+.5);b=Math.ceil(.25*c+.5);a=Math.ceil(.02*c+.5);e.fillRect(l,k,b,a);l=Math.ceil(g+.5*c-c/10+.5);k=Math.ceil(h+.5*c-c/10+.5);b=Math.ceil(.25*c+.5);e.fillStyle=S(new x(255,255,255));e.strokeStyle=S(new x(0,0,0));e.beginPath();e.arc(l,k,b,0,2*Math.PI,!1);e.fill();e.stroke();e.fillStyle=S(new x(0,0,0));l=Math.ceil(g+.5*c+c/10+.5);k=Math.ceil(h+.5*c+c/10+.5);b=Math.ceil(.25*c+.5);e.beginPath();e.arc(l,k,b,0,2*Math.PI,!1);e.fill();break;case 12:k=c/2;a=3*c/4;b=.1*c;m=Math.sqrt(k*k-(a-k)*(a-k))+k;n=-Math.sqrt(k*k-(a-k)*(a-k))+k;e.lineWidth=Math.ceil(.05*c+.5);e.beginPath();e.moveTo(g+c/2,h+2*b);e.lineTo(g+m-b,h+a+b);e.lineTo(g+n+b,h+a+b);e.closePath();e.stroke();break;case 13:k=c/2;b=.05*c;l=-c/2*Math.sqrt(2)/2+c/2;a=c/2*Math.sqrt(2)/2+c/2;m=Math.sqrt(k*k-(l-k)*(l-k))+k;n=-Math.sqrt(k*k-(l-k)*(l-k))+k;k=Math.floor(g+m-b);g=Math.ceil(g+n+b);l=Math.ceil(h+l+b);h=Math.floor(h+a-b);e.lineWidth=Math.ceil(.05*c+.5);e.beginPath();e.moveTo(k,l);e.lineTo(g,l);e.lineTo(g,h);e.lineTo(k,h);e.closePath();e.stroke();break;case 14:a=.05*c;k=c/2;b=4*a;e.lineWidth=Math.ceil(a+.5);e.beginPath();e.arc(g+c/2,h+c/2,k-b,0,2*Math.PI,!1);e.stroke();break;case 15:b=g+.25*c;a=g+.75*c;k=h+.25*c;m=h+.75*c;e.lineWidth=Math.ceil(.05*c+.5);e.beginPath();e.moveTo(b,k);e.lineTo(a,m);e.moveTo(a,k);e.lineTo(b,m);e.stroke();break;case 16:b="A";a=.8*c;l=g+(c-e.measureText(b).width)/2;e.font=a+"px Arial";e.fillText(b,l,h+c/2+a/3);break;case 17:b="1";a=.8*c;l=g+(c-e.measureText(b).width)/2;e.font=a+"px Helvetica, Arial, Verdana";e.fillText(b,l,h+c/2+a/3);break;case 18:16===a.gc?a.X(c,g,h,e,1):(b=Math.floor(g+c/5+c/20+.5),a=Math.ceil(g+4*c/5-c/20+.5),g=Math.ceil(h+c/5+.5),h=Math.ceil(h+4*c/5+.5),l=Math.ceil(b+c/5),c=Math.floor(a-c/5),e.beginPath(),e.moveTo(b,g),e.lineTo(l,g),e.lineTo(l,h),e.lineTo(b,h),e.closePath(),e.fill(),e.beginPath(),e.moveTo(a,g),e.lineTo(c,g),e.lineTo(c,h),e.lineTo(a,h),e.closePath(),e.fill())}return e.getImageData(0,0,d,f)}r.X=function(a,b,c,d,f){var e=Math.ceil(b+a/5+.5);b=Math.ceil(b+4*a/5+.5);var g=Math.ceil(c+a/5+.5),h=Math.ceil(c+a/2+.5);a=Math.ceil(c+4*a/5+.5);0>f?(d.beginPath(),d.moveTo(e,h),d.lineTo(b,g),d.lineTo(b,a)):(d.beginPath(),d.moveTo(e,g),d.lineTo(b,h),d.lineTo(e,a));d.closePath();d.fill()};function nb(a){var b=a.a.sc.d.a.getContext("2d"),c=null;switch(a.U){case 2:c=a.b.Oe;break;case 1:c=a.b.Ee;break;case 4:c=a.b.Je;break;case 8:c=a.b.Xe;break;default:case 0:c=a.b.Ue}b.putImageData(c,0,0)}r.Ce=function(){if(this.e)switch(this.p){case 1:var a=this.e;z(a,a.fa);break;case 2:ja(this.e,5);break;case 3:ja(this.e,1);break;case 4:ma(this.e,1);break;case 5:ma(this.e,5);break;case 6:for(a=this.e;la(a););z(a,a.i);break;case 7:na(this.e);break;case 8:ka(this.e);break;case 9:E(this.e.l,0);break;case 10:E(this.e.l,1);break;case 11:E(this.e.l,2);break;case 12:E(this.e.l,3);break;case 13:E(this.e.l,4);break;case 14:E(this.e.l,5);break;case 15:E(this.e.l,6);break;case 16:E(this.e.l,7);break;case 17:E(this.e.l,8);break;case 18:16===this.gc?ub(this.e):vb(this.e)}};function pb(a){switch(a.p){case 1:return"Back to the start";case 2:return"Back 5 moves";case 3:return"Back";case 4:return"Forward";case 5:return"Forward 5 moves";case 6:return"Go to the end";case 7:return"Next variant";case 8:return"Previous variant";case 9:return"Moves (F1)";case 10:return"Count Scores (F2)";case 11:return"Editor (F3)";case 12:return"Triangles (F4)";case 13:return"Squares (F5)";case 14:return"Circles (F6)";case 15:return"X marks (F7)";case 16:return"Text labels (F8)";case 17:return"Numeric labels (F9)";case 18:return 16===a.gc?"Autoplay start":"Autoplay stop"}};function wb(a){this.j=a;this.a={d:null,Ec:{d:null}};var b=this;this.Bf=function(){b.e.Yd(b.a.Ec.d.a.value)}}wb.prototype.P=function(a,b){this.e=b;this.a.d=F(a);var c=this.a.d.a,d=a+"_TextArea",f=document.createElement("textarea");f.setAttribute("id",d);f.setAttribute("style","position:absolute;padding:0;margin:0;resize:none;outline: none;-moz-appearance: none;");c.appendChild(f);f.onchange=this.Bf;f.onblur=this.Bf;c=this.a.d;this.a.Ec.d=F(d);d=this.a.Ec.d;L(d.h,0,0,2,2,!0,!0,!0,!0,-1,-1);d.u=N|O|Q|R;c.s(d);this.j&&this.j.le.push(this);this.K()};wb.prototype.Fc=function(a){this.a.Ec.d.a.value=a};wb.prototype.K=function(){this.a.d.ta(this.a.d.a.clientWidth,this.a.d.a.clientHeight)};function xb(){this.Aa=this.Ea=this.Fa=this.Ca=0;this.Jc=this.Lc=this.Mc=this.Kc=!1;this.Gb=this.eb=-1}function L(a,b,c,d,f,e,g,h,l,k,m){a.Ca=b;a.Fa=c;a.Ea=d;a.Aa=f;a.Kc=e;a.Mc=g;a.Lc=h;a.Jc=l;a.eb=k;a.Gb=m}var O=1,N=2,R=4,Q=8;function yb(){this.h=new xb;this.u=O|N;this.a=this.yc=this.Se=null;this.Qa=new xb;this.Y=[];this.Ab=0}yb.prototype.Ua=function(a){this.Ab=a};yb.prototype.s=function(a){a.yc=this;this.Y[this.Y.length]=a};yb.prototype.ta=function(a,b){if(null==this.yc)this.Qa.Ca=0,this.Qa.Fa=0,this.Qa.Ea=a,this.Qa.Aa=b,null!==this.a&&zb(this,a,b);else{var c=0,d=0,f=0,e=0,c=this.u&5,d=this.u&10;O==c?(c=this.h.Kc?this.h.Ca:this.h.Ca*a/1E3,f=-1!=this.h.eb?c+this.h.eb:this.h.Lc?a-this.h.Ea:this.h.Ea*a/1E3):R==c?(f=this.h.Lc?a-this.h.Ea:this.h.Ea*a/1E3,c=-1!=this.h.eb?f-this.h.eb:this.h.Kc?this.h.Ca:this.h.Ca*a/1E3):(O|R)==c?(c=this.h.Kc?this.h.Ca:this.h.Ca*a/1E3,f=this.h.Lc?a-this.h.Ea:this.h.Ea*a/1E3):(c=this.h.Ca,f=this.h.Ea);N==d?(d=this.h.Mc?this.h.Fa:this.h.Fa*b/1E3,e=-1!=this.h.Gb?d+this.h.Gb:this.h.Jc?b-this.h.Aa:this.h.Aa*b/1E3):Q==d?(e=this.h.Jc?b-this.h.Aa:this.h.Aa*b/1E3,d=-1!=this.h.Gb?e-this.h.Gb:this.h.Mc?this.h.Fa:this.h.Fa*b/1E3):(N|Q)==d?(d=this.h.Mc?this.h.Fa:this.h.Fa*b/1E3,e=this.h.Jc?b-this.h.Aa:this.h.Aa*b/1E3):(d=this.h.Fa,e=this.h.Aa);f<c&&(f=c);e<d&&(e=d);-2===this.h.eb?f=c+(e-d)*g_dKoef_Board_W_to_H:-3===this.h.eb&&(c=(e-d)*g_dKoef_Board_W_to_H);this.Qa.Ca=c;this.Qa.Fa=d;this.Qa.Ea=f;this.Qa.Aa=e;this.a.style.left=parseInt(c+.5)+"px";this.a.style.top=parseInt(d+.5)+"px";this.a.style.width=parseInt(f-c+.5)+"px";this.a.style.height=parseInt(e-d+.5)+"px";this.a.width=parseInt(f-c+.5);this.a.height=parseInt(e-d+.5);zb(this,f-c,e-d)}};function zb(a,b,c){var d=a.Y.length;if(1===a.Ab&&2===d){var f=a.Y[0],e=a.Y[1],g=b-400>=c?b-c:400;L(f.h,0,0,g,1E3,!1,!1,!0,!1,-1,-1);f.u=O|Q|N;L(e.h,b-g,0,1E3,1E3,!0,!1,!1,!1,-1,-1);e.u=R|Q|N}else 2===a.Ab&&1===d&&(f=a.Y[0],e=Math.min(b,c),L(f.h,(b-e)/2,(c-e)/2,1E3,1E3,!0,!0,!0,!1,e,e),f.u=O|Q|N);for(f=0;f<d;f++)a.Y[f].ta(b,c)}function F(a){var b=new yb;b.Se=a;b.a=document.getElementById(a);return b}function Ab(){this.a=this.yc=null;this.t=0;this.Y=[]}Ab.prototype.S=function(a){this.t=a};Ab.prototype.s=function(a){a.yc=this;this.Y[this.Y.length]=a};Ab.prototype.ta=function(a,b){var c=b-this.t,d=a;d!==c&&(c=d=Math.min(d,c));var f=(b-this.t-c)/2;this.a.style.left=parseInt((a-d)/2+.5)+"px";this.a.style.top=parseInt(f+.5)+"px";this.a.style.width=parseInt(d+.5)+"px";this.a.style.height=parseInt(c+this.t+.5)+"px";this.a.width=parseInt(d+.5);this.a.height=parseInt(c+this.t+.5);for(var f=this.Y.length,e=0;e<f;e++)this.Y[e].ta(d,c+this.t)};function Bb(a){if(this.e=a)a.j=this;this.qa=null;this.Z=[];this.k={hd:[],jd:[],Ra:[],Ta:[],Ad:[],zd:[],hb:[],ib:[],nd:[],pd:[],md:[],sd:[],qd:[],ld:[],td:[],rd:[],od:[]};this.ic=this.rb=this.xe=this.Uc=this.V=null;this.le=[];this.uf=40;setTimeout(function(){b.Af()},this.uf);var b=this;this.Af=function(){this.Uc&&Cb(this.Uc)&&Db(this.Uc);setTimeout(function(){b.Af()},b.uf)}}r=Bb.prototype;r.yd=function(a){var b=new aa(this);b.P(a,this.e);wa(b);this.Z.push(b);this.K()};r.xd=function(a){var b=this.e,c=F(a);this.M(c.a,a+"div");var d=a+"div",f=new Ab;f.Se=d;f.a=document.getElementById(d);f.S(25);var e=f.a;c.s(f);d=a+"_Board";a+="_Toolbar";this.M(e,d);this.M(e,a);e=F(d);L(e.h,0,0,1E3,25,!1,!1,!1,!0,-1,-1);e.u=N|O|R;f.s(e);e=new aa(this);e.P(d,b);wa(e);d=F(a);L(d.h,0,0,1E3,0,!1,!1,!1,!0,-1,25);d.u=O|Q|R;f.s(d);f=new Eb(this);f.P(a,b,{Y:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17]});this.qa=c;this.Z.push(e);this.Z.push(f);this.K()};r.wd=function(a){var b=this.e,c=F(a),d=a+"GoBoard";this.M(c.a,d);d=F(d);L(d.h,0,0,1,1,!1,!1,!0,!0,-1,-1);d.u=N|O|R|Q;c.s(d);d.Ua(1);var f=a+"_Board",e=a+"_Panel";this.M(d.a,f);this.M(d.a,e);var g=F(f);a=F(e);d.s(g);d.s(a);this.M(g.a,f+"_Centred");d=F(f);g.Ua(2);g.s(d);d=new aa(this);d.P(f,b);wa(d);f=e+"_CaT";g=e+"_Navigator";this.M(a.a,f);this.M(a.a,g);e=F(f);L(e.h,0,0,1E3,500,!1,!1,!1,!1,-1,-1);e.u=N|O|R|Q;a.s(e);var h=F(g);L(h.h,0,500,1E3,1E3,!1,!1,!1,!1,-1,-1);h.u=N|O|R|Q;a.s(h);a=new Fb(this);a.P(g,b);var l=f+"_Comments",h=f+"_Toolbar",k=f+"_ToolbarAutoPlay",m=f+"_ToolbarTimeLine";this.M(e.a,l);this.M(e.a,h);var n=this.M(e.a,k);this.M(e.a,m);f=k+"_Slider";g=k+"_Button";this.M(n,g);this.M(n,f);n=F(l);L(n.h,0,0,1E3,75,!1,!1,!1,!0,-1,25);n.u=N|O|R|Q;e.s(n);n=F(h);L(n.h,0,0,1E3,50,!1,!1,!1,!0,-1,25);n.u=O|R|Q;e.s(n);n=F(k);L(n.h,0,0,1E3,25,!1,!1,!1,!0,-1,25);n.u=O|R|Q;e.s(n);k=F(g);L(k.h,0,0,1E3,1E3,!1,!1,!1,!1,25,-1);k.u=O|N|Q;n.s(k);k=F(f);L(k.h,25,0,1E3,1E3,!0,!1,!1,!1,-1,25);k.u=N|R|Q;n.s(k);n=F(m);L(n.h,0,0,1E3,0,!1,!1,!1,!0,-1,25);n.u=O|R|Q;e.s(n);e=new wb(this);e.P(l,b);l=new Eb(this);l.P(h,b,{Y:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17]});h=new Gb(this);h.P(m,b,Hb,0);m=new mb(this);m.P(g,b,18);g=new Gb(this);g.P(f,b,Ib,0);this.Z.push(d);this.Z.push(a);this.Z.push(e);this.Z.push(l);this.Z.push(h);this.Z.push(m);this.Z.push(g);this.qa=c;this.K();b.B&&b.B.Sa();b.j&&(b.Bb(),c=b.j,c.ic&&(c=c.ic,!0!==c.Wb&&Jb(c,b.Yb,!0)))};r.K=function(){this.qa&&this.qa.ta(this.qa.a.clientWidth,this.qa.a.clientHeight);for(var a=0,b=this.Z.length;a<b;a++)this.Z[a].K()};r.M=function(a,b){var c=document.createElement("div");c.setAttribute("id",b);c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("oncontextmenu","return false;");a.appendChild(c);return c};r.We=function(a){this.V=a};function Kb(a){a.rb&&rb(a.rb,0)}r.Bb=function(a){for(var b=0,c=this.k.hd.length;b<c;b++)qb(this.k.hd[b],a.Ra);b=0;for(c=this.k.jd.length;b<c;b++)qb(this.k.jd[b],a.Ra);b=0;for(c=this.k.Ra.length;b<c;b++)qb(this.k.Ra[b],a.Ra);b=0;for(c=this.k.Ta.length;b<c;b++)qb(this.k.Ta[b],a.Ta);b=0;for(c=this.k.Ad.length;b<c;b++)qb(this.k.Ad[b],a.Ta);b=0;for(c=this.k.zd.length;b<c;b++)qb(this.k.zd[b],a.Ta);b=0;for(c=this.k.hb.length;b<c;b++)qb(this.k.hb[b],a.hb);b=0;for(c=this.k.ib.length;b<c;b++)qb(this.k.ib[b],a.ib);b=0;for(c=this.k.nd.length;b<c;b++)sb(this.k.nd[b],0===a.Ba);b=0;for(c=this.k.pd.length;b<c;b++)sb(this.k.pd[b],1===a.Ba);b=0;for(c=this.k.md.length;b<c;b++)sb(this.k.md[b],2===a.Ba);b=0;for(c=this.k.sd.length;b<c;b++)sb(this.k.sd[b],3===a.Ba);b=0;for(c=this.k.qd.length;b<c;b++)sb(this.k.qd[b],4===a.Ba);b=0;for(c=this.k.ld.length;b<c;b++)sb(this.k.ld[b],5===a.Ba);b=0;for(c=this.k.td.length;b<c;b++)sb(this.k.td[b],6===a.Ba);b=0;for(c=this.k.rd.length;b<c;b++)sb(this.k.rd[b],7===a.Ba);b=0;for(c=this.k.od.length;b<c;b++)sb(this.k.od[b],8===a.Ba);this.xe&&(b=this.xe,!0!==b.Wb&&Jb(b,a.df,!0))};r.Fc=function(a){for(var b=0,c=this.le.length;b<c;b++)this.le[b].Fc(a)};var Lb=0,Mb=1,Xa=2,y=new function(){this.Fe=this.g=this.f=0;this.Ab=Mb;this.ea=this.na=this.oc=!1;this.oa=null;this.Pb=-1;this.Re=this.Qe=this.Jb=0;this.Pd=this.uc=!1},ha=new function(){this.ea=this.na=this.oc=!1;this.oa=null;this.vc=this.Gf=0};function ga(a){ha.oc=a.altKey;ha.na=void 0!==a.metaKey?a.ctrlKey||a.metaKey:a.ctrlKey;ha.ea=a.shiftKey;ha.oa=a.srcElement?a.srcElement:a.target;ha.Gf=a.charCode;ha.vc=a.keyCode;ha.Ag=a.which}function ba(a){if(!a.uc||a.Pd){if(a.pageX||a.pageY)y.f=a.pageX,y.g=a.pageY;else if(a.clientX||a.clientY)y.f=a.clientX,y.g=a.clientY;y.oc=a.altKey;y.ea=a.shiftKey;y.na=a.ctrlKey||a.metaKey;y.Ab=Mb;y.uc||(y.oa=a.srcElement?a.srcElement:a.target);if(3<Math.abs(y.f-y.Qe)||3<Math.abs(y.g-y.Re))y.Pb=-1,y.Jb=0}}function fa(a){if(a.pageX||a.pageY)y.f=a.pageX,y.g=a.pageY;else if(a.clientX||a.clientY)y.f=a.clientX,y.g=a.clientY;y.Qe=y.f;y.Re=y.g;y.oc=a.altKey;y.ea=a.shiftKey;y.na=a.ctrlKey||a.metaKey;y.Ab=Lb;y.Fe=a.button;y.oa=a.srcElement?a.srcElement:a.target;a=(new Date).getTime();0==y.Jb?(y.Jb=1,y.Pb=a):500>a-y.Pb?(y.Pb=a,y.Jb++):(y.Jb=1,y.Pb=a);window.qf=!1}window.onmousemove=function(a){y.uc&&void 0!=y.oa&&null!=y.oa&&void 0!=y.oa.onmousemove&&null!=y.oa.onmousemove&&(y.Pd=!0,y.oa.onmousemove(a),y.Pd=!1)};window.onmouseup=function(a){if(!1===window.qf&&(window.qf=!0,y.uc&&void 0!=y.oa.onmouseup&&null!=y.oa.onmouseup))y.oa.onmouseup(a,!0)};function Nb(){this.ib=this.hb=this.Ta=this.Ra=!0;this.df=this.Ba=0};var ya=-1,Va=0,Ua=1,Ta=2,Qa=3,Wa=4,Ra=5,Sa=6;function I(a,b,c,d){this.wf={f:void 0===a?0:a,g:void 0==b?0:b};this.p=void 0===c?Va:c;this.Wc=void 0===d?"":d}I.prototype.Lb=function(){return this.wf.f};I.prototype.Mb=function(){return this.wf.g};I.prototype.Ua=function(a){this.p=a};function Fb(a){this.j=a;this.e=null;this.q=new Ob;this.Oc=this.Nc=!0;this.a={d:null,D:{d:null},Selection:{d:null},fb:{d:null},w:{d:null},ae:{d:null},Vd:{d:null},Jf:{d:null},R:null,T:null,gb:null,jb:null,Bc:0,Ac:0};this.Za=new x(231,188,95,255);this.we=new x(0,0,0,255);this.ra=null;this.b={A:0,t:0,D:null,Ib:null,Sb:null,pc:null,Hc:null,Jd:null,Ne:null,Dd:null,Me:null,Hd:null,ce:null,of:null,ge:null,Nd:null,Kd:null,Ld:null,Md:null,Od:null,Ed:null,Fd:null,Gd:null,Id:null,ie:null,de:null,ee:null,fe:null,he:null,gf:null,kf:null,hf:null,lf:null,jf:null,mf:null,Ma:null,fb:null,da:null,Va:0};this.v={f:0,g:0};this.Db=!1;this.Vf=!0;this.sa={A:0,t:0,f:0,g:0};var b=this;this.De=function(){return setTimeout(function(){b.Be()},20)};this.jc=function(a){b.Db||(b.e&&ob(b.e),fa(a),a=b.lc(y.f,y.g),a=b.q.H(a.f,a.g),a.Nb()&&b.e&&z(b.e,a))};this.dd=function(a){b.Db||(ba(a),a=b.lc(y.f,y.g),b.cb(a.f,a.g))};this.kc=function(){b.Db||b.cb(-1,-1)};this.tg=function(a){if(b.Db)return!1;var d=0,d=void 0!=a.wheelDelta?0<a.wheelDelta?-45:45:0<a.detail?45:-45;a.preventDefault&&a.preventDefault();var f=20+24*(b.q.q.length+1)-b.a.D.d.a.height;b.v.g-=d;b.v.g=Math.min(0,Math.max(b.v.g,-f));Pb(b);b.dd(a);Qb(b);return!1};this.cd=function(){b.e&&ob(b.e)};this.qg=function(){b.a.R.style.opacity=.7;b.a.gb.style.opacity=.3;b.a.gb.style.display="block"};this.ng=function(){b.a.R.style.opacity=.5;b.a.gb.style.opacity=0;b.a.gb.style.display="none"};this.rg=function(){b.a.T.style.opacity=.7;b.a.jb.style.opacity=.3;b.a.jb.style.display="block"};this.og=function(){b.a.T.style.opacity=.5;b.a.jb.style.opacity=0;b.a.jb.style.display="none"};this.zf=function(){b.Db=!0};this.yf=function(){b.Db=!1};this.gg=function(a){var d=b.b.A;b.v.f=-((a-2)/(d-4-b.a.Bc)*(20+24*(Rb(b.q)+1)-d));Pb(b)};this.ig=function(a,d){var f=b.b.t;b.v.g=-((d-2)/(f-4-b.a.Ac)*(20+24*(b.q.q.length+1)-f));Pb(b)}}r=Fb.prototype;r.P=function(a,b){this.j&&(this.j.Uc=this);this.e=b;this.e.B=this;this.q.e=b;this.a.d=F(a);var c=this.a.d.a,d=this.a.d,f=a+"_Board",e=a+"_Selection",g=a+"_Current",h=a+"_Lines",l=a+"_Shadows",k=a+"_Nodes",m=a+"_Events";this.ia(c,f);this.ia(c,e);this.ia(c,g);this.ia(c,h);this.ia(c,l);this.ia(c,k);var n=this.la(c,m);this.a.gb=this.la(c,a+"HorScroll_BG");this.a.R=this.la(c,a+"HorScroll");this.a.jb=this.la(c,a+"VerScroll_BG");this.a.T=this.la(c,a+"VerScroll");this.a.gb.style.background="rgb(0,0,0)";this.a.gb.style.display="none";this.a.jb.style.background="rgb(0,0,0)";this.a.jb.style.display="none";this.a.R.onmouseover=this.qg;this.a.R.onmouseout=this.ng;this.a.T.onmouseover=this.rg;this.a.T.onmouseout=this.og;c=F(a+"HorScroll_BG");L(c.h,2,0,2,4,!0,!1,!0,!0,-1,8);c.u=O|Q|R;d.s(c);c=F(a+"VerScroll_BG");L(c.h,0,2,4,2,!1,!0,!0,!0,8,-1);c.u=N|Q|R;d.s(c);this.W(this.a.D,d,f);this.W(this.a.Selection,d,e);this.W(this.a.fb,d,g);this.W(this.a.w,d,h);this.W(this.a.ae,d,l);this.W(this.a.Vd,d,k);this.W(this.a.Jf,d,m);n.onmousedown=this.jc;n.onmousemove=this.dd;n.onmouseout=this.kc;n.onmousewheel=this.tg;n.onfocus=this.cd;n.tabIndex=-1;n.style.Uf=!0;n.style.outline=0;d=this.a.Vd.d.a.getContext("2d");this.b.Ib=d.createImageData(20,20);this.b.Sb=d.createImageData(20,20);this.b.pc=d.createImageData(20,20);this.b.Hc=d.createImageData(20,20);d=this.b.Ib.data;f=this.b.Sb.data;e=this.b.pc.data;g=this.b.Hc.data;h=Math.sqrt(3);for(l=0;20>l;l++)for(k=0;20>k;k++){var c=l-9.5,t=k-9.5,p=9.3-Math.sqrt(c*c+t*t),m=4*(20*l+20-k-1);if(0<=p){var u=9.3*9.3-c*c-t*t,u=0<u?Math.sqrt(u)*h:0,v=c,D=t,n=Math.sqrt(6*(v*v+D*D+u*u)),n=(2*u-v+D)/n,u=0;.9<n&&(u=10*(n-.9));v=255;.8>=p&&(p=(.8-p)/.8,v=.7,3.1>c-t&&(v=1),v=parseInt(255*(1-p*v)));c=parseInt(10+10*n+140*u);d[m+0]=c;d[m+1]=c;d[m+2]=c;d[m+3]=v;e[m+0]=c;e[m+1]=c;e[m+2]=c;e[m+3]=parseInt(.5*v);c=parseInt(200+10*n+45*u);f[m+0]=c;f[m+1]=c;f[m+2]=c;f[m+3]=v;g[m+0]=c;g[m+1]=c;g[m+2]=c;g[m+3]=parseInt(.7*v)}else d[m+0]=0,d[m+1]=0,d[m+2]=0,d[m+3]=0,g[m+0]=0,g[m+1]=0,g[m+2]=0,g[m+3]=0}this.bd();d=this.a.Selection.d.a.getContext("2d");this.b.Ma=d.createImageData(24,24);this.b.fb=d.createImageData(24,24);f=this.b.Ma.data;e=this.b.fb.data;for(g=0;24>g;g++)for(h=0;24>h;h++)l=4*(h+24*g),f[l+3]=255,e[l+3]=255,0===h&&23===g||23===h&&0===g?(f[l+0]=135,f[l+1]=125,f[l+2]=135,e[l+0]=216):23===h||23===g?(f[l+0]=89,f[l+1]=89,f[l+2]=89,e[l+0]=178):(0===g||0===h?(f[l+0]=182,f[l+1]=182,f[l+2]=182):(f[l+0]=128,f[l+1]=128,f[l+2]=128),e[l+0]=255),e[l+1]=0,e[l+2]=0;d.putImageData(this.b.Ma,0,0);d.putImageData(this.b.fb,0,30);this.Ae()};r.K=function(a){var b=this.a.d.a.clientWidth,c=this.a.d.a.clientHeight;this.a.d.ta(b,c);this.za(b,c,a)};function ia(a){if(!(0>=a.b.A||0>=a.b.t)){var b=a.b.A,c=a.b.t,d=20+24*(Rb(a.q)+1),f=20+24*(a.q.q.length+1);d>b?(a.a.Bc=Math.max(50,b*b/d),a.a.R.style.width=Math.max(50,b*b/d)+"px",a.a.R.style.display="block",a.a.R.style.position="absolute",a.a.R.style.top=c-12+"px",a.a.R.style.height="8px",a.a.R.style.background="rgb(0,0,0)",a.a.R.style.opacity=.5,Sb(a.a.R,2,b-a.a.Bc-2,c-12,c-12),a.a.R.Zc=a.gg,a.a.R.ad=a.zf,a.a.R.$c=a.yf):a.a.R.style.display="none";f>c?(a.a.Ac=Math.max(50,c*c/f),a.a.T.style.height=Math.max(50,c*c/f)+"px",a.a.T.style.display="block",a.a.T.style.position="absolute",a.a.T.style.left=b-12+"px",a.a.T.style.width="8px",a.a.T.style.background="rgb(0,0,0)",a.a.T.style.opacity=.5,Sb(a.a.T,b-12,b-12,2,c-a.a.Ac-2),a.a.T.Zc=a.ig,a.a.T.ad=a.zf,a.a.T.$c=a.yf):a.a.T.style.display="none";a.sa.t=-1;a.sa.A=-1;Pb(a);Qb(a)}}r.Sa=function(){this.q.Sa();this.sa.t=-1;this.sa.A=-1};function Tb(a,b){a.Nc=!0;var c=a.b.A,d=a.b.t;if(!(0>=c||0>=d)){var f=a.e.i.ka,e=f.f,f=f.g,g=10+a.v.f+24*e,h=10+a.v.g+24*f;if(0!=b&&!0===a.Vf&&(10>=g||g>=c-10||10>=h||h>=d-10)){var l=20+24*(a.q.q.length+1)-d,k=20+24*(Rb(a.q)+1)-c;10>=g?a.v.f=24*-e:g>=c-10&&(a.v.f=c-24-10-10-24*e);10>=h?a.v.g=24*-f:h>=d-10&&(a.v.g=d-24-10-10-24*f);a.v.f=Math.min(0,Math.max(a.v.f,-k));a.v.g=Math.min(0,Math.max(a.v.g,-l));Qb(a);Pb(a)}}}function Db(a){if(a.Nc&&a.e){var b=a.b.A,c=a.b.t;if(!(0>=b||0>=c)){var d=a.e.i.ka,f=10+a.v.f+24*d.f,d=10+a.v.g+24*d.g,e=a.a.fb.d.a.getContext("2d");e.clearRect(0,0,b,c);-24<=f&&f<=b+24&&-24<=d&&d<=c+24&&e.putImageData(a.b.fb,f,d);a.Nc=!1}}if(a.Oc&&(b=a.b.A,c=a.b.t,0!==b&&0!==c)){if(!(a.sa.A===b&&a.sa.t===c&&1>Math.abs(a.v.f-a.sa.f)&&1>Math.abs(a.v.g-a.sa.g))){a.sa.A=b;a.sa.t=c;a.sa.f=a.v.f;a.sa.g=a.v.g;var f=a.a.w.d.a.getContext("2d"),d=a.a.ae.d.a.getContext("2d"),e=a.a.Vd.d.a.getContext("2d"),g=a.a.Selection.d.a.getContext("2d");e.clearRect(0,0,b,c);d.clearRect(0,0,b,c);f.clearRect(0,0,b,c);g.clearRect(0,0,b,c);for(var g=10+a.v.f,h=10+a.v.g,l=a.q.q.length,k=0;k<=l-1;k++){var m=h+24*k;if(-24<=m&&m<=c+24)for(var n=a.q.q[k].length-1,t=0;t<=n;t++){var p=g+24*t;if(-24<=p&&p<=b+24){var u=a.q.H(t,k);if(!1===u.Nb()){var v=u.yb();switch(u.p){case Ub:v.Wa?f.putImageData(a.b.ce,p,m):f.putImageData(a.b.ie,p,m);break;case Vb:v.Wa?1===v.$e?f.putImageData(a.b.de,p,m):f.putImageData(a.b.ee,p,m):f.putImageData(a.b.fe,p,m);break;case Wb:v.Wa?f.putImageData(a.b.ge,p,m):f.putImageData(a.b.he,p,m)}}else{var v=u.yb(),D=u.Ja.p,M=""+u.ka.Wd,w=e.measureText(M).width,K=u.$a;G===D?(v&&d.putImageData(a.b.da,p+2+a.b.Va,m+2+a.b.Va),e.putImageData(v?a.b.Ib:a.b.pc,p+2,m+2),""===K?(e.font="bold 10px sans-serif",e.fillStyle=v?"#CCC":"rgb(192, 192, 192)",e.fillText(M,p+12-w/2,m+12+3)):e.putImageData(v?a.b.hf:a.b.jf,p+2,m+2)):H===D?(v&&d.putImageData(a.b.da,p+2+a.b.Va,m+2+a.b.Va),e.putImageData(v?a.b.Sb:a.b.Hc,p+2,m+2),""===K?(e.font="bold 10px sans-serif",e.fillStyle=v?"#000":"rgb(56, 56, 56)",e.fillText(M,p+12-w/2,m+12+3)):e.putImageData(v?a.b.lf:a.b.mf,p+2,m+2)):e.putImageData(v?a.b.gf:a.b.kf,p+2,m+2);M=A(u);u=u.Q;0===t?0!==M&&(1===M?v?f.putImageData(a.b.Jd,p,m):f.putImageData(a.b.Nd,p,m):v?0==u?f.putImageData(a.b.Kd,p,m):f.putImageData(a.b.Ld,p,m):f.putImageData(a.b.Md,p,m)):0===M?v?f.putImageData(a.b.Hd,p,m):f.putImageData(a.b.Id,p,m):1===M?v?f.putImageData(a.b.Dd,p,m):f.putImageData(a.b.Od,p,m):v?0===u?f.putImageData(a.b.Ed,p,m):f.putImageData(a.b.Fd,p,m):f.putImageData(a.b.Gd,p,m);G!==D&&H!==D||f.clearRect(p+3,m+3,18,18)}}}}}a.Oc=!1}}function Cb(a){return a.Nc||a.Oc?!0:!1}r.ia=function(a,b){var c=document.createElement("canvas");c.setAttribute("id",b);c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("oncontextmenu","return false;");a.appendChild(c);return c};r.la=function(a,b){var c=document.createElement("div");c.setAttribute("id",b);c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("oncontextmenu","return false;");a.appendChild(c);return c};r.W=function(a,b,c){a.d=F(c);a=a.d;L(a.h,0,0,1E3,1E3,!1,!1,!1,!1,-1,-1);a.u=N|O|Q|R;b.s(a)};r.za=function(a,b){var c=this.a.D.d.a.getContext("2d");a!==this.b.A||b!==this.b.t||null===this.b.D||null!==this.ra?(this.b.A=a,this.b.t=b,c.fillStyle=S(this.Za),c.fillRect(0,0,a,b),null!==this.ra&&clearTimeout(this.ra),this.ra=this.De()):c.putImageData(this.b.D,0,0);ia(this)};r.Be=function(){this.ra=null;var a=this.b.A,b=this.b.t,c=this.a.D.d.a.getContext("2d");if(0!==a&&0!==b){for(var d=c.createImageData(a,b),f=this.Za.r,e=this.Za.o,g=this.Za.n,h=Array(a),l=0;l<a;l++)h[l]=(Math.tan(300*l/a)+1)/2+(Math.tan(100*l/a)+1)/10;for(var k=Array(b),m=0;m<b;m++)k[m]=.02*Math.tan(m/b);var n,t,p;p=.9;for(m=0;m<b;m++)for(l=0;l<a;l++){p=40*(h[l]+k[m])+.5;p-=Math.floor(p);p=.2>p?1-p/2:.4>p?1-(.4-p)/2:1;if(m==b-1||m==b-2&&l<a-2||l>=a-1||l==a-2&&m<b-1)p/=2;0==m||1==m&&1<l||0==l||1==l&&1<m?(n=128+f*p/2,t=128+e*p/2,p=128+g*p/2):(n=f*p,t=e*p,p*=g);var u=4*(l+m*a);d.data[u+0]=n;d.data[u+1]=t;d.data[u+2]=p;d.data[u+3]=255}this.b.D=d;c.putImageData(this.b.D,0,0)}};r.bd=function(){var a=this.a.w.d.a.getContext("2d");this.b.Jd=a.createImageData(24,24);this.b.Ne=a.createImageData(24,24);this.b.Dd=a.createImageData(24,24);this.b.Me=a.createImageData(24,24);this.b.Hd=a.createImageData(24,24);this.b.ce=a.createImageData(24,24);this.b.of=a.createImageData(24,24);this.b.ge=a.createImageData(24,24);this.b.Nd=a.createImageData(24,24);this.b.Kd=a.createImageData(24,24);this.b.Ld=a.createImageData(24,24);this.b.Md=a.createImageData(24,24);this.b.Od=a.createImageData(24,24);this.b.Ed=a.createImageData(24,24);this.b.Fd=a.createImageData(24,24);this.b.Gd=a.createImageData(24,24);this.b.Id=a.createImageData(24,24);this.b.ie=a.createImageData(24,24);this.b.de=a.createImageData(24,24);this.b.ee=a.createImageData(24,24);this.b.fe=a.createImageData(24,24);this.b.he=a.createImageData(24,24);for(var a=this.b.Jd.data,b=this.b.Ne.data,c=this.b.Dd.data,d=this.b.Me.data,f=this.b.Hd.data,e=this.b.ce.data,g=this.b.of.data,h=this.b.ge.data,l=this.b.Nd.data,k=this.b.Kd.data,m=this.b.Ld.data,n=this.b.Md.data,t=this.b.Od.data,p=this.b.Ed.data,u=this.b.Fd.data,v=this.b.Gd.data,D=this.b.Id.data,M=this.b.ie.data,w=this.b.de.data,K=this.b.ee.data,P=this.b.fe.data,Z=this.b.he.data,s=new x(28,28,28,255),B=0;24>B;B++)for(var C=0;24>C;C++){var q=4*(24*B+C);12<=C&&(11===B||12===B)?(a[q+0]=s.r,a[q+1]=s.n,a[q+2]=s.o,a[q+3]=255,l[q+0]=s.r,l[q+1]=s.n,l[q+2]=s.o,l[q+3]=96):(a[q+3]=0,l[q+3]=0);11<=C&&(11===B||12===B)||12<=B&&(11===C||12===C)?(b[q+0]=s.r,b[q+1]=s.n,b[q+2]=s.o,b[q+3]=255,n[q+0]=s.r,n[q+1]=s.n,n[q+2]=s.o,n[q+3]=96):(b[q+3]=0,n[q+3]=0);11<=C&&(11===B||12===B)?(k[q+0]=s.r,k[q+1]=s.n,k[q+2]=s.o,k[q+3]=255):12<=B&&(11===C||12===C)?(k[q+0]=s.r,k[q+1]=s.n,k[q+2]=s.o,k[q+3]=96):k[q+3]=0;12<=B&&(11===C||12===C)?(m[q+0]=s.r,m[q+1]=s.n,m[q+2]=s.o,m[q+3]=255):11<=C&&(11===B||12===B)?(m[q+0]=s.r,m[q+1]=s.n,m[q+2]=s.o,m[q+3]=96):m[q+3]=0;11===B||12===B?(c[q+0]=s.r,c[q+1]=s.n,c[q+2]=s.o,c[q+3]=255,t[q+0]=s.r,t[q+1]=s.n,t[q+2]=s.o,t[q+3]=96):(c[q+3]=0,t[q+3]=0);11===B||12===B||12<=B&&(11===C||12===C)?(d[q+0]=s.r,d[q+1]=s.n,d[q+2]=s.o,d[q+3]=255,v[q+0]=s.r,v[q+1]=s.n,v[q+2]=s.o,v[q+3]=96):(d[q+3]=0,v[q+3]=0);11===B||12===B?(p[q+0]=s.r,p[q+1]=s.n,p[q+2]=s.o,p[q+3]=255):12<=B&&(11===C||12===C)?(p[q+0]=s.r,p[q+1]=s.n,p[q+2]=s.o,p[q+3]=96):p[q+3]=0;(11===B||12===B)&&12>=C||12<=B&&(11===C||12===C)?(u[q+0]=s.r,u[q+1]=s.n,u[q+2]=s.o,u[q+3]=255):(11===B||12===B)&&12<C?(u[q+0]=s.r,u[q+1]=s.n,u[q+2]=s.o,u[q+3]=96):(d[q+3]=0,v[q+3]=0);11>=C&&(11===B||12===B)?(f[q+0]=s.r,f[q+1]=s.n,f[q+2]=s.o,f[q+3]=255,D[q+0]=s.r,D[q+1]=s.n,D[q+2]=s.o,D[q+3]=96):(f[q+3]=0,D[q+3]=0);11===C||12===C?(e[q+0]=s.r,e[q+1]=s.n,e[q+2]=s.o,e[q+3]=255,M[q+0]=s.r,M[q+1]=s.n,M[q+2]=s.o,M[q+3]=96):(e[q+3]=0,M[q+3]=0);11===C||12===C||12<=C&&(11===B||12===B)?(g[q+0]=s.r,g[q+1]=s.n,g[q+2]=s.o,g[q+3]=255,P[q+0]=s.r,P[q+1]=s.n,P[q+2]=s.o,P[q+3]=96):(g[q+3]=0,P[q+3]=0);(11===C||12===C)&&12>=B||12<=C&&(11===B||12===B)?(w[q+0]=s.r,w[q+1]=s.n,w[q+2]=s.o,w[q+3]=255):(11===C||12===C)&&12<B?(w[q+0]=s.r,w[q+1]=s.n,w[q+2]=s.o,w[q+3]=96):w[q+3]=0;11===C||12===C?(K[q+0]=s.r,K[q+1]=s.n,K[q+2]=s.o,K[q+3]=255):12<C&&(11===B||12===B)?(K[q+0]=s.r,K[q+1]=s.n,K[q+2]=s.o,K[q+3]=96):K[q+3]=0;11>=B&&(11===C||12===C)||11<=C&&(11===B||12===B)?(h[q+0]=s.r,h[q+1]=s.n,h[q+2]=s.o,h[q+3]=255,Z[q+0]=s.r,Z[q+1]=s.n,Z[q+2]=s.o,Z[q+3]=96):(h[q+3]=0,Z[q+3]=0)}this.b.gf=this.X(20,20,20*.07,s,1,null);this.b.kf=this.X(20,20,20*.07,new x(28,28,28,96),1,null);this.b.hf=this.X(20,20,1.2,new x(255,255,255,255),1,this.b.Ib);this.b.lf=this.X(20,20,1.2,new x(0,0,0,255),1,this.b.Sb);this.b.jf=this.X(20,20,1.2,new x(255,255,255,96),1,this.b.pc);this.b.mf=this.X(20,20,1.2,new x(0,0,0,96),1,this.b.Hc)};r.X=function(a,b,c,d,f,e){void 0===f&&(f=1);var g=this.a.w.d.a.getContext("2d");g.clearRect(0,0,a,b);null!==e&&g.putImageData(e,0,0);g.globalAlpha=f;g.strokeStyle=S(d);g.fillStyle=S(d);g.lineWidth=c;f=a/2;d=3*b/4;var h=.1*a;c=Math.sqrt(f*f-(d-f)*(d-f))+f-h;f=-Math.sqrt(f*f-(d-f)*(d-f))+f+h;null!==e&&(c=Math.floor(c-.5),f=Math.ceil(f+.5),h=Math.ceil(h+.5),d=Math.floor(d-.5));g.beginPath();g.moveTo(a/2,h);g.lineTo(c,d);g.lineTo(f,d);g.closePath();g.stroke();a=g.getImageData(0,0,a,b);g.putImageData(a,0,0);return a};r.Ae=function(){var a=this.a.ae.d.a.getContext("2d");this.b.da=a.createImageData(20,20);a=this.b.da.data;this.b.Va=Math.max(3,3);for(var b=0;20>b;b++)for(var c=0;20>c;c++){var d=Math.abs(b-8.5),f=Math.abs(c-8.5),d=Math.sqrt(f*f+d*d)/8.5,d=1>d?.15+.75*(1-d):0,f=4*(20*b+c);a[f+0]=0;a[f+1]=0;a[f+2]=0;a[f+3]=parseInt(255*d)}};function Pb(a){a.Oc=!0;Tb(a,!1)}r.lc=function(a,b){var c=Da(this.a.D.d.a);return{f:(a-c.f-10-this.v.f)/24|0,g:(b-c.g-10-this.v.g)/24|0}};r.cb=function(a,b){var c=this.b.A,d=this.b.t;if(!(0>=c||0>=d)){var f=this.a.Selection.d.a.getContext("2d");f.clearRect(0,0,c,d);0<=a&&0<=b&&(c=10+this.v.f+24*a,d=10+this.v.g+24*b,this.q.H(a,b).Nb()&&f.putImageData(this.b.Ma,c,d))}};function Qb(a){var b=a.b.A,c=a.b.t,c=-a.v.g/(20+24*(a.q.q.length+1)-c)*(c-4-a.a.Ac)+2;a.a.R.style.left=-a.v.f/(20+24*(Rb(a.q)+1)-b)*(b-4-a.a.Bc)+2+"px";a.a.T.style.top=c+"px"};var Ub=-9,Vb=-8,Wb=-7;function Xb(a,b,c){this.p=a;this.L=b;this.Vc=c}Xb.prototype.Nb=function(){return!1};Xb.prototype.J=function(){return this.Vc};Xb.prototype.yb=function(){if(-10!==this.p)if(Ub===this.p){if(this.L.yb()&&0<A(this.L)&&this.L.J().ka.g>=this.Vc.ka.g)return{Wa:!0}}else if(Vb===this.p){if(!this.L.yb())return{Wa:!1};var a=this.Vc.ka.g,b=this.L.J().ka.g;if(a<b)return{Wa:!0,$e:0};if(a===b)return{Wa:!0,$e:1}}else if(Wb===this.p)return{Wa:this.Vc.yb()};return{Wa:!1}};function Ob(){this.q=[];this.e=null;this.ba=0}Ob.prototype.aa=function(){this.q=[];this.ba=0};Ob.prototype.Sa=function(){this.e&&(this.aa(),Yb(this,this.e.fa,0,0))};function Yb(a,b,c,d){var f,e=1;for(f=b;0<A(f);)e++,f=f.J(0);for(f=e;!Zb(a,c,d,f);)d++;var e=c,g=d,h=b;for(a.S(e,g,b);0<A(h);)e++,h=h.J(0),a.S(e,g,h);for(e=b;0<A(e);)e=e.J(0);c+=f-1;for(f={nf:d};;){for(var g=d,h=a.ba,l=A(e),k=1;k<l;k++){a.ba=h;var m=d,n=Yb(a,e.J(k),c+1,d+1);d=n.g;for(m+=1;m<=d;m++)if(m===n.nf)if(l-1===k){a.S(c,m,new Xb(Wb,e,e.J(k)));break}else a.S(c,m,new Xb(Vb,e,e.J(k)));else m<n.nf?a.S(c,m,new Xb(Ub,e,e.J(k))):a.S(c,m,new Xb(Ub,e,e.J(k+1)))}a.ba=h;if(e===b)break;e.xb()&&a.ba--;e=e.L;c--;d=g}f.g=d;return f}Ob.prototype.H=function(a,b){return void 0===this.q[b]||void 0===this.q[b][a]?new Xb(-10,null,null):this.q[b][a]};Ob.prototype.S=function(a,b,c){void 0===this.q[b]&&(this.q[b]=[]);if(c.Nb())if(c.xb()){this.ba++;var d=this.ba;c.ka.f=a;c.ka.g=b;c.ka.Wd=d}else c.ka.f=a,c.ka.g=b,c.ka.Wd=-1;this.q[b][a]=c};function Zb(a,b,c,d){for(var f=0;f<d;f++){var e=b+f;if(!1===(void 0===a.q[c]||void 0===a.q[c][e]||-10===a.q[c][e].p?!0:!1))return!1}return!0}function Rb(a){for(var b=0,c=a.q.length,d=0;d<c;d++){var f=a.q[d].length-1;f>b&&(b=f)}return b};function $b(a){if(this.e=a)a.j=this;this.qa=null;this.Z=[];this.a={Sd:null,cf:null,Ve:null,Te:null,xc:null,zc:null,rc:null};this.Pa=this.Qc=this.xa=0}r=$b.prototype;r.P=function(a,b){ac(this,b);var c=this.e,d=F(a),f=a+"_Board",e=a+"_Message",g=a+"_Next";this.M(d.a,f);var h=this.M(d.a,g),l=this.M(d.a,e);l.style.backgroundColor="rgb(255,255,255)";l.style["border-radius"]="6px";l.style["-webkit-border-radius"]="6px";l.style["-moz-border-radius"]="5px";l.style["-khtml-border-radius"]="10px";l.style.borderColor="#e3e3e3";l.style.borderWidth="5px";l.style.borderStyle="ridge";l.style.display="block";var k=F(f);L(k.h,0,0,1E3,1E3,!1,!1,!1,!1,-1,-1);k.u=N|O|R|Q;d.s(k);this.M(k.a,f+"_Centred");var m=F(f);k.Ua(2);k.s(m);k=F(e);L(k.h,350,350,650,650,!1,!1,!1,!1,-1,-1);k.u=N|O|R|Q;d.s(k);m=new aa(this);m.P(f,c);m.tb=this;var n=F(g);L(n.h,0,0,1E3,1E3,!1,!1,!1,!1,-1,-1);n.u=N|O|R|Q;d.s(n);c=g+"_Centred";this.M(n.a,c);f=F(c);n.Ua(2);n.s(f);n=c+"_Next";g=bc(f.a,n);g.value="\u0414\u0430\u043b\u0435\u0435";g.style.display="none";var t=c+"_Prev",c=bc(f.a,t);c.value="\u041d\u0430\u0437\u0430\u0434";c.style.display="none";var p=this;g.onclick=function(){p.a.xc.style.display="none";p.a.zc.style.display="none";cc(p)};c.onclick=function(){p.a.xc.style.display="none";p.a.zc.style.display="none";dc(p)};n=F(n);L(n.h,501,0,2,2,!1,!1,!0,!0,-1,25);n.u=O|R|Q;f.s(n);n=F(t);L(n.h,2,0,499,2,!0,!1,!1,!0,-1,25);n.u=O|R|Q;f.s(n);var u=e+"_Text",t=e+"_Next",v=e+"_Prev",e=this.M(l,u);e.style.fontFamily="verdana";e.style.textAlign="justify";e.style.Bg="center";e.style.overflowY="scroll";f=bc(l,t);n=bc(l,v);n.onclick=function(){dc(p)};f.onclick=function(){cc(p)};u=F(u);L(u.h,0,0,1E3,35,!1,!1,!1,!0,-1,-1);u.u=N|O|Q|R;k.s(u);t=F(t);L(t.h,0,0,5,5,!1,!1,!0,!0,100,25);t.u=Q|R;k.s(t);t=F(v);L(t.h,5,0,0,5,!0,!1,!1,!0,100,25);t.u=Q|O;k.s(t);this.a.Sd=l;this.a.cf=e;this.a.Ve=n;this.a.Te=f;this.a.xc=g;this.a.zc=c;this.a.rc=h;this.Z.push(m);this.qa=d;this.K();ec(this,0,0)};r.K=function(){this.qa&&this.qa.ta(this.qa.a.clientWidth,this.qa.a.clientHeight);for(var a=0,b=this.Z.length;a<b;a++)this.Z[a].K()};function $a(a){return null===a.G[a.xa].ca||void 0===a.G[a.xa].ca.Ge?0:a.G[a.xa].ca.Ge}function ab(a){null!==a.G[a.xa].ca&&!0===a.G[a.xa].ca.Rf?(a.a.rc.style.display="block",a.a.xc.style.display="block",a.a.zc.style.display="block"):a.Cg(a.xa,2)}r.We=function(){};r.Fc=function(){};r.Bb=function(){};function ac(a,b){var c=b.length;a.Qc=c;a.G=[];for(var d=0;d<c;d++)a.G[d]={},a.G[d].$d=b[d].Sgf,a.G[d].vg=b[d].Before,a.G[d].ug=b[d].After,a.G[d].Rd=b[d].Message,null===b[d].SgfPr?a.G[d].ca=null:(a.G[d].ca={},a.G[d].ca.Ge=b[d].SgfPr.Count,a.G[d].ca.Rf=b[d].SgfPr.WaitOnEnd,a.G[d].ca.Kb={},b[d].SgfPr.Flags&&(a.G[d].ca.Kb.Ud=b[d].SgfPr.Flags.NewNode,a.G[d].ca.Kb.Td=b[d].SgfPr.Flags.Move,a.G[d].ca.Kb.ud=b[d].SgfPr.Flags.ChangeBoardMode,a.G[d].ca.Kb.Qd=b[d].SgfPr.Flags.LoadFile))}function cc(a){var b=a.xa;0===a.Pa?null!==a.G[b].$d?ec(a,b,1):(a.Pa=1,cc(a)):1!==a.Pa||b>=a.Qc-1||(null!==a.G[b+1].Rd?ec(a,b+1,0):(a.xa++,a.Pa=0,cc(a)))}function dc(a){var b=a.xa;0===a.Pa?0>=b||(null!==a.G[b-1].$d?ec(a,b-1,1):(a.xa--,a.Pa=1,dc(a))):1===a.Pa&&(null!==a.G[b].Rd?ec(a,b,0):(a.Pa=0,dc(a)))}function ec(a,b,c){if(!(0>b||b>=a.Qc)){a.xa=b;a.Pa=c;var d=a.G[b].$d,f=a.G[b].ca,e=a.G[b].Rd;0===c?(a.a.rc.style.display="block",null!==e?(c=0===b?null:"\u041d\u0430\u0437\u0430\u0434",b=b===a.Qc-1&&null===d?null:"\u0414\u0430\u043b\u0435\u0435",d=a.a.Ve,f=a.a.Te,a.a.Sd.style.display="block",a.a.cf.innerHTML=e,null===c?d.style.display="none":(d.style.display="block",d.value=c),null===b?f.style.display="none":(f.style.display="block",f.value=b)):cc(a)):1===c&&(a.a.rc.style.display="none",null!==d?(a.a.Sd.style.display="none",a.e.F=4294967295,a.e.zb(d),fc(a.e,f.Kb),ob(a.e)):cc(a))}}r.M=function(a,b){var c=document.createElement("div");c.setAttribute("id",b);c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("oncontextmenu","return false;");a.appendChild(c);return c};function bc(a,b){var c=document.createElement("input");c.setAttribute("id",b);c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("type","button");a.appendChild(c);return c};var gc=0,Ib=0,Hb=1;function Gb(a){this.j=a;this.e=null;this.p=gc;this.a={d:null,wc:null,Xd:null,be:null};this.Xf=new x(217,217,217,255);this.$f=new x(54,101,179,255);this.bg=new x(140,140,140,255);this.cg=new x(0,0,0,255);this.Pc=this.ac=this.I=0;this.Ya=7;this.Ha=10;this.Wb=!1;var b=this;this.eg=function(a){var d=b.I-b.Pc;0!==d&&(Jb(b,(a-b.Ha)/d,!1),hc(b,!1))};this.hg=function(){b.Wb=!0;hc(b,!1)};this.fg=function(a){b.Wb=!1;var d=b.I-b.Pc;0!==d&&(Jb(b,(a-b.Ha)/d,!1),hc(b,!0))}}Gb.prototype.P=function(a,b,c,d){this.e=b;this.p=c;switch(c){case Ib:this.j.ic=this;break;case Hb:this.j.xe=this}this.a.d=F(a);c=this.a.d.a;c.style.backgroundColor=S(this.Xf);c.style.Dg=S(new x(255,255,255,255));var f=a+"_Left";b=a+"_Right";a+="_Slider";this.a.wc=this.la(c,f);this.a.Xd=this.la(c,b);this.a.be=this.la(c,a);a=F(f);L(a.h,this.Ha,this.Ya,500,this.Ya,!0,!0,!1,!0,-1,-1);a.u=N|O|Q|R;this.a.d.s(a);a.a.style.background=S(this.$f);a=F(b);L(a.h,500,this.Ya,this.Ha,this.Ya,!1,!0,!0,!0,-1,-1);a.u=N|O|Q|R;this.a.d.s(a);a.a.style.background=S(this.bg);this.K();Jb(this,d)};Gb.prototype.K=function(){var a=this.a.d.a.clientWidth,b=this.a.d.a.clientHeight;this.I=a-2*this.Ha;this.a.d.ta(a,b);this.za(a,b)};Gb.prototype.za=function(a,b){var c=b-2*this.Ya;this.Pc=c;var d=this.a.be;d.style.width=c+"px";d.style.height=c+"px";d.style.display="block";d.style.position="absolute";d.style.backgroundColor=S(this.cg);d.style.top=this.Ya+"px";d.style.left=this.Ha+"px";Sb(d,this.Ha,a-this.Ha-c,this.Ya,this.Ya);d.Zc=this.eg;d.ad=this.hg;d.$c=this.fg;d=this.a.wc;d.style.fontSize=c+"px";d.style.color="rgb(255,255,255)";d.style.textOverflow="clip";d.style.overflow="hidden"};Gb.prototype.la=function(a,b){var c=document.createElement("div");c.setAttribute("id",b);c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("oncontextmenu","return false;");a.appendChild(c);return c};function Jb(a,b,c){a.ac=Math.min(1,Math.max(b,0));b=a.ac*a.I;a.a.wc.style.width=b+"px";a.a.Xd.style.left=b+a.Ha+"px";a.a.Xd.style.width=a.I-b+"px";!1!==c&&(a.a.be.style.left=a.ac*(a.I-a.Pc)+a.Ha+"px")}function hc(a,b){if(a.e)switch(a.p){case Ib:var c=a.e,d=a.ac;c.Yb=d;if(c.j){var f=c.j;f.ic&&(f=f.ic,!0!==f.Wb&&Jb(f,d,!0))}null!==c.ob&&ub(c);a.a.wc.innerText=b?"":((100+19900*(1-a.e.Yb))/1E3*1E3|0)/1E3+" seconds for move";break;case Hb:c=a.e;d=c.fa;for(f=1;0<A(d);)f++,d=d.J();d=a.ac*(f-1);for(f=c.fa;0<A(f)&&0<d;)d--,f=f.J();z(c,f)}};function Eb(a){this.j=a;this.e=null;this.a={d:null};this.Wf=new x(217,217,217,255);this.me=[]}Eb.prototype.P=function(a,b,c){this.e=b;this.a.d=F(a);var d=this.a.d.a,f=this.a.d;d.style.backgroundColor=S(this.Wf);for(var e=0,g=c.Y.length;e<g;e++){var h=c.Y[e],l=null;switch(h){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:l=new mb(this.j)}if(null!==l){var k=a+e;this.la(d,k);this.W(f,k,e/g,(e+1)/g);l.P(k,b,h);this.me.push(l)}}this.K()};Eb.prototype.K=function(){this.a.d.ta(this.a.d.a.clientWidth,this.a.d.a.clientHeight);for(var a=0,b=this.me.length;a<b;a++)this.me[a].K()};Eb.prototype.la=function(a,b){var c=document.createElement("div");c.setAttribute("id",b);c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("oncontextmenu","return false;");a.appendChild(c);return c};Eb.prototype.W=function(a,b,c,d){b=F(b);L(b.h,1E3*c,0,1E3*d,1E3,!1,!1,!1,!1,-1,-1);b.u=N|O|Q|R;a.s(b)};function U(){}r=U.prototype;r.Hf=function(){return new ic};r.yd=function(a,b){(new Bb(a)).yd(b)};r.xd=function(a,b){(new Bb(a)).xd(b)};r.wd=function(a,b){(new Bb(a)).wd(b)};r.If=function(a,b,c){(new $b(a)).P(b,c)};r.Of=function(a,b){var c={};c.Ud=b.NewNode;c.Td=b.Move;c.ud=b.ChangeBoardMode;c.Qd=b.LoadFile;fc(a,c)};r.zb=function(a,b){a.zb(b)};r.K=function(a){a.K()};window.GoBoardApi=new U;U.prototype.Create_GameTree=U.prototype.Hf;U.prototype.Create_SimpleBoard=U.prototype.yd;U.prototype.Create_BoardWithNavigateButtons=U.prototype.xd;U.prototype.Create_BoardCommentsButtonsNavigator=U.prototype.wd;U.prototype.Create_Presentation=U.prototype.If;U.prototype.Set_Permissions=U.prototype.Of;U.prototype.Load_Sgf=U.prototype.zb;U.prototype.Update_Size=U.prototype.K;var jc={};function kc(a,b,c){this.p=void 0===a?0:a;this.xf=void 0===b?null:b;this.tf=void 0===c?0:c}kc.prototype.ja=function(){return this.xf};kc.prototype.Ua=function(a){this.p=a};kc.prototype.Cc=function(a){this.xf=a};function lc(){Y=X=0}function x(a,b,c,d){this.r=a;this.o=b;this.n=c;this.ke="undefined"===typeof d?255:d}x.prototype={};function S(a){return"rgba("+a.r+","+a.o+","+a.n+","+a.ke/255+")"}function T(a){var b=new lc;b.f=a&255;b.g=a>>8&255;return b}function mc(a){for(var b=[],c=0,d=a.length;c<d;c++)b.push(a[c]);return b}function Da(a){if("undefined"!=typeof a.offsetParent){for(var b=0,c=0;a;a=a.offsetParent)b+=a.offsetLeft,c+=a.offsetTop;return{f:b,g:c}}return{f:a.x,g:a.y}}function Ia(a){if("string"!=typeof a)return!1;for(var b=0;b<a.length;b++){var c=a.charCodeAt(b);if(48>c||57<c)return!1}return!0}function hb(a,b){return a>b?1:b>a?-1:0}var V=null;function Sb(a,b,c,d,f){a.onmousedown=nc;a.Ga=!0;a.Ka=!0;a.root=a;a.Ga&&isNaN(parseInt(a.root.style.left))&&(a.root.style.left="0px");a.Ka&&isNaN(parseInt(a.root.style.top))&&(a.root.style.top="350px");!a.Ga&&isNaN(parseInt(a.root.style.right))&&(a.root.style.right="0px");!a.Ka&&isNaN(parseInt(a.root.style.bottom))&&(a.root.style.bottom="0px");a.ab="undefined"!=typeof b?b:null;a.bb="undefined"!=typeof d?d:null;a.ub="undefined"!=typeof c?c:null;a.vb="undefined"!=typeof f?f:null;a.Cf=null;a.Df=null;a.root.ad=new Function;a.root.$c=new Function;a.root.Zc=new Function}function nc(a){var b=V=this;a=oc(a);var c=parseInt(b.Ka?b.root.style.top:b.root.style.bottom),d=parseInt(b.Ga?b.root.style.left:b.root.style.right);b.root.ad(d,c);b.rf=a.clientX;b.sf=a.clientY;b.Ga?(null!=b.ab&&(b.Xc=a.clientX-d+b.ab),null!=b.ub&&(b.ye=b.Xc+b.ub-b.ab)):(null!=b.ab&&(b.ye=-b.ab+a.clientX+d),null!=b.ub&&(b.Xc=-b.ub+a.clientX+d));b.Ka?(null!=b.bb&&(b.Yc=a.clientY-c+b.bb),null!=b.vb&&(b.ze=b.Yc+b.vb-b.bb)):(null!=b.bb&&(b.ze=-b.bb+a.clientY+c),null!=b.vb&&(b.Yc=-b.vb+a.clientY+c));document.onmousemove=pc;document.onmouseup=qc;return!1}function pc(a){a=oc(a);var b=V,c=a.clientY;a=a.clientX;var d=parseInt(b.Ka?b.root.style.top:b.root.style.bottom),f=parseInt(b.Ga?b.root.style.left:b.root.style.right),e,g;null!=b.ab&&(a=b.Ga?Math.max(a,b.Xc):Math.min(a,b.ye));null!=b.ub&&(a=b.Ga?Math.min(a,b.ye):Math.max(a,b.Xc));null!=b.bb&&(c=b.Ka?Math.max(c,b.Yc):Math.min(c,b.ze));null!=b.vb&&(c=b.Ka?Math.min(c,b.ze):Math.max(c,b.Yc));e=f+(a-b.rf)*(b.Ga?1:-1);g=d+(c-b.sf)*(b.Ka?1:-1);b.Cf?e=b.Cf(d):b.Df&&(g=b.Df(f));null!=b.ab&&(e=Math.max(e,b.ab));null!=b.ub&&(e=Math.min(e,b.ub));null!=b.bb&&(g=Math.max(g,b.bb));null!=b.vb&&(g=Math.min(g,b.vb));V.root.style[b.Ga?"left":"right"]=e+"px";V.root.style[b.Ka?"top":"bottom"]=g+"px";V.rf=a;V.sf=c;V.root.Zc(e,g);return!1}function qc(){document.onmousemove=null;document.onmouseup=null;V.root.$c(parseInt(V.root.style[V.Ga?"left":"right"]),parseInt(V.root.style[V.Ka?"top":"bottom"]));V=null}function oc(a){"undefined"==typeof a&&(a=window.event);"undefined"==typeof a.layerX&&(a.layerX=a.offsetX);"undefined"==typeof a.layerY&&(a.layerY=a.offsetY);return a};var J=0,G=1,H=2,rc=2,pa=0,oa=2,Ga=460,Ea=Ga,Ha=17.51/23.61,Fa=Ha;var Aa=4,sc=4294967295^Aa;function ic(a,b){this.ha=b;this.j=a;this.Zf=new Nb;this.V=new tc;this.B=this.l=null;this.i=this.fa=new uc;this.hc=this.cc=0;this.qb=G;this.dc=this.re=0;this.bc=rc;this.F=4294967295;this.ob=null;this.Yb=.75}function ub(a){if(2&a.F){vb(a);a.j&&Kb(a.j);var b=function(){0<A(a.i)&&ma(a,1);if(0<A(a.i))a.ob=setTimeout(b,100+19900*(1-a.Yb));else if(a.ob=null,a.j){var c=a.j;c.rb&&rb(c.rb,16)}};a.ob=setTimeout(b,100+19900*(1-a.Yb))}}function vb(a){if(a.j){var b=a.j;b.rb&&rb(b.rb,16)}null!==a.ob&&(clearTimeout(a.ob),a.ob=null)}r=ic.prototype;r.K=function(){this.j&&this.j.K()};function ob(a){a.l&&wa(a.l)}r.zb=function(a){if(this.F&8){var b=new vc(this),c=this.F;this.F=4294967295;if(void 0!==a&&""!==a){b.m=[];b.c=0;b.Eb=0;b.ne=[];b.Oa=!0;for(var d=b.ec=0,f=a.length,e=[],g=!1;d<f;){(g||32<a.charCodeAt(d))&&e.push(a.charAt(d));if(3<=e.length&&"["==e[e.length-1]){var h=e[e.length-3]+e[e.length-2];if("C"==e[e.length-2]&&"UC"!=h||"AN"==h||"BR"==h||"BT"==h||"CP"==h||"DT"==h||"EV"==h||"GN"==h||"GC"==h||"ON"==h||"OT"==h||"PB"==h||"PC"==h||"PW"==h||"RE"==h||"RO"==h||"RU"==h||"SO"==h||"TM"==h||"US"==h||"WR"==h||"WT"==h)g=!0}else g&&1<=e.length&&"]"==e[e.length-1]&&(2>e.length||"\\"!=e[e.length-2])&&(g=!1);d++}b.m=e;b.ec=b.m.length;wc(b)||alert("Error occurs, while read SGF")}this.B&&(this.B.Sa(),ia(this.B));z(this,this.fa);this.F=c;this.l&&(a=this.l,null!==a.tb&&Za(a.e.i)>=$a(a.tb)&&ab(a.tb))}};r.Qb=function(){this.fa=new uc;this.bc=0;xc(this)};function ja(a,b){for(var c=a.i;null!=c.L&&0<b;)c=c.L,b--;z(a,c)}function ma(a,b){if(1===b)la(a)&&fb(a);else{for(var c=0;c<b;c++)la(a);z(a,a.i)}}function ka(a){var b=a.i.L;if(null!==b){var c=b.Q;0<A(b)&&0<c&&z(a,b.J(c-1))}}function na(a){var b=a.i.L;if(null!==b){var c=b.Q;c<A(b)-1&&z(a,b.J(c+1))}}r.Cd=function(){for(var a=this.i;!yc(a);){var b=a.L;if(null===b&&a!==this.fa)return;a=b}a.Cd();z(this,a)};r.Zd=function(a){this.qb=a;this.i.Zd(a)};r.wb=function(a,b,c){this.i.wb(a,b,c)};function eb(a,b,c){if(a.F&1){var d=new uc,f=d.L=a.i;f.va.push(d);if(!0===c||-1===f.Q)f.Q=f.va.length-1;a.i=d;a.dc++;!0===b&&a.B&&(a.B.Sa(),ia(a.B))}}r.mc=function(a,b){this.i.mc(a,b)};r.nc=function(a){var b=this.i.$a;this.i.nc(a);this.B&&""===b&&""!==a&&ia(this.B)};r.Yd=function(a){var b=this.i.$a;this.i.Yd(a);this.B&&(""===b&&""!==a||""!==b&&""===a)&&ia(this.B)};r.ma=function(a,b){this.i.ma(a,b)};r.La=function(a){this.i.ma(513,a)};r.Hb=function(a,b){this.i.Hb(a,b)};r.fd=function(a,b){this.i.ya.lb||(this.i.ya.lb=!0);for(var c=0,d=b.length;c<d;c++)this.i.fd(b[c],a)};r.ed=function(a){this.i.ed(a)};r.gd=function(a){this.i.gd(a)};r.vd=function(){!0===this.i.ya.lb&&(this.i.ya.lb=!1,this.i.vd());this.l&&(this.l.ga={},La(this.l))};r.xb=function(){return this.i.xb()};function fb(a){a.l&&(1===a.l.Xa&&E(a.l,0),a.l.ga={},a.Dc());for(var b=0,c=a.i.pa.length;b<c;b++){var d=a.i.pa[b],f=d.ja(),e=d.tf;switch(d.p){case 1:d=T(f);zc(a,d.f,d.g,G,!1);break;case 2:d=T(f);zc(a,d.f,d.g,H,!1);break;case 257:for(var g=0;g<e;g++)d=T(f[g]),Ac(a,d.f,d.g,G,-1);break;case 258:for(g=0;g<e;g++)d=T(f[g]),Ac(a,d.f,d.g,H,-1);break;case 259:for(g=0;g<e;g++)d=T(f[g]),Ac(a,d.f,d.g,J,-1);break;case 260:a.qb=f;break;case 529:if(a.l)for(g=0;g<e;g++)d=T(f[g]),a.l.ma(new I(d.f,d.g,Ta,""));break;case 530:if(a.l)for(g=0;g<e;g++)d=T(f[g]),a.l.ma(new I(d.f,d.g,Wa,""));break;case 531:if(a.l)for(g=0;g<e;g++)d=T(f[g]),a.l.ma(new I(d.f,d.g,Ua,""));break;case 532:if(a.l)for(g=0;g<e;g++)d=T(f[g]),a.l.ma(new I(d.f,d.g,Va,""));break;case 533:a.l&&(d=T(f.Nf),a.l.ma(new I(d.f,d.g,Qa,f.Text)));break;case 513:if(a.l)for(g=0;g<e;g++)d=T(f[g]),a.l.La(d.f,d.g)}}a.l&&(a.i.xb()?(c=a.i.Ja,b=c.Lb(),c=c.Mb(),Oa(a.l,b,c)):Oa(a.l,-1,-1),a.i.ya.lb&&E(a.l,1),La(a.l));a.j&&a.j.Fc(a.i.$a);a.B&&Tb(a.B,!0);a.Bb()}function zc(a,b,c,d,f){if(0!=b||0!=c){a.ha&&!0!==f&&a.ha.zg();Ac(a,b,c,d,a.re+1,f);var e=null;if(null!==(e=jb(a.V,b,c,d,!1))&&0<e.N()){b=e.N();for(c=0;c<b;c++){var g=T(e.ja(c));Ac(a,g.f,g.g,J,-1)}a.ha&&!0!==f&&a.ha.Mf(e);G===d?a.cc+=b:a.hc+=b}else if(null!==(e=kb(a.V,b,c,d))&&0<e.N()){b=e.N();for(c=0;c<b;c++)g=T(e.ja(c)),Ac(a,g.f,g.g,J,-1);a.ha&&!0!==f&&a.ha.Mf(g_nGroupSize);G===d?a.hc+=b:a.cc+=b}else a.V.sb.Qb()}a.qb=G===d?H:G;a.re++}function la(a){if(!(a.F&2)||0===A(a.i)||-1===a.i.Q)return!1;a.i=a.i.J(a.i.Q);a.dc++;return!0}r.Dc=function(){this.l&&this.i.Dc(this.bc,this.l)};r.tc=function(){if(this.l){this.V.tc(this.l);La(this.l);this.i.ya.lb||(this.i.ya.lb=!0);var a=this.V,b=this.i.ya;b.wa={};for(var c=a.N(),d=1;d<=c.g;d++)for(var f=1;f<=c.f;f++){var e=a.Na[Ba(a,f,d)],g=(d<<8)+f;if(G===e||H===e)b.wa[""+g]=e}}};function z(a,b){if(a.F&2){vb(a);xc(a);a.V.aa();a.ha&&a.ha.xg();var c;a:{c=!1;for(var d=b.L,f=b;null!=d;){for(var e=!1,g=0,h=A(d);g<h;g++)if(f===d.J(g)){g!==d.Q&&(c=!0);lb(d,g);e=!0;break}if(!e){c=!1;break a}f=d;d=d.L}}for(a.i=a.fa;a.i!=b&&0<A(a.i);){d=a.i.pa.length;for(f=0;f<d;f++)switch(h=a.i.pa[f],e=h.ja(),g=h.tf,h.p){case 1:h=T(e);zc(a,h.f,h.g,G,!0);break;case 2:h=T(e);zc(a,h.f,h.g,H,!0);break;case 257:for(var l=0;l<g;l++)h=T(e[l]),a.V.S(h.f,h.g,G,-1);break;case 258:for(l=0;l<g;l++)h=T(e[l]),a.V.S(h.f,h.g,H,-1);break;case 259:for(l=0;l<g;l++)h=T(e[l]),a.V.S(h.f,h.g,J,-1)}if(!la(a))break}a.l&&Ka(a.l);fb(a);a.B&&!0===c&&ia(a.B);a.ha&&a.ha.yg()}}function qa(a,b){b!==a.bc&&(a.bc=b,a.Dc())}function xc(a){a.i=a.fa;a.cc=0;a.hc=0;a.re=0;a.dc=0;a.qb=G}function Ac(a,b,c,d,f,e){a.V.S(b,c,d,f);a.l&&!0!==e&&xa(a.l,b,c,d)}r.Bb=function(){if(this.j){var a=this.Zf,b=this.i.L;a.Ra=null===this.i.L?!1:!0;a.Ta=0>=A(this.i)?!1:!0;if(null!==b){var c=b.Q;a.hb=c<A(b)-1?!0:!1;a.ib=0<c?!0:!1}else a.hb=!1,a.ib=!1;this.l&&(a.Ba=this.l.Xa);for(var b=this.fa,d=c=1;0<A(b);)c++,b=b.J(),b===this.i&&(d=c);a.df=0<c?(d-1)/(c-1):1;this.j.Bb(a)}};function fc(a,b){b&&(!0===b.Ud?a.F|=1:!1===b.Ud&&(a.F&=-2),!0===b.Td?a.F|=2:!1===b.Td&&(a.F&=-3),!0===b.ud?a.F|=Aa:!1===b.ud&&(a.F&=sc),!0===b.Qd?a.F|=8:!1===b.Qd&&(a.F&=-9))};"use strict;";function ib(){this.pb=this.ba=0}ib.prototype.Qb=function(){this.pb=this.ba=0};ib.prototype.S=function(a,b){this.ba=a;this.pb=b};function Bc(a,b){this.qe=void 0===a?J:a;this.se=void 0===b?-1:b}Bc.prototype.aa=function(){this.qe=J;this.se=-1};Bc.prototype.Cc=function(a){this.qe=a};Bc.prototype.ja=function(){return this.qe};Bc.prototype.Bd=function(){return this.se};function Cc(){this.Vb=[];this.Cb=[]}Cc.prototype.N=function(){return this.Cb.length};Cc.prototype.ja=function(a){return this.Cb[a]};function Dc(a,b,c){b=(c<<8)+b;c=0;for(var d=a.Cb.length;c<d;c++)if(a.Cb[c]==b)return!0;return!1}function Ec(){this.wa={}}Ec.prototype.aa=function(){this.wa={}};Ec.prototype.Ob=function(a,b){var c=(b<<8)+a;if(void 0!==this.wa[c])return!0;this.wa[c]=1;return!1};function Fc(){this.O={};this.fc=J}Fc.prototype.aa=function(){this.O={};this.fc=J};Fc.prototype.Ob=function(a,b){var c=(b<<8)+a;if(void 0!==this.O[c])return!0;this.O[c]=1;return!1};function db(a,b,c){c=void 0===c?a.fc:c;for(var d in a.O)a=T(d|0),b.Na[Ba(b,a.f,a.g)]=c}function tc(a,b){this.I=void 0===a?19:a;this.$=void 0===b?19:b;this.kb=null;Gc(this);this.sb=new ib;this.Na=null;this.O=new Fc;this.Sc=new Ec}r=tc.prototype;r.aa=function(){for(var a=this.I*this.$,b=0;b<a;b++)this.kb[b].aa()};r.N=function(){return{f:this.I,g:this.$}};r.S=function(a,b,c,d){a=Ba(this,a,b);this.kb[a].Cc(c);void 0!==d&&null!==d&&-1!==d&&(this.kb[a].se=d)};r.H=function(a,b){return this.kb[Ba(this,a,b)].ja()};r.Bd=function(a,b){return this.kb[Ba(this,a,b)].Bd()};function kb(a,b,c,d){var f=new Cc;Hc(a,b,c,d,f);return 0<f.N()?f:null}function jb(a,b,c,d,f){var e;switch(d){case G:e=H;break;case H:e=G;break;default:return null}d=new Cc;!0!==Dc(d,b+1,c)&&Hc(a,b+1,c,e,d);!0!==Dc(d,b-1,c)&&Hc(a,b-1,c,e,d);!0!==Dc(d,b,c+1)&&Hc(a,b,c+1,e,d);!0!==Dc(d,b,c-1)&&Hc(a,b,c-1,e,d);e=d.N();if(1==e){b=(c<<8)+b;c=d.ja(0);e=a.sb;if(c===e.ba&&b===e.pb&&1==f)return null;a.sb.S(b,c)}else if(1<e)a.sb.Qb();else if(0>=e)return null;return d}function Gc(a){var b=a.I*a.$;a.kb=Array(b);for(var c=0;c<b;c++)a.kb[c]=new Bc}function Ba(a,b,c){return(c-1)*a.I+(b-1)}function Ic(a,b,c,d,f){if(b>a.I||1>b||c>a.$||1>c)return!1;var e=a.H(b,c);return J===e?!0:d===e?Jc(a,b,c,d,f):!1}function Jc(a,b,c,d,f){var e;a:{e=(c<<8)+b;for(var g=0,h=f.Vb.length;g<h;g++)if(f.Vb[g]==e){e=!0;break a}f.Vb.push(e);e=!1}return!0===e?!1:!0===Ic(a,b+1,c,d,f)||!0===Ic(a,b-1,c,d,f)||!0===Ic(a,b,c+1,d,f)||!0===Ic(a,b,c-1,d,f)?!0:!1}function Hc(a,b,c,d,f){b>a.I||1>b||c>a.$||1>c||d!==a.H(b,c)||(!0!==Jc(a,b,c,d,f)&&(f.Cb=f.Cb.concat(f.Vb)),f.Vb=[])}r.tc=function(a){for(var b=0,c=0,d=1;d<=this.$;d++)for(var f=1;f<=this.I;f++){var e=null,g=this.Na[Ba(this,f,d)];G===g?(e=new I(f,d,Ra,""),H===this.H(f,d)?b+=2:b++):H===g&&(e=new I(f,d,Sa,""),G===this.H(f,d)?c+=2:c++);null===e?a.La(f,d):a.ma(e)}return{Ib:b,Sb:c}};function Kc(a,b,c){if(!(b>a.I||1>b||c>a.$||1>c)){var d=a.H(b,c);if(J!==a.H(b,c))switch(b=a.O.fc,b){case J:a.O.fc=d;break;case G:case H:b!==d&&(a.O.fc=3)}else!1===a.O.Ob(b,c)&&(Kc(a,b+1,c),Kc(a,b-1,c),Kc(a,b,c+1),Kc(a,b,c-1))}}function bb(a,b,c,d){b>a.I||1>b||c>a.$||1>c||(3-d===a.H(b,c)?d===a.Na[Ba(a,b,c)]&&a.Sc.Ob(b,c):!0!==a.O.Ob(b,c)&&(bb(a,b+1,c,d),bb(a,b-1,c,d),bb(a,b,c+1,d),bb(a,b,c-1,d)))}function cb(a,b,c,d){if(!(b>a.I||1>b||c>a.$||1>c)&&3-d!==a.H(b,c)){if(d===a.H(b,c)){var f=a.Sc,e=(c<<8)+b;void 0!==f.wa[e]&&delete f.wa[e]}!0!==a.O.Ob(b,c)&&(cb(a,b+1,c,d),cb(a,b-1,c,d),cb(a,b,c+1,d),cb(a,b,c-1,d))}}function Ca(a,b){for(var c=1;c<=a.$;c++)for(var d=1;d<=a.I;d++)J===a.H(d,c)&&(J===a.Na[Ba(a,d,c)]||!0===b&&3===a.Na[Ba(a,d,c)])&&(a.O.aa(),Kc(a,d,c),db(a.O,a))};function Lc(a,b){this.Rc=a;this.p=b}r=Lc.prototype;r.Lb=function(){return T(this.Rc).f};r.Mb=function(){return T(this.Rc).g};r.ja=function(){return this.Rc};r.Cc=function(a){this.Rc=a};r.Ua=function(a){this.p=a};function uc(){this.va=[];this.Q=-1;this.L=null;this.pa=[];this.Ja=new Lc(0,J);this.$a="";this.ya=new Mc;this.ka={f:-1,g:-1,Wd:-1}}r=uc.prototype;r.Nb=function(){return!0};r.aa=function(){this.va=[];this.Q=-1;this.pa=[];this.Ja=new Lc(0,J);this.$a="";this.ya=new Mc};r.J=function(a){return void 0!==this.va[a]?this.va[a]:this.va[this.Q]};function lb(a,b){a.Q=b>=a.va.length?a.va.length-1:b}function A(a){return a.va.length}r.xb=function(){return J===this.Ja.p?!1:!0};r.nc=function(a){this.$a+=a};r.Yd=function(a){this.$a=a};r.fd=function(a,b){this.ya.wa[""+a]=b};r.vd=function(){this.ya.wa={}};r.Cd=function(){for(var a=this;0<A(a);)lb(a,0),a=a.J(0)};function yc(a){for(var b=null;null!==(b=a.L);){if(0!=b.Q)return!1;a=b}return!0}r.yb=function(){for(var a=this,b=null;null!=(b=a.L);){if(b.J(b.Q)!=a)return!1;a=b}return!0};r.wb=function(a,b,c){a=(b<<8)+a;this.pa.push(new kc(G===c?1:2,a));J===this.Ja.p&&(this.Ja.Cc(a),this.Ja.Ua(c))};r.mc=function(a,b){var c=new kc(G===a?257:H===a?258:259,mc(b),b.length);this.pa.push(c)};r.ma=function(a,b){var c=0;switch(a){case Ta:c=529;break;case ya:c=jc.wg;break;case Ua:c=531;break;case Va:c=532;break;case Qa:c=533;break;case Wa:c=530}c=new kc(c,mc(b),b.length);this.pa.push(c)};r.Hb=function(a,b){this.pa.push(new kc(533,{Text:a,Nf:b}))};r.Zd=function(a){this.pa.push(new kc(260,a))};r.ed=function(a){this.pa.push(new kc(769,a))};r.gd=function(a){this.pa.push(new kc(770,a))};r.Dc=function(a,b){b.a.Gc.d.a.getContext("2d").clearRect(0,0,b.b.A,b.b.t);switch(a){case rc:Nc(this,b,-1);break;case 1:var c=this.L;null!==c&&Nc(c,b,this.Ja.ja())}};function Za(a){for(var b=1,c=null;null!==(c=a.L);)b++,a=c;return b}function Nc(a,b,c){if(b)for(var d=0,f=A(a);d<f;d++){var e=a.J(d).Ja;if(J!==e.p&&c!==e.ja()){var g=T(e.ja()),e=b;if(e.b.w){var h=(e.b.ua/2-1)/2,l=e.b.w,k=l[g.f-1].f,g=l[g.g-1].g,l=e.a.Gc.d.a.getContext("2d");l.fillStyle=S(e.dg);l.beginPath();l.arc(k,g,h,0,2*Math.PI,!1);l.fill()}}}};function vc(a){this.e=a;this.m=[];this.Eb=this.c=0;this.ne=[];this.Oa=!0;this.ec=0}function wc(a){a.e.Qb();if("("===a.m[0]&&";"===a.m[1])for(a.c++;a.c<a.ec&&(")"!==a.m[a.c]||0!==a.Eb);){var b=a.m[a.c];if(";"===b){1!=a.c?eb(a.e,!1,!1):a.e.i=a.e.fa;a:{b=a;b.c++;for(var c=b.m[b.c],d=b.m[b.c+1];void 0!==c&&")"!==c&&";"!==c&&"("!==c;){switch(c){case "A":switch(d){case "B":Oc(b,G);break;case "E":Oc(b,J);break;case "W":Oc(b,H);break;case "N":c=b;c.c+=3;W(c);break;case "P":c=b;c.c+=3;W(c);break;default:$(b)}break;case "B":switch(d){case "[":Pc(b,G);break;case "R":c=b;c.c+=3;W(c);break;case "T":c=b;c.c+=3;W(c);break;case "L":c=b;c.c+=3;c.e.ed(Qc(c));break;default:$(b)}break;case "C":switch(d){case "[":c=b;c.c+=2;for(d="";"]"!==c.m[c.c]||"\\"===c.m[c.c-1];)"]"===c.m[c.c+1]&&"\\"===c.m[c.c]?(d+="]",c.c++):d+=c.m[c.c],c.c++;c.c++;c.e.nc(d);break;case "A":c=b;c.c+=3;W(c);break;case "P":c=b;c.c+=3;W(c);break;case "R":Rc(b,Ta);break;default:$(b)}break;case "D":switch(d){case "D":c=b;c.c+=3;W(c);break;default:$(b)}break;case "E":switch(d){case "V":c=b;c.c+=3;W(c);break;default:$(b)}break;case "F":switch(d){case "F":$(b);break;default:$(b)}break;case "G":switch(d){case "N":c=b;c.c+=3;W(c);break;case "C":c=b;c.c+=3;W(c);break;case "M":c=b;c.c+=3;1!==Sc(c)&&(c.Oa=!1);break;default:$(b)}break;case "H":switch(d){case "A":c=b;c.c+=3;Sc(c);break;default:$(b)}break;case "K":switch(d){case "M":c=b;c.c+=3;Qc(c);break;default:$(b)}break;case "L":switch(d){case "B":c=b;for(c.c+=3;;){d=c.m[c.c];c.c++;var f=c.m[c.c];c.c++;d=d.charCodeAt(0)-96;f=f.charCodeAt(0)-96;c.c++;for(var e="";"]"!==c.m[c.c]&&c.c<c.ec;)e+=c.m[c.c],c.c++;c.e.Hb(e,(f<<8)+d);if("]"!==c.m[c.c]){c.Oa=!1;break}c.c++;if("["!==c.m[c.c])break;c.c++}break;default:$(b)}break;case "M":switch(d){case "A":Rc(b,Wa);break;default:$(b)}break;case "O":switch(d){case "N":c=b;c.c+=3;W(c);break;case "T":c=b;c.c+=3;W(c);break;default:$(b)}break;case "P":switch(d){case "B":c=b;c.c+=3;W(c);break;case "C":c=b;c.c+=3;W(c);break;case "W":c=b;c.c+=3;W(c);break;default:$(b)}break;case "R":switch(d){case "E":c=b;c.c+=3;W(c);break;case "O":c=b;c.c+=3;W(c);break;case "U":c=b;c.c+=3;W(c);break;default:$(b)}break;case "S":switch(d){case "Q":Rc(b,Ua);break;case "T":c=b;c.c+=3;switch(Sc(c)){case 0:qa(c.e,rc);break;case 1:qa(c.e,1);break;default:qa(c.e,0)}break;case "Z":d=b;d.c+=3;c=Sc(d);0>=c&&(c=19);d=d.e;f=d.V.N();if(c!==f.f||c!==f.g)f=d.V,e=c,f.I=c,f.$=e,Gc(f),f.sb.Qb(),d.l&&(c=d.l,ra(c),c.za(!0));break;case "O":c=b;c.c+=3;W(c);break;default:$(b)}break;case "T":switch(d){case "R":Rc(b,Va);break;case "M":c=b;c.c+=3;W(c);break;case "B":Tc(b,G);break;case "W":Tc(b,H);break;default:$(b)}break;case "U":switch(d){case "S":c=b;c.c+=3;W(c);break;default:$(b)}break;case "W":switch(d){case "[":Pc(b,H);break;case "R":c=b;c.c+=3;W(c);break;case "T":c=b;c.c+=3;W(c);break;case "L":c=b;c.c+=3;c.e.gd(Qc(c));break;default:$(b)}break;default:$(b)}if(!b.Oa){b=!1;break a}c=b.m[b.c];d=b.m[b.c+1]}b=!0}if(!b)return!1}else if("("===b)a.ne[a.Eb]=a.e.i,a.Eb++,a.c++;else if(")"===b)a.Eb--,a.e.i=a.ne[a.Eb],a.c++;else return!1}else return!1;return!0}function W(a,b){void 0===b&&(b="]");for(var c="";void 0!==a.m[a.c]&&b!==a.m[a.c];)c+=a.m[a.c],a.c++;void 0===a.m[a.c]&&(a.Oa=!1);a.c++;return c}function Qc(a){a=parseFloat(W(a,void 0));return isNaN(a)?0:a}function Sc(a){a=parseInt(W(a,void 0));return isNaN(a)?0:a}function $(a){for(;;){for(;void 0!==a.m[a.c]&&"]"!==a.m[a.c]&&a.c<a.ec;)for(a.c++;"]"===a.m[a.c]&&"\\"===a.m[a.c-1];)a.c++;a.c++;if("["!==a.m[a.c])break}}function Oc(a,b){a.c+=3;var c=[];if("]"!==a.m[a.c]){for(;;){var d=a.m[a.c];a.c++;var f=a.m[a.c];a.c++;c.push((f.charCodeAt(0)-96<<8)+(d.charCodeAt(0)-96));if("]"!==a.m[a.c]){a.Oa=!1;return}a.c++;if("["!==a.m[a.c])break;a.c++}a.e.mc(b,c)}}function Pc(a,b){a.c+=2;if("]"==a.m[a.c])a.e.wb(0,0,b);else{var c=a.m[a.c];a.c++;var d=a.m[a.c];a.c++;var f=a.e.V.N();"t"===c&&"t"===d&&19>=f.f&&19>=f.g?a.e.wb(0,0,b):(a.e.wb(c.charCodeAt(0)-96,d.charCodeAt(0)-96,b),"]"!==a.m[a.c]&&(a.Oa=!1))}a.c++}function Rc(a,b){var c=0;a.c+=3;var d=[];if("]"!==a.m[a.c]){for(;;){var f=a.m[a.c];a.c++;var e=a.m[a.c];a.c++;d[c]=(e.charCodeAt(0)-96<<8)+(f.charCodeAt(0)-96);c++;if("]"!==a.m[a.c]){a.Oa=!1;return}a.c++;if("["!==a.m[a.c])break;a.c++}a.e.ma(b,d)}}function Tc(a,b){var c=0;a.c+=3;var d=[];if("]"!==a.m[a.c]){for(;;){var f=a.m[a.c];a.c++;var e=a.m[a.c];a.c++;d[c]=(e.charCodeAt(0)-96<<8)+(f.charCodeAt(0)-96);c++;if("]"!==a.m[a.c]){a.Oa=!1;return}a.c++;if("["!==a.m[a.c])break;a.c++}a.e.fd(b,d)}};function Mc(){this.lb=!1;this.wa={}};}());