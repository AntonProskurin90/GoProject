/*
 * Copyright (C) 2014  Ilya Kirillov 
 * email: ilya_kirillov@inbox.ru
 * 
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 3.0 of the License, or (at your option) any later version.
 * 
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
*/
(function(){var r;function aa(a){this.m=a;this.A=this.f=null;this.Ua=0;this.Sb=!1;this.$d=this.Tb=this.Ub=this.ib=this.jb=0;this.de={};this.oa=null;this.b={w:0,r:0,qa:0,Sa:0,xe:2,v:null,we:null,C:null,Wc:null,Ud:[],$e:Array(361),hc:null,yc:null,Pb:null,Qb:null,Qe:null,Re:null,Ke:null,Le:null,Ne:null,Oe:null,Be:null,te:null,ue:null};this.Va=new x(231,188,95,255);this.ge=new x(0,0,0,255);this.Of=new x(255,0,0,128);this.Ab={rf:new x(232,196,115,255),Ff:new x(255,255,255,255),qf:new x(0,0,0,255),Cf:new x(141,141,141,255),wf:new x(112,95,54,255),xf:new x(112,95,54,255)};this.a={g:null,C:{g:null},v:{g:null},Nb:{g:null},ca:{g:null},wc:{g:null},ya:{g:null},Ia:{g:null},Event:{g:null}};this.Ea={d:-1,e:-1};this.aa={};this.Ic=-1;this.nb=null;var b=this;this.Qc=function(a){ba(a);a=b.cc(y.d,y.e);a=ca(b,a.d,a.e);da(b,a.d,a.e,!1)};this.bc=function(a){ba(a);ea(b)};this.ac=function(a){fa(a);b.a.Event.g.a.focus();var d=b.cc(y.d,y.e),d=ca(b,d.d,d.e);b.oe(d.d,d.e,y);a.preventDefault();a.stopPropagation();return!1};this.Tf=function(a){ga(a);if(16===ha.mc&&2===b.Ua)y.da=!0,b.Za();else{var d=ha,f=d.mc;if(8===f||46===f){if(d=b.f,f=d.i.I,null!==f)for(var e=0,g=z(f);e<g;e++)if(d.i===f.K(e)){g=f;g.Da.splice(e,1);g.Q>=e&&g.Q--; -1===g.Q&&0<g.Da.length&&(g.Q=0);d.i=f;d.H&&d.H.ab();D(d,f);break}}else if(13===f)d=prompt("Enter here code of ur sgf file",""),b.f.ub(d);else if(37===f)d.la&&d.da?(d=b.f,D(d,d.ua)):d.la?ia(b.f,5):ia(b.f,1);else if(38===f)d.la?b.f.od():ja(b.f);else if(39===f)if(d.la&&d.da){for(d=b.f;ka(d););D(d,d.i)}else d.la?la(b.f,5):la(b.f,1);else 40===f?ma(b.f):112===f?E(b,0):113===f?E(b,1):114===f?E(b,2):115===f?E(b,3):116===f?E(b,4):117===f?E(b,5):118===f?E(b,6):119===f?E(b,7):120===f?E(b,8):189===f?(d=b.f.Vb,d++,d>na&&(d=oa),pa(b.f,d)):192===f&&(d=!0===b.Sb?!1:!0,d!==b.Sb&&(b.Sb=d,qa(b),b.Ya(!0)))}a.preventDefault()};this.Uf=function(a){ga(a);16===ha.mc&&2===b.Ua&&(y.da=!1,b.Za())};this.pe=function(){return setTimeout(function(){b.ne();b.Oc();if(b.b.v){var a=b.a.C.g.a.width,d=b.a.C.g.a.height,f=b.a.Nb.g.a.getContext("2d"),e=2*Math.floor(Math.floor(b.Ub*a)/2)+1;b.b.qa=e;b.b.Wc=f.createImageData(e,e);b.b.Ef=f.createImageData(e,e);b.b.hc=f.createImageData(e,e);b.b.yc=f.createImageData(e,e);for(var g=b.b.Wc.data,h=b.b.Ef.data,m=b.b.hc.data,l=b.b.yc.data,k=e/2-.5,n=k-.2,t=Math.sqrt(3),p=0;p<e;p++)for(var u=0;u<e;u++){var v=p-k,C=u-k,I=n-Math.sqrt(v*v+C*C),w=4*(p*e+e-u-1);if(0<=I){var G=n*n-v*v-C*C,G=0<G?Math.sqrt(G)*t:0,N=v,Z=C,s=Math.sqrt(6*(N*N+Z*Z+G*G)),s=(2*G-N+Z)/s,G=0;.9<s&&(G=10*(s-.9));N=255;.8>=I&&(I=(.8-I)/.8,N=.7,v-C<n/3&&(N=1),N=parseInt(255*(1-I*N)));v=parseInt(10+10*s+140*G);g[w+0]=v;g[w+1]=v;g[w+2]=v;g[w+3]=N;m[w+0]=v;m[w+1]=v;m[w+2]=v;m[w+3]=parseInt(N/2);v=parseInt(200+10*s+45*G);h[w+0]=v;h[w+1]=v;h[w+2]=v;h[w+3]=N;l[w+0]=v;l[w+1]=v;l[w+2]=v;l[w+3]=parseInt(N/2)}else g[w+0]=0,g[w+1]=0,g[w+2]=0,g[w+3]=0,m[w+0]=0,m[w+1]=0,m[w+2]=0,m[w+3]=0,h[w+0]=0,h[w+1]=0,h[w+2]=0,h[w+3]=0,l[w+0]=0,l[w+1]=0,l[w+2]=0,l[w+3]=0}g=[];m=[];for(w=0;28>w;w++)for(g[w]=f.createImageData(e,e),m[w]=g[w].data,p=0;p<e;p++)for(u=0;u<e;u++)k=4*(p*e+u),m[w][k+0]=h[k+0],m[w][k+1]=h[k+1],m[w][k+2]=h[k+2],m[w][k+3]=h[k+3];m.push(l);m.push(h);h=.9;u=Array(a);for(l=0;l<a;l++)u[l]=(Math.sin(18*l/a)+1)/20+(Math.sin(3*l/a)+1)/10;w=Array(d);for(p=0;p<d;p++)w[p]=.2*Math.cos(5*p/d)+.1*Math.sin(11*p/d);f=Array(a*d);for(p=0;p<d;p++)for(l=0;l<a;l++)h=75*(u[l]+w[p])+.5,h-=Math.floor(h),h=.2>h?1-h/2:.4>h?1-(.4-h)/2:1,f[l+p*a]=h;d=b.A.L().d;u=b.b.v;w=(b.b.qa-1)/2;k=m.length;for(n=0;n<k;n++){t=m[n];h=l=0;p=n;if(9===d){if(1===n||9===n||13===n||11===n||21===n||23===n||25===n)p=n-1}else 13!==d||3!==n&&7!==n&&11!==n&&15!==n&&23!==n&&27!==n||(p=n-1);switch(p){case 0:l=0;h=3;break;case 1:l=0;h=4;break;case 2:l=0;h=5;break;case 3:l=0;h=6;break;case 4:l=1;h=3;break;case 5:l=1;h=4;break;case 6:l=1;h=5;break;case 7:l=1;h=6;break;case 8:l=2;h=3;break;case 9:l=2;h=4;break;case 10:l=2;h=5;break;case 11:l=2;h=6;break;case 12:h=l=3;break;case 13:l=3;h=4;break;case 14:l=3;h=5;break;case 15:l=3;h=6;break;case 16:l=4;h=3;break;case 17:h=l=4;break;case 18:l=4;h=5;break;case 19:l=4;h=6;break;case 20:l=5;h=3;break;case 21:l=5;h=4;break;case 22:h=l=5;break;case 23:l=5;h=6;break;case 24:l=6;h=3;break;case 25:l=6;h=4;break;case 26:l=6;h=5;break;case 27:h=l=6}s=u[l].d-w;v=u[h].e-w;for(p=0;p<e;p++)for(l=0;l<e;l++)h=f[s+l+(v+p)*a],C=4*(l+p*e),t[C+0]*=h,t[C+1]*=h,t[C+2]*=h}b.b.Ud=g;a=b.A.L();for(e=0;e<a.e;e++)for(d=0;d<a.d;d++)b.b.$e[d+e*a.d]=Math.floor(Math.random()*(b.b.Ud.length-1))}b.me();b.b.v&&(a=b.b.qa,b.b.Pb=ra(b,a,a,.05*a,new x(0,0,0,255)),b.b.Qb=ra(b,a,a,.05*a,new x(255,255,255,255)),b.b.Qe=b.Y(a,a,.05*a,new x(0,0,0,255)),b.b.Re=b.Y(a,a,.05*a,new x(255,255,255,255)),b.b.Ke=sa(b,a,a,.05*a,new x(0,0,0,255)),b.b.Le=sa(b,a,a,.05*a,new x(255,255,255,255)),b.b.Ne=ta(b,a,a,new x(0,0,0,255)),b.b.Oe=ta(b,a,a,new x(255,255,255,255)),b.b.Be=ua(b,a,a,.05*a,new x(255,0,0,255)),b.b.te=ua(b,a,a,.05*a,new x(0,0,0,255)),b.b.ue=ua(b,a,a,.05*a,new x(255,255,255,255)));b.Ya()},20)};this.Rf=function(a){a.preventDefault();return!1};this.Sf=function(a){a.preventDefault();if(0<a.dataTransfer.files.length&&FileReader){a=a.dataTransfer.files[0];var d=new FileReader;d.onload=function(a){b.f.ub(a.target.result)};d.readAsText(a);va(b)}}}r=aa.prototype;r.Z=function(a,b){this.m&&this.m.Ie(this);this.f=b;this.A=b.S;this.f.k=this;this.a.g=F(a);var c=this.a.g.a,d=a+"_BoardCanvas",f=a+"_LinesCanvas",e=a+"_ShadowsCanvas",g=a+"_StonesCanvas",h=a+"_VariantsCanvas",m=a+"_MarksCanvas",l=a+"_TargetCanvas",k=a+"_EventDiv";this.fa(c,d);this.fa(c,f);this.fa(c,e);this.fa(c,g);this.fa(c,h);this.fa(c,m);this.fa(c,l);var c=this.Na(c,k),n=this.a.g;this.U(this.a.C,n,d);this.U(this.a.v,n,f);this.U(this.a.ca,n,e);this.U(this.a.Nb,n,g);this.U(this.a.wc,n,h);this.U(this.a.ya,n,m);this.U(this.a.Ia,n,l);this.U(this.a.Event,n,k);c.onmousemove=this.Qc;c.onmouseout=this.bc;c.onmousedown=this.ac;c.onkeydown=this.Tf;c.onkeyup=this.Uf;c.tabIndex=-1;c.style.Gf=!0;c.style.outline=0;c.ondragover=this.Rf;c.ondrop=this.Sf;return n};function va(a){a.a.Event.g.a.focus()}r.J=function(){var a=this.a.g.a.clientWidth,b=this.a.g.a.clientHeight;a!==b&&(b=a=Math.min(a,b));this.a.g.Aa(a,b);qa(this);this.Ya()};function wa(a,b,c,d){if(a.b.v&&d!==a.de[(c<<8)+b]){var f=a.a.Nb.g.a.getContext("2d"),e=a.a.ca.g.a.getContext("2d"),g=a.b.qa,h=(g-1)/2,m=a.b.v,l=a.b.Sa,k=m[b-1].d-h,h=m[c-1].e-h;switch(d){case H:f.putImageData(a.b.Wc,k,h);e.putImageData(a.b.ca,k+l,h+l);break;case J:f.putImageData(a.b.Ud[a.b.$e[b-1+(c-1)*a.A.L().d]],k,h);e.putImageData(a.b.ca,k+l,h+l);break;default:f.clearRect(k,h,g,g),e.clearRect(k+l,h+l,g,g)}a.de[(c<<8)+b]=d;b===a.Ea.d&&c===a.Ea.e&&(H===d||J===d?ea(a):a.Za())}}r.Ha=function(a,b){var c=(b<<8)+a;delete this.aa[""+c];c===this.Ic&&(this.aa[""+c]=new K(a,b,xa,""))};r.ka=function(a){ya(this,a.Gb(),a.Hb(),a)};function E(a,b){if(a.f.F&za&&a.Ua!==b){a.Ua=b;a.Za();if(1===b){var c=a.A;c.Ja=[];for(var d=1;d<=c.X;d++)for(var f=1;f<=c.V;f++)c.Ja[Aa(c,f,d)]=L;Ba(c,!1);a.f.kc()}a.f.wb()}}r.fa=function(a,b){var c=document.createElement("canvas");c.setAttribute("id",b);c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("oncontextmenu","return false;");a.appendChild(c);return c};r.Na=function(a,b){var c=document.createElement("div");c.setAttribute("id",b);c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("oncontextmenu","return false;");a.appendChild(c);return c};r.U=function(a,b,c){a.g=F(c);a=a.g;M(a.h,0,0,1E3,1E3,!1,!1,!1,!1,-1,-1);a.B=O|P|Q|R;b.u(a)};r.cc=function(a,b){var c=Ca(this.a.C.g.a);return{d:a-c.d,e:b-c.e}};function qa(a){var b=a.A.L(),c=b.d,d=b.e;if(!0===a.Sb){var b=Da/(2*Ea+c),c=(Da-c*b)/2,f=Fa/(2*Ga+d),d=(Fa-d*f)/2;a.jb=(d+f/2)/Fa;a.ib=(c+b/2)/Da}else b=Da/(2*Ea+c-1),c=(Da-(c-1)*b)/2,f=Fa/(2*Ga+d-1),d=(Fa-(d-1)*f)/2,a.jb=d/Fa,a.ib=c/Da;a.Ub=b/Da;a.Tb=f/Fa;a.$d=4/Da}r.Ya=function(a){var b=this.a.C.g.a.width,c=this.a.C.g.a.height;if(b!=this.b.w||c!=this.b.r||null===this.b.C||null!==this.oa||!0===a){if(null!==this.oa&&clearTimeout(this.oa),this.oa=this.pe(),this.Oc(),0!==b&&0!==c){a=this.a.C.g.a.getContext("2d");a.fillStyle=S(this.Ab.rf);a.fillRect(0,0,b,c);var d=this.a.v.g.a.getContext("2d");a=this.ib*b;var f=this.jb*c,e=this.Ub*b,g=this.Tb*c,h=this.A.L();d.clearRect(0,0,b,c);d.strokeStyle=S(this.Ab.xf);for(var m=b-a,l=0;l<h.e;l++){var k=f+l*g;d.beginPath();d.moveTo(a,k);d.lineTo(m,k);d.stroke()}for(var m=c-f,n=0;n<h.d;n++)k=a+n*e,d.beginPath(),d.moveTo(k,f),d.lineTo(k,m),d.stroke();if(h.d===h.e&&(9===h.d||13===h.d||19===h.d)){d.fillStyle=S(this.Ab.wf);l=Math.max(2,this.$d*b/2);n=[];switch(h.d){case 9:n=[[2,2],[2,6],[4,4],[6,2],[6,6]];break;case 13:n=[[3,3],[3,6],[3,9],[6,3],[6,6],[6,9],[9,3],[9,6],[9,9]];break;case 19:n=[[3,3],[3,9],[3,15],[9,3],[9,9],[9,15],[15,3],[15,9],[15,15]]}for(var t=0,p=n.length;t<p;t++)m=a+n[t][0]*e,k=f+n[t][1]*e,d.beginPath(),d.arc(m,k,l,0,2*Math.PI,!1),d.fill()}d=this.a.Nb.g.a.getContext("2d");d.clearRect(0,0,b,c);d.strokeStyle=S(this.Ab.Cf);d.lineWidth=1;t=S(this.Ab.qf);p=S(this.Ab.Ff);for(l=1;l<=h.e;l++)for(n=1;n<=h.d;n++){m=this.A.G(n,l);if(H===m)d.fillStyle=t;else if(J===m)d.fillStyle=p;else continue;m=a+(n-1)*e;k=f+(l-1)*g;d.beginPath();d.arc(m,k,e/2,0,2*Math.PI,!1);d.fill();d.stroke()}this.a.ca.g.a.getContext("2d").clearRect(0,0,b,c);this.a.wc.g.a.getContext("2d").clearRect(0,0,b,c);this.a.ya.g.a.getContext("2d").clearRect(0,0,b,c);this.a.Ia.g.a.getContext("2d").clearRect(0,0,b,c)}}else{this.a.C.g.a.getContext("2d").putImageData(this.b.C,0,0);if(!0===this.Sb&&this.b.v){b=this.a.C.g.a.getContext("2d");c=this.b.w;g=this.b.r;a=this.A.L();for(h=0;h<a.d;h++){d=2*this.b.qa/3;f=(d-1)/2;m=this.b.v;e=m[h].d-f;m=this.jb*g/3-f;k=new String;switch(h+1){case 1:k="A";break;case 2:k="B";break;case 3:k="C";break;case 4:k="D";break;case 5:k="E";break;case 6:k="F";break;case 7:k="G";break;case 8:k="H";break;case 9:k="J";break;case 10:k="K";break;case 11:k="L";break;case 12:k="M";break;case 13:k="N";break;case 14:k="O";break;case 15:k="P";break;case 16:k="Q";break;case 17:k="R";break;case 18:k="S";break;case 19:k="T";break;case 20:k="a";break;case 21:k="b";break;case 22:k="c";break;case 23:k="d";break;case 24:k="e";break;case 25:k="f";break;case 26:k="g";break;case 27:k="h";break;case 28:k="j";break;case 29:k="k";break;case 30:k="l";break;case 31:k="m";break;case 32:k="n";break;case 33:k="o";break;case 34:k="p";break;case 35:k="q";break;case 36:k="r";break;case 37:k="s";break;case 38:k="t"}l=2*d/3;n=Ha(k)?"Arial":"Helvetica, Arial, Verdana";n=l+"px "+n;b.fillStyle="rgb(0,0,0)";b.font=n;l=d/2+l/3;d=(d-b.measureText(k).width)/2;b.fillText(k,e+d,m+l);m=g-this.jb*g/3-f;b.fillText(k,e+d,m+l)}for(g=0;g<a.e;g++)d=2*this.b.qa/3,f=(d-1)/2,m=this.b.v,e=this.ib*c/3-f,m=m[g].e-f,k=a.e-g+"",l=2*d/3,n=Ha(k)?"Arial":"Helvetica, Arial, Verdana",n=l+"px "+n,b.fillStyle="rgb(0,0,0)",b.font=n,l=d/2+l/3,d=(d-b.measureText(k).width)/2,b.fillText(k,e+d,m+l),e=c-this.ib*c/3-f,b.fillText(k,e+d,m+l)}Ia(this);b=this.b.w;c=this.b.r;this.a.Nb.g.a.getContext("2d").clearRect(0,0,b,c);this.a.ca.g.a.getContext("2d").clearRect(0,0,b,c);this.de={};Ja(this);Ka(this)}};r.ne=function(){var a=this.a.C.g.a.width,b=this.a.C.g.a.height,c=this.a.C.g.a.getContext("2d");if(0!==a&&0!==b){for(var c=c.createImageData(a,b),d=.9,f=this.Va.q,e=this.Va.o,g=this.Va.n,h=Array(a),m=0;m<a;m++)h[m]=(Math.tan(300*m/a)+1)/2+(Math.tan(100*m/a)+1)/10;for(var l=Array(b),k=0;k<b;k++)l[k]=.02*Math.tan(k/b);for(var n,t,k=0;k<b;k++)for(m=0;m<a;m++){d=40*(h[m]+l[k])+.5;d-=Math.floor(d);d=.2>d?1-d/2:.4>d?1-(.4-d)/2:1;if(k==b-1||k==b-2&&m<a-2||m>=a-1||m==a-2&&k<b-1)d/=2;0==k||1==k&&1<m||0==m||1==m&&1<k?(n=128+f*d/2,t=128+e*d/2,d=128+g*d/2):(n=f*d,t=e*d,d*=g);var p=4*(m+k*a);c.data[p+0]=n;c.data[p+1]=t;c.data[p+2]=d;c.data[p+3]=255}this.b.C=c;this.b.w=a;this.b.r=b;this.oa=null}};r.Oc=function(){var a=this.b.w,b=this.b.r;if(0!==a&&0!==b){for(var c=this.ib*a,d=this.jb*b,b=this.Tb*b,f=this.Ub*a,e=this.A.L(),g=Array(e.d),h=c,m=d,l=0;l<e.d;l++)h=c+l*f,m=d+l*b,g[l]={d:Math.floor(h+.5),e:Math.floor(m+.5)};this.b.v=g;a=Math.max(2,Math.ceil(this.$d*a/2));c=2*a+1;d=this.b;b=this.ge;f=document.createElement("canvas").getContext("2d").createImageData(c,c);e=a;g=-1;h=e*e;for(l=0;e>g;){g++;m=Math.sqrt(h-g*g);m=Math.ceil(m)-m;m<=l&&e--;var k=Math.floor(255*(1-m)),n=a+e,t=a+e,p=a+g,u=a+g,v=a-e,C=a-e,l=a-g,I=a-g;La(f,n,u,k,c,b);La(f,p,t,k,c,b);La(f,v,u,k,c,b);La(f,l,t,k,c,b);La(f,n,I,k,c,b);La(f,p,C,k,c,b);La(f,v,I,k,c,b);La(f,l,C,k,c,b);for(var k=n-1,t=t-1,v=v+1,C=C+1,n=f,w=k,G=c,N=b,Z=v;Z<=w;Z++)La(n,Z,u,255,G,N);u=f;n=t;w=c;G=b;for(N=C;N<=n;N++)La(u,p,N,255,w,G);p=f;u=c;for(n=b;v<=k;v++)La(p,v,I,255,u,n);I=f;v=c;for(k=b;C<=t;C++)La(I,l,C,255,v,k);l=m}d.we=f;this.b.xe=a}};function Ia(a,b){if(a.b.v){var c=a.b.w,d=a.b.r,f=a.a.v.g.a.getContext("2d"),e=a.A.L(),g=a.b.v;f.clearRect(0,0,c,d);if(e.d===e.e&&(9===e.d||13===e.d||19===e.d)){var d=a.b.we,h=a.b.xe,m=[];switch(e.d){case 9:m=[[2,2],[2,6],[4,4],[6,2],[6,6]];break;case 13:m=[[3,3],[3,6],[3,9],[6,3],[6,6],[6,9],[9,3],[9,6],[9,9]];break;case 19:m=[[3,3],[3,9],[3,15],[9,3],[9,9],[9,15],[15,3],[15,9],[15,15]]}for(var l=0,k=m.length;l<k;l++)f.putImageData(d,g[m[l][0]].d-h,g[m[l][1]].e-h)}for(var h=g[0].d,m=g[g.length-1].d,l=g[0].e,k=g[g.length-1].e,n=f.createImageData(1,k-l),t=f.createImageData(m-h,1),p=a.ge,u=0;u<k-l;u++)d=4*u,n.data[d+0]=p.q,n.data[d+1]=p.o,n.data[d+2]=p.n,n.data[d+3]=p.Vd;for(u=0;u<m-h;u++)d=4*u,t.data[d+0]=p.q,t.data[d+1]=p.o,t.data[d+2]=p.n,t.data[d+3]=p.Vd;for(u=0;u<e.d;u++)f.putImageData(n,g[u].d,g[0].e),f.putImageData(t,g[0].d,g[u].e);if(void 0!==b)for(c=(2*Math.floor(parseInt(a.Tb*c)/2)+1-1)/2,e=g[1].d-g[0].d+2,h=g[1].e-g[0].e+2,d=0;d<b.length;d++)m=b[d].d,l=b[d].e,L===a.A.G(m,l)&&f.clearRect(g[m-1].d-c,g[l-1].e-c,e,h)}}function La(a,b,c,d,f,e){b=4*(b+c*f);a.data[b+0]=e.q;a.data[b+1]=e.o;a.data[b+2]=e.n;a.data[b+3]=d}function Ja(a){for(var b=a.A.L(),c=1;c<=b.e;c++)for(var d=1;d<=b.d;d++)wa(a,d,c,a.A.G(d,c))}r.me=function(){if(this.b.v){var a=this.a.ca.g.a.getContext("2d"),b=this.b.qa;this.b.ca=a.createImageData(b,b);a=this.b.ca.data;this.b.Sa=Math.max(parseInt(.15*b),3);for(var c=(b-5)/2+1,d=0;d<b;d++)for(var f=0;f<b;f++){var e=Math.abs(d-c),g=Math.abs(f-c),e=Math.sqrt(g*g+e*e)/c,e=1>e?.15+.75*(1-e):0,g=4*(b*d+f);a[g+0]=0;a[g+1]=0;a[g+2]=0;a[g+3]=parseInt(255*e)}}};r.Za=function(){da(this,this.Ea.d,this.Ea.e,!0)};function da(a,b,c,d){var f=y;if(-1===b||-1===c||0===b||0===c)ea(a);else if(null===a.oa&&null!==a.b.v&&(void 0===d&&(d=!1),b!==a.Ea.d||c!==a.Ea.e||!0===d)){a.Ea.d=b;a.Ea.e=c;var e=a.b.w,g=a.b.r;d=a.a.Ia.g.a.getContext("2d");d.clearRect(0,0,e,g);var g=(a.b.qa-1)/2,h=a.b.v,e=h[b-1].d-g,g=h[c-1].e-g;b=a.A.G(b,c);switch(a.Ua){case 0:L===b&&(H===a.f.lb?d.putImageData(a.b.hc,e,g):d.putImageData(a.b.yc,e,g));break;case 1:H===b?d.putImageData(a.b.Qb,e,g):J===b&&d.putImageData(a.b.Pb,e,g);break;case 2:H===b?d.putImageData(a.b.Qb,e,g):J===b?d.putImageData(a.b.Pb,e,g):f.da?d.putImageData(a.b.yc,e,g):d.putImageData(a.b.hc,e,g);break;default:H===b?d.putImageData(a.b.Qb,e,g):d.putImageData(a.b.Pb,e,g)}}}function ea(a){var b=a.b.w,c=a.b.r;a.a.Ia.g.a.getContext("2d").clearRect(0,0,b,c);a.Ea.d=-1;a.Ea.e=-1}function ca(a,b,c){var d=a.b.w,f=a.b.r,e=a.ib*d,g=a.jb*f,f=a.Tb*f,d=a.Ub*d,h=0;a=a.A.L();for(h=0;h<a.e-1&&c>g+f*h+f/2;h++);for(c=c=0;c<a.d-1&&b>e+d*c+d/2;c++);return{d:c+1,e:h+1}}function ra(a,b,c,d,f){a=a.a.ya.g.a.getContext("2d");a.clearRect(0,0,b,c);a.strokeStyle=S(f);a.fillStyle=S(f);a.lineWidth=d;a.beginPath();a.moveTo(1*b/4,1*c/4);a.lineTo(3*b/4,3*c/4);a.moveTo(3*b/4,1*c/4);a.lineTo(1*b/4,3*c/4);a.stroke();return a.getImageData(0,0,b,c)}r.Y=function(a,b,c,d,f){void 0===f&&(f=1);var e=this.a.ya.g.a.getContext("2d");e.clearRect(0,0,a,b);e.globalAlpha=f;e.strokeStyle=S(d);e.fillStyle=S(d);e.lineWidth=c;var g=a/2;c=3*b/4;d=.1*a;f=Math.sqrt(g*g-(c-g)*(c-g))+g;g=-Math.sqrt(g*g-(c-g)*(c-g))+g;e.beginPath();e.moveTo(a/2,d);e.lineTo(f-d,c);e.lineTo(g+d,c);e.closePath();e.stroke();return e.getImageData(0,0,a,b)};function sa(a,b,c,d,f){a=a.a.ya.g.a.getContext("2d");a.clearRect(0,0,b,c);a.strokeStyle=S(f);a.fillStyle=S(f);a.lineWidth=Math.floor(d+.5);var e=b/2,g=-c/2*Math.sqrt(2)/2+c/2;f=Math.floor(Math.sqrt(e*e-(g-e)*(g-e))+e-d);e=Math.ceil(-Math.sqrt(e*e-(g-e)*(g-e))+e+d);g=Math.ceil(g+d);d=Math.floor(c/2*Math.sqrt(2)/2+c/2-d);a.beginPath();a.moveTo(f,g);a.lineTo(e,g);a.lineTo(e,d);a.lineTo(f,d);a.closePath();a.stroke();return a.getImageData(0,0,b,c)}function ta(a,b,c,d){a=a.a.ya.g.a.getContext("2d").createImageData(b,c);for(var f=0;f<c;f++)for(var e=0;e<b;e++){var g=4*(f*b+e);f>=c/3&&f<=2*c/3&&e>=b/3&&e<=2*b/3?(a.data[g+0]=d.q,a.data[g+1]=d.o,a.data[g+2]=d.n,a.data[g+3]=255):a.data[g+3]=0}return a}function ua(a,b,c,d,f){a=a.a.ya.g.a.getContext("2d");a.clearRect(0,0,b,c);var e=b/2,g=4*d;a.strokeStyle=S(f);a.fillStyle=S(f);a.lineWidth=d;a.beginPath();a.arc(b/2,c/2,e-g,0,2*Math.PI,!1);a.stroke();return a.getImageData(0,0,b,c)}function Ma(a,b,c){a=a.aa[""+((c<<8)+b)];return void 0!==a?a:null}function ya(a,b,c,d){xa===d.s?Na(a,b,c):a.aa[""+((c<<8)+b)]=d}function Na(a,b,c){if(0>=b||0>=c)a.Ic=0;else{var d=(c<<8)+b;void 0===a.aa[""+d]&&(a.aa[""+d]=new K(b,c,xa,""));a.Ic=d}}function Ka(a){a.a.ya.g.a.getContext("2d").clearRect(0,0,a.b.w,a.b.r);var b=[],c;for(c in a.aa){var d=a.aa[c];Oa(a,d);Pa===d.s&&b.push({d:d.Gb(),e:d.Hb()})}Ia(a,b)}function Oa(a,b){if(a.b.v){var c=b.Gb(),d=b.Hb(),f=b.s,e=a.a.ya.g.a.getContext("2d"),g=a.b.qa,h=(g-1)/2,m=a.b.v,l=m[c-1].d-h,h=m[d-1].e-h,c=a.A.G(c,d);switch(f){case Qa:e.putImageData(a.b.Ne,l,h);break;case Ra:e.putImageData(a.b.Oe,l,h);break;case xa:e.putImageData(a.b.Be,l,h);break;case Sa:e.putImageData(c===H?a.b.ue:a.b.te,l,h);break;case Ta:e.putImageData(c===H?a.b.Le:a.b.Ke,l,h);break;case Ua:e.putImageData(c===H?a.b.Re:a.b.Qe,l,h);break;case Va:e.putImageData(c===H?a.b.Qb:a.b.Pb,l,h);break;case Pa:f=b.Lc,d=2>=f.length?2*g/3:g/2,m=d+"px "+(Ha(f)?"Arial":"Helvetica, Arial, Verdana"),e.fillStyle=c===H?"rgb(255,255,255)":"rgb(0,0,0)",e.font=m,e.fillText(f,l+(g-e.measureText(f).width)/2,h+(g/2+d/3))}}}r.oe=function(a,b,c){switch(this.Ua){case 0:if(Wa==c.re)1<=this.f.Xb&&(ia(this.f,1),Xa(this,a,b));else if(c.da&&c.la)this.f.Kd(H===this.f.lb?J:H),this.Za();else if(!0===c.la){var d=new String;switch(a){case 1:d="A";break;case 2:d="B";break;case 3:d="C";break;case 4:d="D";break;case 5:d="E";break;case 6:d="F";break;case 7:d="G";break;case 8:d="H";break;case 9:d="J";break;case 10:d="K";break;case 11:d="L";break;case 12:d="M";break;case 13:d="N";break;case 14:d="O";break;case 15:d="P";break;case 16:d="Q";break;case 17:d="R";break;case 18:d="S";break;case 19:d="T"}this.f.ec(d+b)}else if(c.da){d=this.f;d.ea&&d.ea.Bf(!0);var f=d.i;D(d,d.ua);for(c=0;1E3>c&&L===d.S.G(a,b);)la(d,1),c++;L===d.S.G(a,b)&&D(d,f);d.ea&&d.ea.Bf(!1)}else Xa(this,a,b),null!==this.nb&&Ya(this.f.i)>=Za(this.nb)&&$a(this.nb);break;case 1:if(!0===c.la)this.f.gd(),E(this,0);else{d=this.A;f=d.G(a,b);if(L!==f)if(d.Hc.ga(),c=d.Ja[Aa(d,a,b)],H!==c&&J!==c){d.M.ga();ab(d,a,b,f);for(var e in d.Hc.sa)c=T(e|0),d.M.ga(),bb(d,c.d,c.e,3-f),cb(d.M,d,3);Ba(d,!0);d.M.ga();ab(d,a,b,f);cb(d.M,d,3-f)}else d.M.ga(),ab(d,a,b,f),cb(d.M,d,3),Ba(d,!0);this.f.kc()}break;case 2:!0===this.f.i.sb()&&(db(this.f,!0,!0),eb(this.f));d=H;L!==this.A.G(a,b)?d=L:c.da&&(d=J);wa(this,a,b,d);this.A.O(a,b,d,-1);this.f.dc(d,[(b<<8)+a]);break;case 3:fb(this,Ua,a,b);break;case 4:fb(this,Ta,a,b);break;case 5:fb(this,Sa,a,b);break;case 6:fb(this,Va,a,b);break;case 7:a:{f=Ma(this,a,b);if(null!==f&&Pa===f.s)this.f.Ha([(b<<8)+a]),this.Ha(a,b);else{f="";c.da&&(f=prompt("Enter the label that you want to add to board here. For best results, keep your label to one or two letters.",""));if(void 0==f||""===f||null===f){f=[];c=-1;for(d in this.aa)if(e=this.aa[d],Pa==e.s){e=e.Lc;var g=e.charCodeAt(0);1==e.length&&65<=g&&90>=g&&(f[g]=1)}for(d=65;90>=d;d++)if(void 0===f[d]||""==f[d]){c=d;break}f=-1==c?null:String.fromCharCode(c);if(null===f){alert("Sorry, all the standard labels are used up! To add more labels, you will have to shift click on the board and make up ur own labels to add.");break a}}d=new K(a,b,Pa,f);this.f.Cb(f,(b<<8)+a);ya(this,a,b,d)}Ka(this)}break;case 8:a:{d=Ma(this,a,b);if(null!==d&&Pa===d.s)this.f.Ha([(b<<8)+a]),this.Ha(a,b);else{d="";if(c.da){d=this.A.nd(a,b);if(-1==d){alert("Sorry, no move has been made at that location, so you can't mark it with the move number!");break a}d=""+d}if(void 0===d||""===d||null===d){d=[];c=0;for(f in this.aa)e=this.aa[f],Pa===e.s&&Ha(e.Lc)&&(d[c]=parseInt(e.Lc),c++);if(0>=c)d="1";else{d.sort(gb);e=f=0;for(var g=!1,h=0;h<c;h++){if(d[h]>f+1){e=f+1;g=!0;break}f=d[h]}g||(e=f+1);d=""+e}}f=new K(a,b,Pa,d);this.f.Cb(d,(b<<8)+a);ya(this,a,b,f)}Ka(this)}}};function fb(a,b,c,d){var f=Ma(a,c,d);if(null!==f&&b===f.s){if(a.f.Ha([(d<<8)+c]),a.Ha(c,d),a.b.v){b=(a.b.qa-1)/2;var e=a.b.v,f=e[c-1].d-b,e=e[d-1].e-b;a.a.ya.g.a.getContext("2d").clearRect(f,e,2*b,2*b);b=T(a.Ic);c===b.d&&d===b.e&&(Na(a,c,d),Oa(a,Ma(a,c,d)))}}else f=new K(c,d,b,""),a.f.ka(b,[(d<<8)+c]),ya(a,c,d,f),Oa(a,f)}function Xa(a,b,c){if(L===a.A.G(b,c)){var d=H===a.f.lb?H:J,f=!1,e=new hb,f=a.A.mb;e.$=f.$;e.kb=f.kb;a.A.O(b,c,d,-1);f=null!==ib(a.A,b,c,d,!0)?!0:null!==jb(a.A,b,c,d)?!1:!0;a.A.O(b,c,L,-1);var g=a.A.mb;g.$=e.$;g.kb=e.kb;if(1==f){a:{for(var e=a.f,h=(c<<8)+b,f=0,m=z(e.i);f<m;f++){var g=e.i.K(f),l=g.Ma,k=l.s;if(h===l.ha()&&d===k&&(H===d||J===d)){b=e.i.Q;kb(e.i,f);e.i=g;e.Xb++;e.H&&b!==f&&lb(e.H);break a}}e.F&1&&(db(e,!1,!0),e.i.rb(b,c,d),e.H&&(e.H.ab(),lb(e.H)))}eb(a.f)}}};function mb(a){this.m=a;this.f=null;this.R=this.s=0;this.Zd=!1;this.b={ve:null,Ge:null,Ae:null,qe:null,Je:null};this.a={g:null,jc:{g:null}};this.gf=new x(217,217,217,255);this.Nf=new x(0,0,0,255);this.ee=new x(54,101,179,255);this.fe=new x(255,255,255,255);this.Lf=new x(140,140,140,255);this.X=this.V=0;var b=this;this.ac=function(){b.Pc();3!==b.R&&(b.R=1,nb(b),b.oe())};this.$f=function(){3!==b.R&&(b.R=2,nb(b))};this.Xf=function(){3!==b.R&&(1!==b.R&&(b.R=2),nb(b))};this.bc=function(){3!==b.R&&(b.R=b.Zd?4:0,nb(b))};this.Pc=function(){b.f&&ob(b.f)}}r=mb.prototype;r.Z=function(a,b,c){this.f=b;this.s=c;if(this.m)switch(this.s){case 1:this.m.j.Uc.push(this);break;case 2:this.m.j.Vc.push(this);break;case 3:this.m.j.Pa.push(this);break;case 4:this.m.j.Qa.push(this);break;case 5:this.m.j.md.push(this);break;case 6:this.m.j.ld.push(this);break;case 7:this.m.j.cb.push(this);break;case 8:this.m.j.eb.push(this);break;case 9:this.m.j.Zc.push(this);break;case 10:this.m.j.ad.push(this);break;case 11:this.m.j.Yc.push(this);break;case 12:this.m.j.dd.push(this);break;case 13:this.m.j.bd.push(this);break;case 14:this.m.j.Xc.push(this);break;case 15:this.m.j.ed.push(this);break;case 16:this.m.j.cd.push(this);break;case 17:this.m.j.$c.push(this)}this.a.g=F(a);b=this.a.g.a;b.setAttribute("title",pb(this));c=document.createElement("canvas");c.setAttribute("id",a+"_canvas");c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("oncontextmenu","return false;");b.appendChild(c);this.a.jc.g=F(a+"_canvas");a=this.a.jc.g;M(a.h,0,0,1E3,1E3,!1,!1,!1,!1,-1,-1);a.B=O|P|Q|R;this.a.g.u(a);b.onmousedown=this.ac;b.onmouseup=this.$f;b.onmouseover=this.Xf;b.onmouseout=this.bc;b.onfocus=this.Pc;b.tabIndex=-1;this.J()};r.J=function(){this.V=this.a.g.a.clientWidth;this.X=this.a.g.a.clientHeight;this.a.g.Aa(this.V,this.X);this.Ya()};function qb(a,b){!0===b&&3===a.R?(a.R=0,nb(a)):!1===b&&3!==a.R&&(a.R=3,nb(a))}function rb(a,b){a.Zd!==b&&(a.Zd=b,!0===b&&0===a.R?(a.R=4,nb(a)):!1===b&&4===a.R&&(a.R=0,nb(a)))}r.Ya=function(){var a=this.X,b=this.V;0!==b&&0!==a&&(this.b.qe=sb(this,this.ee,this.fe,b,a),this.b.Ae=sb(this,this.ee,this.fe,b,a),this.b.Ge=sb(this,this.gf,this.Nf,b,a),this.b.ve=sb(this,this.gf,this.Lf,b,a),this.b.Je=sb(this,this.ee,this.fe,b,a),nb(this))};function sb(a,b,c,d,f){var e=a.a.jc.g.a.getContext("2d");e.fillStyle=S(b);e.fillStyle=S(b);e.fillRect(0,0,d,f);e.fillStyle=S(c);e.strokeStyle=S(c);c=Math.min(d,f);var g=(d-c)/2,h=(f-c)/2;switch(a.s){case 1:a.Y(c,g,h,e,-1);g=Math.ceil(g+c/10+.5);h=Math.ceil(h+c/5+.5);b=Math.floor(c/10+.5);a=Math.floor(3*c/5+.5);e.fillRect(g,h,b,a);break;case 2:a.Y(c,g-c/10,h,e,-1);g=Math.ceil(g+8*c/10+.5);h=Math.ceil(h+c/5+.5);b=Math.floor(c/10+.5);a=Math.floor(3*c/5+.5);e.fillRect(g,h,b,a);break;case 3:a.Y(c,g-c/10,h,e,-1);break;case 4:a.Y(c,g-c/10,h,e,1);break;case 5:a.Y(c,g+c/10,h,e,1);g=Math.ceil(g+c/10+.5);h=Math.ceil(h+c/5+.5);b=Math.floor(c/10+.5);a=Math.floor(3*c/5+.5);e.fillRect(g,h,b,a);break;case 6:a.Y(c,g,h,e,1);g=Math.ceil(g+8*c/10+.5);h=Math.ceil(h+c/5+.5);b=Math.floor(c/10+.5);a=Math.floor(3*c/5+.5);e.fillRect(g,h,b,a);break;case 7:b=Math.ceil(g+.2*c+.5);a=Math.ceil(g+.35*c+.5);var m=Math.ceil(g+.57*c+.5),g=Math.ceil(g+.92*c+.5),l=Math.ceil(h+.2*c+.5),k=Math.ceil(h+.38*c+.5),n=Math.ceil(h+.52*c+.5),t=Math.ceil(h+.6*c+.5),p=Math.ceil(h+.68*c+.5);c=Math.ceil(h+.84*c+.5);e.beginPath();e.moveTo(b,l);e.lineTo(a,l);e.lineTo(a,n);e.lineTo(m,n);e.lineTo(m,k);e.lineTo(g,t);e.lineTo(m,c);e.lineTo(m,p);e.lineTo(b,p);e.closePath();e.fill();break;case 8:b=Math.ceil(g+.2*c+.5);a=Math.ceil(g+.35*c+.5);m=Math.ceil(g+.57*c+.5);g=Math.ceil(g+.92*c+.5);l=Math.ceil(h+.8*c+.5);k=Math.ceil(h+.62*c+.5);n=Math.ceil(h+.48*c+.5);t=Math.ceil(h+.4*c+.5);p=Math.ceil(h+(1-.68)*c+.5);c=Math.ceil(h+(1-.84)*c+.5);e.beginPath();e.moveTo(b,l);e.lineTo(a,l);e.lineTo(a,n);e.lineTo(m,n);e.lineTo(m,k);e.lineTo(g,t);e.lineTo(m,c);e.lineTo(m,p);e.lineTo(b,p);e.closePath();e.fill();break;case 9:m=Math.ceil(g+.5*c-c/10+.5);l=Math.ceil(h+.5*c-c/10+.5);b=Math.ceil(.25*c+.5);e.fillStyle=S(new x(255,255,255));e.strokeStyle=S(new x(0,0,0));e.beginPath();e.arc(m,l,b,0,2*Math.PI,!1);e.fill();e.stroke();e.fillStyle=S(new x(0,0,0));m=Math.ceil(g+.5*c+c/10+.5);l=Math.ceil(h+.5*c+c/10+.5);b=Math.ceil(.25*c+.5);e.beginPath();e.arc(m,l,b,0,2*Math.PI,!1);e.fill();break;case 10:a=e.createImageData(c,c);m=c/5|0;l=4*c/5|0;for(k=0;k<c;k++)for(n=0;n<c;n++)t=4*(k*c+n),k>=m&&k<=l&&n>=m&&n<=l?c-k>=n||k===m||k===l||n===m||n===l?(a.data[t+0]=0,a.data[t+1]=0,a.data[t+2]=0):(a.data[t+0]=255,a.data[t+1]=255,a.data[t+2]=255):(a.data[t+0]=b.q,a.data[t+1]=b.o,a.data[t+2]=b.n),a.data[t+3]=255;e.putImageData(a,g,h);break;case 11:m=Math.ceil(g+.75*c+.5);l=Math.ceil(h+.125*c+.5);b=Math.ceil(.25*c+.5);a=Math.ceil(.02*c+.5);e.fillRect(m,l,b,a);m=Math.ceil(g+.875*c+.5);l=Math.ceil(h+.5);b=Math.ceil(.02*c+.5);a=Math.ceil(.25*c+.5);e.fillRect(m,l,b,a);m=Math.ceil(g+.5);l=Math.ceil(h+.875*c+.5);b=Math.ceil(.25*c+.5);a=Math.ceil(.02*c+.5);e.fillRect(m,l,b,a);m=Math.ceil(g+.5*c-c/10+.5);l=Math.ceil(h+.5*c-c/10+.5);b=Math.ceil(.25*c+.5);e.fillStyle=S(new x(255,255,255));e.strokeStyle=S(new x(0,0,0));e.beginPath();e.arc(m,l,b,0,2*Math.PI,!1);e.fill();e.stroke();e.fillStyle=S(new x(0,0,0));m=Math.ceil(g+.5*c+c/10+.5);l=Math.ceil(h+.5*c+c/10+.5);b=Math.ceil(.25*c+.5);e.beginPath();e.arc(m,l,b,0,2*Math.PI,!1);e.fill();break;case 12:l=c/2;a=3*c/4;b=.1*c;k=Math.sqrt(l*l-(a-l)*(a-l))+l;n=-Math.sqrt(l*l-(a-l)*(a-l))+l;e.lineWidth=Math.ceil(.05*c+.5);e.beginPath();e.moveTo(g+c/2,h+2*b);e.lineTo(g+k-b,h+a+b);e.lineTo(g+n+b,h+a+b);e.closePath();e.stroke();break;case 13:l=c/2;b=.05*c;m=-c/2*Math.sqrt(2)/2+c/2;a=c/2*Math.sqrt(2)/2+c/2;k=Math.sqrt(l*l-(m-l)*(m-l))+l;n=-Math.sqrt(l*l-(m-l)*(m-l))+l;l=Math.floor(g+k-b);g=Math.ceil(g+n+b);m=Math.ceil(h+m+b);h=Math.floor(h+a-b);e.lineWidth=Math.ceil(.05*c+.5);e.beginPath();e.moveTo(l,m);e.lineTo(g,m);e.lineTo(g,h);e.lineTo(l,h);e.closePath();e.stroke();break;case 14:a=.05*c;l=c/2;b=4*a;e.lineWidth=Math.ceil(a+.5);e.beginPath();e.arc(g+c/2,h+c/2,l-b,0,2*Math.PI,!1);e.stroke();break;case 15:b=g+.25*c;a=g+.75*c;l=h+.25*c;k=h+.75*c;e.lineWidth=Math.ceil(.05*c+.5);e.beginPath();e.moveTo(b,l);e.lineTo(a,k);e.moveTo(a,l);e.lineTo(b,k);e.stroke();break;case 16:b="A";a=.8*c;m=g+(c-e.measureText(b).width)/2;e.font=a+"px Arial";e.fillText(b,m,h+c/2+a/3);break;case 17:b="1",a=.8*c,m=g+(c-e.measureText(b).width)/2,e.font=a+"px Helvetica, Arial, Verdana",e.fillText(b,m,h+c/2+a/3)}return e.getImageData(0,0,d,f)}r.Y=function(a,b,c,d,f){var e=Math.ceil(b+a/5+.5);b=Math.ceil(b+4*a/5+.5);var g=Math.ceil(c+a/5+.5),h=Math.ceil(c+a/2+.5);a=Math.ceil(c+4*a/5+.5);0>f?(d.beginPath(),d.moveTo(e,h),d.lineTo(b,g),d.lineTo(b,a)):(d.beginPath(),d.moveTo(e,g),d.lineTo(b,h),d.lineTo(e,a));d.closePath();d.fill()};function nb(a){var b=a.a.jc.g.a.getContext("2d"),c=null;switch(a.R){case 2:c=a.b.Ae;break;case 1:c=a.b.qe;break;case 3:c=a.b.ve;break;case 4:c=a.b.Je;break;default:case 0:c=a.b.Ge}b.putImageData(c,0,0)}r.oe=function(){if(this.f)switch(this.s){case 1:var a=this.f;D(a,a.ua);break;case 2:ia(this.f,5);break;case 3:ia(this.f,1);break;case 4:la(this.f,1);break;case 5:la(this.f,5);break;case 6:for(a=this.f;ka(a););D(a,a.i);break;case 7:ma(this.f);break;case 8:ja(this.f);break;case 9:E(this.f.k,0);break;case 10:E(this.f.k,1);break;case 11:E(this.f.k,2);break;case 12:E(this.f.k,3);break;case 13:E(this.f.k,4);break;case 14:E(this.f.k,5);break;case 15:E(this.f.k,6);break;case 16:E(this.f.k,7);break;case 17:E(this.f.k,8)}};function pb(a){switch(a.s){case 1:return"Back to the start";case 2:return"Back 5 moves";case 3:return"Back";case 4:return"Forward";case 5:return"Forward 5 moves";case 6:return"Go to the end";case 7:return"Next variant";case 8:return"Previous variant";case 9:return"Moves (F1)";case 10:return"Count Scores (F2)";case 11:return"Editor (F3)";case 12:return"Triangles (F4)";case 13:return"Squares (F5)";case 14:return"Circles (F6)";case 15:return"X marks (F7)";case 16:return"Text labels (F8)";case 17:return"Numeric labels (F9)"}};function tb(a){this.m=a;this.a={g:null,uc:{g:null}};var b=this;this.nf=function(){b.f.Jd(b.a.uc.g.a.value)}}tb.prototype.Z=function(a,b){this.f=b;this.a.g=F(a);var c=this.a.g.a,d=a+"_TextArea",f=document.createElement("textarea");f.setAttribute("id",d);f.setAttribute("style","position:absolute;padding:0;margin:0;resize:none;outline: none;-moz-appearance: none;");c.appendChild(f);f.onchange=this.nf;f.onblur=this.nf;c=this.a.g;this.a.uc.g=F(d);d=this.a.uc.g;M(d.h,0,0,2,2,!0,!0,!0,!0,-1,-1);d.B=O|P|Q|R;c.u(d);this.m&&this.m.Wd.push(this);this.J()};tb.prototype.vc=function(a){this.a.uc.g.a.value=a};tb.prototype.J=function(){this.a.g.Aa(this.a.g.a.clientWidth,this.a.g.a.clientHeight)};function ub(){this.va=this.za=this.Ba=this.xa=0;this.zc=this.Bc=this.Cc=this.Ac=!1;this.Bb=this.$a=-1}function M(a,b,c,d,f,e,g,h,m,l,k){a.xa=b;a.Ba=c;a.za=d;a.va=f;a.Ac=e;a.Cc=g;a.Bc=h;a.zc=m;a.$a=l;a.Bb=k}var P=1,O=2,R=4,Q=8;function vb(){this.h=new ub;this.B=P|O;this.a=this.oc=this.Ee=null;this.Oa=new ub;this.W=[];this.vb=0}vb.prototype.Ra=function(a){this.vb=a};vb.prototype.u=function(a){a.oc=this;this.W[this.W.length]=a};vb.prototype.Aa=function(a,b){if(null==this.oc)this.Oa.xa=0,this.Oa.Ba=0,this.Oa.za=a,this.Oa.va=b,null!==this.a&&wb(this,a,b);else{var c=0,d=0,f=0,e=0,c=this.B&5,d=this.B&10;P==c?(c=this.h.Ac?this.h.xa:this.h.xa*a/1E3,f=-1!=this.h.$a?c+this.h.$a:this.h.Bc?a-this.h.za:this.h.za*a/1E3):R==c?(f=this.h.Bc?a-this.h.za:this.h.za*a/1E3,c=-1!=this.h.$a?f-this.h.$a:this.h.Ac?this.h.xa:this.h.xa*a/1E3):(P|R)==c?(c=this.h.Ac?this.h.xa:this.h.xa*a/1E3,f=this.h.Bc?a-this.h.za:this.h.za*a/1E3):(c=this.h.xa,f=this.h.za);O==d?(d=this.h.Cc?this.h.Ba:this.h.Ba*b/1E3,e=-1!=this.h.Bb?d+this.h.Bb:this.h.zc?b-this.h.va:this.h.va*b/1E3):Q==d?(e=this.h.zc?b-this.h.va:this.h.va*b/1E3,d=-1!=this.h.Bb?e-this.h.Bb:this.h.Cc?this.h.Ba:this.h.Ba*b/1E3):(O|Q)==d?(d=this.h.Cc?this.h.Ba:this.h.Ba*b/1E3,e=this.h.zc?b-this.h.va:this.h.va*b/1E3):(d=this.h.Ba,e=this.h.va);f<c&&(f=c);e<d&&(e=d);-2===this.h.$a?f=c+(e-d)*g_dKoef_Board_W_to_H:-3===this.h.$a&&(c=(e-d)*g_dKoef_Board_W_to_H);this.Oa.xa=c;this.Oa.Ba=d;this.Oa.za=f;this.Oa.va=e;this.a.style.left=parseInt(c+.5)+"px";this.a.style.top=parseInt(d+.5)+"px";this.a.style.width=parseInt(f-c+.5)+"px";this.a.style.height=parseInt(e-d+.5)+"px";this.a.width=parseInt(f-c+.5);this.a.height=parseInt(e-d+.5);wb(this,f-c,e-d)}};function wb(a,b,c){var d=a.W.length;if(1===a.vb&&2===d){var f=a.W[0],e=a.W[1],g=b-400>=c?b-c:400;M(f.h,0,0,g,1E3,!1,!1,!0,!1,-1,-1);f.B=P|Q|O;M(e.h,b-g,0,1E3,1E3,!0,!1,!1,!1,-1,-1);e.B=R|Q|O}else 2===a.vb&&1===d&&(f=a.W[0],e=Math.min(b,c),M(f.h,(b-e)/2,(c-e)/2,1E3,1E3,!0,!0,!0,!1,e,e),f.B=P|Q|O);for(f=0;f<d;f++)a.W[f].Aa(b,c)}function F(a){var b=new vb;b.Ee=a;b.a=document.getElementById(a);return b}function xb(){this.a=this.oc=null;this.r=0;this.W=[]}xb.prototype.O=function(a){this.r=a};xb.prototype.u=function(a){a.oc=this;this.W[this.W.length]=a};xb.prototype.Aa=function(a,b){var c=b-this.r,d=a;d!==c&&(c=d=Math.min(d,c));var f=(b-this.r-c)/2;this.a.style.left=parseInt((a-d)/2+.5)+"px";this.a.style.top=parseInt(f+.5)+"px";this.a.style.width=parseInt(d+.5)+"px";this.a.style.height=parseInt(c+this.r+.5)+"px";this.a.width=parseInt(d+.5);this.a.height=parseInt(c+this.r+.5);for(var f=this.W.length,e=0;e<f;e++)this.W[e].Aa(d,c+this.r)};function yb(a){if(this.f=a)a.m=this;this.na=null;this.ia=[];this.j={Uc:[],Vc:[],Pa:[],Qa:[],md:[],ld:[],cb:[],eb:[],Zc:[],ad:[],Yc:[],dd:[],bd:[],Xc:[],ed:[],cd:[],$c:[]};this.Jc=this.S=null;this.Wd=[];this.ff=40;setTimeout(function(){b.mf()},this.ff);var b=this;this.mf=function(){this.Jc&&zb(this.Jc)&&Ab(this.Jc);setTimeout(function(){b.mf()},b.ff)}}r=yb.prototype;r.kd=function(a){var b=new aa(this);b.Z(a,this.f);va(b);this.ia.push(b);this.J()};r.jd=function(a){var b=this.f,c=F(a);this.T(c.a,a+"div");var d=a+"div",f=new xb;f.Ee=d;f.a=document.getElementById(d);f.O(25);var e=f.a;c.u(f);d=a+"_Board";a+="_Toolbar";this.T(e,d);this.T(e,a);e=F(d);M(e.h,0,0,1E3,25,!1,!1,!1,!0,-1,-1);e.B=O|P|R;f.u(e);e=new aa(this);e.Z(d,b);va(e);d=F(a);M(d.h,0,0,1E3,0,!1,!1,!1,!0,-1,25);d.B=P|Q|R;f.u(d);f=new Bb(this);f.Z(a,b,{W:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17]});this.na=c;this.ia.push(e);this.ia.push(f);this.J()};r.hd=function(a){var b=this.f,c=F(a),d=a+"GoBoard";this.T(c.a,d);d=F(d);M(d.h,0,0,1,1,!1,!1,!0,!0,-1,-1);d.B=O|P|R|Q;c.u(d);d.Ra(1);var f=a+"_Board",e=a+"_Panel";this.T(d.a,f);this.T(d.a,e);var g=F(f);a=F(e);d.u(g);d.u(a);this.T(g.a,f+"_Centred");d=F(f);g.Ra(2);g.u(d);d=new aa(this);d.Z(f,b);va(d);g=e+"_CaT";e+="_Navigator";this.T(a.a,g);this.T(a.a,e);f=F(g);M(f.h,0,0,1E3,500,!1,!1,!1,!1,-1,-1);f.B=O|P|R|Q;a.u(f);var h=F(e);M(h.h,0,500,1E3,1E3,!1,!1,!1,!1,-1,-1);h.B=O|P|R|Q;a.u(h);a=new Cb(this);a.Z(e,b);e=g+"_Comments";g+="_Toolbar";this.T(f.a,e);this.T(f.a,g);h=F(e);M(h.h,0,0,1E3,25,!1,!1,!1,!0,-1,25);h.B=O|P|R|Q;f.u(h);h=F(g);M(h.h,0,0,1E3,0,!1,!1,!1,!0,-1,25);h.B=P|R|Q;f.u(h);f=new tb(this);f.Z(e,b);e=new Bb(this);e.Z(g,b,{W:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17]});this.ia.push(d);this.ia.push(a);this.ia.push(f);this.ia.push(e);this.na=c;this.J();b.H&&b.H.ab();b.wb()};r.J=function(){this.na&&this.na.Aa(this.na.a.clientWidth,this.na.a.clientHeight);for(var a=0,b=this.ia.length;a<b;a++)this.ia[a].J()};r.T=function(a,b){var c=document.createElement("div");c.setAttribute("id",b);c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("oncontextmenu","return false;");a.appendChild(c);return c};r.Ie=function(a){this.S=a};r.wb=function(a){for(var b=0,c=this.j.Uc.length;b<c;b++)qb(this.j.Uc[b],a.Pa);b=0;for(c=this.j.Vc.length;b<c;b++)qb(this.j.Vc[b],a.Pa);b=0;for(c=this.j.Pa.length;b<c;b++)qb(this.j.Pa[b],a.Pa);b=0;for(c=this.j.Qa.length;b<c;b++)qb(this.j.Qa[b],a.Qa);b=0;for(c=this.j.md.length;b<c;b++)qb(this.j.md[b],a.Qa);b=0;for(c=this.j.ld.length;b<c;b++)qb(this.j.ld[b],a.Qa);b=0;for(c=this.j.cb.length;b<c;b++)qb(this.j.cb[b],a.cb);b=0;for(c=this.j.eb.length;b<c;b++)qb(this.j.eb[b],a.eb);b=0;for(c=this.j.Zc.length;b<c;b++)rb(this.j.Zc[b],0===a.wa);b=0;for(c=this.j.ad.length;b<c;b++)rb(this.j.ad[b],1===a.wa);b=0;for(c=this.j.Yc.length;b<c;b++)rb(this.j.Yc[b],2===a.wa);b=0;for(c=this.j.dd.length;b<c;b++)rb(this.j.dd[b],3===a.wa);b=0;for(c=this.j.bd.length;b<c;b++)rb(this.j.bd[b],4===a.wa);b=0;for(c=this.j.Xc.length;b<c;b++)rb(this.j.Xc[b],5===a.wa);b=0;for(c=this.j.ed.length;b<c;b++)rb(this.j.ed[b],6===a.wa);b=0;for(c=this.j.cd.length;b<c;b++)rb(this.j.cd[b],7===a.wa);b=0;for(c=this.j.$c.length;b<c;b++)rb(this.j.$c[b],8===a.wa)};r.vc=function(a){for(var b=0,c=this.Wd.length;b<c;b++)this.Wd[b].vc(a)};var Db=0,Eb=1,Wa=2,y=new function(){this.re=this.e=this.d=0;this.vb=Eb;this.da=this.la=this.fc=!1;this.ma=null;this.Lb=-1;this.De=this.Ce=this.Eb=0;this.Bd=this.lc=!1},ha=new function(){this.da=this.la=this.fc=!1;this.ma=null;this.mc=this.sf=0};function ga(a){ha.fc=a.altKey;ha.la=void 0!==a.metaKey?a.ctrlKey||a.metaKey:a.ctrlKey;ha.da=a.shiftKey;ha.ma=a.srcElement?a.srcElement:a.target;ha.sf=a.charCode;ha.mc=a.keyCode;ha.hg=a.which}function ba(a){if(!a.lc||a.Bd){if(a.pageX||a.pageY)y.d=a.pageX,y.e=a.pageY;else if(a.clientX||a.clientY)y.d=a.clientX,y.e=a.clientY;y.fc=a.altKey;y.da=a.shiftKey;y.la=a.ctrlKey||a.metaKey;y.vb=Eb;y.lc||(y.ma=a.srcElement?a.srcElement:a.target);if(3<Math.abs(y.d-y.Ce)||3<Math.abs(y.e-y.De))y.Lb=-1,y.Eb=0}}function fa(a){if(a.pageX||a.pageY)y.d=a.pageX,y.e=a.pageY;else if(a.clientX||a.clientY)y.d=a.clientX,y.e=a.clientY;y.Ce=y.d;y.De=y.e;y.fc=a.altKey;y.da=a.shiftKey;y.la=a.ctrlKey||a.metaKey;y.vb=Db;y.re=a.button;y.ma=a.srcElement?a.srcElement:a.target;a=(new Date).getTime();0==y.Eb?(y.Eb=1,y.Lb=a):500>a-y.Lb?(y.Lb=a,y.Eb++):(y.Eb=1,y.Lb=a);window.af=!1}window.onmousemove=function(a){y.lc&&void 0!=y.ma&&null!=y.ma&&void 0!=y.ma.onmousemove&&null!=y.ma.onmousemove&&(y.Bd=!0,y.ma.onmousemove(a),y.Bd=!1)};window.onmouseup=function(a){if(!1===window.af&&(window.af=!0,y.lc&&void 0!=y.ma.onmouseup&&null!=y.ma.onmouseup))y.ma.onmouseup(a,!0)};function Fb(){this.eb=this.cb=this.Qa=this.Pa=!0;this.wa=0};var xa=-1,Ua=0,Ta=1,Sa=2,Pa=3,Va=4,Qa=5,Ra=6;function K(a,b,c,d){this.hf={d:void 0===a?0:a,e:void 0==b?0:b};this.s=void 0===c?Ua:c;this.Lc=void 0===d?"":d}K.prototype.Gb=function(){return this.hf.d};K.prototype.Hb=function(){return this.hf.e};K.prototype.Ra=function(a){this.s=a};function Cb(a){this.m=a;this.f=null;this.p=new Gb;this.Ec=this.Dc=!0;this.a={g:null,C:{g:null},Selection:{g:null},bb:{g:null},v:{g:null},Md:{g:null},Hd:{g:null},vf:{g:null},N:null,P:null,Ib:null,fb:null,rc:0,qc:0};this.Va=new x(231,188,95,255);this.ge=new x(0,0,0,255);this.oa=null;this.b={w:0,r:0,C:null,Db:null,Ob:null,gc:null,xc:null,vd:null,ze:null,pd:null,ye:null,td:null,Nd:null,Ze:null,Rd:null,zd:null,wd:null,xd:null,yd:null,Ad:null,qd:null,rd:null,sd:null,ud:null,Td:null,Od:null,Pd:null,Qd:null,Sd:null,Se:null,Ve:null,Te:null,We:null,Ue:null,Xe:null,Ia:null,bb:null,ca:null,Sa:0};this.t={d:0,e:0};this.yb=!1;this.Hf=!0;this.pa={w:0,r:0,d:0,e:0};var b=this;this.pe=function(){return setTimeout(function(){b.ne()},20)};this.ac=function(a){b.yb||(b.f&&ob(b.f),fa(a),a=b.cc(y.d,y.e),a=b.p.G(a.d,a.e),a.Jb()&&b.f&&D(b.f,a))};this.Qc=function(a){b.yb||(ba(a),a=b.cc(y.d,y.e),b.Za(a.d,a.e))};this.bc=function(){b.yb||b.Za(-1,-1)};this.ag=function(a){if(b.yb)return!1;var d=0,d=void 0!=a.wheelDelta?0<a.wheelDelta?-45:45:0<a.detail?45:-45;a.preventDefault&&a.preventDefault();var f=20+24*(b.p.p.length+1)-b.a.C.g.a.height;b.t.e-=d;b.t.e=Math.min(0,Math.max(b.t.e,-f));Hb(b);b.Qc(a);Ib(b);return!1};this.Pc=function(){b.f&&ob(b.f)};this.Yf=function(){b.a.N.style.opacity=.7;b.a.Ib.style.opacity=.3};this.Vf=function(){b.a.N.style.opacity=.5;b.a.Ib.style.opacity=0};this.Zf=function(){b.a.P.style.opacity=.7;b.a.fb.style.opacity=.3;b.a.fb.style.display="block"};this.Wf=function(){b.a.P.style.opacity=.5;b.a.fb.style.opacity=0;b.a.fb.style.display="none"};this.lf=function(){b.yb=!0};this.kf=function(){b.yb=!1};this.Pf=function(a){var d=b.b.w;b.t.d=-((a-2)/(d-4-b.a.rc)*(20+24*(Jb(b.p)+1)-d));Hb(b)};this.Qf=function(a,d){var f=b.b.r;b.t.e=-((d-2)/(f-4-b.a.qc)*(20+24*(b.p.p.length+1)-f));Hb(b)}}r=Cb.prototype;r.Z=function(a,b){this.m&&(this.m.Jc=this);this.f=b;this.f.H=this;this.p.f=b;this.a.g=F(a);var c=this.a.g.a,d=this.a.g,f=a+"_Board",e=a+"_Selection",g=a+"_Current",h=a+"_Lines",m=a+"_Shadows",l=a+"_Nodes",k=a+"_Events";this.fa(c,f);this.fa(c,e);this.fa(c,g);this.fa(c,h);this.fa(c,m);this.fa(c,l);var n=this.Na(c,k);this.a.Ib=this.Na(c,a+"HorScroll_BG");this.a.N=this.Na(c,a+"HorScroll");this.a.fb=this.Na(c,a+"VerScroll_BG");this.a.P=this.Na(c,a+"VerScroll");this.a.Ib.style.background="rgb(0,0,0)";this.a.Ib.style.display="none";this.a.fb.style.background="rgb(0,0,0)";this.a.fb.style.display="none";this.a.N.onmouseover=this.Yf;this.a.N.onmouseout=this.Vf;this.a.P.onmouseover=this.Zf;this.a.P.onmouseout=this.Wf;c=F(a+"HorScroll_BG");M(c.h,2,0,2,2,!0,!1,!0,!0,-1,12);c.B=P|Q|R;d.u(c);c=F(a+"VerScroll_BG");M(c.h,0,2,2,2,!1,!0,!0,!0,12,-1);c.B=O|Q|R;d.u(c);this.U(this.a.C,d,f);this.U(this.a.Selection,d,e);this.U(this.a.bb,d,g);this.U(this.a.v,d,h);this.U(this.a.Md,d,m);this.U(this.a.Hd,d,l);this.U(this.a.vf,d,k);n.onmousedown=this.ac;n.onmousemove=this.Qc;n.onmouseout=this.bc;n.onmousewheel=this.ag;n.onfocus=this.Pc;n.tabIndex=-1;n.style.Gf=!0;n.style.outline=0;d=this.a.Hd.g.a.getContext("2d");this.b.Db=d.createImageData(20,20);this.b.Ob=d.createImageData(20,20);this.b.gc=d.createImageData(20,20);this.b.xc=d.createImageData(20,20);d=this.b.Db.data;f=this.b.Ob.data;e=this.b.gc.data;g=this.b.xc.data;h=Math.sqrt(3);for(m=0;20>m;m++)for(l=0;20>l;l++){var c=m-9.5,t=l-9.5,p=9.3-Math.sqrt(c*c+t*t),k=4*(20*m+20-l-1);if(0<=p){var u=9.3*9.3-c*c-t*t,u=0<u?Math.sqrt(u)*h:0,v=c,C=t,n=Math.sqrt(6*(v*v+C*C+u*u)),n=(2*u-v+C)/n,u=0;.9<n&&(u=10*(n-.9));v=255;.8>=p&&(p=(.8-p)/.8,v=.7,3.1>c-t&&(v=1),v=parseInt(255*(1-p*v)));c=parseInt(10+10*n+140*u);d[k+0]=c;d[k+1]=c;d[k+2]=c;d[k+3]=v;e[k+0]=c;e[k+1]=c;e[k+2]=c;e[k+3]=parseInt(.5*v);c=parseInt(200+10*n+45*u);f[k+0]=c;f[k+1]=c;f[k+2]=c;f[k+3]=v;g[k+0]=c;g[k+1]=c;g[k+2]=c;g[k+3]=parseInt(.7*v)}else d[k+0]=0,d[k+1]=0,d[k+2]=0,d[k+3]=0,g[k+0]=0,g[k+1]=0,g[k+2]=0,g[k+3]=0}this.Oc();d=this.a.Selection.g.a.getContext("2d");this.b.Ia=d.createImageData(24,24);this.b.bb=d.createImageData(24,24);f=this.b.Ia.data;e=this.b.bb.data;for(g=0;24>g;g++)for(h=0;24>h;h++)m=4*(h+24*g),f[m+3]=255,e[m+3]=255,0===h&&23===g||23===h&&0===g?(f[m+0]=135,f[m+1]=125,f[m+2]=135,e[m+0]=216):23===h||23===g?(f[m+0]=89,f[m+1]=89,f[m+2]=89,e[m+0]=178):(0===g||0===h?(f[m+0]=182,f[m+1]=182,f[m+2]=182):(f[m+0]=128,f[m+1]=128,f[m+2]=128),e[m+0]=255),e[m+1]=0,e[m+2]=0;d.putImageData(this.b.Ia,0,0);d.putImageData(this.b.bb,0,30);this.me()};r.J=function(a){var b=this.a.g.a.clientWidth,c=this.a.g.a.clientHeight;this.a.g.Aa(b,c);this.Ya(b,c,a)};function lb(a){if(!(0>=a.b.w||0>=a.b.r)){var b=a.b.w,c=a.b.r,d=20+24*(Jb(a.p)+1),f=20+24*(a.p.p.length+1);d>b?(a.a.rc=Math.max(50,b*b/d),a.a.N.style.width=Math.max(50,b*b/d)+"px",a.a.N.style.display="block",a.a.N.style.position="absolute",a.a.N.style.top=c-14+"px",a.a.N.style.height="12px",a.a.N.style.background="rgb(0,0,0)",a.a.N.style.opacity=.5,Kb(a.a.N,2,b-a.a.rc-2,c-14,c-14),a.a.N.je=a.Pf,a.a.N.le=a.lf,a.a.N.ke=a.kf):a.a.N.style.display="none";f>c?(a.a.qc=Math.max(50,c*c/f),a.a.P.style.height=Math.max(50,c*c/f)+"px",a.a.P.style.display="block",a.a.P.style.position="absolute",a.a.P.style.left=b-14+"px",a.a.P.style.width="12px",a.a.P.style.background="rgb(0,0,0)",a.a.P.style.opacity=.5,Kb(a.a.P,b-14,b-14,2,c-a.a.qc-2),a.a.P.je=a.Qf,a.a.P.le=a.lf,a.a.P.ke=a.kf):a.a.P.style.display="none";a.pa.r=-1;a.pa.w=-1;Hb(a);Ib(a)}}r.ab=function(){this.p.ab();this.pa.r=-1;this.pa.w=-1};function Lb(a,b){a.Dc=!0;var c=a.b.w,d=a.b.r;if(!(0>=c||0>=d)){var f=a.f.i.ja,e=f.d,f=f.e,g=10+a.t.d+24*e,h=10+a.t.e+24*f;if(0!=b&&!0===a.Hf&&(10>=g||g>=c-10||10>=h||h>=d-10)){var m=20+24*(a.p.p.length+1)-d,l=20+24*(Jb(a.p)+1)-c;10>=g?a.t.d=24*-e:g>=c-10&&(a.t.d=c-24-10-10-24*e);10>=h?a.t.e=24*-f:h>=d-10&&(a.t.e=d-24-10-10-24*f);a.t.d=Math.min(0,Math.max(a.t.d,-l));a.t.e=Math.min(0,Math.max(a.t.e,-m));Ib(a);Hb(a)}}}function Ab(a){if(a.Dc&&a.f){var b=a.b.w,c=a.b.r;if(!(0>=b||0>=c)){var d=a.f.i.ja,f=10+a.t.d+24*d.d,d=10+a.t.e+24*d.e,e=a.a.bb.g.a.getContext("2d");e.clearRect(0,0,b,c);-24<=f&&f<=b+24&&-24<=d&&d<=c+24&&e.putImageData(a.b.bb,f,d);a.Dc=!1}}if(a.Ec&&(b=a.b.w,c=a.b.r,0!==b&&0!==c)){if(!(a.pa.w===b&&a.pa.r===c&&1>Math.abs(a.t.d-a.pa.d)&&1>Math.abs(a.t.e-a.pa.e))){a.pa.w=b;a.pa.r=c;a.pa.d=a.t.d;a.pa.e=a.t.e;var f=a.a.v.g.a.getContext("2d"),d=a.a.Md.g.a.getContext("2d"),e=a.a.Hd.g.a.getContext("2d"),g=a.a.Selection.g.a.getContext("2d");e.clearRect(0,0,b,c);d.clearRect(0,0,b,c);f.clearRect(0,0,b,c);g.clearRect(0,0,b,c);for(var g=10+a.t.d,h=10+a.t.e,m=a.p.p.length,l=0;l<=m-1;l++){var k=h+24*l;if(-24<=k&&k<=c+24)for(var n=a.p.p[l].length-1,t=0;t<=n;t++){var p=g+24*t;if(-24<=p&&p<=b+24){var u=a.p.G(t,l);if(!1===u.Jb()){var v=u.tb();switch(u.s){case Mb:v.Ta?f.putImageData(a.b.Nd,p,k):f.putImageData(a.b.Td,p,k);break;case Nb:v.Ta?1===v.Me?f.putImageData(a.b.Od,p,k):f.putImageData(a.b.Pd,p,k):f.putImageData(a.b.Qd,p,k);break;case Ob:v.Ta?f.putImageData(a.b.Rd,p,k):f.putImageData(a.b.Sd,p,k)}}else{var v=u.tb(),C=u.Ma.s,I=""+u.ja.Id,w=e.measureText(I).width,G=u.ob;H===C?(v&&d.putImageData(a.b.ca,p+2+a.b.Sa,k+2+a.b.Sa),e.putImageData(v?a.b.Db:a.b.gc,p+2,k+2),""===G?(e.font="bold 10px sans-serif",e.fillStyle=v?"#CCC":"rgb(192, 192, 192)",e.fillText(I,p+12-w/2,k+12+3)):e.putImageData(v?a.b.Te:a.b.Ue,p+2,k+2)):J===C?(v&&d.putImageData(a.b.ca,p+2+a.b.Sa,k+2+a.b.Sa),e.putImageData(v?a.b.Ob:a.b.xc,p+2,k+2),""===G?(e.font="bold 10px sans-serif",e.fillStyle=v?"#000":"rgb(56, 56, 56)",e.fillText(I,p+12-w/2,k+12+3)):e.putImageData(v?a.b.We:a.b.Xe,p+2,k+2)):e.putImageData(v?a.b.Se:a.b.Ve,p+2,k+2);I=z(u);u=u.Q;0===t?0!==I&&(1===I?v?f.putImageData(a.b.vd,p,k):f.putImageData(a.b.zd,p,k):v?0==u?f.putImageData(a.b.wd,p,k):f.putImageData(a.b.xd,p,k):f.putImageData(a.b.yd,p,k)):0===I?v?f.putImageData(a.b.td,p,k):f.putImageData(a.b.ud,p,k):1===I?v?f.putImageData(a.b.pd,p,k):f.putImageData(a.b.Ad,p,k):v?0===u?f.putImageData(a.b.qd,p,k):f.putImageData(a.b.rd,p,k):f.putImageData(a.b.sd,p,k);H!==C&&J!==C||f.clearRect(p+3,k+3,18,18)}}}}}a.Ec=!1}}function zb(a){return a.Dc||a.Ec?!0:!1}r.fa=function(a,b){var c=document.createElement("canvas");c.setAttribute("id",b);c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("oncontextmenu","return false;");a.appendChild(c);return c};r.Na=function(a,b){var c=document.createElement("div");c.setAttribute("id",b);c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("oncontextmenu","return false;");a.appendChild(c);return c};r.U=function(a,b,c){a.g=F(c);a=a.g;M(a.h,0,0,1E3,1E3,!1,!1,!1,!1,-1,-1);a.B=O|P|Q|R;b.u(a)};r.Ya=function(a,b){var c=this.a.C.g.a.getContext("2d");a!==this.b.w||b!==this.b.r||null===this.b.C||null!==this.oa?(this.b.w=a,this.b.r=b,c.fillStyle=S(this.Va),c.fillRect(0,0,a,b),null!==this.oa&&clearTimeout(this.oa),this.oa=this.pe()):c.putImageData(this.b.C,0,0);lb(this)};r.ne=function(){this.oa=null;var a=this.b.w,b=this.b.r,c=this.a.C.g.a.getContext("2d");if(0!==a&&0!==b){for(var d=c.createImageData(a,b),f=this.Va.q,e=this.Va.o,g=this.Va.n,h=Array(a),m=0;m<a;m++)h[m]=(Math.tan(300*m/a)+1)/2+(Math.tan(100*m/a)+1)/10;for(var l=Array(b),k=0;k<b;k++)l[k]=.02*Math.tan(k/b);var n,t,p;p=.9;for(k=0;k<b;k++)for(m=0;m<a;m++){p=40*(h[m]+l[k])+.5;p-=Math.floor(p);p=.2>p?1-p/2:.4>p?1-(.4-p)/2:1;if(k==b-1||k==b-2&&m<a-2||m>=a-1||m==a-2&&k<b-1)p/=2;0==k||1==k&&1<m||0==m||1==m&&1<k?(n=128+f*p/2,t=128+e*p/2,p=128+g*p/2):(n=f*p,t=e*p,p*=g);var u=4*(m+k*a);d.data[u+0]=n;d.data[u+1]=t;d.data[u+2]=p;d.data[u+3]=255}this.b.C=d;c.putImageData(this.b.C,0,0)}};r.Oc=function(){var a=this.a.v.g.a.getContext("2d");this.b.vd=a.createImageData(24,24);this.b.ze=a.createImageData(24,24);this.b.pd=a.createImageData(24,24);this.b.ye=a.createImageData(24,24);this.b.td=a.createImageData(24,24);this.b.Nd=a.createImageData(24,24);this.b.Ze=a.createImageData(24,24);this.b.Rd=a.createImageData(24,24);this.b.zd=a.createImageData(24,24);this.b.wd=a.createImageData(24,24);this.b.xd=a.createImageData(24,24);this.b.yd=a.createImageData(24,24);this.b.Ad=a.createImageData(24,24);this.b.qd=a.createImageData(24,24);this.b.rd=a.createImageData(24,24);this.b.sd=a.createImageData(24,24);this.b.ud=a.createImageData(24,24);this.b.Td=a.createImageData(24,24);this.b.Od=a.createImageData(24,24);this.b.Pd=a.createImageData(24,24);this.b.Qd=a.createImageData(24,24);this.b.Sd=a.createImageData(24,24);for(var a=this.b.vd.data,b=this.b.ze.data,c=this.b.pd.data,d=this.b.ye.data,f=this.b.td.data,e=this.b.Nd.data,g=this.b.Ze.data,h=this.b.Rd.data,m=this.b.zd.data,l=this.b.wd.data,k=this.b.xd.data,n=this.b.yd.data,t=this.b.Ad.data,p=this.b.qd.data,u=this.b.rd.data,v=this.b.sd.data,C=this.b.ud.data,I=this.b.Td.data,w=this.b.Od.data,G=this.b.Pd.data,N=this.b.Qd.data,Z=this.b.Sd.data,s=new x(28,28,28,255),A=0;24>A;A++)for(var B=0;24>B;B++){var q=4*(24*A+B);12<=B&&(11===A||12===A)?(a[q+0]=s.q,a[q+1]=s.n,a[q+2]=s.o,a[q+3]=255,m[q+0]=s.q,m[q+1]=s.n,m[q+2]=s.o,m[q+3]=96):(a[q+3]=0,m[q+3]=0);11<=B&&(11===A||12===A)||12<=A&&(11===B||12===B)?(b[q+0]=s.q,b[q+1]=s.n,b[q+2]=s.o,b[q+3]=255,n[q+0]=s.q,n[q+1]=s.n,n[q+2]=s.o,n[q+3]=96):(b[q+3]=0,n[q+3]=0);11<=B&&(11===A||12===A)?(l[q+0]=s.q,l[q+1]=s.n,l[q+2]=s.o,l[q+3]=255):12<=A&&(11===B||12===B)?(l[q+0]=s.q,l[q+1]=s.n,l[q+2]=s.o,l[q+3]=96):l[q+3]=0;12<=A&&(11===B||12===B)?(k[q+0]=s.q,k[q+1]=s.n,k[q+2]=s.o,k[q+3]=255):11<=B&&(11===A||12===A)?(k[q+0]=s.q,k[q+1]=s.n,k[q+2]=s.o,k[q+3]=96):k[q+3]=0;11===A||12===A?(c[q+0]=s.q,c[q+1]=s.n,c[q+2]=s.o,c[q+3]=255,t[q+0]=s.q,t[q+1]=s.n,t[q+2]=s.o,t[q+3]=96):(c[q+3]=0,t[q+3]=0);11===A||12===A||12<=A&&(11===B||12===B)?(d[q+0]=s.q,d[q+1]=s.n,d[q+2]=s.o,d[q+3]=255,v[q+0]=s.q,v[q+1]=s.n,v[q+2]=s.o,v[q+3]=96):(d[q+3]=0,v[q+3]=0);11===A||12===A?(p[q+0]=s.q,p[q+1]=s.n,p[q+2]=s.o,p[q+3]=255):12<=A&&(11===B||12===B)?(p[q+0]=s.q,p[q+1]=s.n,p[q+2]=s.o,p[q+3]=96):p[q+3]=0;(11===A||12===A)&&12>=B||12<=A&&(11===B||12===B)?(u[q+0]=s.q,u[q+1]=s.n,u[q+2]=s.o,u[q+3]=255):(11===A||12===A)&&12<B?(u[q+0]=s.q,u[q+1]=s.n,u[q+2]=s.o,u[q+3]=96):(d[q+3]=0,v[q+3]=0);11>=B&&(11===A||12===A)?(f[q+0]=s.q,f[q+1]=s.n,f[q+2]=s.o,f[q+3]=255,C[q+0]=s.q,C[q+1]=s.n,C[q+2]=s.o,C[q+3]=96):(f[q+3]=0,C[q+3]=0);11===B||12===B?(e[q+0]=s.q,e[q+1]=s.n,e[q+2]=s.o,e[q+3]=255,I[q+0]=s.q,I[q+1]=s.n,I[q+2]=s.o,I[q+3]=96):(e[q+3]=0,I[q+3]=0);11===B||12===B||12<=B&&(11===A||12===A)?(g[q+0]=s.q,g[q+1]=s.n,g[q+2]=s.o,g[q+3]=255,N[q+0]=s.q,N[q+1]=s.n,N[q+2]=s.o,N[q+3]=96):(g[q+3]=0,N[q+3]=0);(11===B||12===B)&&12>=A||12<=B&&(11===A||12===A)?(w[q+0]=s.q,w[q+1]=s.n,w[q+2]=s.o,w[q+3]=255):(11===B||12===B)&&12<A?(w[q+0]=s.q,w[q+1]=s.n,w[q+2]=s.o,w[q+3]=96):w[q+3]=0;11===B||12===B?(G[q+0]=s.q,G[q+1]=s.n,G[q+2]=s.o,G[q+3]=255):12<B&&(11===A||12===A)?(G[q+0]=s.q,G[q+1]=s.n,G[q+2]=s.o,G[q+3]=96):G[q+3]=0;11>=A&&(11===B||12===B)||11<=B&&(11===A||12===A)?(h[q+0]=s.q,h[q+1]=s.n,h[q+2]=s.o,h[q+3]=255,Z[q+0]=s.q,Z[q+1]=s.n,Z[q+2]=s.o,Z[q+3]=96):(h[q+3]=0,Z[q+3]=0)}this.b.Se=this.Y(20,20,20*.07,s,1,null);this.b.Ve=this.Y(20,20,20*.07,new x(28,28,28,96),1,null);this.b.Te=this.Y(20,20,1.2,new x(255,255,255,255),1,this.b.Db);this.b.We=this.Y(20,20,1.2,new x(0,0,0,255),1,this.b.Ob);this.b.Ue=this.Y(20,20,1.2,new x(255,255,255,96),1,this.b.gc);this.b.Xe=this.Y(20,20,1.2,new x(0,0,0,96),1,this.b.xc)};r.Y=function(a,b,c,d,f,e){void 0===f&&(f=1);var g=this.a.v.g.a.getContext("2d");g.clearRect(0,0,a,b);null!==e&&g.putImageData(e,0,0);g.globalAlpha=f;g.strokeStyle=S(d);g.fillStyle=S(d);g.lineWidth=c;f=a/2;d=3*b/4;var h=.1*a;c=Math.sqrt(f*f-(d-f)*(d-f))+f-h;f=-Math.sqrt(f*f-(d-f)*(d-f))+f+h;null!==e&&(c=Math.floor(c-.5),f=Math.ceil(f+.5),h=Math.ceil(h+.5),d=Math.floor(d-.5));g.beginPath();g.moveTo(a/2,h);g.lineTo(c,d);g.lineTo(f,d);g.closePath();g.stroke();a=g.getImageData(0,0,a,b);g.putImageData(a,0,0);return a};r.me=function(){var a=this.a.Md.g.a.getContext("2d");this.b.ca=a.createImageData(20,20);a=this.b.ca.data;this.b.Sa=Math.max(3,3);for(var b=0;20>b;b++)for(var c=0;20>c;c++){var d=Math.abs(b-8.5),f=Math.abs(c-8.5),d=Math.sqrt(f*f+d*d)/8.5,d=1>d?.15+.75*(1-d):0,f=4*(20*b+c);a[f+0]=0;a[f+1]=0;a[f+2]=0;a[f+3]=parseInt(255*d)}};function Hb(a){a.Ec=!0;Lb(a,!1)}r.cc=function(a,b){var c=Ca(this.a.C.g.a);return{d:(a-c.d-10-this.t.d)/24|0,e:(b-c.e-10-this.t.e)/24|0}};r.Za=function(a,b){var c=this.b.w,d=this.b.r;if(!(0>=c||0>=d)){var f=this.a.Selection.g.a.getContext("2d");f.clearRect(0,0,c,d);0<=a&&0<=b&&(c=10+this.t.d+24*a,d=10+this.t.e+24*b,this.p.G(a,b).Jb()&&f.putImageData(this.b.Ia,c,d))}};function Ib(a){var b=a.b.w,c=a.b.r,c=-a.t.e/(20+24*(a.p.p.length+1)-c)*(c-4-a.a.qc)+2;a.a.N.style.left=-a.t.d/(20+24*(Jb(a.p)+1)-b)*(b-4-a.a.rc)+2+"px";a.a.P.style.top=c+"px"};var Mb=-9,Nb=-8,Ob=-7;function Pb(a,b,c){this.s=a;this.I=b;this.Kc=c}Pb.prototype.Jb=function(){return!1};Pb.prototype.K=function(){return this.Kc};Pb.prototype.tb=function(){if(-10!==this.s)if(Mb===this.s){if(this.I.tb()&&0<z(this.I)&&this.I.K().ja.e>=this.Kc.ja.e)return{Ta:!0}}else if(Nb===this.s){if(!this.I.tb())return{Ta:!1};var a=this.Kc.ja.e,b=this.I.K().ja.e;if(a<b)return{Ta:!0,Me:0};if(a===b)return{Ta:!0,Me:1}}else if(Ob===this.s)return{Ta:this.Kc.tb()};return{Ta:!1}};function Gb(){this.p=[];this.f=null;this.$=0}Gb.prototype.ga=function(){this.p=[];this.$=0};Gb.prototype.ab=function(){this.f&&(this.ga(),Qb(this,this.f.ua,0,0))};function Qb(a,b,c,d){var f,e=1;for(f=b;0<z(f);)e++,f=f.K(0);for(f=e;!Rb(a,c,d,f);)d++;var e=c,g=d,h=b;for(a.O(e,g,b);0<z(h);)e++,h=h.K(0),a.O(e,g,h);for(e=b;0<z(e);)e=e.K(0);c+=f-1;for(f={Ye:d};;){for(var g=d,h=a.$,m=z(e),l=1;l<m;l++){a.$=h;var k=d,n=Qb(a,e.K(l),c+1,d+1);d=n.e;for(k+=1;k<=d;k++)if(k===n.Ye)if(m-1===l){a.O(c,k,new Pb(Ob,e,e.K(l)));break}else a.O(c,k,new Pb(Nb,e,e.K(l)));else k<n.Ye?a.O(c,k,new Pb(Mb,e,e.K(l))):a.O(c,k,new Pb(Mb,e,e.K(l+1)))}a.$=h;if(e===b)break;e.sb()&&a.$--;e=e.I;c--;d=g}f.e=d;return f}Gb.prototype.G=function(a,b){return void 0===this.p[b]||void 0===this.p[b][a]?new Pb(-10,null,null):this.p[b][a]};Gb.prototype.O=function(a,b,c){void 0===this.p[b]&&(this.p[b]=[]);if(c.Jb())if(c.sb()){this.$++;var d=this.$;c.ja.d=a;c.ja.e=b;c.ja.Id=d}else c.ja.d=a,c.ja.e=b,c.ja.Id=-1;this.p[b][a]=c};function Rb(a,b,c,d){for(var f=0;f<d;f++){var e=b+f;if(!1===(void 0===a.p[c]||void 0===a.p[c][e]||-10===a.p[c][e].s?!0:!1))return!1}return!0}function Jb(a){for(var b=0,c=a.p.length,d=0;d<c;d++){var f=a.p[d].length-1;f>b&&(b=f)}return b};function Sb(a){if(this.f=a)a.m=this;this.na=null;this.ia=[];this.a={Ed:null,Pe:null,He:null,Fe:null,nc:null,pc:null,ic:null};this.La=this.Fc=this.ta=0}r=Sb.prototype;r.Z=function(a,b){Tb(this,b);var c=this.f,d=F(a),f=a+"_Board",e=a+"_Message",g=a+"_Next";this.T(d.a,f);var h=this.T(d.a,g),m=this.T(d.a,e);m.style.backgroundColor="rgb(255,255,255)";m.style["border-radius"]="6px";m.style["-webkit-border-radius"]="6px";m.style["-moz-border-radius"]="5px";m.style["-khtml-border-radius"]="10px";m.style.borderColor="#e3e3e3";m.style.borderWidth="5px";m.style.borderStyle="ridge";m.style.display="block";var l=F(f);M(l.h,0,0,1E3,1E3,!1,!1,!1,!1,-1,-1);l.B=O|P|R|Q;d.u(l);this.T(l.a,f+"_Centred");var k=F(f);l.Ra(2);l.u(k);l=F(e);M(l.h,350,350,650,650,!1,!1,!1,!1,-1,-1);l.B=O|P|R|Q;d.u(l);k=new aa(this);k.Z(f,c);k.nb=this;var n=F(g);M(n.h,0,0,1E3,1E3,!1,!1,!1,!1,-1,-1);n.B=O|P|R|Q;d.u(n);c=g+"_Centred";this.T(n.a,c);f=F(c);n.Ra(2);n.u(f);n=c+"_Next";g=Ub(f.a,n);g.value="\u0414\u0430\u043b\u0435\u0435";g.style.display="none";var t=c+"_Prev",c=Ub(f.a,t);c.value="\u041d\u0430\u0437\u0430\u0434";c.style.display="none";var p=this;g.onclick=function(){p.a.nc.style.display="none";p.a.pc.style.display="none";Vb(p)};c.onclick=function(){p.a.nc.style.display="none";p.a.pc.style.display="none";Wb(p)};n=F(n);M(n.h,501,0,2,2,!1,!1,!0,!0,-1,25);n.B=P|R|Q;f.u(n);n=F(t);M(n.h,2,0,499,2,!0,!1,!1,!0,-1,25);n.B=P|R|Q;f.u(n);var u=e+"_Text",t=e+"_Next",v=e+"_Prev",e=this.T(m,u);e.style.fontFamily="verdana";e.style.textAlign="justify";e.style.ig="center";e.style.overflowY="scroll";f=Ub(m,t);n=Ub(m,v);n.onclick=function(){Wb(p)};f.onclick=function(){Vb(p)};u=F(u);M(u.h,0,0,1E3,35,!1,!1,!1,!0,-1,-1);u.B=O|P|Q|R;l.u(u);t=F(t);M(t.h,0,0,5,5,!1,!1,!0,!0,100,25);t.B=Q|R;l.u(t);t=F(v);M(t.h,5,0,0,5,!0,!1,!1,!0,100,25);t.B=Q|P;l.u(t);this.a.Ed=m;this.a.Pe=e;this.a.He=n;this.a.Fe=f;this.a.nc=g;this.a.pc=c;this.a.ic=h;this.ia.push(k);this.na=d;this.J();Xb(this,0,0)};r.J=function(){this.na&&this.na.Aa(this.na.a.clientWidth,this.na.a.clientHeight);for(var a=0,b=this.ia.length;a<b;a++)this.ia[a].J()};function Za(a){return null===a.D[a.ta].ba||void 0===a.D[a.ta].ba.se?0:a.D[a.ta].ba.se}function $a(a){null!==a.D[a.ta].ba&&!0===a.D[a.ta].ba.Df?(a.a.ic.style.display="block",a.a.nc.style.display="block",a.a.pc.style.display="block"):a.jg(a.ta,2)}r.Ie=function(){};r.vc=function(){};r.wb=function(){};function Tb(a,b){var c=b.length;a.Fc=c;a.D=[];for(var d=0;d<c;d++)a.D[d]={},a.D[d].Ld=b[d].Sgf,a.D[d].cg=b[d].Before,a.D[d].bg=b[d].After,a.D[d].Dd=b[d].Message,null===b[d].SgfPr?a.D[d].ba=null:(a.D[d].ba={},a.D[d].ba.se=b[d].SgfPr.Count,a.D[d].ba.Df=b[d].SgfPr.WaitOnEnd,a.D[d].ba.Fb={},b[d].SgfPr.Flags&&(a.D[d].ba.Fb.Gd=b[d].SgfPr.Flags.NewNode,a.D[d].ba.Fb.Fd=b[d].SgfPr.Flags.Move,a.D[d].ba.Fb.fd=b[d].SgfPr.Flags.ChangeBoardMode,a.D[d].ba.Fb.Cd=b[d].SgfPr.Flags.LoadFile))}function Vb(a){var b=a.ta;0===a.La?null!==a.D[b].Ld?Xb(a,b,1):(a.La=1,Vb(a)):1!==a.La||b>=a.Fc-1||(null!==a.D[b+1].Dd?Xb(a,b+1,0):(a.ta++,a.La=0,Vb(a)))}function Wb(a){var b=a.ta;0===a.La?0>=b||(null!==a.D[b-1].Ld?Xb(a,b-1,1):(a.ta--,a.La=1,Wb(a))):1===a.La&&(null!==a.D[b].Dd?Xb(a,b,0):(a.La=0,Wb(a)))}function Xb(a,b,c){if(!(0>b||b>=a.Fc)){a.ta=b;a.La=c;var d=a.D[b].Ld,f=a.D[b].ba,e=a.D[b].Dd;0===c?(a.a.ic.style.display="block",null!==e?(c=0===b?null:"\u041d\u0430\u0437\u0430\u0434",b=b===a.Fc-1&&null===d?null:"\u0414\u0430\u043b\u0435\u0435",d=a.a.He,f=a.a.Fe,a.a.Ed.style.display="block",a.a.Pe.innerHTML=e,null===c?d.style.display="none":(d.style.display="block",d.value=c),null===b?f.style.display="none":(f.style.display="block",f.value=b)):Vb(a)):1===c&&(a.a.ic.style.display="none",null!==d?(a.a.Ed.style.display="none",a.f.F=4294967295,a.f.ub(d),Yb(a.f,f.Fb),ob(a.f)):Vb(a))}}r.T=function(a,b){var c=document.createElement("div");c.setAttribute("id",b);c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("oncontextmenu","return false;");a.appendChild(c);return c};function Ub(a,b){var c=document.createElement("input");c.setAttribute("id",b);c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("type","button");a.appendChild(c);return c};function Bb(a){this.m=a;this.f=null;this.a={g:null};this.Kf=new x(217,217,217,255);this.Xd=[]}Bb.prototype.Z=function(a,b,c){this.f=b;this.a.g=F(a);var d=this.a.g.a,f=this.a.g;d.style.backgroundColor=S(this.Kf);for(var e=0,g=c.W.length;e<g;e++){var h=c.W[e],m=null;switch(h){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:m=new mb(this.m)}if(null!==m){var l=a+e;this.Na(d,l);this.U(f,l,e/g,(e+1)/g);m.Z(l,b,h);this.Xd.push(m)}}this.J()};Bb.prototype.J=function(){this.a.g.Aa(this.a.g.a.clientWidth,this.a.g.a.clientHeight);for(var a=0,b=this.Xd.length;a<b;a++)this.Xd[a].J()};Bb.prototype.Na=function(a,b){var c=document.createElement("div");c.setAttribute("id",b);c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("oncontextmenu","return false;");a.appendChild(c);return c};Bb.prototype.U=function(a,b,c,d){b=F(b);M(b.h,1E3*c,0,1E3*d,1E3,!1,!1,!1,!1,-1,-1);b.B=O|P|Q|R;a.u(b)};function U(){}r=U.prototype;r.tf=function(){return new Zb};r.kd=function(a,b){(new yb(a)).kd(b)};r.jd=function(a,b){(new yb(a)).jd(b)};r.hd=function(a,b){(new yb(a)).hd(b)};r.uf=function(a,b,c){(new Sb(a)).Z(b,c)};r.Af=function(a,b){var c={};c.Gd=b.NewNode;c.Fd=b.Move;c.fd=b.ChangeBoardMode;c.Cd=b.LoadFile;Yb(a,c)};r.ub=function(a,b){a.ub(b)};r.J=function(a){a.J()};window.GoBoardApi=new U;U.prototype.Create_GameTree=U.prototype.tf;U.prototype.Create_SimpleBoard=U.prototype.kd;U.prototype.Create_BoardWithNavigateButtons=U.prototype.jd;U.prototype.Create_BoardCommentsButtonsNavigator=U.prototype.hd;U.prototype.Create_Presentation=U.prototype.uf;U.prototype.Set_Permissions=U.prototype.Af;U.prototype.Load_Sgf=U.prototype.ub;U.prototype.Update_Size=U.prototype.J;var $b={};function ac(a,b,c){this.s=void 0===a?0:a;this.jf=void 0===b?null:b;this.ef=void 0===c?0:c}ac.prototype.ha=function(){return this.jf};ac.prototype.Ra=function(a){this.s=a};ac.prototype.sc=function(a){this.jf=a};function bc(){Y=X=0}function x(a,b,c,d){this.q=a;this.o=b;this.n=c;this.Vd="undefined"===typeof d?255:d}x.prototype={};function S(a){return"rgba("+a.q+","+a.o+","+a.n+","+a.Vd/255+")"}function T(a){var b=new bc;b.d=a&255;b.e=a>>8&255;return b}function cc(a){for(var b=[],c=0,d=a.length;c<d;c++)b.push(a[c]);return b}function Ca(a){if("undefined"!=typeof a.offsetParent){for(var b=0,c=0;a;a=a.offsetParent)b+=a.offsetLeft,c+=a.offsetTop;return{d:b,e:c}}return{d:a.x,e:a.y}}function Ha(a){if("string"!=typeof a)return!1;for(var b=0;b<a.length;b++){var c=a.charCodeAt(b);if(48>c||57<c)return!1}return!0}function gb(a,b){return a>b?1:b>a?-1:0}var V=null;function Kb(a,b,c,d,f){a.onmousedown=dc;a.Ca=!0;a.Ga=!0;a.root=a;a.Ca&&isNaN(parseInt(a.root.style.left))&&(a.root.style.left="0px");a.Ga&&isNaN(parseInt(a.root.style.top))&&(a.root.style.top="350px");!a.Ca&&isNaN(parseInt(a.root.style.right))&&(a.root.style.right="0px");!a.Ga&&isNaN(parseInt(a.root.style.bottom))&&(a.root.style.bottom="0px");a.Wa="undefined"!=typeof b?b:null;a.Xa="undefined"!=typeof d?d:null;a.pb="undefined"!=typeof c?c:null;a.qb="undefined"!=typeof f?f:null;a.of=null;a.pf=null;a.root.le=new Function;a.root.ke=new Function;a.root.je=new Function}function dc(a){var b=V=this;a=ec(a);var c=parseInt(b.Ga?b.root.style.top:b.root.style.bottom),d=parseInt(b.Ca?b.root.style.left:b.root.style.right);b.root.le(d,c);b.bf=a.clientX;b.cf=a.clientY;b.Ca?(null!=b.Wa&&(b.Mc=a.clientX-d+b.Wa),null!=b.pb&&(b.he=b.Mc+b.pb-b.Wa)):(null!=b.Wa&&(b.he=-b.Wa+a.clientX+d),null!=b.pb&&(b.Mc=-b.pb+a.clientX+d));b.Ga?(null!=b.Xa&&(b.Nc=a.clientY-c+b.Xa),null!=b.qb&&(b.ie=b.Nc+b.qb-b.Xa)):(null!=b.Xa&&(b.ie=-b.Xa+a.clientY+c),null!=b.qb&&(b.Nc=-b.qb+a.clientY+c));document.onmousemove=fc;document.onmouseup=gc;return!1}function fc(a){a=ec(a);var b=V,c=a.clientY;a=a.clientX;var d=parseInt(b.Ga?b.root.style.top:b.root.style.bottom),f=parseInt(b.Ca?b.root.style.left:b.root.style.right),e,g;null!=b.Wa&&(a=b.Ca?Math.max(a,b.Mc):Math.min(a,b.he));null!=b.pb&&(a=b.Ca?Math.min(a,b.he):Math.max(a,b.Mc));null!=b.Xa&&(c=b.Ga?Math.max(c,b.Nc):Math.min(c,b.ie));null!=b.qb&&(c=b.Ga?Math.min(c,b.ie):Math.max(c,b.Nc));e=f+(a-b.bf)*(b.Ca?1:-1);g=d+(c-b.cf)*(b.Ga?1:-1);b.of?e=b.of(d):b.pf&&(g=b.pf(f));null!=b.Wa&&(e=Math.max(e,b.Wa));null!=b.pb&&(e=Math.min(e,b.pb));null!=b.Xa&&(g=Math.max(g,b.Xa));null!=b.qb&&(g=Math.min(g,b.qb));V.root.style[b.Ca?"left":"right"]=e+"px";V.root.style[b.Ga?"top":"bottom"]=g+"px";V.bf=a;V.cf=c;V.root.je(e,g);return!1}function gc(){document.onmousemove=null;document.onmouseup=null;V.root.ke(parseInt(V.root.style[V.Ca?"left":"right"]),parseInt(V.root.style[V.Ga?"top":"bottom"]));V=null}function ec(a){"undefined"==typeof a&&(a=window.event);"undefined"==typeof a.layerX&&(a.layerX=a.offsetX);"undefined"==typeof a.layerY&&(a.layerY=a.offsetY);return a};var L=0,H=1,J=2,hc=2,oa=0,na=2,Fa=460,Da=Fa,Ga=17.51/23.61,Ea=Ga;var za=4,ic=4294967295^za;function Zb(a,b,c,d){this.ea=c;this.m=a;this.aa=d;this.Mf=new Fb;this.S=new jc;this.H=this.k=null;this.df=[];this.ua=new kc(this);this.Jf=0;this.i=this.ua;this.$b=this.Wb=0;this.lb=H;this.Xb=this.be=0;this.Vb=hc;this.F=4294967295}r=Zb.prototype;r.J=function(){this.m&&this.m.J()};function ob(a){a.k&&va(a.k)}r.ub=function(a){if(this.F&8){var b=new lc(this),c=this.F;this.F=4294967295;if(void 0!==a&&""!==a){b.l=[];b.c=0;b.zb=0;b.Yd=[];b.Ka=!0;for(var d=b.Yb=0,f=a.length,e=[],g=!1;d<f;){(g||32<a.charCodeAt(d))&&e.push(a.charAt(d));if(3<=e.length&&"["==e[e.length-1]){var h=e[e.length-3]+e[e.length-2];if("C"==e[e.length-2]&&"UC"!=h||"AN"==h||"BR"==h||"BT"==h||"CP"==h||"DT"==h||"EV"==h||"GN"==h||"GC"==h||"ON"==h||"OT"==h||"PB"==h||"PC"==h||"PW"==h||"RE"==h||"RO"==h||"RU"==h||"SO"==h||"TM"==h||"US"==h||"WR"==h||"WT"==h)g=!0}else g&&1<=e.length&&"]"==e[e.length-1]&&(2>e.length||"\\"!=e[e.length-2])&&(g=!1);d++}b.l=e;b.Yb=b.l.length;mc(b)||alert("Error occurs, while read SGF")}this.H&&this.H.ab();D(this,this.ua);this.F=c;this.k&&(a=this.k,null!==a.nb&&Ya(a.f.i)>=Za(a.nb)&&$a(a.nb))}};r.Mb=function(){this.df=[];this.ua=new kc(this);this.Vb=0;nc(this)};function ia(a,b){for(var c=a.i;null!=c.I&&0<b;)c=c.I,b--;D(a,c)}function la(a,b){if(1===b)ka(a)&&eb(a);else{for(var c=0;c<b;c++)ka(a);D(a,a.i)}}function ja(a){var b=a.i.I;if(null!==b){var c=b.Q;0<z(b)&&0<c&&D(a,b.K(c-1))}}function ma(a){var b=a.i.I;if(null!==b){var c=b.Q;c<z(b)-1&&D(a,b.K(c+1))}}r.od=function(){for(var a=this.i;!oc(a);){var b=a.I;if(null===b&&a!==this.ua)return;a=b}a.od();D(this,a)};r.Kd=function(a){this.lb=a;this.i.Kd(a)};r.rb=function(a,b,c){this.i.rb(a,b,c)};function db(a,b,c){if(a.F&1){var d=new kc(a),f=d.I=a.i;f.Da.push(d);if(!0===c||-1===f.Q)f.Q=f.Da.length-1;a.i=d;a.Xb++;!0===b&&a.H&&(a.H.ab(),lb(a.H))}}r.dc=function(a,b){this.i.dc(a,b)};r.ec=function(a){var b=this.i.ob;this.i.ec(a);this.H&&""===b&&""!==a&&lb(this.H)};r.Jd=function(a){var b=this.i.ob;this.i.Jd(a);this.H&&(""===b&&""!==a||""!==b&&""===a)&&lb(this.H)};r.ka=function(a,b){this.i.ka(a,b)};r.Ha=function(a){this.i.ka(513,a)};r.Cb=function(a,b){this.i.Cb(a,b)};r.Sc=function(a,b){this.i.Fa.hb||(this.i.Fa.hb=!0);for(var c=0,d=b.length;c<d;c++)this.i.Sc(b[c],a)};r.Rc=function(a){this.i.Rc(a)};r.Tc=function(a){this.i.Tc(a)};r.gd=function(){!0===this.i.Fa.hb&&(this.i.Fa.hb=!1,this.i.gd());this.k&&(this.k.aa={},Ka(this.k))};r.sb=function(){return this.i.sb()};function eb(a){a.k&&(1===a.k.Ua&&E(a.k,0),a.k.aa={},a.tc());for(var b=0,c=a.i.ra.length;b<c;b++){var d=a.i.ra[b],f=d.ha(),e=d.ef;switch(d.s){case 1:d=T(f);pc(a,d.d,d.e,H,!1);break;case 2:d=T(f);pc(a,d.d,d.e,J,!1);break;case 257:for(var g=0;g<e;g++)d=T(f[g]),qc(a,d.d,d.e,H,-1);break;case 258:for(g=0;g<e;g++)d=T(f[g]),qc(a,d.d,d.e,J,-1);break;case 259:for(g=0;g<e;g++)d=T(f[g]),qc(a,d.d,d.e,L,-1);break;case 260:a.lb=f;break;case 529:if(a.k)for(g=0;g<e;g++)d=T(f[g]),a.k.ka(new K(d.d,d.e,Sa,""));break;case 530:if(a.k)for(g=0;g<e;g++)d=T(f[g]),a.k.ka(new K(d.d,d.e,Va,""));break;case 531:if(a.k)for(g=0;g<e;g++)d=T(f[g]),a.k.ka(new K(d.d,d.e,Ta,""));break;case 532:if(a.k)for(g=0;g<e;g++)d=T(f[g]),a.k.ka(new K(d.d,d.e,Ua,""));break;case 533:a.k&&(d=T(f.zf),a.k.ka(new K(d.d,d.e,Pa,f.Text)));break;case 513:if(a.k)for(g=0;g<e;g++)d=T(f[g]),a.k.Ha(d.d,d.e)}}a.k&&(a.i.sb()?(c=a.i.Ma,b=c.Gb(),c=c.Hb(),Na(a.k,b,c)):Na(a.k,-1,-1),a.i.Fa.hb&&E(a.k,1),Ka(a.k));a.m&&a.m.vc(a.i.ob);a.H&&Lb(a.H,!0);a.wb()}function pc(a,b,c,d,f){if(0!=b||0!=c){a.ea&&!0!==f&&a.ea.gg();qc(a,b,c,d,a.be+1,f);var e=null;if(null!==(e=ib(a.S,b,c,d,!1))&&0<e.L()){b=e.L();for(c=0;c<b;c++){var g=T(e.ha(c));qc(a,g.d,g.e,L,-1)}a.ea&&!0!==f&&a.ea.yf(e);H===d?a.Wb+=b:a.$b+=b}else if(null!==(e=jb(a.S,b,c,d))&&0<e.L()){b=e.L();for(c=0;c<b;c++)g=T(e.ha(c)),qc(a,g.d,g.e,L,-1);a.ea&&!0!==f&&a.ea.yf(g_nGroupSize);H===d?a.$b+=b:a.Wb+=b}else a.S.mb.Mb()}a.lb=H===d?J:H;a.be++}function ka(a){if(!(a.F&2)||0===z(a.i)||-1===a.i.Q)return!1;a.i=a.i.K(a.i.Q);a.Xb++;return!0}r.tc=function(){this.k&&this.i.tc(this.Vb,this.k)};r.kc=function(){if(this.k){this.S.kc(this.k);Ka(this.k);this.i.Fa.hb||(this.i.Fa.hb=!0);var a=this.S,b=this.i.Fa;b.sa={};for(var c=a.L(),d=1;d<=c.e;d++)for(var f=1;f<=c.d;f++){var e=a.Ja[Aa(a,f,d)],g=(d<<8)+f;if(H===e||J===e)b.sa[""+g]=e}}};function D(a,b){if(a.F&2){nc(a);a.S.ga();a.ea&&a.ea.eg();var c;a:{c=!1;for(var d=b.I,f=b;null!=d;){for(var e=!1,g=0,h=z(d);g<h;g++)if(f===d.K(g)){g!==d.Q&&(c=!0);kb(d,g);e=!0;break}if(!e){c=!1;break a}f=d;d=d.I}}for(a.i=a.ua;a.i!=b&&0<z(a.i);){d=a.i.ra.length;for(f=0;f<d;f++)switch(h=a.i.ra[f],e=h.ha(),g=h.ef,h.s){case 1:h=T(e);pc(a,h.d,h.e,H,!0);break;case 2:h=T(e);pc(a,h.d,h.e,J,!0);break;case 257:for(var m=0;m<g;m++)h=T(e[m]),a.S.O(h.d,h.e,H,-1);break;case 258:for(m=0;m<g;m++)h=T(e[m]),a.S.O(h.d,h.e,J,-1);break;case 259:for(m=0;m<g;m++)h=T(e[m]),a.S.O(h.d,h.e,L,-1)}if(!ka(a))break}a.k&&Ja(a.k);eb(a);a.H&&!0===c&&lb(a.H);a.ea&&a.ea.fg()}}function pa(a,b){b!==a.Vb&&(a.Vb=b,a.tc())}function nc(a){a.i=a.ua;a.Wb=0;a.$b=0;a.be=0;a.Xb=0;a.lb=H}function qc(a,b,c,d,f,e){a.S.O(b,c,d,f);a.k&&!0!==e&&wa(a.k,b,c,d)}r.wb=function(){if(this.m){var a=this.Mf,b=this.i.I;a.Pa=null===this.i.I?!1:!0;a.Qa=0>=z(this.i)?!1:!0;if(null!==b){var c=b.Q;a.cb=c<z(b)-1?!0:!1;a.eb=0<c?!0:!1}else a.cb=!1,a.eb=!1;this.k&&(a.wa=this.k.Ua);this.m.wb(a)}};function Yb(a,b){b&&(!0===b.Gd?a.F|=1:!1===b.Gd&&(a.F&=-2),!0===b.Fd?a.F|=2:!1===b.Fd&&(a.F&=-3),!0===b.fd?a.F|=za:!1===b.fd&&(a.F&=ic),!0===b.Cd?a.F|=8:!1===b.Cd&&(a.F&=-9))};"use strict;";function hb(){this.kb=this.$=0}hb.prototype.Mb=function(){this.kb=this.$=0};hb.prototype.O=function(a,b){this.$=a;this.kb=b};function rc(a,b){this.ae=void 0===a?L:a;this.ce=void 0===b?-1:b}rc.prototype.ga=function(){this.ae=L;this.ce=-1};rc.prototype.sc=function(a){this.ae=a};rc.prototype.ha=function(){return this.ae};rc.prototype.nd=function(){return this.ce};function sc(){this.Rb=[];this.xb=[]}sc.prototype.L=function(){return this.xb.length};sc.prototype.ha=function(a){return this.xb[a]};function tc(a,b,c){b=(c<<8)+b;c=0;for(var d=a.xb.length;c<d;c++)if(a.xb[c]==b)return!0;return!1}function uc(){this.sa={}}uc.prototype.ga=function(){this.sa={}};uc.prototype.Kb=function(a,b){var c=(b<<8)+a;if(void 0!==this.sa[c])return!0;this.sa[c]=1;return!1};function vc(){this.M={};this.Zb=L}vc.prototype.ga=function(){this.M={};this.Zb=L};vc.prototype.Kb=function(a,b){var c=(b<<8)+a;if(void 0!==this.M[c])return!0;this.M[c]=1;return!1};function cb(a,b,c){c=void 0===c?a.Zb:c;for(var d in a.M)a=T(d|0),b.Ja[Aa(b,a.d,a.e)]=c}function jc(a,b){this.V=void 0===a?19:a;this.X=void 0===b?19:b;this.gb=null;wc(this);this.mb=new hb;this.Ja=null;this.M=new vc;this.Hc=new uc}r=jc.prototype;r.ga=function(){for(var a=this.V*this.X,b=0;b<a;b++)this.gb[b].ga()};r.L=function(){return{d:this.V,e:this.X}};r.O=function(a,b,c,d){a=Aa(this,a,b);this.gb[a].sc(c);void 0!==d&&null!==d&&-1!==d&&(this.gb[a].ce=d)};r.G=function(a,b){return this.gb[Aa(this,a,b)].ha()};r.nd=function(a,b){return this.gb[Aa(this,a,b)].nd()};function jb(a,b,c,d){var f=new sc;xc(a,b,c,d,f);return 0<f.L()?f:null}function ib(a,b,c,d,f){var e;switch(d){case H:e=J;break;case J:e=H;break;default:return null}d=new sc;!0!==tc(d,b+1,c)&&xc(a,b+1,c,e,d);!0!==tc(d,b-1,c)&&xc(a,b-1,c,e,d);!0!==tc(d,b,c+1)&&xc(a,b,c+1,e,d);!0!==tc(d,b,c-1)&&xc(a,b,c-1,e,d);e=d.L();if(1==e){b=(c<<8)+b;c=d.ha(0);e=a.mb;if(c===e.$&&b===e.kb&&1==f)return null;a.mb.O(b,c)}else if(1<e)a.mb.Mb();else if(0>=e)return null;return d}function wc(a){var b=a.V*a.X;a.gb=Array(b);for(var c=0;c<b;c++)a.gb[c]=new rc}function Aa(a,b,c){return(c-1)*a.V+(b-1)}function yc(a,b,c,d,f){if(b>a.V||1>b||c>a.X||1>c)return!1;var e=a.G(b,c);return L===e?!0:d===e?zc(a,b,c,d,f):!1}function zc(a,b,c,d,f){var e;a:{e=(c<<8)+b;for(var g=0,h=f.Rb.length;g<h;g++)if(f.Rb[g]==e){e=!0;break a}f.Rb.push(e);e=!1}return!0===e?!1:!0===yc(a,b+1,c,d,f)||!0===yc(a,b-1,c,d,f)||!0===yc(a,b,c+1,d,f)||!0===yc(a,b,c-1,d,f)?!0:!1}function xc(a,b,c,d,f){b>a.V||1>b||c>a.X||1>c||d!==a.G(b,c)||(!0!==zc(a,b,c,d,f)&&(f.xb=f.xb.concat(f.Rb)),f.Rb=[])}r.kc=function(a){for(var b=0,c=0,d=1;d<=this.X;d++)for(var f=1;f<=this.V;f++){var e=null,g=this.Ja[Aa(this,f,d)];H===g?(e=new K(f,d,Qa,""),J===this.G(f,d)?b+=2:b++):J===g&&(e=new K(f,d,Ra,""),H===this.G(f,d)?c+=2:c++);null===e?a.Ha(f,d):a.ka(e)}return{Db:b,Ob:c}};function Ac(a,b,c){if(!(b>a.V||1>b||c>a.X||1>c)){var d=a.G(b,c);if(L!==a.G(b,c))switch(b=a.M.Zb,b){case L:a.M.Zb=d;break;case H:case J:b!==d&&(a.M.Zb=3)}else!1===a.M.Kb(b,c)&&(Ac(a,b+1,c),Ac(a,b-1,c),Ac(a,b,c+1),Ac(a,b,c-1))}}function ab(a,b,c,d){b>a.V||1>b||c>a.X||1>c||(3-d===a.G(b,c)?d===a.Ja[Aa(a,b,c)]&&a.Hc.Kb(b,c):!0!==a.M.Kb(b,c)&&(ab(a,b+1,c,d),ab(a,b-1,c,d),ab(a,b,c+1,d),ab(a,b,c-1,d)))}function bb(a,b,c,d){if(!(b>a.V||1>b||c>a.X||1>c)&&3-d!==a.G(b,c)){if(d===a.G(b,c)){var f=a.Hc,e=(c<<8)+b;void 0!==f.sa[e]&&delete f.sa[e]}!0!==a.M.Kb(b,c)&&(bb(a,b+1,c,d),bb(a,b-1,c,d),bb(a,b,c+1,d),bb(a,b,c-1,d))}}function Ba(a,b){for(var c=1;c<=a.X;c++)for(var d=1;d<=a.V;d++)L===a.G(d,c)&&(L===a.Ja[Aa(a,d,c)]||!0===b&&3===a.Ja[Aa(a,d,c)])&&(a.M.ga(),Ac(a,d,c),cb(a.M,a))};function Bc(a,b){this.Gc=a;this.s=b}r=Bc.prototype;r.Gb=function(){return T(this.Gc).d};r.Hb=function(){return T(this.Gc).e};r.ha=function(){return this.Gc};r.sc=function(a){this.Gc=a};r.Ra=function(a){this.s=a};function kc(a){this.If=++a.Jf;this.Da=[];this.Q=-1;this.I=null;this.ra=[];this.Ma=new Bc(0,L);this.ob="";this.Fa=new Cc;this.ja={d:-1,e:-1,Id:-1};a.df[this.If]=this}r=kc.prototype;r.Jb=function(){return!0};r.K=function(a){return void 0!==this.Da[a]?this.Da[a]:this.Da[this.Q]};function kb(a,b){a.Q=b>=a.Da.length?a.Da.length-1:b}function z(a){return a.Da.length}r.sb=function(){return L===this.Ma.s?!1:!0};r.ec=function(a){this.ob+=a};r.Jd=function(a){this.ob=a};r.Sc=function(a,b){this.Fa.sa[""+a]=b};r.gd=function(){this.Fa.sa={}};r.od=function(){for(var a=this;0<z(a);)kb(a,0),a=a.K(0)};function oc(a){for(var b=null;null!==(b=a.I);){if(0!=b.Q)return!1;a=b}return!0}r.tb=function(){for(var a=this,b=null;null!=(b=a.I);){if(b.K(b.Q)!=a)return!1;a=b}return!0};r.rb=function(a,b,c){a=(b<<8)+a;this.ra.push(new ac(H===c?1:2,a));L===this.Ma.s&&(this.Ma.sc(a),this.Ma.Ra(c))};r.dc=function(a,b){var c=new ac(H===a?257:J===a?258:259,cc(b),b.length);this.ra.push(c)};r.ka=function(a,b){var c=0;switch(a){case Sa:c=529;break;case xa:c=$b.dg;break;case Ta:c=531;break;case Ua:c=532;break;case Pa:c=533;break;case Va:c=530}c=new ac(c,cc(b),b.length);this.ra.push(c)};r.Cb=function(a,b){this.ra.push(new ac(533,{Text:a,zf:b}))};r.Kd=function(a){this.ra.push(new ac(260,a))};r.Rc=function(a){this.ra.push(new ac(769,a))};r.Tc=function(a){this.ra.push(new ac(770,a))};r.tc=function(a,b){b.a.wc.g.a.getContext("2d").clearRect(0,0,b.b.w,b.b.r);switch(a){case hc:Dc(this,b,-1);break;case 1:var c=this.I;null!==c&&Dc(c,b,this.Ma.ha())}};function Ya(a){for(var b=1,c=null;null!==(c=a.I);)b++,a=c;return b}function Dc(a,b,c){if(b)for(var d=0,f=z(a);d<f;d++){var e=a.K(d).Ma;if(L!==e.s&&c!==e.ha()){var g=T(e.ha()),e=b;if(e.b.v){var h=(e.b.qa/2-1)/2,m=e.b.v,l=m[g.d-1].d,g=m[g.e-1].e,m=e.a.wc.g.a.getContext("2d");m.fillStyle=S(e.Of);m.beginPath();m.arc(l,g,h,0,2*Math.PI,!1);m.fill()}}}};function lc(a){this.f=a;this.l=[];this.zb=this.c=0;this.Yd=[];this.Ka=!0;this.Yb=0}function mc(a){a.f.Mb();if("("===a.l[0]&&";"===a.l[1])for(a.c++;a.c<a.Yb&&(")"!==a.l[a.c]||0!==a.zb);){var b=a.l[a.c];if(";"===b){1!=a.c?db(a.f,!1,!1):a.f.i=a.f.ua;a:{b=a;b.c++;for(var c=b.l[b.c],d=b.l[b.c+1];void 0!==c&&")"!==c&&";"!==c&&"("!==c;){switch(c){case "A":switch(d){case "B":Ec(b,H);break;case "E":Ec(b,L);break;case "W":Ec(b,J);break;case "N":c=b;c.c+=3;W(c);break;case "P":c=b;c.c+=3;W(c);break;default:$(b)}break;case "B":switch(d){case "[":Fc(b,H);break;case "R":c=b;c.c+=3;W(c);break;case "T":c=b;c.c+=3;W(c);break;case "L":c=b;c.c+=3;c.f.Rc(Gc(c));break;default:$(b)}break;case "C":switch(d){case "[":c=b;c.c+=2;for(d="";"]"!==c.l[c.c]||"\\"===c.l[c.c-1];)"]"===c.l[c.c+1]&&"\\"===c.l[c.c]?(d+="]",c.c++):d+=c.l[c.c],c.c++;c.c++;c.f.ec(d);break;case "A":c=b;c.c+=3;W(c);break;case "P":c=b;c.c+=3;W(c);break;case "R":Hc(b,Sa);break;default:$(b)}break;case "D":switch(d){case "D":c=b;c.c+=3;W(c);break;default:$(b)}break;case "E":switch(d){case "V":c=b;c.c+=3;W(c);break;default:$(b)}break;case "F":switch(d){case "F":$(b);break;default:$(b)}break;case "G":switch(d){case "N":c=b;c.c+=3;W(c);break;case "C":c=b;c.c+=3;W(c);break;case "M":c=b;c.c+=3;1!==Ic(c)&&(c.Ka=!1);break;default:$(b)}break;case "H":switch(d){case "A":c=b;c.c+=3;Ic(c);break;default:$(b)}break;case "K":switch(d){case "M":c=b;c.c+=3;Gc(c);break;default:$(b)}break;case "L":switch(d){case "B":c=b;for(c.c+=3;;){d=c.l[c.c];c.c++;var f=c.l[c.c];c.c++;d=d.charCodeAt(0)-96;f=f.charCodeAt(0)-96;c.c++;for(var e="";"]"!==c.l[c.c]&&c.c<c.Yb;)e+=c.l[c.c],c.c++;c.f.Cb(e,(f<<8)+d);if("]"!==c.l[c.c]){c.Ka=!1;break}c.c++;if("["!==c.l[c.c])break;c.c++}break;default:$(b)}break;case "M":switch(d){case "A":Hc(b,Va);break;default:$(b)}break;case "O":switch(d){case "N":c=b;c.c+=3;W(c);break;case "T":c=b;c.c+=3;W(c);break;default:$(b)}break;case "P":switch(d){case "B":c=b;c.c+=3;W(c);break;case "C":c=b;c.c+=3;W(c);break;case "W":c=b;c.c+=3;W(c);break;default:$(b)}break;case "R":switch(d){case "E":c=b;c.c+=3;W(c);break;case "O":c=b;c.c+=3;W(c);break;case "U":c=b;c.c+=3;W(c);break;default:$(b)}break;case "S":switch(d){case "Q":Hc(b,Ta);break;case "T":c=b;c.c+=3;switch(Ic(c)){case 0:pa(c.f,hc);break;case 1:pa(c.f,1);break;default:pa(c.f,0)}break;case "Z":d=b;d.c+=3;c=Ic(d);0>=c&&(c=19);d=d.f;f=d.S.L();if(c!==f.d||c!==f.e)f=d.S,e=c,f.V=c,f.X=e,wc(f),f.mb.Mb(),d.k&&(c=d.k,qa(c),c.Ya(!0));break;case "O":c=b;c.c+=3;W(c);break;default:$(b)}break;case "T":switch(d){case "R":Hc(b,Ua);break;case "M":c=b;c.c+=3;W(c);break;case "B":Jc(b,H);break;case "W":Jc(b,J);break;default:$(b)}break;case "U":switch(d){case "S":c=b;c.c+=3;W(c);break;default:$(b)}break;case "W":switch(d){case "[":Fc(b,J);break;case "R":c=b;c.c+=3;W(c);break;case "T":c=b;c.c+=3;W(c);break;case "L":c=b;c.c+=3;c.f.Tc(Gc(c));break;default:$(b)}break;default:$(b)}if(!b.Ka){b=!1;break a}c=b.l[b.c];d=b.l[b.c+1]}b=!0}if(!b)return!1}else if("("===b)a.Yd[a.zb]=a.f.i,a.zb++,a.c++;else if(")"===b)a.zb--,a.f.i=a.Yd[a.zb],a.c++;else return!1}else return!1;return!0}function W(a,b){void 0===b&&(b="]");for(var c="";void 0!==a.l[a.c]&&b!==a.l[a.c];)c+=a.l[a.c],a.c++;void 0===a.l[a.c]&&(a.Ka=!1);a.c++;return c}function Gc(a){a=parseFloat(W(a,void 0));return isNaN(a)?0:a}function Ic(a){a=parseInt(W(a,void 0));return isNaN(a)?0:a}function $(a){for(;;){for(;void 0!==a.l[a.c]&&"]"!==a.l[a.c]&&a.c<a.Yb;)for(a.c++;"]"===a.l[a.c]&&"\\"===a.l[a.c-1];)a.c++;a.c++;if("["!==a.l[a.c])break}}function Ec(a,b){a.c+=3;var c=[];if("]"!==a.l[a.c]){for(;;){var d=a.l[a.c];a.c++;var f=a.l[a.c];a.c++;c.push((f.charCodeAt(0)-96<<8)+(d.charCodeAt(0)-96));if("]"!==a.l[a.c]){a.Ka=!1;return}a.c++;if("["!==a.l[a.c])break;a.c++}a.f.dc(b,c)}}function Fc(a,b){a.c+=2;if("]"==a.l[a.c])a.f.rb(0,0,b);else{var c=a.l[a.c];a.c++;var d=a.l[a.c];a.c++;var f=a.f.S.L();"t"===c&&"t"===d&&19>=f.d&&19>=f.e?a.f.rb(0,0,b):(a.f.rb(c.charCodeAt(0)-96,d.charCodeAt(0)-96,b),"]"!==a.l[a.c]&&(a.Ka=!1))}a.c++}function Hc(a,b){var c=0;a.c+=3;var d=[];if("]"!==a.l[a.c]){for(;;){var f=a.l[a.c];a.c++;var e=a.l[a.c];a.c++;d[c]=(e.charCodeAt(0)-96<<8)+(f.charCodeAt(0)-96);c++;if("]"!==a.l[a.c]){a.Ka=!1;return}a.c++;if("["!==a.l[a.c])break;a.c++}a.f.ka(b,d)}}function Jc(a,b){var c=0;a.c+=3;var d=[];if("]"!==a.l[a.c]){for(;;){var f=a.l[a.c];a.c++;var e=a.l[a.c];a.c++;d[c]=(e.charCodeAt(0)-96<<8)+(f.charCodeAt(0)-96);c++;if("]"!==a.l[a.c]){a.Ka=!1;return}a.c++;if("["!==a.l[a.c])break;a.c++}a.f.Sc(b,d)}};function Cc(){this.hb=!1;this.sa={}};}());