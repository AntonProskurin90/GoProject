/*
 * Copyright (C) 2014  Ilya Kirillov 
 * email: ilya_kirillov@inbox.ru
 * 
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 3.0 of the License, or (at your option) any later version.
 * 
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
*/
(function(){var r;function aa(a){this.j=a;this.C=this.d=null;this.Ha=0;this.cc=!1;this.He=this.ec=this.fc=this.pb=this.qb=0;this.Me={};this.ra=null;this.b={A:0,u:0,ua:0,Ya:0,df:2,w:null,cf:null,D:null,wd:null,Ae:[],Jf:Array(361),uc:null,Oc:null,Zb:null,$b:null,zf:null,Af:null,sf:null,tf:null,vf:null,wf:null,hf:null,$e:null,af:null};this.ab=new x(231,188,95,255);this.Pe=new x(0,0,0,255);this.Dg=new x(255,0,0,128);this.Lb={dg:new x(232,196,115,255),rg:new x(255,255,255,255),cg:new x(0,0,0,255),og:new x(141,141,141,255),ig:new x(112,95,54,255),jg:new x(112,95,54,255)};this.a={e:null,D:{e:null},w:{e:null},Wb:{e:null},da:{e:null},Mc:{e:null},Da:{e:null},Na:{e:null},Event:{e:null}};this.Ja={f:-1,g:-1};this.ga={};this.Zc=-1;this.xb=null;var b=this;this.qd=function(a){ba(a);a=b.pc(y.f,y.g);a=ca(b,a.f,a.g);da(b,a.f,a.g,!1)};this.oc=function(a){ba(a);ea(b)};this.nc=function(a){fa(a);b.a.Event.e.a.focus();var d=b.pc(y.f,y.g),d=ca(b,d.f,d.g);b.Ve(d.f,d.g,y);a.preventDefault();a.stopPropagation();return!1};this.Lg=function(a){ga(a);if(16===ha.zc&&2===b.Ha)y.ea=!0,b.fb();else{var d=ha,f=d.zc;if(8===f||46===f)if(d=b.d,f=d.i.N,null===f)d.i.aa(),d.B&&(d.B.Va(),ia(d.B)),z(d,d.i);else for(var e=0,g=A(f);e<g;e++){if(d.i===f.L(e)){g=f;g.va.splice(e,1);g.Q>=e&&g.Q--; -1===g.Q&&0<g.va.length&&(g.Q=0);d.i=f;d.B&&(d.B.Va(),ia(d.B));z(d,f);break}}else if(13===f)d=prompt("Enter here code of ur sgf file",""),b.d.Eb(d);else if(37===f)d.na&&d.ea?(d=b.d,z(d,d.fa)):d.na?ja(b.d,5):ja(b.d,1);else if(38===f)d.na?b.d.Od():ka(b.d);else if(39===f)if(d.na&&d.ea){for(d=b.d;la(d););z(d,d.i)}else d.na?ma(b.d,5):ma(b.d,1);else 40===f?na(b.d):112===f?C(b,0):113===f?C(b,1):114===f?C(b,2):115===f?C(b,3):116===f?C(b,4):117===f?C(b,5):118===f?C(b,6):119===f?C(b,7):120===f?C(b,8):189===f?(d=b.d.gc,d++,d>oa&&(d=pa),qa(b.d,d)):192===f&&(d=!0===b.cc?!1:!0,d!==b.cc&&(b.cc=d,ra(b),b.za(!0)))}a.preventDefault()};this.Mg=function(a){ga(a);16===ha.zc&&2===b.Ha&&(y.ea=!1,b.fb())};this.We=function(){return setTimeout(function(){b.Ue();b.od();if(b.b.w){var a=b.a.D.e.a.width,d=b.a.D.e.a.height,f=b.a.Wb.e.a.getContext("2d"),e=2*Math.floor(Math.floor(b.fc*a)/2)+1;b.b.ua=e;b.b.wd=f.createImageData(e,e);b.b.qg=f.createImageData(e,e);b.b.uc=f.createImageData(e,e);b.b.Oc=f.createImageData(e,e);for(var g=b.b.wd.data,h=b.b.qg.data,k=b.b.uc.data,m=b.b.Oc.data,l=e/2-.5,n=l-.2,s=Math.sqrt(3),p=0;p<e;p++)for(var u=0;u<e;u++){var v=p-l,E=u-l,N=n-Math.sqrt(v*v+E*E),w=4*(p*e+e-u-1);if(0<=N){var M=n*n-v*v-E*E,M=0<M?Math.sqrt(M)*s:0,P=v,Z=E,t=Math.sqrt(6*(P*P+Z*Z+M*M)),t=(2*M-P+Z)/t,M=0;.9<t&&(M=10*(t-.9));P=255;.8>=N&&(N=(.8-N)/.8,P=.7,v-E<n/3&&(P=1),P=parseInt(255*(1-N*P)));v=parseInt(10+10*t+140*M);g[w+0]=v;g[w+1]=v;g[w+2]=v;g[w+3]=P;k[w+0]=v;k[w+1]=v;k[w+2]=v;k[w+3]=parseInt(P/2);v=parseInt(200+10*t+45*M);h[w+0]=v;h[w+1]=v;h[w+2]=v;h[w+3]=P;m[w+0]=v;m[w+1]=v;m[w+2]=v;m[w+3]=parseInt(P/2)}else g[w+0]=0,g[w+1]=0,g[w+2]=0,g[w+3]=0,k[w+0]=0,k[w+1]=0,k[w+2]=0,k[w+3]=0,h[w+0]=0,h[w+1]=0,h[w+2]=0,h[w+3]=0,m[w+0]=0,m[w+1]=0,m[w+2]=0,m[w+3]=0}g=[];k=[];for(w=0;28>w;w++)for(g[w]=f.createImageData(e,e),k[w]=g[w].data,p=0;p<e;p++)for(u=0;u<e;u++)l=4*(p*e+u),k[w][l+0]=h[l+0],k[w][l+1]=h[l+1],k[w][l+2]=h[l+2],k[w][l+3]=h[l+3];k.push(m);k.push(h);h=.9;u=Array(a);for(m=0;m<a;m++)u[m]=(Math.sin(18*m/a)+1)/20+(Math.sin(3*m/a)+1)/10;w=Array(d);for(p=0;p<d;p++)w[p]=.2*Math.cos(5*p/d)+.1*Math.sin(11*p/d);f=Array(a*d);for(p=0;p<d;p++)for(m=0;m<a;m++)h=75*(u[m]+w[p])+.5,h-=Math.floor(h),h=.2>h?1-h/2:.4>h?1-(.4-h)/2:1,f[m+p*a]=h;d=b.C.O().f;u=b.b.w;w=(b.b.ua-1)/2;l=k.length;for(n=0;n<l;n++){s=k[n];h=m=0;p=n;if(9===d){if(1===n||9===n||13===n||11===n||21===n||23===n||25===n)p=n-1}else 13!==d||3!==n&&7!==n&&11!==n&&15!==n&&23!==n&&27!==n||(p=n-1);switch(p){case 0:m=0;h=3;break;case 1:m=0;h=4;break;case 2:m=0;h=5;break;case 3:m=0;h=6;break;case 4:m=1;h=3;break;case 5:m=1;h=4;break;case 6:m=1;h=5;break;case 7:m=1;h=6;break;case 8:m=2;h=3;break;case 9:m=2;h=4;break;case 10:m=2;h=5;break;case 11:m=2;h=6;break;case 12:h=m=3;break;case 13:m=3;h=4;break;case 14:m=3;h=5;break;case 15:m=3;h=6;break;case 16:m=4;h=3;break;case 17:h=m=4;break;case 18:m=4;h=5;break;case 19:m=4;h=6;break;case 20:m=5;h=3;break;case 21:m=5;h=4;break;case 22:h=m=5;break;case 23:m=5;h=6;break;case 24:m=6;h=3;break;case 25:m=6;h=4;break;case 26:m=6;h=5;break;case 27:h=m=6}t=u[m].f-w;v=u[h].g-w;for(p=0;p<e;p++)for(m=0;m<e;m++)h=f[t+m+(v+p)*a],E=4*(m+p*e),s[E+0]*=h,s[E+1]*=h,s[E+2]*=h}b.b.Ae=g;a=b.C.O();for(e=0;e<a.g;e++)for(d=0;d<a.f;d++)b.b.Jf[d+e*a.f]=Math.floor(Math.random()*(b.b.Ae.length-1))}b.Te();b.b.w&&(a=b.b.ua,b.b.Zb=sa(b,a,a,.05*a,new x(0,0,0,255)),b.b.$b=sa(b,a,a,.05*a,new x(255,255,255,255)),b.b.zf=b.Y(a,a,.05*a,new x(0,0,0,255)),b.b.Af=b.Y(a,a,.05*a,new x(255,255,255,255)),b.b.sf=ta(b,a,a,.05*a,new x(0,0,0,255)),b.b.tf=ta(b,a,a,.05*a,new x(255,255,255,255)),b.b.vf=ua(b,a,a,new x(0,0,0,255)),b.b.wf=ua(b,a,a,new x(255,255,255,255)),b.b.hf=va(b,a,a,.05*a,new x(255,0,0,255)),b.b.$e=va(b,a,a,.05*a,new x(0,0,0,255)),b.b.af=va(b,a,a,.05*a,new x(255,255,255,255)));b.za()},20)};this.Jg=function(a){a.preventDefault();return!1};this.Kg=function(a){a.preventDefault();if(0<a.dataTransfer.files.length&&FileReader){a=a.dataTransfer.files[0];var d=new FileReader;d.onload=function(a){b.d.Eb(a.target.result)};d.readAsText(a);wa(b)}}}r=aa.prototype;r.M=function(a,b){this.j&&this.j.qf(this);this.d=b;this.C=b.W;this.d.k=this;this.a.e=F(a);var c=this.a.e.a,d=a+"_BoardCanvas",f=a+"_LinesCanvas",e=a+"_ShadowsCanvas",g=a+"_StonesCanvas",h=a+"_VariantsCanvas",k=a+"_MarksCanvas",m=a+"_TargetCanvas",l=a+"_EventDiv";this.ia(c,d);this.ia(c,f);this.ia(c,e);this.ia(c,g);this.ia(c,h);this.ia(c,k);this.ia(c,m);var c=this.la(c,l),n=this.a.e;this.X(this.a.D,n,d);this.X(this.a.w,n,f);this.X(this.a.da,n,e);this.X(this.a.Wb,n,g);this.X(this.a.Mc,n,h);this.X(this.a.Da,n,k);this.X(this.a.Na,n,m);this.X(this.a.Event,n,l);c.onmousemove=this.qd;c.onmouseout=this.oc;c.onmousedown=this.nc;c.onkeydown=this.Lg;c.onkeyup=this.Mg;c.tabIndex=-1;c.style.sg=!0;c.style.outline=0;c.ondragover=this.Jg;c.ondrop=this.Kg;return n};function wa(a){a.a.Event.e.a.focus()}r.J=function(){var a=this.a.e.a.clientWidth,b=this.a.e.a.clientHeight;a!==b&&(b=a=Math.min(a,b));this.a.e.ta(a,b);ra(this);this.za()};function xa(a,b,c,d){if(a.b.w&&d!==a.Me[(c<<8)+b]){var f=a.a.Wb.e.a.getContext("2d"),e=a.a.da.e.a.getContext("2d"),g=a.b.ua,h=(g-1)/2,k=a.b.w,m=a.b.Ya,l=k[b-1].f-h,h=k[c-1].g-h;switch(d){case G:f.putImageData(a.b.wd,l,h);e.putImageData(a.b.da,l+m,h+m);break;case H:f.putImageData(a.b.Ae[a.b.Jf[b-1+(c-1)*a.C.O().f]],l,h);e.putImageData(a.b.da,l+m,h+m);break;default:f.clearRect(l,h,g,g),e.clearRect(l+m,h+m,g,g)}a.Me[(c<<8)+b]=d;b===a.Ja.f&&c===a.Ja.g&&(G===d||H===d?ea(a):a.fb())}}r.Ma=function(a,b){var c=(b<<8)+a;delete this.ga[""+c];c===this.Zc&&(this.ga[""+c]=new I(a,b,ya,""))};r.ma=function(a){za(this,a.Qb(),a.Rb(),a)};function C(a,b){if(a.d.F&Aa&&a.Ha!==b){1===a.Ha&&a.d.Hd();a.Ha=b;a.fb();if(1===b){var c=a.C;c.Oa=[];for(var d=1;d<=c.$;d++)for(var f=1;f<=c.K;f++)c.Oa[Ba(c,f,d)]=J;Ca(c,!1);a.d.xc()}a.d.lb()}}r.ia=function(a,b){var c=document.createElement("canvas");c.setAttribute("id",b);c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("oncontextmenu","return false;");a.appendChild(c);return c};r.la=function(a,b){var c=document.createElement("div");c.setAttribute("id",b);c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("oncontextmenu","return false;");a.appendChild(c);return c};r.X=function(a,b,c){a.e=F(c);a=a.e;K(a.h,0,0,1E3,1E3,!1,!1,!1,!1,-1,-1);a.o=L|O|Q|R;b.n(a)};r.pc=function(a,b){var c=Da(this.a.D.e.a);return{f:a-c.f,g:b-c.g}};function ra(a){var b=a.C.O(),c=b.f,d=b.g;if(!0===a.cc){var b=Ea/(2*Fa+c),c=(Ea-c*b)/2,f=Ga/(2*Ha+d),d=(Ga-d*f)/2;a.qb=(d+f/2)/Ga;a.pb=(c+b/2)/Ea}else b=Ea/(2*Fa+c-1),c=(Ea-(c-1)*b)/2,f=Ga/(2*Ha+d-1),d=(Ga-(d-1)*f)/2,a.qb=d/Ga,a.pb=c/Ea;a.fc=b/Ea;a.ec=f/Ga;a.He=4/Ea}r.za=function(a){var b=this.a.D.e.a.width,c=this.a.D.e.a.height;if(b!=this.b.A||c!=this.b.u||null===this.b.D||null!==this.ra||!0===a){if(null!==this.ra&&clearTimeout(this.ra),this.ra=this.We(),this.od(),0!==b&&0!==c){a=this.a.D.e.a.getContext("2d");a.fillStyle=S(this.Lb.dg);a.fillRect(0,0,b,c);var d=this.a.w.e.a.getContext("2d");a=this.pb*b;var f=this.qb*c,e=this.fc*b,g=this.ec*c,h=this.C.O();d.clearRect(0,0,b,c);d.strokeStyle=S(this.Lb.jg);for(var k=b-a,m=0;m<h.g;m++){var l=f+m*g;d.beginPath();d.moveTo(a,l);d.lineTo(k,l);d.stroke()}for(var k=c-f,n=0;n<h.f;n++)l=a+n*e,d.beginPath(),d.moveTo(l,f),d.lineTo(l,k),d.stroke();if(h.f===h.g&&(9===h.f||13===h.f||19===h.f)){d.fillStyle=S(this.Lb.ig);m=Math.max(2,this.He*b/2);n=[];switch(h.f){case 9:n=[[2,2],[2,6],[4,4],[6,2],[6,6]];break;case 13:n=[[3,3],[3,6],[3,9],[6,3],[6,6],[6,9],[9,3],[9,6],[9,9]];break;case 19:n=[[3,3],[3,9],[3,15],[9,3],[9,9],[9,15],[15,3],[15,9],[15,15]]}for(var s=0,p=n.length;s<p;s++)k=a+n[s][0]*e,l=f+n[s][1]*e,d.beginPath(),d.arc(k,l,m,0,2*Math.PI,!1),d.fill()}d=this.a.Wb.e.a.getContext("2d");d.clearRect(0,0,b,c);d.strokeStyle=S(this.Lb.og);d.lineWidth=1;s=S(this.Lb.cg);p=S(this.Lb.rg);for(m=1;m<=h.g;m++)for(n=1;n<=h.f;n++){k=this.C.I(n,m);if(G===k)d.fillStyle=s;else if(H===k)d.fillStyle=p;else continue;k=a+(n-1)*e;l=f+(m-1)*g;d.beginPath();d.arc(k,l,e/2,0,2*Math.PI,!1);d.fill();d.stroke()}this.a.da.e.a.getContext("2d").clearRect(0,0,b,c);this.a.Mc.e.a.getContext("2d").clearRect(0,0,b,c);this.a.Da.e.a.getContext("2d").clearRect(0,0,b,c);this.a.Na.e.a.getContext("2d").clearRect(0,0,b,c)}}else{this.a.D.e.a.getContext("2d").putImageData(this.b.D,0,0);if(!0===this.cc&&this.b.w){b=this.a.D.e.a.getContext("2d");c=this.b.A;g=this.b.u;a=this.C.O();for(h=0;h<a.f;h++){d=2*this.b.ua/3;f=(d-1)/2;k=this.b.w;e=k[h].f-f;k=this.qb*g/3-f;l=new String;switch(h+1){case 1:l="A";break;case 2:l="B";break;case 3:l="C";break;case 4:l="D";break;case 5:l="E";break;case 6:l="F";break;case 7:l="G";break;case 8:l="H";break;case 9:l="J";break;case 10:l="K";break;case 11:l="L";break;case 12:l="M";break;case 13:l="N";break;case 14:l="O";break;case 15:l="P";break;case 16:l="Q";break;case 17:l="R";break;case 18:l="S";break;case 19:l="T";break;case 20:l="a";break;case 21:l="b";break;case 22:l="c";break;case 23:l="d";break;case 24:l="e";break;case 25:l="f";break;case 26:l="g";break;case 27:l="h";break;case 28:l="j";break;case 29:l="k";break;case 30:l="l";break;case 31:l="m";break;case 32:l="n";break;case 33:l="o";break;case 34:l="p";break;case 35:l="q";break;case 36:l="r";break;case 37:l="s";break;case 38:l="t"}m=2*d/3;n=Ia(l)?"Arial":"Helvetica, Arial, Verdana";n=m+"px "+n;b.fillStyle="rgb(0,0,0)";b.font=n;m=d/2+m/3;d=(d-b.measureText(l).width)/2;b.fillText(l,e+d,k+m);k=g-this.qb*g/3-f;b.fillText(l,e+d,k+m)}for(g=0;g<a.g;g++)d=2*this.b.ua/3,f=(d-1)/2,k=this.b.w,e=this.pb*c/3-f,k=k[g].g-f,l=a.g-g+"",m=2*d/3,n=Ia(l)?"Arial":"Helvetica, Arial, Verdana",n=m+"px "+n,b.fillStyle="rgb(0,0,0)",b.font=n,m=d/2+m/3,d=(d-b.measureText(l).width)/2,b.fillText(l,e+d,k+m),e=c-this.pb*c/3-f,b.fillText(l,e+d,k+m)}Ja(this);b=this.b.A;c=this.b.u;this.a.Wb.e.a.getContext("2d").clearRect(0,0,b,c);this.a.da.e.a.getContext("2d").clearRect(0,0,b,c);this.Me={};Ka(this);La(this)}};r.Ue=function(){var a=this.a.D.e.a.width,b=this.a.D.e.a.height,c=this.a.D.e.a.getContext("2d");if(0!==a&&0!==b){for(var c=c.createImageData(a,b),d=.9,f=this.ab.t,e=this.ab.q,g=this.ab.p,h=Array(a),k=0;k<a;k++)h[k]=(Math.tan(300*k/a)+1)/2+(Math.tan(100*k/a)+1)/10;for(var m=Array(b),l=0;l<b;l++)m[l]=.02*Math.tan(l/b);for(var n,s,l=0;l<b;l++)for(k=0;k<a;k++){d=40*(h[k]+m[l])+.5;d-=Math.floor(d);d=.2>d?1-d/2:.4>d?1-(.4-d)/2:1;if(l==b-1||l==b-2&&k<a-2||k>=a-1||k==a-2&&l<b-1)d/=2;0==l||1==l&&1<k||0==k||1==k&&1<l?(n=128+f*d/2,s=128+e*d/2,d=128+g*d/2):(n=f*d,s=e*d,d*=g);var p=4*(k+l*a);c.data[p+0]=n;c.data[p+1]=s;c.data[p+2]=d;c.data[p+3]=255}this.b.D=c;this.b.A=a;this.b.u=b;this.ra=null}};r.od=function(){var a=this.b.A,b=this.b.u;if(0!==a&&0!==b){for(var c=this.pb*a,d=this.qb*b,b=this.ec*b,f=this.fc*a,e=this.C.O(),g=Array(e.f),h=c,k=d,m=0;m<e.f;m++)h=c+m*f,k=d+m*b,g[m]={f:Math.floor(h+.5),g:Math.floor(k+.5)};this.b.w=g;a=Math.max(2,Math.ceil(this.He*a/2));c=2*a+1;d=this.b;b=this.Pe;f=document.createElement("canvas").getContext("2d").createImageData(c,c);e=a;g=-1;h=e*e;for(m=0;e>g;){g++;k=Math.sqrt(h-g*g);k=Math.ceil(k)-k;k<=m&&e--;var l=Math.floor(255*(1-k)),n=a+e,s=a+e,p=a+g,u=a+g,v=a-e,E=a-e,m=a-g,N=a-g;Ma(f,n,u,l,c,b);Ma(f,p,s,l,c,b);Ma(f,v,u,l,c,b);Ma(f,m,s,l,c,b);Ma(f,n,N,l,c,b);Ma(f,p,E,l,c,b);Ma(f,v,N,l,c,b);Ma(f,m,E,l,c,b);for(var l=n-1,s=s-1,v=v+1,E=E+1,n=f,w=l,M=c,P=b,Z=v;Z<=w;Z++)Ma(n,Z,u,255,M,P);u=f;n=s;w=c;M=b;for(P=E;P<=n;P++)Ma(u,p,P,255,w,M);p=f;u=c;for(n=b;v<=l;v++)Ma(p,v,N,255,u,n);N=f;v=c;for(l=b;E<=s;E++)Ma(N,m,E,255,v,l);m=k}d.cf=f;this.b.df=a}};function Ja(a,b){if(a.b.w){var c=a.b.A,d=a.b.u,f=a.a.w.e.a.getContext("2d"),e=a.C.O(),g=a.b.w;f.clearRect(0,0,c,d);if(e.f===e.g&&(9===e.f||13===e.f||19===e.f)){var d=a.b.cf,h=a.b.df,k=[];switch(e.f){case 9:k=[[2,2],[2,6],[4,4],[6,2],[6,6]];break;case 13:k=[[3,3],[3,6],[3,9],[6,3],[6,6],[6,9],[9,3],[9,6],[9,9]];break;case 19:k=[[3,3],[3,9],[3,15],[9,3],[9,9],[9,15],[15,3],[15,9],[15,15]]}for(var m=0,l=k.length;m<l;m++)f.putImageData(d,g[k[m][0]].f-h,g[k[m][1]].g-h)}for(var h=g[0].f,k=g[g.length-1].f,m=g[0].g,l=g[g.length-1].g,n=f.createImageData(1,l-m),s=f.createImageData(k-h,1),p=a.Pe,u=0;u<l-m;u++)d=4*u,n.data[d+0]=p.t,n.data[d+1]=p.q,n.data[d+2]=p.p,n.data[d+3]=p.Be;for(u=0;u<k-h;u++)d=4*u,s.data[d+0]=p.t,s.data[d+1]=p.q,s.data[d+2]=p.p,s.data[d+3]=p.Be;for(u=0;u<e.f;u++)f.putImageData(n,g[u].f,g[0].g),f.putImageData(s,g[0].f,g[u].g);if(void 0!==b)for(c=(2*Math.floor(parseInt(a.ec*c)/2)+1-1)/2,e=g[1].f-g[0].f+2,h=g[1].g-g[0].g+2,d=0;d<b.length;d++)k=b[d].f,m=b[d].g,J===a.C.I(k,m)&&f.clearRect(g[k-1].f-c,g[m-1].g-c,e,h)}}function Ma(a,b,c,d,f,e){b=4*(b+c*f);a.data[b+0]=e.t;a.data[b+1]=e.q;a.data[b+2]=e.p;a.data[b+3]=d}function Ka(a){for(var b=a.C.O(),c=1;c<=b.g;c++)for(var d=1;d<=b.f;d++)xa(a,d,c,a.C.I(d,c))}r.Te=function(){if(this.b.w){var a=this.a.da.e.a.getContext("2d"),b=this.b.ua;this.b.da=a.createImageData(b,b);a=this.b.da.data;this.b.Ya=Math.max(parseInt(.15*b),3);for(var c=(b-5)/2+1,d=0;d<b;d++)for(var f=0;f<b;f++){var e=Math.abs(d-c),g=Math.abs(f-c),e=Math.sqrt(g*g+e*e)/c,e=1>e?.15+.75*(1-e):0,g=4*(b*d+f);a[g+0]=0;a[g+1]=0;a[g+2]=0;a[g+3]=parseInt(255*e)}}};r.fb=function(){da(this,this.Ja.f,this.Ja.g,!0)};function da(a,b,c,d){var f=y;if(-1===b||-1===c||0===b||0===c)ea(a);else if(null===a.ra&&null!==a.b.w&&(void 0===d&&(d=!1),b!==a.Ja.f||c!==a.Ja.g||!0===d)){a.Ja.f=b;a.Ja.g=c;var e=a.b.A,g=a.b.u;d=a.a.Na.e.a.getContext("2d");d.clearRect(0,0,e,g);var g=(a.b.ua-1)/2,h=a.b.w,e=h[b-1].f-g,g=h[c-1].g-g;b=a.C.I(b,c);switch(a.Ha){case 0:J===b&&(G===a.d.ub?d.putImageData(a.b.uc,e,g):d.putImageData(a.b.Oc,e,g));break;case 1:G===b?d.putImageData(a.b.$b,e,g):H===b&&d.putImageData(a.b.Zb,e,g);break;case 2:G===b?d.putImageData(a.b.$b,e,g):H===b?d.putImageData(a.b.Zb,e,g):f.ea?d.putImageData(a.b.Oc,e,g):d.putImageData(a.b.uc,e,g);break;default:G===b?d.putImageData(a.b.$b,e,g):d.putImageData(a.b.Zb,e,g)}}}function ea(a){var b=a.b.A,c=a.b.u;a.a.Na.e.a.getContext("2d").clearRect(0,0,b,c);a.Ja.f=-1;a.Ja.g=-1}function ca(a,b,c){var d=a.b.A,f=a.b.u,e=a.pb*d,g=a.qb*f,f=a.ec*f,d=a.fc*d,h=0;a=a.C.O();for(h=0;h<a.g-1&&c>g+f*h+f/2;h++);for(c=c=0;c<a.f-1&&b>e+d*c+d/2;c++);return{f:c+1,g:h+1}}function sa(a,b,c,d,f){a=a.a.Da.e.a.getContext("2d");a.clearRect(0,0,b,c);a.strokeStyle=S(f);a.fillStyle=S(f);a.lineWidth=d;a.beginPath();a.moveTo(1*b/4,1*c/4);a.lineTo(3*b/4,3*c/4);a.moveTo(3*b/4,1*c/4);a.lineTo(1*b/4,3*c/4);a.stroke();return a.getImageData(0,0,b,c)}r.Y=function(a,b,c,d,f){void 0===f&&(f=1);var e=this.a.Da.e.a.getContext("2d");e.clearRect(0,0,a,b);e.globalAlpha=f;e.strokeStyle=S(d);e.fillStyle=S(d);e.lineWidth=c;var g=a/2;c=3*b/4;d=.1*a;f=Math.sqrt(g*g-(c-g)*(c-g))+g;g=-Math.sqrt(g*g-(c-g)*(c-g))+g;e.beginPath();e.moveTo(a/2,d);e.lineTo(f-d,c);e.lineTo(g+d,c);e.closePath();e.stroke();return e.getImageData(0,0,a,b)};function ta(a,b,c,d,f){a=a.a.Da.e.a.getContext("2d");a.clearRect(0,0,b,c);a.strokeStyle=S(f);a.fillStyle=S(f);a.lineWidth=Math.floor(d+.5);var e=b/2,g=-c/2*Math.sqrt(2)/2+c/2;f=Math.floor(Math.sqrt(e*e-(g-e)*(g-e))+e-d);e=Math.ceil(-Math.sqrt(e*e-(g-e)*(g-e))+e+d);g=Math.ceil(g+d);d=Math.floor(c/2*Math.sqrt(2)/2+c/2-d);a.beginPath();a.moveTo(f,g);a.lineTo(e,g);a.lineTo(e,d);a.lineTo(f,d);a.closePath();a.stroke();return a.getImageData(0,0,b,c)}function ua(a,b,c,d){a=a.a.Da.e.a.getContext("2d").createImageData(b,c);for(var f=0;f<c;f++)for(var e=0;e<b;e++){var g=4*(f*b+e);f>=c/3&&f<=2*c/3&&e>=b/3&&e<=2*b/3?(a.data[g+0]=d.t,a.data[g+1]=d.q,a.data[g+2]=d.p,a.data[g+3]=255):a.data[g+3]=0}return a}function va(a,b,c,d,f){a=a.a.Da.e.a.getContext("2d");a.clearRect(0,0,b,c);var e=b/2,g=4*d;a.strokeStyle=S(f);a.fillStyle=S(f);a.lineWidth=d;a.beginPath();a.arc(b/2,c/2,e-g,0,2*Math.PI,!1);a.stroke();return a.getImageData(0,0,b,c)}function Na(a,b,c){a=a.ga[""+((c<<8)+b)];return void 0!==a?a:null}function za(a,b,c,d){ya===d.r?Oa(a,b,c):a.ga[""+((c<<8)+b)]=d}function Oa(a,b,c){if(0>=b||0>=c)a.Zc=0;else{var d=(c<<8)+b;void 0===a.ga[""+d]&&(a.ga[""+d]=new I(b,c,ya,""));a.Zc=d}}function La(a){a.a.Da.e.a.getContext("2d").clearRect(0,0,a.b.A,a.b.u);var b=[],c;for(c in a.ga){var d=a.ga[c];Pa(a,d);Qa===d.r&&b.push({f:d.Qb(),g:d.Rb()})}Ja(a,b)}function Pa(a,b){if(a.b.w){var c=b.Qb(),d=b.Rb(),f=b.r,e=a.a.Da.e.a.getContext("2d"),g=a.b.ua,h=(g-1)/2,k=a.b.w,m=k[c-1].f-h,h=k[d-1].g-h,c=a.C.I(c,d);switch(f){case Ra:e.putImageData(a.b.vf,m,h);break;case Sa:e.putImageData(a.b.wf,m,h);break;case ya:e.putImageData(a.b.hf,m,h);break;case Ta:e.putImageData(c===G?a.b.af:a.b.$e,m,h);break;case Ua:e.putImageData(c===G?a.b.tf:a.b.sf,m,h);break;case Va:e.putImageData(c===G?a.b.Af:a.b.zf,m,h);break;case Wa:e.putImageData(c===G?a.b.$b:a.b.Zb,m,h);break;case Qa:f=b.fd,d=2>=f.length?2*g/3:g/2,k=d+"px "+(Ia(f)?"Arial":"Helvetica, Arial, Verdana"),e.fillStyle=c===G?"rgb(255,255,255)":"rgb(0,0,0)",e.font=k,e.fillText(f,m+(g-e.measureText(f).width)/2,h+(g/2+d/3))}}}r.Ve=function(a,b,c){switch(this.Ha){case 0:if(Xa==c.Ye)1<=this.d.hc&&(ja(this.d,1),Ya(this,a,b));else if(c.ea&&c.na)this.d.le(G===this.d.ub?H:G),this.fb();else if(!0===c.na){var d=new String;switch(a){case 1:d="A";break;case 2:d="B";break;case 3:d="C";break;case 4:d="D";break;case 5:d="E";break;case 6:d="F";break;case 7:d="G";break;case 8:d="H";break;case 9:d="J";break;case 10:d="K";break;case 11:d="L";break;case 12:d="M";break;case 13:d="N";break;case 14:d="O";break;case 15:d="P";break;case 16:d="Q";break;case 17:d="R";break;case 18:d="S";break;case 19:d="T"}this.d.rc(d+b)}else if(c.ea){d=this.d;d.ha&&d.ha.ng(!0);var f=d.i;z(d,d.fa);for(c=0;1E3>c&&J===d.W.I(a,b);)ma(d,1),c++;J===d.W.I(a,b)&&z(d,f);d.ha&&d.ha.ng(!1)}else Ya(this,a,b),null!==this.xb&&Za(this.d.i)>=$a(this.xb)&&ab(this.xb);break;case 1:if(!0===c.na)C(this,0);else{d=this.C;f=d.I(a,b);if(J!==f)if(d.Yc.aa(),c=d.Oa[Ba(d,a,b)],G!==c&&H!==c){d.P.aa();bb(d,a,b,f);for(var e in d.Yc.wa)c=T(e|0),d.P.aa(),cb(d,c.f,c.g,3-f),db(d.P,d,3);Ca(d,!0);d.P.aa();bb(d,a,b,f);db(d.P,d,3-f)}else d.P.aa(),bb(d,a,b,f),db(d.P,d,3),Ca(d,!0);this.d.xc()}break;case 2:!0===this.d.i.Cb()&&(eb(this.d,!0,!0),fb(this.d));d=G;J!==this.C.I(a,b)?d=J:c.ea&&(d=H);xa(this,a,b,d);this.C.S(a,b,d,-1);this.d.qc(d,[(b<<8)+a]);break;case 3:gb(this,Va,a,b);break;case 4:gb(this,Ua,a,b);break;case 5:gb(this,Ta,a,b);break;case 6:gb(this,Wa,a,b);break;case 7:a:{f=Na(this,a,b);if(null!==f&&Qa===f.r)this.d.Ma([(b<<8)+a]),this.Ma(a,b);else{f="";c.ea&&(f=prompt("Enter the label that you want to add to board here. For best results, keep your label to one or two letters.",""));if(void 0==f||""===f||null===f){f=[];c=-1;for(d in this.ga)if(e=this.ga[d],Qa==e.r){e=e.fd;var g=e.charCodeAt(0);1==e.length&&65<=g&&90>=g&&(f[g]=1)}for(d=65;90>=d;d++)if(void 0===f[d]||""==f[d]){c=d;break}f=-1==c?null:String.fromCharCode(c);if(null===f){alert("Sorry, all the standard labels are used up! To add more labels, you will have to shift click on the board and make up ur own labels to add.");break a}}d=new I(a,b,Qa,f);this.d.Nb(f,(b<<8)+a);za(this,a,b,d)}La(this)}break;case 8:a:{d=Na(this,a,b);if(null!==d&&Qa===d.r)this.d.Ma([(b<<8)+a]),this.Ma(a,b);else{d="";if(c.ea){d=this.C.Nd(a,b);if(-1==d){alert("Sorry, no move has been made at that location, so you can't mark it with the move number!");break a}d=""+d}if(void 0===d||""===d||null===d){d=[];c=0;for(f in this.ga)e=this.ga[f],Qa===e.r&&Ia(e.fd)&&(d[c]=parseInt(e.fd),c++);if(0>=c)d="1";else{d.sort(hb);e=f=0;for(var g=!1,h=0;h<c;h++){if(d[h]>f+1){e=f+1;g=!0;break}f=d[h]}g||(e=f+1);d=""+e}}f=new I(a,b,Qa,d);this.d.Nb(d,(b<<8)+a);za(this,a,b,f)}La(this)}}};function gb(a,b,c,d){var f=Na(a,c,d);if(null!==f&&b===f.r){if(a.d.Ma([(d<<8)+c]),a.Ma(c,d),a.b.w){b=(a.b.ua-1)/2;var e=a.b.w,f=e[c-1].f-b,e=e[d-1].g-b;a.a.Da.e.a.getContext("2d").clearRect(f,e,2*b,2*b);b=T(a.Zc);c===b.f&&d===b.g&&(Oa(a,c,d),Pa(a,Na(a,c,d)))}}else f=new I(c,d,b,""),a.d.ma(b,[(d<<8)+c]),za(a,c,d,f),Pa(a,f)}function Ya(a,b,c){if(J===a.C.I(b,c)){var d=G===a.d.ub?G:H,f=!1,e=new ib,f=a.C.wb;e.ba=f.ba;e.tb=f.tb;a.C.S(b,c,d,-1);f=null!==jb(a.C,b,c,d,!0)?!0:null!==kb(a.C,b,c,d)?!1:!0;a.C.S(b,c,J,-1);var g=a.C.wb;g.ba=e.ba;g.tb=e.tb;if(1==f){a:{for(var e=a.d,h=(c<<8)+b,f=0,k=A(e.i);f<k;f++){var g=e.i.L(f),m=g.Ka,l=m.r;if(h===m.ja()&&d===l&&(G===d||H===d)){b=e.i.Q;lb(e.i,f);e.i=g;e.hc++;e.B&&b!==f&&ia(e.B);break a}}e.F&1&&(eb(e,!1,!0),e.i.Ab(b,c,d),e.B&&(e.B.Va(),ia(e.B)))}fb(a.d)}}};function mb(a){this.j=a;this.d=null;this.V=this.r=0;this.kc=16;this.Ge=!1;this.b={bf:null,nf:null,gf:null,Xe:null,rf:null};this.a={e:null,wc:{e:null}};this.Uf=new x(217,217,217,255);this.Ag=new x(0,0,0,255);this.Ne=new x(54,101,179,255);this.Oe=new x(255,255,255,255);this.xg=new x(140,140,140,255);this.$=this.K=0;var b=this;this.nc=function(){b.pd();4!==b.V&&(b.V=1,nb(b),b.Ve())};this.Sg=function(){4!==b.V&&(b.V=2,nb(b))};this.Pg=function(){4!==b.V&&(1!==b.V&&(b.V=2),nb(b))};this.oc=function(){4!==b.V&&(b.V=b.Ge?8:0,nb(b))};this.pd=function(){b.d&&ob(b.d)}}r=mb.prototype;r.M=function(a,b,c){this.d=b;this.r=c;if(this.j)switch(this.r){case 1:this.j.l.ud.push(this);break;case 2:this.j.l.vd.push(this);break;case 3:this.j.l.Ua.push(this);break;case 4:this.j.l.Wa.push(this);break;case 5:this.j.l.Md.push(this);break;case 6:this.j.l.Ld.push(this);break;case 7:this.j.l.jb.push(this);break;case 8:this.j.l.kb.push(this);break;case 9:this.j.l.zd.push(this);break;case 10:this.j.l.Bd.push(this);break;case 11:this.j.l.yd.push(this);break;case 12:this.j.l.Ed.push(this);break;case 13:this.j.l.Cd.push(this);break;case 14:this.j.l.xd.push(this);break;case 15:this.j.l.Fd.push(this);break;case 16:this.j.l.Dd.push(this);break;case 17:this.j.l.Ad.push(this);break;case 18:this.j.lc=this}this.a.e=F(a);b=this.a.e.a;b.setAttribute("title",pb(this));c=document.createElement("canvas");c.setAttribute("id",a+"_canvas");c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("oncontextmenu","return false;");b.appendChild(c);this.a.wc.e=F(a+"_canvas");a=this.a.wc.e;K(a.h,0,0,1E3,1E3,!1,!1,!1,!1,-1,-1);a.o=L|O|Q|R;this.a.e.n(a);b.onmousedown=this.nc;b.onmouseup=this.Sg;b.onmouseover=this.Pg;b.onmouseout=this.oc;b.onfocus=this.pd;b.tabIndex=-1;this.J()};r.J=function(){this.K=this.a.e.a.clientWidth;this.$=this.a.e.a.clientHeight;this.a.e.ta(this.K,this.$);this.za()};function qb(a,b){!0===b&&4===a.V?(a.V=0,nb(a)):!1===b&&4!==a.V&&(a.V=4,nb(a))}function rb(a,b){a.kc!==b&&(a.kc=b,a.za(),a.a.e.a.setAttribute("title",pb(a)))}function sb(a,b){a.Ge!==b&&(a.Ge=b,!0===b&&0===a.V?(a.V=8,nb(a)):!1===b&&8===a.V&&(a.V=0,nb(a)))}r.za=function(){var a=this.$,b=this.K;0!==b&&0!==a&&(this.b.Xe=tb(this,this.Ne,this.Oe,b,a),this.b.gf=tb(this,this.Ne,this.Oe,b,a),this.b.nf=tb(this,this.Uf,this.Ag,b,a),this.b.bf=tb(this,this.Uf,this.xg,b,a),this.b.rf=tb(this,this.Ne,this.Oe,b,a),nb(this))};function tb(a,b,c,d,f){var e=a.a.wc.e.a.getContext("2d");e.fillStyle=S(b);e.fillStyle=S(b);e.fillRect(0,0,d,f);e.fillStyle=S(c);e.strokeStyle=S(c);c=Math.min(d,f);var g=(d-c)/2,h=(f-c)/2;switch(a.r){case 1:a.Y(c,g,h,e,-1);var k=Math.ceil(g+c/10+.5),g=Math.ceil(h+c/5+.5);b=Math.floor(c/10+.5);a=Math.floor(3*c/5+.5);e.fillRect(k,g,b,a);break;case 2:a.Y(c,g-c/10,h,e,-1);k=Math.ceil(g+8*c/10+.5);g=Math.ceil(h+c/5+.5);b=Math.floor(c/10+.5);a=Math.floor(3*c/5+.5);e.fillRect(k,g,b,a);break;case 3:a.Y(c,g-c/10,h,e,-1);break;case 4:a.Y(c,g-c/10,h,e,1);break;case 5:a.Y(c,g+c/10,h,e,1);k=Math.ceil(g+c/10+.5);g=Math.ceil(h+c/5+.5);b=Math.floor(c/10+.5);a=Math.floor(3*c/5+.5);e.fillRect(k,g,b,a);break;case 6:a.Y(c,g,h,e,1);k=Math.ceil(g+8*c/10+.5);g=Math.ceil(h+c/5+.5);b=Math.floor(c/10+.5);a=Math.floor(3*c/5+.5);e.fillRect(k,g,b,a);break;case 7:b=Math.ceil(g+.2*c+.5);a=Math.ceil(g+.35*c+.5);var k=Math.ceil(g+.57*c+.5),g=Math.ceil(g+.92*c+.5),m=Math.ceil(h+.2*c+.5),l=Math.ceil(h+.38*c+.5),n=Math.ceil(h+.52*c+.5),s=Math.ceil(h+.6*c+.5),p=Math.ceil(h+.68*c+.5);c=Math.ceil(h+.84*c+.5);e.beginPath();e.moveTo(b,m);e.lineTo(a,m);e.lineTo(a,n);e.lineTo(k,n);e.lineTo(k,l);e.lineTo(g,s);e.lineTo(k,c);e.lineTo(k,p);e.lineTo(b,p);e.closePath();e.fill();break;case 8:b=Math.ceil(g+.2*c+.5);a=Math.ceil(g+.35*c+.5);k=Math.ceil(g+.57*c+.5);g=Math.ceil(g+.92*c+.5);m=Math.ceil(h+.8*c+.5);l=Math.ceil(h+.62*c+.5);n=Math.ceil(h+.48*c+.5);s=Math.ceil(h+.4*c+.5);p=Math.ceil(h+(1-.68)*c+.5);c=Math.ceil(h+(1-.84)*c+.5);e.beginPath();e.moveTo(b,m);e.lineTo(a,m);e.lineTo(a,n);e.lineTo(k,n);e.lineTo(k,l);e.lineTo(g,s);e.lineTo(k,c);e.lineTo(k,p);e.lineTo(b,p);e.closePath();e.fill();break;case 9:k=Math.ceil(g+.5*c-c/10+.5);m=Math.ceil(h+.5*c-c/10+.5);b=Math.ceil(.25*c+.5);e.fillStyle=S(new x(255,255,255));e.strokeStyle=S(new x(0,0,0));e.beginPath();e.arc(k,m,b,0,2*Math.PI,!1);e.fill();e.stroke();e.fillStyle=S(new x(0,0,0));k=Math.ceil(g+.5*c+c/10+.5);m=Math.ceil(h+.5*c+c/10+.5);b=Math.ceil(.25*c+.5);e.beginPath();e.arc(k,m,b,0,2*Math.PI,!1);e.fill();break;case 10:a=e.createImageData(c,c);k=c/5|0;m=4*c/5|0;for(l=0;l<c;l++)for(n=0;n<c;n++)s=4*(l*c+n),l>=k&&l<=m&&n>=k&&n<=m?c-l>=n||l===k||l===m||n===k||n===m?(a.data[s+0]=0,a.data[s+1]=0,a.data[s+2]=0):(a.data[s+0]=255,a.data[s+1]=255,a.data[s+2]=255):(a.data[s+0]=b.t,a.data[s+1]=b.q,a.data[s+2]=b.p),a.data[s+3]=255;e.putImageData(a,g,h);break;case 11:k=Math.ceil(g+.75*c+.5);m=Math.ceil(h+.125*c+.5);b=Math.ceil(.25*c+.5);a=Math.ceil(.02*c+.5);e.fillRect(k,m,b,a);k=Math.ceil(g+.875*c+.5);m=Math.ceil(h+.5);b=Math.ceil(.02*c+.5);a=Math.ceil(.25*c+.5);e.fillRect(k,m,b,a);k=Math.ceil(g+.5);m=Math.ceil(h+.875*c+.5);b=Math.ceil(.25*c+.5);a=Math.ceil(.02*c+.5);e.fillRect(k,m,b,a);k=Math.ceil(g+.5*c-c/10+.5);m=Math.ceil(h+.5*c-c/10+.5);b=Math.ceil(.25*c+.5);e.fillStyle=S(new x(255,255,255));e.strokeStyle=S(new x(0,0,0));e.beginPath();e.arc(k,m,b,0,2*Math.PI,!1);e.fill();e.stroke();e.fillStyle=S(new x(0,0,0));k=Math.ceil(g+.5*c+c/10+.5);m=Math.ceil(h+.5*c+c/10+.5);b=Math.ceil(.25*c+.5);e.beginPath();e.arc(k,m,b,0,2*Math.PI,!1);e.fill();break;case 12:m=c/2;a=3*c/4;b=.1*c;l=Math.sqrt(m*m-(a-m)*(a-m))+m;n=-Math.sqrt(m*m-(a-m)*(a-m))+m;e.lineWidth=Math.ceil(.05*c+.5);e.beginPath();e.moveTo(g+c/2,h+2*b);e.lineTo(g+l-b,h+a+b);e.lineTo(g+n+b,h+a+b);e.closePath();e.stroke();break;case 13:m=c/2;b=.05*c;k=-c/2*Math.sqrt(2)/2+c/2;a=c/2*Math.sqrt(2)/2+c/2;l=Math.sqrt(m*m-(k-m)*(k-m))+m;n=-Math.sqrt(m*m-(k-m)*(k-m))+m;m=Math.floor(g+l-b);g=Math.ceil(g+n+b);k=Math.ceil(h+k+b);h=Math.floor(h+a-b);e.lineWidth=Math.ceil(.05*c+.5);e.beginPath();e.moveTo(m,k);e.lineTo(g,k);e.lineTo(g,h);e.lineTo(m,h);e.closePath();e.stroke();break;case 14:a=.05*c;m=c/2;b=4*a;e.lineWidth=Math.ceil(a+.5);e.beginPath();e.arc(g+c/2,h+c/2,m-b,0,2*Math.PI,!1);e.stroke();break;case 15:b=g+.25*c;a=g+.75*c;m=h+.25*c;l=h+.75*c;e.lineWidth=Math.ceil(.05*c+.5);e.beginPath();e.moveTo(b,m);e.lineTo(a,l);e.moveTo(a,m);e.lineTo(b,l);e.stroke();break;case 16:b="A";a=.8*c;k=g+(c-e.measureText(b).width)/2;e.font=a+"px Arial";e.fillText(b,k,h+c/2+a/3);break;case 17:b="1";a=.8*c;k=g+(c-e.measureText(b).width)/2;e.font=a+"px Helvetica, Arial, Verdana";e.fillText(b,k,h+c/2+a/3);break;case 18:16===a.kc?a.Y(c,g,h,e,1):(b=Math.floor(g+c/5+c/20+.5),a=Math.ceil(g+4*c/5-c/20+.5),g=Math.ceil(h+c/5+.5),h=Math.ceil(h+4*c/5+.5),k=Math.ceil(b+c/5),c=Math.floor(a-c/5),e.beginPath(),e.moveTo(b,g),e.lineTo(k,g),e.lineTo(k,h),e.lineTo(b,h),e.closePath(),e.fill(),e.beginPath(),e.moveTo(a,g),e.lineTo(c,g),e.lineTo(c,h),e.lineTo(a,h),e.closePath(),e.fill())}return e.getImageData(0,0,d,f)}r.Y=function(a,b,c,d,f){var e=Math.ceil(b+a/5+.5);b=Math.ceil(b+4*a/5+.5);var g=Math.ceil(c+a/5+.5),h=Math.ceil(c+a/2+.5);a=Math.ceil(c+4*a/5+.5);0>f?(d.beginPath(),d.moveTo(e,h),d.lineTo(b,g),d.lineTo(b,a)):(d.beginPath(),d.moveTo(e,g),d.lineTo(b,h),d.lineTo(e,a));d.closePath();d.fill()};function nb(a){var b=a.a.wc.e.a.getContext("2d"),c=null;switch(a.V){case 2:c=a.b.gf;break;case 1:c=a.b.Xe;break;case 4:c=a.b.bf;break;case 8:c=a.b.rf;break;default:case 0:c=a.b.nf}b.putImageData(c,0,0)}r.Ve=function(){if(this.d)switch(this.r){case 1:var a=this.d;z(a,a.fa);break;case 2:ja(this.d,5);break;case 3:ja(this.d,1);break;case 4:ma(this.d,1);break;case 5:ma(this.d,5);break;case 6:for(a=this.d;la(a););z(a,a.i);break;case 7:na(this.d);break;case 8:ka(this.d);break;case 9:C(this.d.k,0);break;case 10:C(this.d.k,1);break;case 11:C(this.d.k,2);break;case 12:C(this.d.k,3);break;case 13:C(this.d.k,4);break;case 14:C(this.d.k,5);break;case 15:C(this.d.k,6);break;case 16:C(this.d.k,7);break;case 17:C(this.d.k,8);break;case 18:16===this.kc?ub(this.d):vb(this.d)}};function pb(a){switch(a.r){case 1:return"Back to the start";case 2:return"Back 5 moves";case 3:return"Back";case 4:return"Forward";case 5:return"Forward 5 moves";case 6:return"Go to the end";case 7:return"Next variant";case 8:return"Previous variant";case 9:return"Moves (F1)";case 10:return"Count Scores (F2)";case 11:return"Editor (F3)";case 12:return"Triangles (F4)";case 13:return"Squares (F5)";case 14:return"Circles (F6)";case 15:return"X marks (F7)";case 16:return"Text labels (F8)";case 17:return"Numeric labels (F9)";case 18:return 16===a.kc?"Autoplay start":"Autoplay stop"}};function wb(a){this.j=a;this.d=null;this.a={e:null,Kc:{e:null}};var b=this;this.$f=function(){b.d.ke(b.a.Kc.e.a.value)}}wb.prototype.M=function(a,b){this.d=b;this.a.e=F(a);var c=this.a.e.a,d=a+"_TextArea",f=document.createElement("textarea");f.setAttribute("id",d);f.setAttribute("style","position:absolute;padding:0;margin:0;resize:none;outline: none;-moz-appearance: none;");c.appendChild(f);f.onchange=this.$f;f.onblur=this.$f;c=this.a.e;this.a.Kc.e=F(d);d=this.a.Kc.e;K(d.h,0,0,2,2,!0,!0,!0,!0,-1,-1);d.o=L|O|Q|R;c.n(d);this.j&&this.j.Ce.push(this);this.J()};wb.prototype.Lc=function(a){this.a.Kc.e.a.value=a};wb.prototype.J=function(){this.a.e.ta(this.a.e.a.clientWidth,this.a.e.a.clientHeight)};function xb(a){this.j=a;this.Sf=J;this.d=null;this.a={e:null,Bc:null,Fc:null,Image:null};this.ed=this.dd="";this.Ie=0;this.Fe=!1}xb.prototype.M=function(a,b,c){this.Sf=c;this.d=b;this.a.e=F(a);b=this.a.e.a;b.style.backgroundColor=S(new x(217,217,217,255));this.a.Bc=document.createElement("div");this.a.Fc=document.createElement("div");this.a.Image=document.createElement("canvas");var d=this.a.Image,f=this.a.Bc,e=this.a.Fc;b.appendChild(d);b.appendChild(f);b.appendChild(e);f.style.paddingLeft="25px";e.style.paddingLeft="25px";f.style.fontSize="14pt";e.style.paddingLeft="10pt";d.setAttribute("id",a+"_Image");d.setAttribute("style","position:absolute;padding:0;margin:0;");d.setAttribute("oncontextmenu","return false;");d.style.left="0px";d.style.top="0px";d.style.width="25px";d.style.height="25px";d.width=25;d.height=25;a=d.getContext("2d");a.clearRect(0,0,25,25);b=Math.ceil(13);d=Math.ceil(13);f=Math.ceil(6.75);H===c?(a.fillStyle=S(new x(255,255,255)),a.strokeStyle=S(new x(0,0,0))):G===c&&(a.fillStyle=S(new x(0,0,0)),a.strokeStyle=S(new x(0,0,0)));a.beginPath();a.arc(b,d,f,0,2*Math.PI,!1);a.fill();a.stroke();this.j&&(G===c?this.j.Ra=this:H===c&&(this.j.Sa=this));yb(this)};xb.prototype.J=function(){yb(this);var a=this.ug,b=this.a.e.a.clientWidth-25,c=0,c=b<a?0:(b-a)/2;this.a.Image.style.left=c+"px";c+=25;this.a.Bc.style.paddingLeft=c+"px";this.a.Fc.style.paddingLeft=c+"px"};xb.prototype.Xb=function(a){this.Fe=!1;this.Ie=a;yb(this)};xb.prototype.Yb=function(a){this.Fe=!0;this.Ie=a;yb(this)};function yb(a){var b=a.a.Fc,c=(""===a.dd?G===a.Sf?"Black ":"White ":a.dd)+(""===a.ed?"":"["+a.ed+"]"),d=(!0===a.Fe?"Scores ":"Captured ")+a.Ie;a.a.Bc.innerText=c;b.innerText=d;b=document.createElement("canvas").getContext("2d");b.font="14pt Times New Roman";a.ug=b.measureText(c).width};function zb(){this.Aa=this.Ea=this.Fa=this.Ca=0;this.Pc=this.Rc=this.Sc=this.Qc=!1;this.Mb=this.gb=-1}function K(a,b,c,d,f,e,g,h,k,m,l){a.Ca=b;a.Fa=c;a.Ea=d;a.Aa=f;a.Qc=e;a.Sc=g;a.Rc=h;a.Pc=k;a.gb=m;a.Mb=l}var O=1,L=2,R=4,Q=8;function Ab(){this.h=new zb;this.o=O|L;this.a=this.Dc=this.lf=null;this.Ta=new zb;this.Z=[];this.Fb=0}Ab.prototype.Xa=function(a){this.Fb=a};Ab.prototype.n=function(a){a.Dc=this;this.Z[this.Z.length]=a};Ab.prototype.ta=function(a,b){if(null==this.Dc)this.Ta.Ca=0,this.Ta.Fa=0,this.Ta.Ea=a,this.Ta.Aa=b,null!==this.a&&Bb(this,a,b);else{var c=0,d=0,f=0,e=0,c=this.o&5,d=this.o&10;O==c?(c=this.h.Qc?this.h.Ca:this.h.Ca*a/1E3,f=-1!=this.h.gb?c+this.h.gb:this.h.Rc?a-this.h.Ea:this.h.Ea*a/1E3):R==c?(f=this.h.Rc?a-this.h.Ea:this.h.Ea*a/1E3,c=-1!=this.h.gb?f-this.h.gb:this.h.Qc?this.h.Ca:this.h.Ca*a/1E3):(O|R)==c?(c=this.h.Qc?this.h.Ca:this.h.Ca*a/1E3,f=this.h.Rc?a-this.h.Ea:this.h.Ea*a/1E3):(c=this.h.Ca,f=this.h.Ea);L==d?(d=this.h.Sc?this.h.Fa:this.h.Fa*b/1E3,e=-1!=this.h.Mb?d+this.h.Mb:this.h.Pc?b-this.h.Aa:this.h.Aa*b/1E3):Q==d?(e=this.h.Pc?b-this.h.Aa:this.h.Aa*b/1E3,d=-1!=this.h.Mb?e-this.h.Mb:this.h.Sc?this.h.Fa:this.h.Fa*b/1E3):(L|Q)==d?(d=this.h.Sc?this.h.Fa:this.h.Fa*b/1E3,e=this.h.Pc?b-this.h.Aa:this.h.Aa*b/1E3):(d=this.h.Fa,e=this.h.Aa);f<c&&(f=c);e<d&&(e=d);-2===this.h.gb?f=c+(e-d)*g_dKoef_Board_W_to_H:-3===this.h.gb&&(c=(e-d)*g_dKoef_Board_W_to_H);this.Ta.Ca=c;this.Ta.Fa=d;this.Ta.Ea=f;this.Ta.Aa=e;this.a.style.left=parseInt(c+.5)+"px";this.a.style.top=parseInt(d+.5)+"px";this.a.style.width=parseInt(f-c+.5)+"px";this.a.style.height=parseInt(e-d+.5)+"px";this.a.width=parseInt(f-c+.5);this.a.height=parseInt(e-d+.5);Bb(this,f-c,e-d)}};function Bb(a,b,c){var d=a.Z.length;if(1===a.Fb&&2===d){var f=a.Z[0],e=a.Z[1],g=b-400>=c?b-c:400;K(f.h,0,0,g,1E3,!1,!1,!0,!1,-1,-1);f.o=O|Q|L;K(e.h,b-g,0,1E3,1E3,!0,!1,!1,!1,-1,-1);e.o=R|Q|L}else 2===a.Fb&&1===d&&(f=a.Z[0],e=Math.min(b,c),K(f.h,(b-e)/2,(c-e)/2,1E3,1E3,!0,!0,!0,!1,e,e),f.o=O|Q|L);for(f=0;f<d;f++)a.Z[f].ta(b,c)}function F(a){var b=new Ab;b.lf=a;b.a=document.getElementById(a);return b}function Cb(){this.a=this.Dc=null;this.u=0;this.Z=[]}Cb.prototype.S=function(a){this.u=a};Cb.prototype.n=function(a){a.Dc=this;this.Z[this.Z.length]=a};Cb.prototype.ta=function(a,b){var c=b-this.u,d=a;d!==c&&(c=d=Math.min(d,c));var f=(b-this.u-c)/2;this.a.style.left=parseInt((a-d)/2+.5)+"px";this.a.style.top=parseInt(f+.5)+"px";this.a.style.width=parseInt(d+.5)+"px";this.a.style.height=parseInt(c+this.u+.5)+"px";this.a.width=parseInt(d+.5);this.a.height=parseInt(c+this.u+.5);for(var f=this.Z.length,e=0;e<f;e++)this.Z[e].ta(d,c+this.u)};function Db(a){if(this.d=a)a.j=this;this.qa=null;this.U=[];this.l={ud:[],vd:[],Ua:[],Wa:[],Md:[],Ld:[],jb:[],kb:[],zd:[],Bd:[],yd:[],Ed:[],Cd:[],xd:[],Fd:[],Dd:[],Ad:[]};this.Sa=this.Ra=this.mc=this.lc=this.Qe=this.$c=this.W=null;this.Ce=[];this.Qf=40;setTimeout(function(){b.Zf()},this.Qf);var b=this;this.Zf=function(){this.$c&&Eb(this.$c)&&Fb(this.$c);setTimeout(function(){b.Zf()},b.Qf)}}r=Db.prototype;r.Kd=function(a){var b=new aa(this);b.M(a,this.d);wa(b);this.U.push(b);this.J()};r.Jd=function(a){var b=this.d,c=F(a);this.H(c.a,a+"div");var d=a+"div",f=new Cb;f.lf=d;f.a=document.getElementById(d);f.S(25);var e=f.a;c.n(f);d=a+"_Board";a+="_Toolbar";this.H(e,d);this.H(e,a);e=F(d);K(e.h,0,0,1E3,25,!1,!1,!1,!0,-1,-1);e.o=L|O|R;f.n(e);e=new aa(this);e.M(d,b);wa(e);d=F(a);K(d.h,0,0,1E3,0,!1,!1,!1,!0,-1,25);d.o=O|Q|R;f.n(d);f=new Gb(this);f.M(a,b,{Z:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17]});this.qa=c;this.U.push(e);this.U.push(f);this.J()};r.Id=function(a){var b=this.d,c=F(a),d=a+"GoBoard";this.H(c.a,d);d=F(d);K(d.h,0,0,1,1,!1,!1,!0,!0,-1,-1);d.o=L|O|R|Q;c.n(d);d.Xa(1);var f=a+"_Board",e=a+"_Panel";this.H(d.a,f);this.H(d.a,e);var g=F(f);a=F(e);d.n(g);d.n(a);this.H(g.a,f+"_Centred");d=F(f);g.Xa(2);g.n(d);d=new aa(this);d.M(f,b);wa(d);f=e+"_CaT";g=e+"_Navigator";this.H(a.a,f);this.H(a.a,g);e=F(f);K(e.h,0,0,1E3,500,!1,!1,!1,!1,-1,-1);e.o=L|O|R|Q;a.n(e);var h=F(g);K(h.h,0,500,1E3,1E3,!1,!1,!1,!1,-1,-1);h.o=L|O|R|Q;a.n(h);a=new Hb(this);a.M(g,b);var k=f+"_Info",m=f+"_Comments",h=f+"_Toolbar",l=f+"_ToolbarAutoPlay",n=f+"_ToolbarTimeLine";this.H(e.a,k);this.H(e.a,m);this.H(e.a,h);var s=this.H(e.a,l);this.H(e.a,n);f=l+"_Slider";g=l+"_Button";this.H(s,g);this.H(s,f);s=F(k);K(s.h,0,0,1E3,0,!1,!1,!1,!1,-1,40);s.o=L|O|R;e.n(s);var p=k+"_White",k=k+"_Black";this.H(s.a,p);this.H(s.a,k);var u=F(p);K(u.h,0,0,500,1E3,!1,!1,!1,!1,-1,-1);u.o=L|O|R|Q;s.n(u);u=F(k);K(u.h,500,0,1E3,1E3,!1,!1,!1,!1,-1,-1);u.o=L|O|R|Q;s.n(u);s=new xb(this);s.M(p,b,H);p=new xb(this);p.M(k,b,G);k=F(m);K(k.h,0,40,1E3,75,!1,!0,!1,!0,-1,25);k.o=L|O|R|Q;e.n(k);k=F(h);K(k.h,0,0,1E3,50,!1,!1,!1,!0,-1,25);k.o=O|R|Q;e.n(k);k=F(l);K(k.h,0,0,1E3,25,!1,!1,!1,!0,-1,25);k.o=O|R|Q;e.n(k);l=F(g);K(l.h,0,0,1E3,1E3,!1,!1,!1,!1,25,-1);l.o=O|L|Q;k.n(l);l=F(f);K(l.h,25,0,1E3,1E3,!0,!1,!1,!1,-1,25);l.o=L|R|Q;k.n(l);k=F(n);K(k.h,0,0,1E3,0,!1,!1,!1,!0,-1,25);k.o=O|R|Q;e.n(k);e=new wb(this);e.M(m,b);m=new Gb(this);m.M(h,b,{Z:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17]});h=new Ib(this);h.M(n,b,Jb,0);n=new mb(this);n.M(g,b,18);g=new Ib(this);g.M(f,b,Kb,0);this.U.push(d);this.U.push(a);this.U.push(e);this.U.push(m);this.U.push(h);this.U.push(n);this.U.push(g);this.U.push(p);this.U.push(s);this.qa=c;this.J();b.B&&b.B.Va();b.j&&(b.lb(),c=b.j,c.mc&&(c=c.mc,!0!==c.bc&&Lb(c,b.dc,!0)))};r.J=function(){this.qa&&this.qa.ta(this.qa.a.clientWidth,this.qa.a.clientHeight);for(var a=0,b=this.U.length;a<b;a++)this.U[a].J()};r.H=function(a,b){var c=document.createElement("div");c.setAttribute("id",b);c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("oncontextmenu","return false;");a.appendChild(c);return c};r.qf=function(a){this.W=a};r.of=function(){this.lc&&rb(this.lc,0)};r.ie=function(){this.lc&&rb(this.lc,16)};r.pe=function(a){if(this.Ra){var b=this.Ra;b.dd=a;yb(b)}};r.qe=function(a){if(this.Ra){var b=this.Ra;b.ed=a;yb(b)}};r.re=function(a){if(this.Sa){var b=this.Sa;b.dd=a;yb(b)}};r.se=function(a){if(this.Sa){var b=this.Sa;b.ed=a;yb(b)}};r.Xb=function(a,b){this.Ra&&this.Ra.Xb(a);this.Sa&&this.Sa.Xb(b)};r.Yb=function(a,b){this.Ra&&this.Ra.Yb(a);this.Sa&&this.Sa.Yb(b)};r.lb=function(a){for(var b=0,c=this.l.ud.length;b<c;b++)qb(this.l.ud[b],a.Ua);b=0;for(c=this.l.vd.length;b<c;b++)qb(this.l.vd[b],a.Ua);b=0;for(c=this.l.Ua.length;b<c;b++)qb(this.l.Ua[b],a.Ua);b=0;for(c=this.l.Wa.length;b<c;b++)qb(this.l.Wa[b],a.Wa);b=0;for(c=this.l.Md.length;b<c;b++)qb(this.l.Md[b],a.Wa);b=0;for(c=this.l.Ld.length;b<c;b++)qb(this.l.Ld[b],a.Wa);b=0;for(c=this.l.jb.length;b<c;b++)qb(this.l.jb[b],a.jb);b=0;for(c=this.l.kb.length;b<c;b++)qb(this.l.kb[b],a.kb);b=0;for(c=this.l.zd.length;b<c;b++)sb(this.l.zd[b],0===a.Ba);b=0;for(c=this.l.Bd.length;b<c;b++)sb(this.l.Bd[b],1===a.Ba);b=0;for(c=this.l.yd.length;b<c;b++)sb(this.l.yd[b],2===a.Ba);b=0;for(c=this.l.Ed.length;b<c;b++)sb(this.l.Ed[b],3===a.Ba);b=0;for(c=this.l.Cd.length;b<c;b++)sb(this.l.Cd[b],4===a.Ba);b=0;for(c=this.l.xd.length;b<c;b++)sb(this.l.xd[b],5===a.Ba);b=0;for(c=this.l.Fd.length;b<c;b++)sb(this.l.Fd[b],6===a.Ba);b=0;for(c=this.l.Dd.length;b<c;b++)sb(this.l.Dd[b],7===a.Ba);b=0;for(c=this.l.Ad.length;b<c;b++)sb(this.l.Ad[b],8===a.Ba);this.Qe&&(b=this.Qe,!0!==b.bc&&Lb(b,a.yf,!0))};r.Lc=function(a){for(var b=0,c=this.Ce.length;b<c;b++)this.Ce[b].Lc(a)};var Mb=0,Nb=1,Xa=2,y=new function(){this.Ye=this.g=this.f=0;this.Fb=Nb;this.ea=this.na=this.sc=!1;this.oa=null;this.Ub=-1;this.kf=this.jf=this.Ob=0;this.ae=this.yc=!1},ha=new function(){this.ea=this.na=this.sc=!1;this.oa=null;this.zc=this.eg=0};function ga(a){ha.sc=a.altKey;ha.na=void 0!==a.metaKey?a.ctrlKey||a.metaKey:a.ctrlKey;ha.ea=a.shiftKey;ha.oa=a.srcElement?a.srcElement:a.target;ha.eg=a.charCode;ha.zc=a.keyCode;ha.$g=a.which}function ba(a){if(!a.yc||a.ae){if(a.pageX||a.pageY)y.f=a.pageX,y.g=a.pageY;else if(a.clientX||a.clientY)y.f=a.clientX,y.g=a.clientY;y.sc=a.altKey;y.ea=a.shiftKey;y.na=a.ctrlKey||a.metaKey;y.Fb=Nb;y.yc||(y.oa=a.srcElement?a.srcElement:a.target);if(3<Math.abs(y.f-y.jf)||3<Math.abs(y.g-y.kf))y.Ub=-1,y.Ob=0}}function fa(a){if(a.pageX||a.pageY)y.f=a.pageX,y.g=a.pageY;else if(a.clientX||a.clientY)y.f=a.clientX,y.g=a.clientY;y.jf=y.f;y.kf=y.g;y.sc=a.altKey;y.ea=a.shiftKey;y.na=a.ctrlKey||a.metaKey;y.Fb=Mb;y.Ye=a.button;y.oa=a.srcElement?a.srcElement:a.target;a=(new Date).getTime();0==y.Ob?(y.Ob=1,y.Ub=a):500>a-y.Ub?(y.Ub=a,y.Ob++):(y.Ob=1,y.Ub=a);window.Kf=!1}window.onmousemove=function(a){y.yc&&void 0!=y.oa&&null!=y.oa&&void 0!=y.oa.onmousemove&&null!=y.oa.onmousemove&&(y.ae=!0,y.oa.onmousemove(a),y.ae=!1)};window.onmouseup=function(a){if(!1===window.Kf&&(window.Kf=!0,y.yc&&void 0!=y.oa.onmouseup&&null!=y.oa.onmouseup))y.oa.onmouseup(a,!0)};function Ob(){this.kb=this.jb=this.Wa=this.Ua=!0;this.yf=this.Ba=0};var ya=-1,Va=0,Ua=1,Ta=2,Qa=3,Wa=4,Ra=5,Sa=6;function I(a,b,c,d){this.Vf={f:void 0===a?0:a,g:void 0==b?0:b};this.r=void 0===c?Va:c;this.fd=void 0===d?"":d}I.prototype.Qb=function(){return this.Vf.f};I.prototype.Rb=function(){return this.Vf.g};I.prototype.Xa=function(a){this.r=a};function Hb(a){this.j=a;this.d=null;this.s=new Pb;this.Uc=this.Tc=!0;this.a={e:null,D:{e:null},Selection:{e:null},hb:{e:null},w:{e:null},ne:{e:null},ge:{e:null},hg:{e:null},R:null,T:null,ib:null,mb:null,Hc:0,Gc:0};this.ab=new x(231,188,95,255);this.Pe=new x(0,0,0,255);this.ra=null;this.b={A:0,u:0,D:null,Bb:null,Gb:null,tc:null,Nc:null,Vd:null,ff:null,Pd:null,ef:null,Td:null,te:null,If:null,xe:null,Zd:null,Wd:null,Xd:null,Yd:null,$d:null,Qd:null,Rd:null,Sd:null,Ud:null,ze:null,ue:null,ve:null,we:null,ye:null,Bf:null,Ef:null,Cf:null,Ff:null,Df:null,Gf:null,Na:null,hb:null,da:null,Ya:0};this.v={f:0,g:0};this.Ib=!1;this.tg=!0;this.sa={A:0,u:0,f:0,g:0};var b=this;this.We=function(){return setTimeout(function(){b.Ue()},20)};this.nc=function(a){b.Ib||(b.d&&ob(b.d),fa(a),a=b.pc(y.f,y.g),a=b.s.I(a.f,a.g),a.Sb()&&b.d&&z(b.d,a))};this.qd=function(a){b.Ib||(ba(a),a=b.pc(y.f,y.g),b.fb(a.f,a.g))};this.oc=function(){b.Ib||b.fb(-1,-1)};this.Tg=function(a){if(b.Ib)return!1;var d=0,d=void 0!=a.wheelDelta?0<a.wheelDelta?-45:45:0<a.detail?45:-45;a.preventDefault&&a.preventDefault();var f=20+24*(b.s.s.length+1)-b.a.D.e.a.height;b.v.g-=d;b.v.g=Math.min(0,Math.max(b.v.g,-f));Qb(b);b.qd(a);Rb(b);return!1};this.pd=function(){b.d&&ob(b.d)};this.Qg=function(){b.a.R.style.opacity=.7;b.a.ib.style.opacity=.3;b.a.ib.style.display="block"};this.Ng=function(){b.a.R.style.opacity=.5;b.a.ib.style.opacity=0;b.a.ib.style.display="none"};this.Rg=function(){b.a.T.style.opacity=.7;b.a.mb.style.opacity=.3;b.a.mb.style.display="block"};this.Og=function(){b.a.T.style.opacity=.5;b.a.mb.style.opacity=0;b.a.mb.style.display="none"};this.Yf=function(){b.Ib=!0};this.Xf=function(){b.Ib=!1};this.Gg=function(a){var d=b.b.A;b.v.f=-((a-2)/(d-4-b.a.Hc)*(20+24*(Sb(b.s)+1)-d));Qb(b)};this.Ig=function(a,d){var f=b.b.u;b.v.g=-((d-2)/(f-4-b.a.Gc)*(20+24*(b.s.s.length+1)-f));Qb(b)}}r=Hb.prototype;r.M=function(a,b){this.j&&(this.j.$c=this);this.d=b;this.d.B=this;this.s.d=b;this.a.e=F(a);var c=this.a.e.a,d=this.a.e,f=a+"_Board",e=a+"_Selection",g=a+"_Current",h=a+"_Lines",k=a+"_Shadows",m=a+"_Nodes",l=a+"_Events";this.ia(c,f);this.ia(c,e);this.ia(c,g);this.ia(c,h);this.ia(c,k);this.ia(c,m);var n=this.la(c,l);this.a.ib=this.la(c,a+"HorScroll_BG");this.a.R=this.la(c,a+"HorScroll");this.a.mb=this.la(c,a+"VerScroll_BG");this.a.T=this.la(c,a+"VerScroll");this.a.ib.style.background="rgb(0,0,0)";this.a.ib.style.display="none";this.a.mb.style.background="rgb(0,0,0)";this.a.mb.style.display="none";this.a.R.onmouseover=this.Qg;this.a.R.onmouseout=this.Ng;this.a.T.onmouseover=this.Rg;this.a.T.onmouseout=this.Og;c=F(a+"HorScroll_BG");K(c.h,2,0,2,4,!0,!1,!0,!0,-1,8);c.o=O|Q|R;d.n(c);c=F(a+"VerScroll_BG");K(c.h,0,2,4,2,!1,!0,!0,!0,8,-1);c.o=L|Q|R;d.n(c);this.X(this.a.D,d,f);this.X(this.a.Selection,d,e);this.X(this.a.hb,d,g);this.X(this.a.w,d,h);this.X(this.a.ne,d,k);this.X(this.a.ge,d,m);this.X(this.a.hg,d,l);n.onmousedown=this.nc;n.onmousemove=this.qd;n.onmouseout=this.oc;n.onmousewheel=this.Tg;n.onfocus=this.pd;n.tabIndex=-1;n.style.sg=!0;n.style.outline=0;d=this.a.ge.e.a.getContext("2d");this.b.Bb=d.createImageData(20,20);this.b.Gb=d.createImageData(20,20);this.b.tc=d.createImageData(20,20);this.b.Nc=d.createImageData(20,20);d=this.b.Bb.data;f=this.b.Gb.data;e=this.b.tc.data;g=this.b.Nc.data;h=Math.sqrt(3);for(k=0;20>k;k++)for(m=0;20>m;m++){var c=k-9.5,s=m-9.5,p=9.3-Math.sqrt(c*c+s*s),l=4*(20*k+20-m-1);if(0<=p){var u=9.3*9.3-c*c-s*s,u=0<u?Math.sqrt(u)*h:0,v=c,E=s,n=Math.sqrt(6*(v*v+E*E+u*u)),n=(2*u-v+E)/n,u=0;.9<n&&(u=10*(n-.9));v=255;.8>=p&&(p=(.8-p)/.8,v=.7,3.1>c-s&&(v=1),v=parseInt(255*(1-p*v)));c=parseInt(10+10*n+140*u);d[l+0]=c;d[l+1]=c;d[l+2]=c;d[l+3]=v;e[l+0]=c;e[l+1]=c;e[l+2]=c;e[l+3]=parseInt(.5*v);c=parseInt(200+10*n+45*u);f[l+0]=c;f[l+1]=c;f[l+2]=c;f[l+3]=v;g[l+0]=c;g[l+1]=c;g[l+2]=c;g[l+3]=parseInt(.7*v)}else d[l+0]=0,d[l+1]=0,d[l+2]=0,d[l+3]=0,g[l+0]=0,g[l+1]=0,g[l+2]=0,g[l+3]=0}this.od();d=this.a.Selection.e.a.getContext("2d");this.b.Na=d.createImageData(24,24);this.b.hb=d.createImageData(24,24);f=this.b.Na.data;e=this.b.hb.data;for(g=0;24>g;g++)for(h=0;24>h;h++)k=4*(h+24*g),f[k+3]=255,e[k+3]=255,0===h&&23===g||23===h&&0===g?(f[k+0]=135,f[k+1]=125,f[k+2]=135,e[k+0]=216):23===h||23===g?(f[k+0]=89,f[k+1]=89,f[k+2]=89,e[k+0]=178):(0===g||0===h?(f[k+0]=182,f[k+1]=182,f[k+2]=182):(f[k+0]=128,f[k+1]=128,f[k+2]=128),e[k+0]=255),e[k+1]=0,e[k+2]=0;d.putImageData(this.b.Na,0,0);d.putImageData(this.b.hb,0,30);this.Te()};r.J=function(a){var b=this.a.e.a.clientWidth,c=this.a.e.a.clientHeight;this.a.e.ta(b,c);this.za(b,c,a)};function ia(a){if(!(0>=a.b.A||0>=a.b.u)){var b=a.b.A,c=a.b.u,d=20+24*(Sb(a.s)+1),f=20+24*(a.s.s.length+1);d>b?(a.a.Hc=Math.max(50,b*b/d),a.a.R.style.width=Math.max(50,b*b/d)+"px",a.a.R.style.display="block",a.a.R.style.position="absolute",a.a.R.style.top=c-12+"px",a.a.R.style.height="8px",a.a.R.style.background="rgb(0,0,0)",a.a.R.style.opacity=.5,Tb(a.a.R,2,b-a.a.Hc-2,c-12,c-12),a.a.R.ld=a.Gg,a.a.R.nd=a.Yf,a.a.R.md=a.Xf):a.a.R.style.display="none";f>c?(a.a.Gc=Math.max(50,c*c/f),a.a.T.style.height=Math.max(50,c*c/f)+"px",a.a.T.style.display="block",a.a.T.style.position="absolute",a.a.T.style.left=b-12+"px",a.a.T.style.width="8px",a.a.T.style.background="rgb(0,0,0)",a.a.T.style.opacity=.5,Tb(a.a.T,b-12,b-12,2,c-a.a.Gc-2),a.a.T.ld=a.Ig,a.a.T.nd=a.Yf,a.a.T.md=a.Xf):a.a.T.style.display="none";a.sa.u=-1;a.sa.A=-1;Qb(a);Rb(a)}}r.Va=function(){this.s.Va();this.sa.u=-1;this.sa.A=-1};function Ub(a,b){a.Tc=!0;var c=a.b.A,d=a.b.u;if(!(0>=c||0>=d)){var f=a.d.i.ka,e=f.f,f=f.g,g=10+a.v.f+24*e,h=10+a.v.g+24*f;if(0!=b&&!0===a.tg&&(10>=g||g>=c-10||10>=h||h>=d-10)){var k=20+24*(a.s.s.length+1)-d,m=20+24*(Sb(a.s)+1)-c;10>=g?a.v.f=24*-e:g>=c-10&&(a.v.f=c-24-10-10-24*e);10>=h?a.v.g=24*-f:h>=d-10&&(a.v.g=d-24-10-10-24*f);a.v.f=Math.min(0,Math.max(a.v.f,-m));a.v.g=Math.min(0,Math.max(a.v.g,-k));Rb(a);Qb(a)}}}function Fb(a){if(a.Tc&&a.d){var b=a.b.A,c=a.b.u;if(!(0>=b||0>=c)){var d=a.d.i.ka,f=10+a.v.f+24*d.f,d=10+a.v.g+24*d.g,e=a.a.hb.e.a.getContext("2d");e.clearRect(0,0,b,c);-24<=f&&f<=b+24&&-24<=d&&d<=c+24&&e.putImageData(a.b.hb,f,d);a.Tc=!1}}if(a.Uc&&(b=a.b.A,c=a.b.u,0!==b&&0!==c)){if(!(a.sa.A===b&&a.sa.u===c&&1>Math.abs(a.v.f-a.sa.f)&&1>Math.abs(a.v.g-a.sa.g))){a.sa.A=b;a.sa.u=c;a.sa.f=a.v.f;a.sa.g=a.v.g;var f=a.a.w.e.a.getContext("2d"),d=a.a.ne.e.a.getContext("2d"),e=a.a.ge.e.a.getContext("2d"),g=a.a.Selection.e.a.getContext("2d");e.clearRect(0,0,b,c);d.clearRect(0,0,b,c);f.clearRect(0,0,b,c);g.clearRect(0,0,b,c);for(var g=10+a.v.f,h=10+a.v.g,k=a.s.s.length,m=0;m<=k-1;m++){var l=h+24*m;if(-24<=l&&l<=c+24)for(var n=a.s.s[m].length-1,s=0;s<=n;s++){var p=g+24*s;if(-24<=p&&p<=b+24){var u=a.s.I(s,m);if(!1===u.Sb()){var v=u.Db();switch(u.r){case Vb:v.Za?f.putImageData(a.b.te,p,l):f.putImageData(a.b.ze,p,l);break;case Wb:v.Za?1===v.uf?f.putImageData(a.b.ue,p,l):f.putImageData(a.b.ve,p,l):f.putImageData(a.b.we,p,l);break;case Xb:v.Za?f.putImageData(a.b.xe,p,l):f.putImageData(a.b.ye,p,l)}}else{var v=u.Db(),E=u.Ka.r,N=""+u.ka.he,w=e.measureText(N).width,M=u.bb;G===E?(v&&d.putImageData(a.b.da,p+2+a.b.Ya,l+2+a.b.Ya),e.putImageData(v?a.b.Bb:a.b.tc,p+2,l+2),""===M?(e.font="bold 10px sans-serif",e.fillStyle=v?"#CCC":"rgb(192, 192, 192)",e.fillText(N,p+12-w/2,l+12+3)):e.putImageData(v?a.b.Cf:a.b.Df,p+2,l+2)):H===E?(v&&d.putImageData(a.b.da,p+2+a.b.Ya,l+2+a.b.Ya),e.putImageData(v?a.b.Gb:a.b.Nc,p+2,l+2),""===M?(e.font="bold 10px sans-serif",e.fillStyle=v?"#000":"rgb(56, 56, 56)",e.fillText(N,p+12-w/2,l+12+3)):e.putImageData(v?a.b.Ff:a.b.Gf,p+2,l+2)):e.putImageData(v?a.b.Bf:a.b.Ef,p+2,l+2);N=A(u);u=u.Q;0===s?0!==N&&(1===N?v?f.putImageData(a.b.Vd,p,l):f.putImageData(a.b.Zd,p,l):v?0==u?f.putImageData(a.b.Wd,p,l):f.putImageData(a.b.Xd,p,l):f.putImageData(a.b.Yd,p,l)):0===N?v?f.putImageData(a.b.Td,p,l):f.putImageData(a.b.Ud,p,l):1===N?v?f.putImageData(a.b.Pd,p,l):f.putImageData(a.b.$d,p,l):v?0===u?f.putImageData(a.b.Qd,p,l):f.putImageData(a.b.Rd,p,l):f.putImageData(a.b.Sd,p,l);G!==E&&H!==E||f.clearRect(p+3,l+3,18,18)}}}}}a.Uc=!1}}function Eb(a){return a.Tc||a.Uc?!0:!1}r.ia=function(a,b){var c=document.createElement("canvas");c.setAttribute("id",b);c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("oncontextmenu","return false;");a.appendChild(c);return c};r.la=function(a,b){var c=document.createElement("div");c.setAttribute("id",b);c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("oncontextmenu","return false;");a.appendChild(c);return c};r.X=function(a,b,c){a.e=F(c);a=a.e;K(a.h,0,0,1E3,1E3,!1,!1,!1,!1,-1,-1);a.o=L|O|Q|R;b.n(a)};r.za=function(a,b){var c=this.a.D.e.a.getContext("2d");a!==this.b.A||b!==this.b.u||null===this.b.D||null!==this.ra?(this.b.A=a,this.b.u=b,c.fillStyle=S(this.ab),c.fillRect(0,0,a,b),null!==this.ra&&clearTimeout(this.ra),this.ra=this.We()):c.putImageData(this.b.D,0,0);ia(this)};r.Ue=function(){this.ra=null;var a=this.b.A,b=this.b.u,c=this.a.D.e.a.getContext("2d");if(0!==a&&0!==b){for(var d=c.createImageData(a,b),f=this.ab.t,e=this.ab.q,g=this.ab.p,h=Array(a),k=0;k<a;k++)h[k]=(Math.tan(300*k/a)+1)/2+(Math.tan(100*k/a)+1)/10;for(var m=Array(b),l=0;l<b;l++)m[l]=.02*Math.tan(l/b);var n,s,p;p=.9;for(l=0;l<b;l++)for(k=0;k<a;k++){p=40*(h[k]+m[l])+.5;p-=Math.floor(p);p=.2>p?1-p/2:.4>p?1-(.4-p)/2:1;if(l==b-1||l==b-2&&k<a-2||k>=a-1||k==a-2&&l<b-1)p/=2;0==l||1==l&&1<k||0==k||1==k&&1<l?(n=128+f*p/2,s=128+e*p/2,p=128+g*p/2):(n=f*p,s=e*p,p*=g);var u=4*(k+l*a);d.data[u+0]=n;d.data[u+1]=s;d.data[u+2]=p;d.data[u+3]=255}this.b.D=d;c.putImageData(this.b.D,0,0)}};r.od=function(){var a=this.a.w.e.a.getContext("2d");this.b.Vd=a.createImageData(24,24);this.b.ff=a.createImageData(24,24);this.b.Pd=a.createImageData(24,24);this.b.ef=a.createImageData(24,24);this.b.Td=a.createImageData(24,24);this.b.te=a.createImageData(24,24);this.b.If=a.createImageData(24,24);this.b.xe=a.createImageData(24,24);this.b.Zd=a.createImageData(24,24);this.b.Wd=a.createImageData(24,24);this.b.Xd=a.createImageData(24,24);this.b.Yd=a.createImageData(24,24);this.b.$d=a.createImageData(24,24);this.b.Qd=a.createImageData(24,24);this.b.Rd=a.createImageData(24,24);this.b.Sd=a.createImageData(24,24);this.b.Ud=a.createImageData(24,24);this.b.ze=a.createImageData(24,24);this.b.ue=a.createImageData(24,24);this.b.ve=a.createImageData(24,24);this.b.we=a.createImageData(24,24);this.b.ye=a.createImageData(24,24);for(var a=this.b.Vd.data,b=this.b.ff.data,c=this.b.Pd.data,d=this.b.ef.data,f=this.b.Td.data,e=this.b.te.data,g=this.b.If.data,h=this.b.xe.data,k=this.b.Zd.data,m=this.b.Wd.data,l=this.b.Xd.data,n=this.b.Yd.data,s=this.b.$d.data,p=this.b.Qd.data,u=this.b.Rd.data,v=this.b.Sd.data,E=this.b.Ud.data,N=this.b.ze.data,w=this.b.ue.data,M=this.b.ve.data,P=this.b.we.data,Z=this.b.ye.data,t=new x(28,28,28,255),B=0;24>B;B++)for(var D=0;24>D;D++){var q=4*(24*B+D);12<=D&&(11===B||12===B)?(a[q+0]=t.t,a[q+1]=t.p,a[q+2]=t.q,a[q+3]=255,k[q+0]=t.t,k[q+1]=t.p,k[q+2]=t.q,k[q+3]=96):(a[q+3]=0,k[q+3]=0);11<=D&&(11===B||12===B)||12<=B&&(11===D||12===D)?(b[q+0]=t.t,b[q+1]=t.p,b[q+2]=t.q,b[q+3]=255,n[q+0]=t.t,n[q+1]=t.p,n[q+2]=t.q,n[q+3]=96):(b[q+3]=0,n[q+3]=0);11<=D&&(11===B||12===B)?(m[q+0]=t.t,m[q+1]=t.p,m[q+2]=t.q,m[q+3]=255):12<=B&&(11===D||12===D)?(m[q+0]=t.t,m[q+1]=t.p,m[q+2]=t.q,m[q+3]=96):m[q+3]=0;12<=B&&(11===D||12===D)?(l[q+0]=t.t,l[q+1]=t.p,l[q+2]=t.q,l[q+3]=255):11<=D&&(11===B||12===B)?(l[q+0]=t.t,l[q+1]=t.p,l[q+2]=t.q,l[q+3]=96):l[q+3]=0;11===B||12===B?(c[q+0]=t.t,c[q+1]=t.p,c[q+2]=t.q,c[q+3]=255,s[q+0]=t.t,s[q+1]=t.p,s[q+2]=t.q,s[q+3]=96):(c[q+3]=0,s[q+3]=0);11===B||12===B||12<=B&&(11===D||12===D)?(d[q+0]=t.t,d[q+1]=t.p,d[q+2]=t.q,d[q+3]=255,v[q+0]=t.t,v[q+1]=t.p,v[q+2]=t.q,v[q+3]=96):(d[q+3]=0,v[q+3]=0);11===B||12===B?(p[q+0]=t.t,p[q+1]=t.p,p[q+2]=t.q,p[q+3]=255):12<=B&&(11===D||12===D)?(p[q+0]=t.t,p[q+1]=t.p,p[q+2]=t.q,p[q+3]=96):p[q+3]=0;(11===B||12===B)&&12>=D||12<=B&&(11===D||12===D)?(u[q+0]=t.t,u[q+1]=t.p,u[q+2]=t.q,u[q+3]=255):(11===B||12===B)&&12<D?(u[q+0]=t.t,u[q+1]=t.p,u[q+2]=t.q,u[q+3]=96):(d[q+3]=0,v[q+3]=0);11>=D&&(11===B||12===B)?(f[q+0]=t.t,f[q+1]=t.p,f[q+2]=t.q,f[q+3]=255,E[q+0]=t.t,E[q+1]=t.p,E[q+2]=t.q,E[q+3]=96):(f[q+3]=0,E[q+3]=0);11===D||12===D?(e[q+0]=t.t,e[q+1]=t.p,e[q+2]=t.q,e[q+3]=255,N[q+0]=t.t,N[q+1]=t.p,N[q+2]=t.q,N[q+3]=96):(e[q+3]=0,N[q+3]=0);11===D||12===D||12<=D&&(11===B||12===B)?(g[q+0]=t.t,g[q+1]=t.p,g[q+2]=t.q,g[q+3]=255,P[q+0]=t.t,P[q+1]=t.p,P[q+2]=t.q,P[q+3]=96):(g[q+3]=0,P[q+3]=0);(11===D||12===D)&&12>=B||12<=D&&(11===B||12===B)?(w[q+0]=t.t,w[q+1]=t.p,w[q+2]=t.q,w[q+3]=255):(11===D||12===D)&&12<B?(w[q+0]=t.t,w[q+1]=t.p,w[q+2]=t.q,w[q+3]=96):w[q+3]=0;11===D||12===D?(M[q+0]=t.t,M[q+1]=t.p,M[q+2]=t.q,M[q+3]=255):12<D&&(11===B||12===B)?(M[q+0]=t.t,M[q+1]=t.p,M[q+2]=t.q,M[q+3]=96):M[q+3]=0;11>=B&&(11===D||12===D)||11<=D&&(11===B||12===B)?(h[q+0]=t.t,h[q+1]=t.p,h[q+2]=t.q,h[q+3]=255,Z[q+0]=t.t,Z[q+1]=t.p,Z[q+2]=t.q,Z[q+3]=96):(h[q+3]=0,Z[q+3]=0)}this.b.Bf=this.Y(20,20,20*.07,t,1,null);this.b.Ef=this.Y(20,20,20*.07,new x(28,28,28,96),1,null);this.b.Cf=this.Y(20,20,1.2,new x(255,255,255,255),1,this.b.Bb);this.b.Ff=this.Y(20,20,1.2,new x(0,0,0,255),1,this.b.Gb);this.b.Df=this.Y(20,20,1.2,new x(255,255,255,96),1,this.b.tc);this.b.Gf=this.Y(20,20,1.2,new x(0,0,0,96),1,this.b.Nc)};r.Y=function(a,b,c,d,f,e){void 0===f&&(f=1);var g=this.a.w.e.a.getContext("2d");g.clearRect(0,0,a,b);null!==e&&g.putImageData(e,0,0);g.globalAlpha=f;g.strokeStyle=S(d);g.fillStyle=S(d);g.lineWidth=c;f=a/2;d=3*b/4;var h=.1*a;c=Math.sqrt(f*f-(d-f)*(d-f))+f-h;f=-Math.sqrt(f*f-(d-f)*(d-f))+f+h;null!==e&&(c=Math.floor(c-.5),f=Math.ceil(f+.5),h=Math.ceil(h+.5),d=Math.floor(d-.5));g.beginPath();g.moveTo(a/2,h);g.lineTo(c,d);g.lineTo(f,d);g.closePath();g.stroke();a=g.getImageData(0,0,a,b);g.putImageData(a,0,0);return a};r.Te=function(){var a=this.a.ne.e.a.getContext("2d");this.b.da=a.createImageData(20,20);a=this.b.da.data;this.b.Ya=Math.max(3,3);for(var b=0;20>b;b++)for(var c=0;20>c;c++){var d=Math.abs(b-8.5),f=Math.abs(c-8.5),d=Math.sqrt(f*f+d*d)/8.5,d=1>d?.15+.75*(1-d):0,f=4*(20*b+c);a[f+0]=0;a[f+1]=0;a[f+2]=0;a[f+3]=parseInt(255*d)}};function Qb(a){a.Uc=!0;Ub(a,!1)}r.pc=function(a,b){var c=Da(this.a.D.e.a);return{f:(a-c.f-10-this.v.f)/24|0,g:(b-c.g-10-this.v.g)/24|0}};r.fb=function(a,b){var c=this.b.A,d=this.b.u;if(!(0>=c||0>=d)){var f=this.a.Selection.e.a.getContext("2d");f.clearRect(0,0,c,d);0<=a&&0<=b&&(c=10+this.v.f+24*a,d=10+this.v.g+24*b,this.s.I(a,b).Sb()&&f.putImageData(this.b.Na,c,d))}};function Rb(a){var b=a.b.A,c=a.b.u,c=-a.v.g/(20+24*(a.s.s.length+1)-c)*(c-4-a.a.Gc)+2;a.a.R.style.left=-a.v.f/(20+24*(Sb(a.s)+1)-b)*(b-4-a.a.Hc)+2+"px";a.a.T.style.top=c+"px"};var Vb=-9,Wb=-8,Xb=-7;function Yb(a,b,c){this.r=a;this.N=b;this.ad=c}Yb.prototype.Sb=function(){return!1};Yb.prototype.L=function(){return this.ad};Yb.prototype.Db=function(){if(-10!==this.r)if(Vb===this.r){if(this.N.Db()&&0<A(this.N)&&this.N.L().ka.g>=this.ad.ka.g)return{Za:!0}}else if(Wb===this.r){if(!this.N.Db())return{Za:!1};var a=this.ad.ka.g,b=this.N.L().ka.g;if(a<b)return{Za:!0,uf:0};if(a===b)return{Za:!0,uf:1}}else if(Xb===this.r)return{Za:this.ad.Db()};return{Za:!1}};function Pb(){this.s=[];this.d=null;this.ba=0}Pb.prototype.aa=function(){this.s=[];this.ba=0};Pb.prototype.Va=function(){this.d&&(this.aa(),Zb(this,this.d.fa,0,0))};function Zb(a,b,c,d){var f,e=1;for(f=b;0<A(f);)e++,f=f.L(0);for(f=e;!$b(a,c,d,f);)d++;var e=c,g=d,h=b;for(a.S(e,g,b);0<A(h);)e++,h=h.L(0),a.S(e,g,h);for(e=b;0<A(e);)e=e.L(0);c+=f-1;for(f={Hf:d};;){for(var g=d,h=a.ba,k=A(e),m=1;m<k;m++){a.ba=h;var l=d,n=Zb(a,e.L(m),c+1,d+1);d=n.g;for(l+=1;l<=d;l++)if(l===n.Hf)if(k-1===m){a.S(c,l,new Yb(Xb,e,e.L(m)));break}else a.S(c,l,new Yb(Wb,e,e.L(m)));else l<n.Hf?a.S(c,l,new Yb(Vb,e,e.L(m))):a.S(c,l,new Yb(Vb,e,e.L(m+1)))}a.ba=h;if(e===b)break;e.Cb()&&a.ba--;e=e.N;c--;d=g}f.g=d;return f}Pb.prototype.I=function(a,b){return void 0===this.s[b]||void 0===this.s[b][a]?new Yb(-10,null,null):this.s[b][a]};Pb.prototype.S=function(a,b,c){void 0===this.s[b]&&(this.s[b]=[]);if(c.Sb())if(c.Cb()){this.ba++;var d=this.ba;c.ka.f=a;c.ka.g=b;c.ka.he=d}else c.ka.f=a,c.ka.g=b,c.ka.he=-1;this.s[b][a]=c};function $b(a,b,c,d){for(var f=0;f<d;f++){var e=b+f;if(!1===(void 0===a.s[c]||void 0===a.s[c][e]||-10===a.s[c][e].r?!0:!1))return!1}return!0}function Sb(a){for(var b=0,c=a.s.length,d=0;d<c;d++){var f=a.s[d].length-1;f>b&&(b=f)}return b};function ac(a){if(this.d=a)a.j=this;this.qa=null;this.U=[];this.a={de:null,xf:null,pf:null,mf:null,Cc:null,Ec:null,vc:null};this.Qa=this.Wc=this.xa=0}r=ac.prototype;r.M=function(a,b){bc(this,b);var c=this.d,d=F(a),f=a+"_Board",e=a+"_Message",g=a+"_Next";this.H(d.a,f);var h=this.H(d.a,g),k=this.H(d.a,e);k.style.backgroundColor="rgb(255,255,255)";k.style["border-radius"]="6px";k.style["-webkit-border-radius"]="6px";k.style["-moz-border-radius"]="5px";k.style["-khtml-border-radius"]="10px";k.style.borderColor="#e3e3e3";k.style.borderWidth="5px";k.style.borderStyle="ridge";k.style.display="block";var m=F(f);K(m.h,0,0,1E3,1E3,!1,!1,!1,!1,-1,-1);m.o=L|O|R|Q;d.n(m);this.H(m.a,f+"_Centred");var l=F(f);m.Xa(2);m.n(l);m=F(e);K(m.h,350,350,650,650,!1,!1,!1,!1,-1,-1);m.o=L|O|R|Q;d.n(m);l=new aa(this);l.M(f,c);l.xb=this;var n=F(g);K(n.h,0,0,1E3,1E3,!1,!1,!1,!1,-1,-1);n.o=L|O|R|Q;d.n(n);c=g+"_Centred";this.H(n.a,c);f=F(c);n.Xa(2);n.n(f);n=c+"_Next";g=cc(f.a,n);g.value="\u0414\u0430\u043b\u0435\u0435";g.style.display="none";var s=c+"_Prev",c=cc(f.a,s);c.value="\u041d\u0430\u0437\u0430\u0434";c.style.display="none";var p=this;g.onclick=function(){p.a.Cc.style.display="none";p.a.Ec.style.display="none";dc(p)};c.onclick=function(){p.a.Cc.style.display="none";p.a.Ec.style.display="none";ec(p)};n=F(n);K(n.h,501,0,2,2,!1,!1,!0,!0,-1,25);n.o=O|R|Q;f.n(n);n=F(s);K(n.h,2,0,499,2,!0,!1,!1,!0,-1,25);n.o=O|R|Q;f.n(n);var u=e+"_Text",s=e+"_Next",v=e+"_Prev",e=this.H(k,u);e.style.fontFamily="verdana";e.style.textAlign="justify";e.style.ah="center";e.style.overflowY="scroll";f=cc(k,s);n=cc(k,v);n.onclick=function(){ec(p)};f.onclick=function(){dc(p)};u=F(u);K(u.h,0,0,1E3,35,!1,!1,!1,!0,-1,-1);u.o=L|O|Q|R;m.n(u);s=F(s);K(s.h,0,0,5,5,!1,!1,!0,!0,100,25);s.o=Q|R;m.n(s);s=F(v);K(s.h,5,0,0,5,!0,!1,!1,!0,100,25);s.o=Q|O;m.n(s);this.a.de=k;this.a.xf=e;this.a.pf=n;this.a.mf=f;this.a.Cc=g;this.a.Ec=c;this.a.vc=h;this.U.push(l);this.qa=d;this.J();fc(this,0,0)};r.J=function(){this.qa&&this.qa.ta(this.qa.a.clientWidth,this.qa.a.clientHeight);for(var a=0,b=this.U.length;a<b;a++)this.U[a].J()};function $a(a){return null===a.G[a.xa].ca||void 0===a.G[a.xa].ca.Ze?0:a.G[a.xa].ca.Ze}function ab(a){null!==a.G[a.xa].ca&&!0===a.G[a.xa].ca.pg?(a.a.vc.style.display="block",a.a.Cc.style.display="block",a.a.Ec.style.display="block"):a.bh(a.xa,2)}r.qf=function(){};r.Lc=function(){};r.lb=function(){};r.pe=function(){};r.re=function(){};r.qe=function(){};r.se=function(){};r.Yb=function(){};r.Xb=function(){};r.ie=function(){};r.of=function(){};function bc(a,b){var c=b.length;a.Wc=c;a.G=[];for(var d=0;d<c;d++)a.G[d]={},a.G[d].me=b[d].Sgf,a.G[d].Vg=b[d].Before,a.G[d].Ug=b[d].After,a.G[d].ce=b[d].Message,null===b[d].SgfPr?a.G[d].ca=null:(a.G[d].ca={},a.G[d].ca.Ze=b[d].SgfPr.Count,a.G[d].ca.pg=b[d].SgfPr.WaitOnEnd,a.G[d].ca.Pb={},b[d].SgfPr.Flags&&(a.G[d].ca.Pb.fe=b[d].SgfPr.Flags.NewNode,a.G[d].ca.Pb.ee=b[d].SgfPr.Flags.Move,a.G[d].ca.Pb.Gd=b[d].SgfPr.Flags.ChangeBoardMode,a.G[d].ca.Pb.be=b[d].SgfPr.Flags.LoadFile))}function dc(a){var b=a.xa;0===a.Qa?null!==a.G[b].me?fc(a,b,1):(a.Qa=1,dc(a)):1!==a.Qa||b>=a.Wc-1||(null!==a.G[b+1].ce?fc(a,b+1,0):(a.xa++,a.Qa=0,dc(a)))}function ec(a){var b=a.xa;0===a.Qa?0>=b||(null!==a.G[b-1].me?fc(a,b-1,1):(a.xa--,a.Qa=1,ec(a))):1===a.Qa&&(null!==a.G[b].ce?fc(a,b,0):(a.Qa=0,ec(a)))}function fc(a,b,c){if(!(0>b||b>=a.Wc)){a.xa=b;a.Qa=c;var d=a.G[b].me,f=a.G[b].ca,e=a.G[b].ce;0===c?(a.a.vc.style.display="block",null!==e?(c=0===b?null:"\u041d\u0430\u0437\u0430\u0434",b=b===a.Wc-1&&null===d?null:"\u0414\u0430\u043b\u0435\u0435",d=a.a.pf,f=a.a.mf,a.a.de.style.display="block",a.a.xf.innerHTML=e,null===c?d.style.display="none":(d.style.display="block",d.value=c),null===b?f.style.display="none":(f.style.display="block",f.value=b)):dc(a)):1===c&&(a.a.vc.style.display="none",null!==d?(a.a.de.style.display="none",a.d.F=4294967295,a.d.Eb(d),gc(a.d,f.Pb),ob(a.d)):dc(a))}}r.H=function(a,b){var c=document.createElement("div");c.setAttribute("id",b);c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("oncontextmenu","return false;");a.appendChild(c);return c};function cc(a,b){var c=document.createElement("input");c.setAttribute("id",b);c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("type","button");a.appendChild(c);return c};var hc=0,Kb=0,Jb=1;function Ib(a){this.j=a;this.d=null;this.r=hc;this.a={e:null,Ac:null,je:null,oe:null};this.wg=new x(217,217,217,255);this.zg=new x(54,101,179,255);this.Bg=new x(140,140,140,255);this.Cg=new x(0,0,0,255);this.Vc=this.Jb=this.K=0;this.$a=7;this.Ia=10;this.bc=!1;var b=this;this.Eg=function(a){var d=b.K-b.Vc;0!==d&&(Lb(b,(a-b.Ia)/d,!1),ic(b,!1))};this.Hg=function(){b.bc=!0;ic(b,!1)};this.Fg=function(a){b.bc=!1;var d=b.K-b.Vc;0!==d&&(Lb(b,(a-b.Ia)/d,!1),ic(b,!0))}}Ib.prototype.M=function(a,b,c,d){this.d=b;this.r=c;switch(c){case Kb:this.j.mc=this;break;case Jb:this.j.Qe=this}this.a.e=F(a);c=this.a.e.a;c.style.backgroundColor=S(this.wg);c.style.dh=S(new x(255,255,255,255));var f=a+"_Left";b=a+"_Right";a+="_Slider";this.a.Ac=this.la(c,f);this.a.je=this.la(c,b);this.a.oe=this.la(c,a);a=F(f);K(a.h,this.Ia,this.$a,500,this.$a,!0,!0,!1,!0,-1,-1);a.o=L|O|Q|R;this.a.e.n(a);a.a.style.background=S(this.zg);a=F(b);K(a.h,500,this.$a,this.Ia,this.$a,!1,!0,!0,!0,-1,-1);a.o=L|O|Q|R;this.a.e.n(a);a.a.style.background=S(this.Bg);this.J();Lb(this,d)};Ib.prototype.J=function(){var a=this.a.e.a.clientWidth,b=this.a.e.a.clientHeight;this.K=a-2*this.Ia;this.a.e.ta(a,b);this.za(a,b);Lb(this,this.Jb,!0)};Ib.prototype.za=function(a,b){var c=b-2*this.$a;this.Vc=c;var d=this.a.oe;d.style.width=c+"px";d.style.height=c+"px";d.style.display="block";d.style.position="absolute";d.style.backgroundColor=S(this.Cg);d.style.top=this.$a+"px";d.style.left=this.Ia+"px";Tb(d,this.Ia,a-this.Ia-c,this.$a,this.$a);d.ld=this.Eg;d.nd=this.Hg;d.md=this.Fg;d=this.a.Ac;d.style.fontSize=c+"px";d.style.color="rgb(255,255,255)";d.style.textOverflow="clip";d.style.overflow="hidden"};Ib.prototype.la=function(a,b){var c=document.createElement("div");c.setAttribute("id",b);c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("oncontextmenu","return false;");a.appendChild(c);return c};function Lb(a,b,c){a.Jb=Math.min(1,Math.max(b,0));b=a.Jb*a.K;a.a.Ac.style.width=b+"px";a.a.je.style.left=b+a.Ia+"px";a.a.je.style.width=a.K-b+"px";!1!==c&&(a.a.oe.style.left=a.Jb*(a.K-a.Vc)+a.Ia+"px")}function ic(a,b){if(a.d)switch(a.r){case Kb:var c=a.d,d=a.Jb;c.dc=d;if(c.j){var f=c.j;f.mc&&(f=f.mc,!0!==f.bc&&Lb(f,d,!0))}null!==c.rb&&ub(c);a.a.Ac.innerText=b?"":((100+19900*(1-a.d.dc))/1E3*1E3|0)/1E3+" seconds for move";break;case Jb:c=a.d;d=c.fa;for(f=1;0<A(d);)f++,d=d.L();d=a.Jb*(f-1);for(f=c.fa;0<A(f)&&0<d;)d--,f=f.L();z(c,f)}};function Gb(a){this.j=a;this.d=null;this.a={e:null};this.vg=new x(217,217,217,255);this.De=[]}Gb.prototype.M=function(a,b,c){this.d=b;this.a.e=F(a);var d=this.a.e.a,f=this.a.e;d.style.backgroundColor=S(this.vg);for(var e=0,g=c.Z.length;e<g;e++){var h=c.Z[e],k=null;switch(h){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:k=new mb(this.j)}if(null!==k){var m=a+e;this.la(d,m);this.X(f,m,e/g,(e+1)/g);k.M(m,b,h);this.De.push(k)}}this.J()};Gb.prototype.J=function(){this.a.e.ta(this.a.e.a.clientWidth,this.a.e.a.clientHeight);for(var a=0,b=this.De.length;a<b;a++)this.De[a].J()};Gb.prototype.la=function(a,b){var c=document.createElement("div");c.setAttribute("id",b);c.setAttribute("style","position:absolute;padding:0;margin:0;");c.setAttribute("oncontextmenu","return false;");a.appendChild(c);return c};Gb.prototype.X=function(a,b,c,d){b=F(b);K(b.h,1E3*c,0,1E3*d,1E3,!1,!1,!1,!1,-1,-1);b.o=L|O|Q|R;a.n(b)};function U(){}r=U.prototype;r.fg=function(){return new jc};r.Kd=function(a,b){(new Db(a)).Kd(b)};r.Jd=function(a,b){(new Db(a)).Jd(b)};r.Id=function(a,b){(new Db(a)).Id(b)};r.gg=function(a,b,c){(new ac(a)).M(b,c)};r.mg=function(a,b){var c={};c.fe=b.NewNode;c.ee=b.Move;c.Gd=b.ChangeBoardMode;c.be=b.LoadFile;gc(a,c)};r.Eb=function(a,b){a.Eb(b)};r.J=function(a){a.J()};window.GoBoardApi=new U;U.prototype.Create_GameTree=U.prototype.fg;U.prototype.Create_SimpleBoard=U.prototype.Kd;U.prototype.Create_BoardWithNavigateButtons=U.prototype.Jd;U.prototype.Create_BoardCommentsButtonsNavigator=U.prototype.Id;U.prototype.Create_Presentation=U.prototype.gg;U.prototype.Set_Permissions=U.prototype.mg;U.prototype.Load_Sgf=U.prototype.Eb;U.prototype.Update_Size=U.prototype.J;var kc={};function lc(a,b,c){this.r=void 0===a?0:a;this.Wf=void 0===b?null:b;this.Pf=void 0===c?0:c}lc.prototype.ja=function(){return this.Wf};lc.prototype.Xa=function(a){this.r=a};lc.prototype.Ic=function(a){this.Wf=a};function mc(){Y=X=0}function x(a,b,c,d){this.t=a;this.q=b;this.p=c;this.Be="undefined"===typeof d?255:d}x.prototype={};function S(a){return"rgba("+a.t+","+a.q+","+a.p+","+a.Be/255+")"}function T(a){var b=new mc;b.f=a&255;b.g=a>>8&255;return b}function nc(a){for(var b=[],c=0,d=a.length;c<d;c++)b.push(a[c]);return b}function Da(a){if("undefined"!=typeof a.offsetParent){for(var b=0,c=0;a;a=a.offsetParent)b+=a.offsetLeft,c+=a.offsetTop;return{f:b,g:c}}return{f:a.x,g:a.y}}function Ia(a){if("string"!=typeof a)return!1;for(var b=0;b<a.length;b++){var c=a.charCodeAt(b);if(48>c||57<c)return!1}return!0}function hb(a,b){return a>b?1:b>a?-1:0}var V=null;function Tb(a,b,c,d,f){a.onmousedown=oc;a.Ga=!0;a.La=!0;a.root=a;a.Ga&&isNaN(parseInt(a.root.style.left))&&(a.root.style.left="0px");a.La&&isNaN(parseInt(a.root.style.top))&&(a.root.style.top="350px");!a.Ga&&isNaN(parseInt(a.root.style.right))&&(a.root.style.right="0px");!a.La&&isNaN(parseInt(a.root.style.bottom))&&(a.root.style.bottom="0px");a.cb="undefined"!=typeof b?b:null;a.eb="undefined"!=typeof d?d:null;a.yb="undefined"!=typeof c?c:null;a.zb="undefined"!=typeof f?f:null;a.ag=null;a.bg=null;a.root.nd=new Function;a.root.md=new Function;a.root.ld=new Function}function oc(a){var b=V=this;a=pc(a);var c=parseInt(b.La?b.root.style.top:b.root.style.bottom),d=parseInt(b.Ga?b.root.style.left:b.root.style.right);b.root.nd(d,c);b.Lf=a.clientX;b.Mf=a.clientY;b.Ga?(null!=b.cb&&(b.jd=a.clientX-d+b.cb),null!=b.yb&&(b.Re=b.jd+b.yb-b.cb)):(null!=b.cb&&(b.Re=-b.cb+a.clientX+d),null!=b.yb&&(b.jd=-b.yb+a.clientX+d));b.La?(null!=b.eb&&(b.kd=a.clientY-c+b.eb),null!=b.zb&&(b.Se=b.kd+b.zb-b.eb)):(null!=b.eb&&(b.Se=-b.eb+a.clientY+c),null!=b.zb&&(b.kd=-b.zb+a.clientY+c));document.onmousemove=qc;document.onmouseup=rc;return!1}function qc(a){a=pc(a);var b=V,c=a.clientY;a=a.clientX;var d=parseInt(b.La?b.root.style.top:b.root.style.bottom),f=parseInt(b.Ga?b.root.style.left:b.root.style.right),e,g;null!=b.cb&&(a=b.Ga?Math.max(a,b.jd):Math.min(a,b.Re));null!=b.yb&&(a=b.Ga?Math.min(a,b.Re):Math.max(a,b.jd));null!=b.eb&&(c=b.La?Math.max(c,b.kd):Math.min(c,b.Se));null!=b.zb&&(c=b.La?Math.min(c,b.Se):Math.max(c,b.kd));e=f+(a-b.Lf)*(b.Ga?1:-1);g=d+(c-b.Mf)*(b.La?1:-1);b.ag?e=b.ag(d):b.bg&&(g=b.bg(f));null!=b.cb&&(e=Math.max(e,b.cb));null!=b.yb&&(e=Math.min(e,b.yb));null!=b.eb&&(g=Math.max(g,b.eb));null!=b.zb&&(g=Math.min(g,b.zb));V.root.style[b.Ga?"left":"right"]=e+"px";V.root.style[b.La?"top":"bottom"]=g+"px";V.Lf=a;V.Mf=c;V.root.ld(e,g);return!1}function rc(){document.onmousemove=null;document.onmouseup=null;V.root.md(parseInt(V.root.style[V.Ga?"left":"right"]),parseInt(V.root.style[V.La?"top":"bottom"]));V=null}function pc(a){"undefined"==typeof a&&(a=window.event);"undefined"==typeof a.layerX&&(a.layerX=a.offsetX);"undefined"==typeof a.layerY&&(a.layerY=a.offsetY);return a};var J=0,G=1,H=2,sc=2,pa=0,oa=2,Ga=460,Ea=Ga,Ha=17.51/23.61,Fa=Ha;var Aa=4,tc=4294967295^Aa;function jc(a,b){this.ha=b;this.j=a;this.yg=new Ob;this.W=new uc;this.B=this.k=null;this.i=this.fa=new vc;this.vb=this.sb=0;this.ub=G;this.hc=this.Ke=this.Tf=this.Of=this.Rf=0;this.cd="";this.bd="Black";this.gd="White";this.hd="";this.gc=sc;this.F=4294967295;this.rb=null;this.dc=.75;this.Nf=-1}function ub(a){if(2&a.F){vb(a);a.j&&a.j.of();var b=function(){0<A(a.i)&&ma(a,1);0<A(a.i)?(a.Nf=(new Date).getTime(),a.rb=setTimeout(b,100+19900*(1-a.dc))):(a.rb=null,a.j&&a.j.ie())},c=100+19900*(1-a.dc)-((new Date).getTime()-a.Nf);0>=c?b():a.rb=setTimeout(b,c)}}function vb(a){a.j&&a.j.ie();null!==a.rb&&(clearTimeout(a.rb),a.rb=null)}r=jc.prototype;r.J=function(){this.j&&this.j.J()};function ob(a){a.k&&wa(a.k)}r.Eb=function(a){if(this.F&8){var b=new wc(this),c=this.F;this.F=4294967295;if(void 0!==a&&""!==a){b.m=[];b.c=0;b.Kb=0;b.Ee=[];b.Pa=!0;for(var d=b.ic=0,f=a.length,e=[],g=!1;d<f;){(g||32<a.charCodeAt(d))&&e.push(a.charAt(d));if(3<=e.length&&"["==e[e.length-1]){var h=e[e.length-3]+e[e.length-2];if("C"==e[e.length-2]&&"UC"!=h||"AN"==h||"BR"==h||"BT"==h||"CP"==h||"DT"==h||"EV"==h||"GN"==h||"GC"==h||"ON"==h||"OT"==h||"PB"==h||"PC"==h||"PW"==h||"RE"==h||"RO"==h||"RU"==h||"SO"==h||"TM"==h||"US"==h||"WR"==h||"WT"==h)g=!0}else g&&1<=e.length&&"]"==e[e.length-1]&&(2>e.length||"\\"!=e[e.length-2])&&(g=!1);d++}b.m=e;b.ic=b.m.length;xc(b)||alert("Error occurs, while read SGF")}this.B&&(this.B.Va(),ia(this.B));z(this,this.fa);this.F=c;this.k&&(a=this.k,null!==a.xb&&Za(a.d.i)>=$a(a.xb)&&ab(a.xb))}};r.Vb=function(){this.fa=new vc;this.bd="Black";this.j&&this.j.pe(this.bd);this.gd="White";this.j&&this.j.re(this.gd);this.cd="";this.j&&this.j.qe(this.cd);this.hd="";this.j&&this.j.se(this.hd);this.gc=0;yc(this)};function ja(a,b){for(var c=a.i;null!=c.N&&0<b;)c=c.N,b--;z(a,c)}function ma(a,b){if(1===b)la(a)&&fb(a);else{for(var c=0;c<b;c++)la(a);z(a,a.i)}}function ka(a){var b=a.i.N;if(null!==b){var c=b.Q;0<A(b)&&0<c&&z(a,b.L(c-1))}}function na(a){var b=a.i.N;if(null!==b){var c=b.Q;c<A(b)-1&&z(a,b.L(c+1))}}r.Od=function(){for(var a=this.i;!zc(a);){var b=a.N;if(null===b&&a!==this.fa)return;a=b}a.Od();z(this,a)};r.le=function(a){this.ub=a;this.i.le(a)};r.Ab=function(a,b,c){this.i.Ab(a,b,c)};function eb(a,b,c){if(a.F&1){var d=new vc,f=d.N=a.i;f.va.push(d);if(!0===c||-1===f.Q)f.Q=f.va.length-1;a.i=d;a.hc++;!0===b&&a.B&&(a.B.Va(),ia(a.B))}}r.qc=function(a,b){this.i.qc(a,b)};r.rc=function(a){var b=this.i.bb;this.i.rc(a);this.B&&""===b&&""!==a&&ia(this.B)};r.ke=function(a){var b=this.i.bb;this.i.ke(a);this.B&&(""===b&&""!==a||""!==b&&""===a)&&ia(this.B)};r.ma=function(a,b){this.i.ma(a,b)};r.Ma=function(a){this.i.ma(513,a)};r.Nb=function(a,b){this.i.Nb(a,b)};r.sd=function(a,b){this.i.ya.ob||(this.i.ya.ob=!0);for(var c=0,d=b.length;c<d;c++)this.i.sd(b[c],a)};r.rd=function(a){this.i.rd(a)};r.td=function(a){this.i.td(a)};r.Hd=function(){!0===this.i.ya.ob&&(this.i.ya.ob=!1,this.i.Hd());this.k&&(this.k.ga={},La(this.k))};r.Cb=function(){return this.i.Cb()};function fb(a){a.k&&(1===a.k.Ha&&C(a.k,0),a.k.ga={},a.Jc());for(var b=0,c=a.i.pa.length;b<c;b++){var d=a.i.pa[b],f=d.ja(),e=d.Pf;switch(d.r){case 1:d=T(f);Ac(a,d.f,d.g,G,!1);break;case 2:d=T(f);Ac(a,d.f,d.g,H,!1);break;case 257:for(var g=0;g<e;g++)d=T(f[g]),Bc(a,d.f,d.g,G,-1);break;case 258:for(g=0;g<e;g++)d=T(f[g]),Bc(a,d.f,d.g,H,-1);break;case 259:for(g=0;g<e;g++)d=T(f[g]),Bc(a,d.f,d.g,J,-1);break;case 260:a.ub=f;break;case 529:if(a.k)for(g=0;g<e;g++)d=T(f[g]),a.k.ma(new I(d.f,d.g,Ta,""));break;case 530:if(a.k)for(g=0;g<e;g++)d=T(f[g]),a.k.ma(new I(d.f,d.g,Wa,""));break;case 531:if(a.k)for(g=0;g<e;g++)d=T(f[g]),a.k.ma(new I(d.f,d.g,Ua,""));break;case 532:if(a.k)for(g=0;g<e;g++)d=T(f[g]),a.k.ma(new I(d.f,d.g,Va,""));break;case 533:a.k&&(d=T(f.lg),a.k.ma(new I(d.f,d.g,Qa,f.Text)));break;case 513:if(a.k)for(g=0;g<e;g++)d=T(f[g]),a.k.Ma(d.f,d.g)}}a.k&&(a.i.Cb()?(c=a.i.Ka,b=c.Qb(),c=c.Rb(),Oa(a.k,b,c)):Oa(a.k,-1,-1),a.i.ya.ob&&C(a.k,1),La(a.k));a.j&&a.j.Lc(a.i.bb);a.B&&Ub(a.B,!0);a.lb()}function Ac(a,b,c,d,f){if(0!=b||0!=c){a.ha&&!0!==f&&a.ha.Zg();Bc(a,b,c,d,a.Ke+1,f);var e=null;if(null!==(e=jb(a.W,b,c,d,!1))&&0<e.O()){b=e.O();for(c=0;c<b;c++){var g=T(e.ja(c));Bc(a,g.f,g.g,J,-1)}a.ha&&!0!==f&&a.ha.kg(e);G===d?a.sb+=b:a.vb+=b}else if(null!==(e=kb(a.W,b,c,d))&&0<e.O()){b=e.O();for(c=0;c<b;c++)g=T(e.ja(c)),Bc(a,g.f,g.g,J,-1);a.ha&&!0!==f&&a.ha.kg(g_nGroupSize);G===d?a.vb+=b:a.sb+=b}else a.W.wb.Vb()}a.ub=G===d?H:G;a.Ke++}function la(a){if(!(a.F&2)||0===A(a.i)||-1===a.i.Q)return!1;a.i=a.i.L(a.i.Q);a.hc++;return!0}r.Jc=function(){this.k&&this.i.Jc(this.gc,this.k)};r.xc=function(){if(this.k){var a=this.W.xc(this.k);La(this.k);this.i.ya.ob||(this.i.ya.ob=!0);var b=this.W,c=this.i.ya;c.wa={};for(var d=b.O(),f=1;f<=d.g;f++)for(var e=1;e<=d.f;e++){var g=b.Oa[Ba(b,e,f)],h=(f<<8)+e;if(G===g||H===g)c.wa[""+h]=g}this.Of=a.Bb+this.sb;this.Tf=a.Gb+this.vb+this.Rf;this.lb()}};function z(a,b){if(a.F&2){vb(a);yc(a);a.W.aa();a.ha&&a.ha.Xg();var c;a:{c=!1;for(var d=b.N,f=b;null!=d;){for(var e=!1,g=0,h=A(d);g<h;g++)if(f===d.L(g)){g!==d.Q&&(c=!0);lb(d,g);e=!0;break}if(!e){c=!1;break a}f=d;d=d.N}}for(a.i=a.fa;a.i!=b&&0<A(a.i);){d=a.i.pa.length;for(f=0;f<d;f++)switch(h=a.i.pa[f],e=h.ja(),g=h.Pf,h.r){case 1:h=T(e);Ac(a,h.f,h.g,G,!0);break;case 2:h=T(e);Ac(a,h.f,h.g,H,!0);break;case 257:for(var k=0;k<g;k++)h=T(e[k]),a.W.S(h.f,h.g,G,-1);break;case 258:for(k=0;k<g;k++)h=T(e[k]),a.W.S(h.f,h.g,H,-1);break;case 259:for(k=0;k<g;k++)h=T(e[k]),a.W.S(h.f,h.g,J,-1)}if(!la(a))break}a.k&&Ka(a.k);fb(a);a.B&&!0===c&&ia(a.B);a.ha&&a.ha.Yg()}}function qa(a,b){b!==a.gc&&(a.gc=b,a.Jc())}function yc(a){a.i=a.fa;a.sb=0;a.vb=0;a.Ke=0;a.hc=0;a.ub=G}function Bc(a,b,c,d,f,e){a.W.S(b,c,d,f);a.k&&!0!==e&&xa(a.k,b,c,d)}r.lb=function(){if(this.j){var a=this.yg,b=this.i.N;a.Ua=null===this.i.N?!1:!0;a.Wa=0>=A(this.i)?!1:!0;if(null!==b){var c=b.Q;a.jb=c<A(b)-1?!0:!1;a.kb=0<c?!0:!1}else a.jb=!1,a.kb=!1;this.k&&(a.Ba=this.k.Ha);for(var b=this.fa,d=c=1;0<A(b);)c++,b=b.L(),b===this.i&&(d=c);a.yf=0<c?(d-1)/(c-1):1;this.j.lb(a);this.k&&1===this.k.Ha?this.j.Yb(this.Of,this.Tf):this.j.Xb(this.sb,this.vb)}};function gc(a,b){b&&(!0===b.fe?a.F|=1:!1===b.fe&&(a.F&=-2),!0===b.ee?a.F|=2:!1===b.ee&&(a.F&=-3),!0===b.Gd?a.F|=Aa:!1===b.Gd&&(a.F&=tc),!0===b.be?a.F|=8:!1===b.be&&(a.F&=-9))};"use strict;";function ib(){this.tb=this.ba=0}ib.prototype.Vb=function(){this.tb=this.ba=0};ib.prototype.S=function(a,b){this.ba=a;this.tb=b};function Cc(a,b){this.Je=void 0===a?J:a;this.Le=void 0===b?-1:b}Cc.prototype.aa=function(){this.Je=J;this.Le=-1};Cc.prototype.Ic=function(a){this.Je=a};Cc.prototype.ja=function(){return this.Je};Cc.prototype.Nd=function(){return this.Le};function Dc(){this.ac=[];this.Hb=[]}Dc.prototype.O=function(){return this.Hb.length};Dc.prototype.ja=function(a){return this.Hb[a]};function Ec(a,b,c){b=(c<<8)+b;c=0;for(var d=a.Hb.length;c<d;c++)if(a.Hb[c]==b)return!0;return!1}function Fc(){this.wa={}}Fc.prototype.aa=function(){this.wa={}};Fc.prototype.Tb=function(a,b){var c=(b<<8)+a;if(void 0!==this.wa[c])return!0;this.wa[c]=1;return!1};function Gc(){this.P={};this.jc=J}Gc.prototype.aa=function(){this.P={};this.jc=J};Gc.prototype.Tb=function(a,b){var c=(b<<8)+a;if(void 0!==this.P[c])return!0;this.P[c]=1;return!1};function db(a,b,c){c=void 0===c?a.jc:c;for(var d in a.P)a=T(d|0),b.Oa[Ba(b,a.f,a.g)]=c}function uc(a,b){this.K=void 0===a?19:a;this.$=void 0===b?19:b;this.nb=null;Hc(this);this.wb=new ib;this.Oa=null;this.P=new Gc;this.Yc=new Fc}r=uc.prototype;r.aa=function(){for(var a=this.K*this.$,b=0;b<a;b++)this.nb[b].aa()};r.O=function(){return{f:this.K,g:this.$}};r.S=function(a,b,c,d){a=Ba(this,a,b);this.nb[a].Ic(c);void 0!==d&&null!==d&&-1!==d&&(this.nb[a].Le=d)};r.I=function(a,b){return this.nb[Ba(this,a,b)].ja()};r.Nd=function(a,b){return this.nb[Ba(this,a,b)].Nd()};function kb(a,b,c,d){var f=new Dc;Ic(a,b,c,d,f);return 0<f.O()?f:null}function jb(a,b,c,d,f){var e;switch(d){case G:e=H;break;case H:e=G;break;default:return null}d=new Dc;!0!==Ec(d,b+1,c)&&Ic(a,b+1,c,e,d);!0!==Ec(d,b-1,c)&&Ic(a,b-1,c,e,d);!0!==Ec(d,b,c+1)&&Ic(a,b,c+1,e,d);!0!==Ec(d,b,c-1)&&Ic(a,b,c-1,e,d);e=d.O();if(1==e){b=(c<<8)+b;c=d.ja(0);e=a.wb;if(c===e.ba&&b===e.tb&&1==f)return null;a.wb.S(b,c)}else if(1<e)a.wb.Vb();else if(0>=e)return null;return d}function Hc(a){var b=a.K*a.$;a.nb=Array(b);for(var c=0;c<b;c++)a.nb[c]=new Cc}function Ba(a,b,c){return(c-1)*a.K+(b-1)}function Jc(a,b,c,d,f){if(b>a.K||1>b||c>a.$||1>c)return!1;var e=a.I(b,c);return J===e?!0:d===e?Kc(a,b,c,d,f):!1}function Kc(a,b,c,d,f){var e;a:{e=(c<<8)+b;for(var g=0,h=f.ac.length;g<h;g++)if(f.ac[g]==e){e=!0;break a}f.ac.push(e);e=!1}return!0===e?!1:!0===Jc(a,b+1,c,d,f)||!0===Jc(a,b-1,c,d,f)||!0===Jc(a,b,c+1,d,f)||!0===Jc(a,b,c-1,d,f)?!0:!1}function Ic(a,b,c,d,f){b>a.K||1>b||c>a.$||1>c||d!==a.I(b,c)||(!0!==Kc(a,b,c,d,f)&&(f.Hb=f.Hb.concat(f.ac)),f.ac=[])}r.xc=function(a){for(var b=0,c=0,d=1;d<=this.$;d++)for(var f=1;f<=this.K;f++){var e=null,g=this.Oa[Ba(this,f,d)];G===g?(e=new I(f,d,Ra,""),H===this.I(f,d)?b+=2:b++):H===g&&(e=new I(f,d,Sa,""),G===this.I(f,d)?c+=2:c++);null===e?a.Ma(f,d):a.ma(e)}return{Bb:b,Gb:c}};function Lc(a,b,c){if(!(b>a.K||1>b||c>a.$||1>c)){var d=a.I(b,c);if(J!==a.I(b,c))switch(b=a.P.jc,b){case J:a.P.jc=d;break;case G:case H:b!==d&&(a.P.jc=3)}else!1===a.P.Tb(b,c)&&(Lc(a,b+1,c),Lc(a,b-1,c),Lc(a,b,c+1),Lc(a,b,c-1))}}function bb(a,b,c,d){b>a.K||1>b||c>a.$||1>c||(3-d===a.I(b,c)?d===a.Oa[Ba(a,b,c)]&&a.Yc.Tb(b,c):!0!==a.P.Tb(b,c)&&(bb(a,b+1,c,d),bb(a,b-1,c,d),bb(a,b,c+1,d),bb(a,b,c-1,d)))}function cb(a,b,c,d){if(!(b>a.K||1>b||c>a.$||1>c)&&3-d!==a.I(b,c)){if(d===a.I(b,c)){var f=a.Yc,e=(c<<8)+b;void 0!==f.wa[e]&&delete f.wa[e]}!0!==a.P.Tb(b,c)&&(cb(a,b+1,c,d),cb(a,b-1,c,d),cb(a,b,c+1,d),cb(a,b,c-1,d))}}function Ca(a,b){for(var c=1;c<=a.$;c++)for(var d=1;d<=a.K;d++)J===a.I(d,c)&&(J===a.Oa[Ba(a,d,c)]||!0===b&&3===a.Oa[Ba(a,d,c)])&&(a.P.aa(),Lc(a,d,c),db(a.P,a))};function Mc(a,b){this.Xc=a;this.r=b}r=Mc.prototype;r.Qb=function(){return T(this.Xc).f};r.Rb=function(){return T(this.Xc).g};r.ja=function(){return this.Xc};r.Ic=function(a){this.Xc=a};r.Xa=function(a){this.r=a};function vc(){this.va=[];this.Q=-1;this.N=null;this.pa=[];this.Ka=new Mc(0,J);this.bb="";this.ya=new Nc;this.ka={f:-1,g:-1,he:-1}}r=vc.prototype;r.Sb=function(){return!0};r.aa=function(){this.va=[];this.Q=-1;this.pa=[];this.Ka=new Mc(0,J);this.bb="";this.ya=new Nc};r.L=function(a){return void 0!==this.va[a]?this.va[a]:this.va[this.Q]};function lb(a,b){a.Q=b>=a.va.length?a.va.length-1:b}function A(a){return a.va.length}r.Cb=function(){return J===this.Ka.r?!1:!0};r.rc=function(a){this.bb+=a};r.ke=function(a){this.bb=a};r.sd=function(a,b){this.ya.wa[""+a]=b};r.Hd=function(){this.ya.wa={}};r.Od=function(){for(var a=this;0<A(a);)lb(a,0),a=a.L(0)};function zc(a){for(var b=null;null!==(b=a.N);){if(0!=b.Q)return!1;a=b}return!0}r.Db=function(){for(var a=this,b=null;null!=(b=a.N);){if(b.L(b.Q)!=a)return!1;a=b}return!0};r.Ab=function(a,b,c){a=(b<<8)+a;this.pa.push(new lc(G===c?1:2,a));J===this.Ka.r&&(this.Ka.Ic(a),this.Ka.Xa(c))};r.qc=function(a,b){var c=new lc(G===a?257:H===a?258:259,nc(b),b.length);this.pa.push(c)};r.ma=function(a,b){var c=0;switch(a){case Ta:c=529;break;case ya:c=kc.Wg;break;case Ua:c=531;break;case Va:c=532;break;case Qa:c=533;break;case Wa:c=530}c=new lc(c,nc(b),b.length);this.pa.push(c)};r.Nb=function(a,b){this.pa.push(new lc(533,{Text:a,lg:b}))};r.le=function(a){this.pa.push(new lc(260,a))};r.rd=function(a){this.pa.push(new lc(769,a))};r.td=function(a){this.pa.push(new lc(770,a))};r.Jc=function(a,b){b.a.Mc.e.a.getContext("2d").clearRect(0,0,b.b.A,b.b.u);switch(a){case sc:Oc(this,b,-1);break;case 1:var c=this.N;null!==c&&Oc(c,b,this.Ka.ja())}};function Za(a){for(var b=1,c=null;null!==(c=a.N);)b++,a=c;return b}function Oc(a,b,c){if(b)for(var d=0,f=A(a);d<f;d++){var e=a.L(d).Ka;if(J!==e.r&&c!==e.ja()){var g=T(e.ja()),e=b;if(e.b.w){var h=(e.b.ua/2-1)/2,k=e.b.w,m=k[g.f-1].f,g=k[g.g-1].g,k=e.a.Mc.e.a.getContext("2d");k.fillStyle=S(e.Dg);k.beginPath();k.arc(m,g,h,0,2*Math.PI,!1);k.fill()}}}};function wc(a){this.d=a;this.m=[];this.Kb=this.c=0;this.Ee=[];this.Pa=!0;this.ic=0}function xc(a){a.d.Vb();if("("===a.m[0]&&";"===a.m[1])for(a.c++;a.c<a.ic&&(")"!==a.m[a.c]||0!==a.Kb);){var b=a.m[a.c];if(";"===b){1!=a.c?eb(a.d,!1,!1):a.d.i=a.d.fa;a:{b=a;b.c++;for(var c=b.m[b.c],d=b.m[b.c+1];void 0!==c&&")"!==c&&";"!==c&&"("!==c;){switch(c){case "A":switch(d){case "B":Pc(b,G);break;case "E":Pc(b,J);break;case "W":Pc(b,H);break;case "N":c=b;c.c+=3;W(c);break;case "P":c=b;c.c+=3;W(c);break;default:$(b)}break;case "B":switch(d){case "[":Qc(b,G);break;case "R":d=b;d.c+=3;c=d.d;d=W(d);c.cd=d;c.j&&c.j.qe(c.cd);break;case "T":c=b;c.c+=3;W(c);break;case "L":c=b;c.c+=3;c.d.rd(Rc(c));break;default:$(b)}break;case "C":switch(d){case "[":c=b;c.c+=2;for(d="";"]"!==c.m[c.c]||"\\"===c.m[c.c-1];)"]"===c.m[c.c+1]&&"\\"===c.m[c.c]?(d+="]",c.c++):d+=c.m[c.c],c.c++;c.c++;c.d.rc(d);break;case "A":c=b;c.c+=3;W(c);break;case "P":c=b;c.c+=3;W(c);break;case "R":Sc(b,Ta);break;default:$(b)}break;case "D":switch(d){case "D":c=b;c.c+=3;W(c);break;default:$(b)}break;case "E":switch(d){case "V":c=b;c.c+=3;W(c);break;default:$(b)}break;case "F":switch(d){case "F":$(b);break;default:$(b)}break;case "G":switch(d){case "N":c=b;c.c+=3;W(c);break;case "C":c=b;c.c+=3;W(c);break;case "M":c=b;c.c+=3;1!==Tc(c)&&(c.Pa=!1);break;default:$(b)}break;case "H":switch(d){case "A":c=b;c.c+=3;Tc(c);break;default:$(b)}break;case "K":switch(d){case "M":c=b;c.c+=3;d=Rc(c);c.d.Rf=d;break;default:$(b)}break;case "L":switch(d){case "B":c=b;for(c.c+=3;;){d=c.m[c.c];c.c++;var f=c.m[c.c];c.c++;d=d.charCodeAt(0)-96;f=f.charCodeAt(0)-96;c.c++;for(var e="";"]"!==c.m[c.c]&&c.c<c.ic;)e+=c.m[c.c],c.c++;c.d.Nb(e,(f<<8)+d);if("]"!==c.m[c.c]){c.Pa=!1;break}c.c++;if("["!==c.m[c.c])break;c.c++}break;default:$(b)}break;case "M":switch(d){case "A":Sc(b,Wa);break;default:$(b)}break;case "O":switch(d){case "N":c=b;c.c+=3;W(c);break;case "T":c=b;c.c+=3;W(c);break;default:$(b)}break;case "P":switch(d){case "B":d=b;d.c+=3;c=d.d;d=W(d);c.bd=d;c.j&&c.j.pe(c.bd);break;case "C":c=b;c.c+=3;W(c);break;case "W":d=b;d.c+=3;c=d.d;d=W(d);c.gd=d;c.j&&c.j.re(c.gd);break;default:$(b)}break;case "R":switch(d){case "E":c=b;c.c+=3;W(c);break;case "O":c=b;c.c+=3;W(c);break;case "U":c=b;c.c+=3;W(c);break;default:$(b)}break;case "S":switch(d){case "Q":Sc(b,Ua);break;case "T":c=b;c.c+=3;switch(Tc(c)){case 0:qa(c.d,sc);break;case 1:qa(c.d,1);break;default:qa(c.d,0)}break;case "Z":d=b;d.c+=3;c=Tc(d);0>=c&&(c=19);d=d.d;f=d.W.O();if(c!==f.f||c!==f.g)f=d.W,e=c,f.K=c,f.$=e,Hc(f),f.wb.Vb(),d.k&&(c=d.k,ra(c),c.za(!0));break;case "O":c=b;c.c+=3;W(c);break;default:$(b)}break;case "T":switch(d){case "R":Sc(b,Va);break;case "M":c=b;c.c+=3;W(c);break;case "B":Uc(b,G);break;case "W":Uc(b,H);break;default:$(b)}break;case "U":switch(d){case "S":c=b;c.c+=3;W(c);break;default:$(b)}break;case "W":switch(d){case "[":Qc(b,H);break;case "R":d=b;d.c+=3;c=d.d;d=W(d);c.hd=d;c.j&&c.j.se(c.hd);break;case "T":c=b;c.c+=3;W(c);break;case "L":c=b;c.c+=3;c.d.td(Rc(c));break;default:$(b)}break;default:$(b)}if(!b.Pa){b=!1;break a}c=b.m[b.c];d=b.m[b.c+1]}b=!0}if(!b)return!1}else if("("===b)a.Ee[a.Kb]=a.d.i,a.Kb++,a.c++;else if(")"===b)a.Kb--,a.d.i=a.Ee[a.Kb],a.c++;else return!1}else return!1;return!0}function W(a,b){void 0===b&&(b="]");for(var c="";void 0!==a.m[a.c]&&b!==a.m[a.c];)c+=a.m[a.c],a.c++;void 0===a.m[a.c]&&(a.Pa=!1);a.c++;return c}function Rc(a){a=parseFloat(W(a,void 0));return isNaN(a)?0:a}function Tc(a){a=parseInt(W(a,void 0));return isNaN(a)?0:a}function $(a){for(;;){for(;void 0!==a.m[a.c]&&"]"!==a.m[a.c]&&a.c<a.ic;)for(a.c++;"]"===a.m[a.c]&&"\\"===a.m[a.c-1];)a.c++;a.c++;if("["!==a.m[a.c])break}}function Pc(a,b){a.c+=3;var c=[];if("]"!==a.m[a.c]){for(;;){var d=a.m[a.c];a.c++;var f=a.m[a.c];a.c++;c.push((f.charCodeAt(0)-96<<8)+(d.charCodeAt(0)-96));if("]"!==a.m[a.c]){a.Pa=!1;return}a.c++;if("["!==a.m[a.c])break;a.c++}a.d.qc(b,c)}}function Qc(a,b){a.c+=2;if("]"==a.m[a.c])a.d.Ab(0,0,b);else{var c=a.m[a.c];a.c++;var d=a.m[a.c];a.c++;var f=a.d.W.O();"t"===c&&"t"===d&&19>=f.f&&19>=f.g?a.d.Ab(0,0,b):(a.d.Ab(c.charCodeAt(0)-96,d.charCodeAt(0)-96,b),"]"!==a.m[a.c]&&(a.Pa=!1))}a.c++}function Sc(a,b){var c=0;a.c+=3;var d=[];if("]"!==a.m[a.c]){for(;;){var f=a.m[a.c];a.c++;var e=a.m[a.c];a.c++;d[c]=(e.charCodeAt(0)-96<<8)+(f.charCodeAt(0)-96);c++;if("]"!==a.m[a.c]){a.Pa=!1;return}a.c++;if("["!==a.m[a.c])break;a.c++}a.d.ma(b,d)}}function Uc(a,b){var c=0;a.c+=3;var d=[];if("]"!==a.m[a.c]){for(;;){var f=a.m[a.c];a.c++;var e=a.m[a.c];a.c++;d[c]=(e.charCodeAt(0)-96<<8)+(f.charCodeAt(0)-96);c++;if("]"!==a.m[a.c]){a.Pa=!1;return}a.c++;if("["!==a.m[a.c])break;a.c++}a.d.sd(b,d)}};function Nc(){this.ob=!1;this.wa={}};}());